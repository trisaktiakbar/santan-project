(self["webpackChunksantan_vuejs"]=self["webpackChunksantan_vuejs"]||[]).push([[998],{4552:function(t,e,n){"use strict";n(560);var r,i,o=n(199),s=n(9658),a=n(8914),l=n(7e3),u=(r={},r["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",r["bad-app-name"]="Illegal App name: '{$appName}",r["duplicate-app"]="Firebase App named '{$appName}' already exists",r["app-deleted"]="Firebase App named '{$appName}' already deleted",r["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",r["invalid-log-argument"]="First argument to `onLog` must be null or a function.",r),c=new s.LL("app","Firebase",u),h="@firebase/app",d="0.6.30",p="@firebase/analytics",f="@firebase/app-check",g="@firebase/auth",m="@firebase/database",y="@firebase/functions",b="@firebase/installations",v="@firebase/messaging",w="@firebase/performance",x="@firebase/remote-config",k="@firebase/storage",_="@firebase/firestore",I="firebase-wrapper",C="[DEFAULT]",S=(i={},i[h]="fire-core",i[p]="fire-analytics",i[f]="fire-app-check",i[g]="fire-auth",i[m]="fire-rtdb",i[y]="fire-fn",i[b]="fire-iid",i[v]="fire-fcm",i[w]="fire-perf",i[x]="fire-rc",i[k]="fire-gcs",i[_]="fire-fst",i["fire-js"]="fire-js",i[I]="fire-js-all",i),T=new l.Yd("@firebase/app"),E=function(){function t(t,e,n){var r=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=(0,s.p$)(t),this.container=new a.H0(e.name),this._addComponent(new a.wA("app",(function(){return r}),"PUBLIC")),this.firebase_.INTERNAL.components.forEach((function(t){return r._addComponent(t)}))}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){var n;void 0===e&&(e=C),this.checkDestroyed_();var r=this.container.getProvider(t);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=C),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){T.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw c.create("app-deleted",{appName:this.name_})},t}();E.prototype.name&&E.prototype.options||E.prototype.delete||console.log("dc");var N="8.10.0";
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A(t){var e={},n=new Map,r={__esModule:!0,initializeApp:u,app:o,registerVersion:p,setLogLevel:l.Ub,onLog:f,apps:null,SDK_VERSION:N,INTERNAL:{registerComponent:d,removeApp:i,components:n,useAsService:g}};function i(t){delete e[t]}function o(t){if(t=t||C,!(0,s.r3)(e,t))throw c.create("no-app",{appName:t});return e[t]}function u(n,i){if(void 0===i&&(i={}),"object"!==typeof i||null===i){var o=i;i={name:o}}var a=i;void 0===a.name&&(a.name=C);var l=a.name;if("string"!==typeof l||!l)throw c.create("bad-app-name",{appName:String(l)});if((0,s.r3)(e,l))throw c.create("duplicate-app",{appName:l});var u=new t(n,a,r);return e[l]=u,u}function h(){return Object.keys(e).map((function(t){return e[t]}))}function d(i){var a=i.name;if(n.has(a))return T.debug("There were multiple attempts to register component "+a+"."),"PUBLIC"===i.type?r[a]:null;if(n.set(a,i),"PUBLIC"===i.type){var l=function(t){if(void 0===t&&(t=o()),"function"!==typeof t[a])throw c.create("invalid-app-argument",{appName:a});return t[a]()};void 0!==i.serviceProps&&(0,s.ZB)(l,i.serviceProps),r[a]=l,t.prototype[a]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this._getService.bind(this,a);return n.apply(this,i.multipleInstances?t:[])}}for(var u=0,h=Object.keys(e);u<h.length;u++){var d=h[u];e[d]._addComponent(i)}return"PUBLIC"===i.type?r[a]:null}function p(t,e,n){var r,i=null!==(r=S[t])&&void 0!==r?r:t;n&&(i+="-"+n);var o=i.match(/\s|\//),s=e.match(/\s|\//);if(o||s){var l=['Unable to register library "'+i+'" with version "'+e+'":'];return o&&l.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),o&&s&&l.push("and"),s&&l.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void T.warn(l.join(" "))}d(new a.wA(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))}function f(t,e){if(null!==t&&"function"!==typeof t)throw c.create("invalid-log-argument");(0,l.Am)(t,e)}function g(t,e){if("serverAuth"===e)return null;var n=e;return n}return r["default"]=r,Object.defineProperty(r,"apps",{get:h}),o["App"]=t,r}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R(){var t=A(E);function e(e){(0,s.ZB)(t,e)}return t.INTERNAL=(0,o.pi)((0,o.pi)({},t.INTERNAL),{createFirebaseNamespace:R,extendNamespace:e,createSubscribe:s.ne,ErrorFactory:s.LL,deepExtend:s.ZB}),t}var $=R(),D=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){var t=this.container.getProviders();return t.map((function(t){if(O(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O(t){var e=t.getComponent();return"VERSION"===(null===e||void 0===e?void 0:e.type)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F(t,e){t.INTERNAL.registerComponent(new a.wA("platform-logger",(function(t){return new D(t)}),"PRIVATE")),t.registerVersion(h,d,e),t.registerVersion("fire-js","")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */if((0,s.jU)()&&void 0!==self.firebase){T.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var M=self.firebase.SDK_VERSION;M&&M.indexOf("LITE")>=0&&T.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var P=$.initializeApp;$.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return(0,s.UG)()&&T.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),P.apply(void 0,t)};var L=$;F(L),e.Z=L},8914:function(t,e,n){"use strict";n.d(e,{H0:function(){return c},wA:function(){return o},zt:function(){return a}});var r=n(199),i=n(9658),o=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t.prototype.setInstanceCreatedCallback=function(t){return this.onInstanceCreated=t,this},t}(),s="[DEFAULT]",a=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return t.prototype.get=function(t){var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new i.BH;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:e});r&&n.resolve(r)}catch(o){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e,n=this.normalizeInstanceIdentifier(null===t||void 0===t?void 0:t.identifier),r=null!==(e=null===t||void 0===t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,this.shouldAutoInitialize()){if(u(t))try{this.getOrInitializeService({instanceIdentifier:s})}catch(p){}try{for(var i=(0,r.XA)(this.instancesDeferred.entries()),o=i.next();!o.done;o=i.next()){var a=(0,r.CR)(o.value,2),l=a[0],c=a[1],h=this.normalizeInstanceIdentifier(l);try{var d=this.getOrInitializeService({instanceIdentifier:h});c.resolve(d)}catch(p){}}}catch(f){e={error:f}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}}},t.prototype.clearInstance=function(t){void 0===t&&(t=s),this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return(0,r.mG)(this,void 0,void 0,(function(){var t;return(0,r.Jh)(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all((0,r.ev)((0,r.ev)([],(0,r.CR)(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})))),(0,r.CR)(t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()})))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.isInitialized=function(t){return void 0===t&&(t=s),this.instances.has(t)},t.prototype.getOptions=function(t){return void 0===t&&(t=s),this.instancesOptions.get(t)||{}},t.prototype.initialize=function(t){var e,n;void 0===t&&(t={});var i=t.options,o=void 0===i?{}:i,s=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(s))throw Error(this.name+"("+s+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var a=this.getOrInitializeService({instanceIdentifier:s,options:o});try{for(var l=(0,r.XA)(this.instancesDeferred.entries()),u=l.next();!u.done;u=l.next()){var c=(0,r.CR)(u.value,2),h=c[0],d=c[1],p=this.normalizeInstanceIdentifier(h);s===p&&d.resolve(a)}}catch(f){e={error:f}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(e)throw e.error}}return a},t.prototype.onInit=function(t,e){var n,r=this.normalizeInstanceIdentifier(e),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(t),this.onInitCallbacks.set(r,i);var o=this.instances.get(r);return o&&t(o,r),function(){i.delete(t)}},t.prototype.invokeOnInitCallbacks=function(t,e){var n,i,o=this.onInitCallbacks.get(e);if(o)try{for(var s=(0,r.XA)(o),a=s.next();!a.done;a=s.next()){var l=a.value;try{l(t,e)}catch(u){}}}catch(c){n={error:c}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}},t.prototype.getOrInitializeService=function(t){var e=t.instanceIdentifier,n=t.options,r=void 0===n?{}:n,i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:l(e),options:r}),this.instances.set(e,i),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch(o){}return i||null},t.prototype.normalizeInstanceIdentifier=function(t){return void 0===t&&(t=s),this.component?this.component.multipleInstances?t:s:t},t.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},t}();function l(t){return t===s?void 0:t}function u(t){return"EAGER"===t.instantiationMode}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var c=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){var e=this.getProvider(t.name);e.isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new a(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}()},5706:function(t,e,n){"use strict";n(560);var r=n(4552),i=n(8914),o=n(9658),s=n(199),a=n(7e3);t=n.hmd(t);var l="@firebase/database",u="0.11.0",c="";function h(t){c=t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var d=function(){function t(t){this.domStorage_=t,this.prefix_="firebase:"}return t.prototype.set=function(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),(0,o.Pz)(e))},t.prototype.get=function(t){var e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:(0,o.cI)(e)},t.prototype.remove=function(t){this.domStorage_.removeItem(this.prefixedName_(t))},t.prototype.prefixedName_=function(t){return this.prefix_+t},t.prototype.toString=function(){return this.domStorage_.toString()},t}(),p=function(){function t(){this.cache_={},this.isInMemoryStorage=!0}return t.prototype.set=function(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e},t.prototype.get=function(t){return(0,o.r3)(this.cache_,t)?this.cache_[t]:null},t.prototype.remove=function(t){delete this.cache_[t]},t}(),f=function(t){try{if("undefined"!==typeof window&&"undefined"!==typeof window[t]){var e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new d(e)}}catch(n){}return new p},g=f("localStorage"),m=f("sessionStorage"),y=new a.Yd("@firebase/database"),b=function(){var t=1;return function(){return t++}}(),v=function(t){var e=(0,o.dS)(t),n=new o.gQ;n.update(e);var r=n.digest();return o.US.encodeByteArray(r)},w=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n="",r=0;r<t.length;r++){var i=t[r];Array.isArray(i)||i&&"object"===typeof i&&"number"===typeof i.length?n+=w.apply(null,i):n+="object"===typeof i?(0,o.Pz)(i):i,n+=" "}return n},x=null,k=!0,_=function(t,e){(0,o.hu)(!e||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(y.logLevel=a["in"].VERBOSE,x=y.log.bind(y),e&&m.set("logging_enabled",!0)):"function"===typeof t?x=t:(x=null,m.remove("logging_enabled"))},I=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!0===k&&(k=!1,null===x&&!0===m.get("logging_enabled")&&_(!0)),x){var n=w.apply(null,t);x(n)}},C=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];I.apply(void 0,(0,s.ev)([t],(0,s.CR)(e)))}},S=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE INTERNAL ERROR: "+w.apply(void 0,(0,s.ev)([],(0,s.CR)(t)));y.error(n)},T=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE FATAL ERROR: "+w.apply(void 0,(0,s.ev)([],(0,s.CR)(t)));throw y.error(n),new Error(n)},E=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE WARNING: "+w.apply(void 0,(0,s.ev)([],(0,s.CR)(t)));y.warn(n)},N=function(){"undefined"!==typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&E("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},A=function(t){return"number"===typeof t&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},R=function(t){if((0,o.Yr)()||"complete"===document.readyState)t();else{var e=!1,n=function(){document.body?e||(e=!0,t()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}},$="[MIN_NAME]",D="[MAX_NAME]",O=function(t,e){if(t===e)return 0;if(t===$||e===D)return-1;if(e===$||t===D)return 1;var n=q(t),r=q(e);return null!==n?null!==r?n-r===0?t.length-e.length:n-r:-1:null!==r?1:t<e?-1:1},F=function(t,e){return t===e?0:t<e?-1:1},M=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+(0,o.Pz)(e))},P=function(t){if("object"!==typeof t||null===t)return(0,o.Pz)(t);var e=[];for(var n in t)e.push(n);e.sort();for(var r="{",i=0;i<e.length;i++)0!==i&&(r+=","),r+=(0,o.Pz)(e[i]),r+=":",r+=P(t[e[i]]);return r+="}",r},L=function(t,e){var n=t.length;if(n<=e)return[t];for(var r=[],i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z(t,e){for(var n in t)t.hasOwnProperty(n)&&e(n,t[n])}var B=function(t){(0,o.hu)(!A(t),"Invalid JSON number");var e,n,r,i,s,a=11,l=52,u=(1<<a-1)-1;0===t?(n=0,r=0,e=1/t===-1/0?1:0):(e=t<0,t=Math.abs(t),t>=Math.pow(2,1-u)?(i=Math.min(Math.floor(Math.log(t)/Math.LN2),u),n=i+u,r=Math.round(t*Math.pow(2,l-i)-Math.pow(2,l))):(n=0,r=Math.round(t/Math.pow(2,1-u-l))));var c=[];for(s=l;s;s-=1)c.push(r%2?1:0),r=Math.floor(r/2);for(s=a;s;s-=1)c.push(n%2?1:0),n=Math.floor(n/2);c.push(e?1:0),c.reverse();var h=c.join(""),d="";for(s=0;s<64;s+=8){var p=parseInt(h.substr(s,8),2).toString(16);1===p.length&&(p="0"+p),d+=p}return d.toLowerCase()},W=function(){return!("object"!==typeof window||!window["chrome"]||!window["chrome"]["extension"]||/^chrome/.test(window.location.href))},U=function(){return"object"===typeof Windows&&"object"===typeof Windows.UI};function V(t,e){var n="Unknown Error";"too_big"===t?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===t?n="Client doesn't have permission to access the desired data.":"unavailable"===t&&(n="The service is unavailable");var r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}var j=new RegExp("^-?(0*)\\d{1,10}$"),H=-2147483648,G=2147483647,q=function(t){if(j.test(t)){var e=Number(t);if(e>=H&&e<=G)return e}return null},K=function(t){try{t()}catch(e){setTimeout((function(){var t=e.stack||"";throw E("Exception was thrown by user callback.",t),e}),Math.floor(0))}},X=function(){var t="object"===typeof window&&window["navigator"]&&window["navigator"]["userAgent"]||"";return t.search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Y=function(t,e){var n=setTimeout(t,e);return"object"===typeof n&&n["unref"]&&n["unref"](),n},J=function(){function t(t,e){var n=this;this.appName_=t,this.appCheckProvider=e,this.appCheck=null===e||void 0===e?void 0:e.getImmediate({optional:!0}),this.appCheck||null===e||void 0===e||e.get().then((function(t){return n.appCheck=t}))}return t.prototype.getToken=function(t){var e=this;return this.appCheck?this.appCheck.getToken(t):new Promise((function(n,r){setTimeout((function(){e.appCheck?e.getToken(t).then(n,r):n(null)}),0)}))},t.prototype.addTokenChangeListener=function(t){var e;null===(e=this.appCheckProvider)||void 0===e||e.get().then((function(e){return e.addTokenListener(t)}))},t.prototype.notifyForInvalidToken=function(){E('Provided AppCheck credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly.')},t}(),Z=function(){function t(t,e,n){var r=this;this.appName_=t,this.firebaseOptions_=e,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((function(t){return r.auth_=t}))}return t.prototype.getToken=function(t){var e=this;return this.auth_?this.auth_.getToken(t).catch((function(t){return t&&"auth/token-not-initialized"===t.code?(I("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)})):new Promise((function(n,r){setTimeout((function(){e.auth_?e.getToken(t).then(n,r):n(null)}),0)}))},t.prototype.addTokenChangeListener=function(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then((function(e){return e.addAuthTokenListener(t)}))},t.prototype.removeTokenChangeListener=function(t){this.authProvider_.get().then((function(e){return e.removeAuthTokenListener(t)}))},t.prototype.notifyForInvalidToken=function(){var t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',E(t)},t}(),Q=function(){function t(t){this.accessToken=t}return t.prototype.getToken=function(t){return Promise.resolve({accessToken:this.accessToken})},t.prototype.addTokenChangeListener=function(t){t(this.accessToken)},t.prototype.removeTokenChangeListener=function(t){},t.prototype.notifyForInvalidToken=function(){},t.OWNER="owner",t}(),tt="5",et="v",nt="s",rt="r",it="f",ot=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,st="ls",at="p",lt="ac",ut="websocket",ct="long_polling",ht=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=!1),void 0===o&&(o=""),void 0===s&&(s=!1),this.secure=e,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=s,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=g.get("host:"+t)||this._host}return t.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},t.prototype.isCustomHost=function(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain},Object.defineProperty(t.prototype,"host",{get:function(){return this._host},set:function(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&g.set("host:"+this._host,this.internalHost))},enumerable:!1,configurable:!0}),t.prototype.toString=function(){var t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t},t.prototype.toURLString=function(){var t=this.secure?"https://":"http://",e=this.includeNamespaceInQueryParams?"?ns="+this.namespace:"";return""+t+this.host+"/"+e},t}();function dt(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function pt(t,e,n){var r;if((0,o.hu)("string"===typeof e,"typeof type must == string"),(0,o.hu)("object"===typeof n,"typeof params must == object"),e===ut)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else{if(e!==ct)throw new Error("Unknown connection type: "+e);r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?"}dt(t)&&(n["ns"]=t.namespace);var i=[];return z(n,(function(t,e){i.push(t+"="+e)})),r+i.join("&")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ft=function(){function t(){this.counters_={}}return t.prototype.incrementCounter=function(t,e){void 0===e&&(e=1),(0,o.r3)(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e},t.prototype.get=function(){return(0,o.p$)(this.counters_)},t}(),gt={},mt={};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yt(t){var e=t.toString();return gt[e]||(gt[e]=new ft),gt[e]}function bt(t,e){var n=t.toString();return mt[n]||(mt[n]=e()),mt[n]}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vt=function(){function t(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return t.prototype.closeAfter=function(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},t.prototype.handleResponse=function(t,e){var n=this;this.pendingResponses[t]=e;var r=function(){var t=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var e=function(e){t[e]&&K((function(){n.onMessage_(t[e])}))},r=0;r<t.length;++r)e(r);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++},i=this;while(this.pendingResponses[this.currentResponseNum]){var o=r();if("break"===o)break}},t}(),wt="start",xt="close",kt="pLPCommand",_t="pRTLPCB",It="id",Ct="pw",St="ser",Tt="cb",Et="seg",Nt="ts",At="d",Rt="dframe",$t=1870,Dt=30,Ot=$t-Dt,Ft=25e3,Mt=3e4,Pt=function(){function t(t,e,n,r,i,o,s){var a=this;this.connId=t,this.repoInfo=e,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=o,this.lastSessionId=s,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=C(t),this.stats_=yt(e),this.urlFn=function(t){return a.appCheckToken&&(t[lt]=a.appCheckToken),pt(e,ct,t)}}return t.prototype.open=function(t,e){var n=this;this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new vt(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null}),Math.floor(Mt)),R((function(){if(!n.isClosed_){n.scriptTagHolder=new Lt((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=(0,s.CR)(t,5),i=r[0],o=r[1],a=r[2];if(r[3],r[4],n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,i===wt)n.id=o,n.password=a;else{if(i!==xt)throw new Error("Unrecognized command received: "+i);o?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(o,(function(){n.onClosed_()}))):n.onClosed_()}}),(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=(0,s.CR)(t,2),i=r[0],o=r[1];n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(i,o)}),(function(){n.onClosed_()}),n.urlFn);var t={};t[wt]="t",t[St]=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(t[Tt]=n.scriptTagHolder.uniqueCallbackIdentifier),t[et]=tt,n.transportSessionId&&(t[nt]=n.transportSessionId),n.lastSessionId&&(t[st]=n.lastSessionId),n.applicationId&&(t[at]=n.applicationId),n.appCheckToken&&(t[lt]=n.appCheckToken),"undefined"!==typeof location&&location.hostname&&ot.test(location.hostname)&&(t[rt]=it);var e=n.urlFn(t);n.log_("Connecting via long-poll to "+e),n.scriptTagHolder.addTag(e,(function(){}))}}))},t.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},t.forceAllow=function(){t.forceAllow_=!0},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){return!(0,o.Yr)()&&(!!t.forceAllow_||!t.forceDisallow_&&"undefined"!==typeof document&&null!=document.createElement&&!W()&&!U())},t.prototype.markConnectionHealthy=function(){},t.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},t.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},t.prototype.send=function(t){var e=(0,o.Pz)(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);for(var n=(0,o.h$)(e),r=L(n,Ot),i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++},t.prototype.addDisconnectPingFrame=function(t,e){if(!(0,o.Yr)()){this.myDisconnFrame=document.createElement("iframe");var n={};n[Rt]="t",n[It]=t,n[Ct]=e,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},t.prototype.incrementIncomingBytes_=function(t){var e=(0,o.Pz)(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)},t}(),Lt=function(){function t(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,o.Yr)())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=b(),window[kt+this.uniqueCallbackIdentifier]=e,window[_t+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();var s="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)){var a=document.domain;s='<script>document.domain="'+a+'";<\/script>'}var l="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(l),this.myIFrame.doc.close()}catch(u){I("frame writing exception"),u.stack&&I(u.stack),I(u)}}}return t.createIFrame_=function(){var t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{var e=t.contentWindow.document;e||I("No IE domain setting required")}catch(r){var n=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t},t.prototype.close=function(){var t=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((function(){null!==t.myIFrame&&(document.body.removeChild(t.myIFrame),t.myIFrame=null)}),Math.floor(0)));var e=this.onDisconnect;e&&(this.onDisconnect=null,e())},t.prototype.startLongPoll=function(t,e){this.myID=t,this.myPW=e,this.alive=!0;while(this.newRequest_());},t.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var t={};t[It]=this.myID,t[Ct]=this.myPW,t[St]=this.currentSerial;var e=this.urlFn(t),n="",r=0;while(this.pendingSegs.length>0){var i=this.pendingSegs[0];if(!(i.d.length+Dt+n.length<=$t))break;var o=this.pendingSegs.shift();n=n+"&"+Et+r+"="+o.seg+"&"+Nt+r+"="+o.ts+"&"+At+r+"="+o.d,r++}return e+=n,this.addLongPollTag_(e,this.currentSerial),!0}return!1},t.prototype.enqueueSegment=function(t,e,n){this.pendingSegs.push({seg:t,ts:e,d:n}),this.alive&&this.newRequest_()},t.prototype.addLongPollTag_=function(t,e){var n=this;this.outstandingRequests.add(e);var r=function(){n.outstandingRequests.delete(e),n.newRequest_()},i=setTimeout(r,Math.floor(Ft)),o=function(){clearTimeout(i),r()};this.addTag(t,o)},t.prototype.addTag=function(t,e){var n=this;(0,o.Yr)()?this.doNodeLongPoll(t,e):setTimeout((function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=t,r.onload=r.onreadystatechange=function(){var t=r.readyState;t&&"loaded"!==t&&"complete"!==t||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),e())},r.onerror=function(){I("Long-poll script failed to load: "+t),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(i){}}),Math.floor(1))},t}(),zt=16384,Bt=45e3,Wt=null;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */"undefined"!==typeof MozWebSocket?Wt=MozWebSocket:"undefined"!==typeof WebSocket&&(Wt=WebSocket);var Ut=function(){function t(e,n,r,i,o,s,a){this.connId=e,this.applicationId=r,this.appCheckToken=i,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=C(this.connId),this.stats_=yt(n),this.connURL=t.connectionURL_(n,s,a,i),this.nodeAdmin=n.nodeAdmin}return t.connectionURL_=function(t,e,n,r){var i={};return i[et]=tt,!(0,o.Yr)()&&"undefined"!==typeof location&&location.hostname&&ot.test(location.hostname)&&(i[rt]=it),e&&(i[nt]=e),n&&(i[st]=n),r&&(i[lt]=r),pt(t,ut,i)},t.prototype.open=function(t,e){var n=this;this.onDisconnect=e,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,g.set("previous_websocket_failure",!0);try{if((0,o.Yr)()){var r=this.nodeAdmin?"AdminNode":"Node",i={headers:{"User-Agent":"Firebase/"+tt+"/"+c+"/"+process.platform+"/"+r,"X-Firebase-GMPID":this.applicationId||""}};this.authToken&&(i.headers["Authorization"]="Bearer "+this.authToken),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);var s={NODE_ENV:"production",BASE_URL:"/"},a=0===this.connURL.indexOf("wss://")?s["HTTPS_PROXY"]||s["https_proxy"]:s["HTTP_PROXY"]||s["http_proxy"];a&&(i["proxy"]={origin:a}),this.mySock=new Wt(this.connURL,[],i)}else{i={headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}};this.mySock=new Wt(this.connURL,[],i)}}catch(u){this.log_("Error instantiating WebSocket.");var l=u.message||u.data;return l&&this.log_(l),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(t){n.handleIncomingFrame(t)},this.mySock.onerror=function(t){n.log_("WebSocket error.  Closing connection.");var e=t.message||t.data;e&&n.log_(e),n.onClosed_()}},t.prototype.start=function(){},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){var e=!1;if("undefined"!==typeof navigator&&navigator.userAgent){var n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&null!==Wt&&!t.forceDisallow_},t.previouslyFailed=function(){return g.isInMemoryStorage||!0===g.get("previous_websocket_failure")},t.prototype.markConnectionHealthy=function(){g.remove("previous_websocket_failure")},t.prototype.appendFrame_=function(t){if(this.frames.push(t),this.frames.length===this.totalFrames){var e=this.frames.join("");this.frames=null;var n=(0,o.cI)(e);this.onMessage(n)}},t.prototype.handleNewFrameCount_=function(t){this.totalFrames=t,this.frames=[]},t.prototype.extractFrameCount_=function(t){if((0,o.hu)(null===this.frames,"We already have a frame buffer"),t.length<=6){var e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t},t.prototype.handleIncomingFrame=function(t){if(null!==this.mySock){var e=t["data"];if(this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(e);else{var n=this.extractFrameCount_(e);null!==n&&this.appendFrame_(n)}}},t.prototype.send=function(t){this.resetKeepAlive();var e=(0,o.Pz)(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);var n=L(e,zt);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])},t.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},t.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},t.prototype.resetKeepAlive=function(){var t=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((function(){t.mySock&&t.sendString_("0"),t.resetKeepAlive()}),Math.floor(Bt))},t.prototype.sendString_=function(t){try{this.mySock.send(t)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t}(),Vt=function(){function t(t){this.initTransports_(t)}return Object.defineProperty(t,"ALL_TRANSPORTS",{get:function(){return[Pt,Ut]},enumerable:!1,configurable:!0}),t.prototype.initTransports_=function(e){var n,r,i=Ut&&Ut["isAvailable"](),o=i&&!Ut.previouslyFailed();if(e.webSocketOnly&&(i||E("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),o=!0),o)this.transports_=[Ut];else{var a=this.transports_=[];try{for(var l=(0,s.XA)(t.ALL_TRANSPORTS),u=l.next();!u.done;u=l.next()){var c=u.value;c&&c["isAvailable"]()&&a.push(c)}}catch(h){n={error:h}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}}},t.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},t.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},t}(),jt=6e4,Ht=5e3,Gt=10240,qt=102400,Kt="t",Xt="d",Yt="s",Jt="r",Zt="e",Qt="o",te="a",ee="n",ne="p",re="h",ie=function(){function t(t,e,n,r,i,o,s,a,l,u){this.id=t,this.repoInfo_=e,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=o,this.onReady_=s,this.onDisconnect_=a,this.onKill_=l,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=C("c:"+this.id+":"),this.transportManager_=new Vt(e),this.log_("Connection created"),this.start_()}return t.prototype.start_=function(){var t=this,e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e["responsesRequiredToBeHealthy"]||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((function(){t.conn_&&t.conn_.open(n,r)}),Math.floor(0));var i=e["healthyTimeout"]||0;i>0&&(this.healthyTimeout_=Y((function(){t.healthyTimeout_=null,t.isHealthy_||(t.conn_&&t.conn_.bytesReceived>qt?(t.log_("Connection exceeded healthy timeout but has received "+t.conn_.bytesReceived+" bytes.  Marking connection healthy."),t.isHealthy_=!0,t.conn_.markConnectionHealthy()):t.conn_&&t.conn_.bytesSent>Gt?t.log_("Connection exceeded healthy timeout but has sent "+t.conn_.bytesSent+" bytes.  Leaving connection alive."):(t.log_("Closing unhealthy connection after timeout."),t.close()))}),Math.floor(i)))},t.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},t.prototype.disconnReceiver_=function(t){var e=this;return function(n){t===e.conn_?e.onConnectionLost_(n):t===e.secondaryConn_?(e.log_("Secondary connection lost."),e.onSecondaryConnectionLost_()):e.log_("closing an old connection")}},t.prototype.connReceiver_=function(t){var e=this;return function(n){2!==e.state_&&(t===e.rx_?e.onPrimaryMessageReceived_(n):t===e.secondaryConn_?e.onSecondaryMessageReceived_(n):e.log_("message on old connection"))}},t.prototype.sendRequest=function(t){var e={t:"d",d:t};this.sendData_(e)},t.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},t.prototype.onSecondaryControl_=function(t){if(Kt in t){var e=t[Kt];e===te?this.upgradeIfSecondaryHealthy_():e===Jt?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):e===Qt&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},t.prototype.onSecondaryMessageReceived_=function(t){var e=M("t",t),n=M("d",t);if("c"===e)this.onSecondaryControl_(n);else{if("d"!==e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(n)}},t.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:ne,d:{}}}))},t.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:te,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:ee,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},t.prototype.onPrimaryMessageReceived_=function(t){var e=M("t",t),n=M("d",t);"c"===e?this.onControl_(n):"d"===e&&this.onDataMessage_(n)},t.prototype.onDataMessage_=function(t){this.onPrimaryResponse_(),this.onMessage_(t)},t.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},t.prototype.onControl_=function(t){var e=M(Kt,t);if(Xt in t){var n=t[Xt];if(e===re)this.onHandshake_(n);else if(e===ee){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else e===Yt?this.onConnectionShutdown_(n):e===Jt?this.onReset_(n):e===Zt?S("Server Error: "+n):e===Qt?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):S("Unknown control packet command: "+e)}},t.prototype.onHandshake_=function(t){var e=t.ts,n=t.v,r=t.h;this.sessionId=t.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),tt!==n&&E("Protocol version mismatch detected"),this.tryStartUpgrade_())},t.prototype.tryStartUpgrade_=function(){var t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)},t.prototype.startUpgrade_=function(t){var e=this;this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=t["responsesRequiredToBeHealthy"]||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),Y((function(){e.secondaryConn_&&(e.log_("Timed out trying to upgrade."),e.secondaryConn_.close())}),Math.floor(jt))},t.prototype.onReset_=function(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,1===this.state_?this.close():(this.closeConnections_(),this.start_())},t.prototype.onConnectionEstablished_=function(t,e){var n=this;this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Y((function(){n.sendPingOnPrimaryIfNecessary_()}),Math.floor(Ht))},t.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:ne,d:{}}}))},t.prototype.onSecondaryConnectionLost_=function(){var t=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==t&&this.rx_!==t||this.close()},t.prototype.onConnectionLost_=function(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(g.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},t.prototype.onConnectionShutdown_=function(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()},t.prototype.sendData_=function(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)},t.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},t.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},t}(),oe=function(){function t(){}return t.prototype.put=function(t,e,n,r){},t.prototype.merge=function(t,e,n,r){},t.prototype.refreshAuthToken=function(t){},t.prototype.refreshAppCheckToken=function(t){},t.prototype.onDisconnectPut=function(t,e,n){},t.prototype.onDisconnectMerge=function(t,e,n){},t.prototype.onDisconnectCancel=function(t,e){},t.prototype.reportStats=function(t){},t}(),se=function(){function t(t){this.allowedEvents_=t,this.listeners_={},(0,o.hu)(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}return t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Array.isArray(this.listeners_[t]))for(var r=(0,s.ev)([],(0,s.CR)(this.listeners_[t])),i=0;i<r.length;i++)r[i].callback.apply(r[i].context,e)},t.prototype.on=function(t,e,n){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:n});var r=this.getInitialEvent(t);r&&e.apply(n,r)},t.prototype.off=function(t,e,n){this.validateEventType_(t);for(var r=this.listeners_[t]||[],i=0;i<r.length;i++)if(r[i].callback===e&&(!n||n===r[i].context))return void r.splice(i,1)},t.prototype.validateEventType_=function(t){(0,o.hu)(this.allowedEvents_.find((function(e){return e===t})),"Unknown event: "+t)},t}(),ae=function(t){function e(){var e=t.call(this,["online"])||this;return e.online_=!0,"undefined"===typeof window||"undefined"===typeof window.addEventListener||(0,o.uI)()||(window.addEventListener("online",(function(){e.online_||(e.online_=!0,e.trigger("online",!0))}),!1),window.addEventListener("offline",(function(){e.online_&&(e.online_=!1,e.trigger("online",!1))}),!1)),e}return(0,s.ZT)(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return(0,o.hu)("online"===t,"Unknown event type: "+t),[this.online_]},e.prototype.currentlyOnline=function(){return this.online_},e}(se),le=32,ue=768,ce=function(){function t(t,e){if(void 0===e){this.pieces_=t.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}return t.prototype.toString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function he(){return new ce("")}function de(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function pe(t){return t.pieces_.length-t.pieceNum_}function fe(t){var e=t.pieceNum_;return e<t.pieces_.length&&e++,new ce(t.pieces_,e)}function ge(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function me(t){for(var e="",n=t.pieceNum_;n<t.pieces_.length;n++)""!==t.pieces_[n]&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function ye(t,e){return void 0===e&&(e=0),t.pieces_.slice(t.pieceNum_+e)}function be(t){if(t.pieceNum_>=t.pieces_.length)return null;for(var e=[],n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new ce(e,0)}function ve(t,e){for(var n=[],r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof ce)for(r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{var i=e.split("/");for(r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new ce(n,0)}function we(t){return t.pieceNum_>=t.pieces_.length}function xe(t,e){var n=de(t),r=de(e);if(null===n)return e;if(n===r)return xe(fe(t),fe(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function ke(t,e){for(var n=ye(t,0),r=ye(e,0),i=0;i<n.length&&i<r.length;i++){var o=O(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1}function _e(t,e){if(pe(t)!==pe(e))return!1;for(var n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function Ie(t,e){var n=t.pieceNum_,r=e.pieceNum_;if(pe(t)>pe(e))return!1;while(n<t.pieces_.length){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}var Ce=function(){function t(t,e){this.errorPrefix_=e,this.parts_=ye(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=(0,o.ug)(this.parts_[n]);Ee(this)}return t}();function Se(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=(0,o.ug)(e),Ee(t)}function Te(t){var e=t.parts_.pop();t.byteLength_-=(0,o.ug)(e),t.parts_.length>0&&(t.byteLength_-=1)}function Ee(t){if(t.byteLength_>ue)throw new Error(t.errorPrefix_+"has a key path longer than "+ue+" bytes ("+t.byteLength_+").");if(t.parts_.length>le)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+le+") or object contains a cycle "+Ne(t))}function Ne(t){return 0===t.parts_.length?"":"in property '"+t.parts_.join(".")+"'"}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ae,Re,$e=function(t){function e(){var e,n,r=t.call(this,["visible"])||this;return"undefined"!==typeof document&&"undefined"!==typeof document.addEventListener&&("undefined"!==typeof document["hidden"]?(n="visibilitychange",e="hidden"):"undefined"!==typeof document["mozHidden"]?(n="mozvisibilitychange",e="mozHidden"):"undefined"!==typeof document["msHidden"]?(n="msvisibilitychange",e="msHidden"):"undefined"!==typeof document["webkitHidden"]&&(n="webkitvisibilitychange",e="webkitHidden")),r.visible_=!0,n&&document.addEventListener(n,(function(){var t=!document[e];t!==r.visible_&&(r.visible_=t,r.trigger("visible",t))}),!1),r}return(0,s.ZT)(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return(0,o.hu)("visible"===t,"Unknown event type: "+t),[this.visible_]},e}(se),De=1e3,Oe=3e5,Fe=3e3,Me=3e4,Pe=1.3,Le=3e4,ze="server_kill",Be=3,We=function(t){function e(n,r,i,s,a,l,u,c){var h=t.call(this)||this;if(h.repoInfo_=n,h.applicationId_=r,h.onDataUpdate_=i,h.onConnectStatus_=s,h.onServerInfoUpdate_=a,h.authTokenProvider_=l,h.appCheckTokenProvider_=u,h.authOverride_=c,h.id=e.nextPersistentConnectionId_++,h.log_=C("p:"+h.id+":"),h.interruptReasons_={},h.listens=new Map,h.outstandingPuts_=[],h.outstandingGets_=[],h.outstandingPutCount_=0,h.outstandingGetCount_=0,h.onDisconnectRequestQueue_=[],h.connected_=!1,h.reconnectDelay_=De,h.maxReconnectDelay_=Oe,h.securityDebugCallback_=null,h.lastSessionId=null,h.establishConnectionTimer_=null,h.visible_=!1,h.requestCBHash_={},h.requestNumber_=0,h.realtime_=null,h.authToken_=null,h.appCheckToken_=null,h.forceTokenRefresh_=!1,h.invalidAuthTokenCount_=0,h.invalidAppCheckTokenCount_=0,h.firstConnection_=!0,h.lastConnectionAttemptTime_=null,h.lastConnectionEstablishedTime_=null,c&&!(0,o.Yr)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return $e.getInstance().on("visible",h.onVisible_,h),-1===n.host.indexOf("fblocal")&&ae.getInstance().on("online",h.onOnline_,h),h}return(0,s.ZT)(e,t),e.prototype.sendRequest=function(t,e,n){var r=++this.requestNumber_,i={r:r,a:t,b:e};this.log_((0,o.Pz)(i)),(0,o.hu)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)},e.prototype.get=function(t){var e=this;this.initConnection_();var n=new o.BH,r={p:t._path.toString(),q:t._queryObject},i={action:"g",request:r,onComplete:function(t){var i=t["d"];"ok"===t["s"]?(e.onDataUpdate_(r["p"],i,!1,null),n.resolve(i)):n.reject(i)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;var s=this.outstandingGets_.length-1;return this.connected_||setTimeout((function(){var t=e.outstandingGets_[s];void 0!==t&&i===t&&(delete e.outstandingGets_[s],e.outstandingGetCount_--,0===e.outstandingGetCount_&&(e.outstandingGets_=[]),e.log_("get "+s+" timed out on connection"),n.reject(new Error("Client is offline.")))}),Fe),this.connected_&&this.sendGet_(s),n.promise},e.prototype.listen=function(t,e,n,r){this.initConnection_();var i=t._queryIdentifier,s=t._path.toString();this.log_("Listen called for "+s+" "+i),this.listens.has(s)||this.listens.set(s,new Map),(0,o.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,o.hu)(!this.listens.get(s).has(i),"listen() called twice for same path/queryId.");var a={onComplete:r,hashFn:e,query:t,tag:n};this.listens.get(s).set(i,a),this.connected_&&this.sendListen_(a)},e.prototype.sendGet_=function(t){var e=this,n=this.outstandingGets_[t];this.sendRequest("g",n.request,(function(r){delete e.outstandingGets_[t],e.outstandingGetCount_--,0===e.outstandingGetCount_&&(e.outstandingGets_=[]),n.onComplete&&n.onComplete(r)}))},e.prototype.sendListen_=function(t){var n=this,r=t.query,i=r._path.toString(),o=r._queryIdentifier;this.log_("Listen on "+i+" for "+o);var s={p:i},a="q";t.tag&&(s["q"]=r._queryObject,s["t"]=t.tag),s["h"]=t.hashFn(),this.sendRequest(a,s,(function(s){var a=s["d"],l=s["s"];e.warnOnListenWarnings_(a,r);var u=n.listens.get(i)&&n.listens.get(i).get(o);u===t&&(n.log_("listen response",s),"ok"!==l&&n.removeListen_(i,o),t.onComplete&&t.onComplete(l,a))}))},e.warnOnListenWarnings_=function(t,e){if(t&&"object"===typeof t&&(0,o.r3)(t,"w")){var n=(0,o.DV)(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+e._queryParams.getIndex().toString()+'"',i=e._path.toString();E("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+r+" at "+i+" to your security rules for better performance.")}}},e.prototype.refreshAuthToken=function(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(function(){})),this.reduceReconnectDelayIfAdminCredential_(t)},e.prototype.reduceReconnectDelayIfAdminCredential_=function(t){var e=t&&40===t.length;(e||(0,o.GJ)(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=Me)},e.prototype.refreshAppCheckToken=function(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(function(){}))},e.prototype.tryAuth=function(){var t=this;if(this.connected_&&this.authToken_){var e=this.authToken_,n=(0,o.w9)(e)?"auth":"gauth",r={cred:e};null===this.authOverride_?r["noauth"]=!0:"object"===typeof this.authOverride_&&(r["authvar"]=this.authOverride_),this.sendRequest(n,r,(function(n){var r=n["s"],i=n["d"]||"error";t.authToken_===e&&("ok"===r?t.invalidAuthTokenCount_=0:t.onAuthRevoked_(r,i))}))}},e.prototype.tryAppCheck=function(){var t=this;this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(function(e){var n=e["s"],r=e["d"]||"error";"ok"===n?t.invalidAppCheckTokenCount_=0:t.onAppCheckRevoked_(n,r)}))},e.prototype.unlisten=function(t,e){var n=t._path.toString(),r=t._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),(0,o.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query");var i=this.removeListen_(n,r);i&&this.connected_&&this.sendUnlisten_(n,r,t._queryObject,e)},e.prototype.sendUnlisten_=function(t,e,n,r){this.log_("Unlisten on "+t+" for "+e);var i={p:t},o="n";r&&(i["q"]=n,i["t"]=r),this.sendRequest(o,i)},e.prototype.onDisconnectPut=function(t,e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:n})},e.prototype.onDisconnectMerge=function(t,e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:e,onComplete:n})},e.prototype.onDisconnectCancel=function(t,e){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,e):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:e})},e.prototype.sendOnDisconnect_=function(t,e,n,r){var i={p:e,d:n};this.log_("onDisconnect "+t,i),this.sendRequest(t,i,(function(t){r&&setTimeout((function(){r(t["s"],t["d"])}),Math.floor(0))}))},e.prototype.put=function(t,e,n,r){this.putInternal("p",t,e,n,r)},e.prototype.merge=function(t,e,n,r){this.putInternal("m",t,e,n,r)},e.prototype.putInternal=function(t,e,n,r,i){this.initConnection_();var o={p:e,d:n};void 0!==i&&(o["h"]=i),this.outstandingPuts_.push({action:t,request:o,onComplete:r}),this.outstandingPutCount_++;var s=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(s):this.log_("Buffering put: "+e)},e.prototype.sendPut_=function(t){var e=this,n=this.outstandingPuts_[t].action,r=this.outstandingPuts_[t].request,i=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(n,r,(function(r){e.log_(n+" response",r),delete e.outstandingPuts_[t],e.outstandingPutCount_--,0===e.outstandingPutCount_&&(e.outstandingPuts_=[]),i&&i(r["s"],r["d"])}))},e.prototype.reportStats=function(t){var e=this;if(this.connected_){var n={c:t};this.log_("reportStats",n),this.sendRequest("s",n,(function(t){var n=t["s"];if("ok"!==n){var r=t["d"];e.log_("reportStats","Error sending stats: "+r)}}))}},e.prototype.onDataMessage_=function(t){if("r"in t){this.log_("from server: "+(0,o.Pz)(t));var e=t["r"],n=this.requestCBHash_[e];n&&(delete this.requestCBHash_[e],n(t["b"]))}else{if("error"in t)throw"A server-side error has occurred: "+t["error"];"a"in t&&this.onDataPush_(t["a"],t["b"])}},e.prototype.onDataPush_=function(t,e){this.log_("handleServerMessage",t,e),"d"===t?this.onDataUpdate_(e["p"],e["d"],!1,e["t"]):"m"===t?this.onDataUpdate_(e["p"],e["d"],!0,e["t"]):"c"===t?this.onListenRevoked_(e["p"],e["q"]):"ac"===t?this.onAuthRevoked_(e["s"],e["d"]):"apc"===t?this.onAppCheckRevoked_(e["s"],e["d"]):"sd"===t?this.onSecurityDebugPacket_(e):S("Unrecognized action received from server: "+(0,o.Pz)(t)+"\nAre you using the latest client?")},e.prototype.onReady_=function(t,e){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=e,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},e.prototype.scheduleConnect_=function(t){var e=this;(0,o.hu)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((function(){e.establishConnectionTimer_=null,e.establishConnection_()}),Math.floor(t))},e.prototype.initConnection_=function(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)},e.prototype.onVisible_=function(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=De,this.realtime_||this.scheduleConnect_(0)),this.visible_=t},e.prototype.onOnline_=function(t){t?(this.log_("Browser went online."),this.reconnectDelay_=De,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},e.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){var t=(new Date).getTime()-this.lastConnectionEstablishedTime_;t>Le&&(this.reconnectDelay_=De),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();var e=(new Date).getTime()-this.lastConnectionAttemptTime_,n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*Pe)}this.onConnectStatus_(!1)},e.prototype.establishConnection_=function(){return(0,s.mG)(this,void 0,void 0,(function(){var t,n,r,i,a,l,u,c,h,d,p,f,g,m,y=this;return(0,s.Jh)(this,(function(b){switch(b.label){case 0:if(!this.shouldReconnect_())return[3,4];this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null,t=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+e.nextConnectionId_++,a=this.lastSessionId,l=!1,u=null,c=function(){u?u.close():(l=!0,r())},h=function(t){(0,o.hu)(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(t)},this.realtime_={close:c,sendRequest:h},d=this.forceTokenRefresh_,this.forceTokenRefresh_=!1,b.label=1;case 1:return b.trys.push([1,3,,4]),[4,Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)])];case 2:return p=s.CR.apply(void 0,[b.sent(),2]),f=p[0],g=p[1],l?I("getToken() completed but was canceled"):(I("getToken() completed. Creating connection."),this.authToken_=f&&f.accessToken,this.appCheckToken_=g&&g.token,u=new ie(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,n,r,(function(t){E(t+" ("+y.repoInfo_.toString()+")"),y.interrupt(ze)}),a)),[3,4];case 3:return m=b.sent(),this.log_("Failed to get token: "+m),l||(this.repoInfo_.nodeAdmin&&E(m),c()),[3,4];case 4:return[2]}}))}))},e.prototype.interrupt=function(t){I("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},e.prototype.resume=function(t){I("Resuming connection for reason: "+t),delete this.interruptReasons_[t],(0,o.xb)(this.interruptReasons_)&&(this.reconnectDelay_=De,this.realtime_||this.scheduleConnect_(0))},e.prototype.handleTimestamp_=function(t){var e=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:e})},e.prototype.cancelSentTransactions_=function(){for(var t=0;t<this.outstandingPuts_.length;t++){var e=this.outstandingPuts_[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},e.prototype.onListenRevoked_=function(t,e){var n;n=e?e.map((function(t){return P(t)})).join("$"):"default";var r=this.removeListen_(t,n);r&&r.onComplete&&r.onComplete("permission_denied")},e.prototype.removeListen_=function(t,e){var n,r=new ce(t).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(e),i.delete(e),0===i.size&&this.listens.delete(r)}else n=void 0;return n},e.prototype.onAuthRevoked_=function(t,e){I("Auth token revoked: "+t+"/"+e),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=Be&&(this.reconnectDelay_=Me,this.authTokenProvider_.notifyForInvalidToken()))},e.prototype.onAppCheckRevoked_=function(t,e){I("App check token revoked: "+t+"/"+e),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=Be&&this.appCheckTokenProvider_.notifyForInvalidToken())},e.prototype.onSecurityDebugPacket_=function(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t["msg"].replace("\n","\nFIREBASE: "))},e.prototype.restoreState_=function(){var t,e,n,r;this.tryAuth(),this.tryAppCheck();try{for(var i=(0,s.XA)(this.listens.values()),o=i.next();!o.done;o=i.next()){var a=o.value;try{for(var l=(n=void 0,(0,s.XA)(a.values())),u=l.next();!u.done;u=l.next()){var c=u.value;this.sendListen_(c)}}catch(p){n={error:p}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}}}catch(f){t={error:f}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}for(var h=0;h<this.outstandingPuts_.length;h++)this.outstandingPuts_[h]&&this.sendPut_(h);while(this.onDisconnectRequestQueue_.length){var d=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(d.action,d.pathString,d.data,d.onComplete)}for(h=0;h<this.outstandingGets_.length;h++)this.outstandingGets_[h]&&this.sendGet_(h)},e.prototype.sendConnectStats_=function(){var t={},e="js";(0,o.Yr)()&&(e=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+e+"."+c.replace(/\./g,"-")]=1,(0,o.uI)()?t["framework.cordova"]=1:(0,o.b$)()&&(t["framework.reactnative"]=1),this.reportStats(t)},e.prototype.shouldReconnect_=function(){var t=ae.getInstance().currentlyOnline();return(0,o.xb)(this.interruptReasons_)&&t},e.nextPersistentConnectionId_=0,e.nextConnectionId_=0,e}(oe),Ue=function(){function t(t,e){this.name=t,this.node=e}return t.Wrap=function(e,n){return new t(e,n)},t}(),Ve=function(){function t(){}return t.prototype.getCompare=function(){return this.compare.bind(this)},t.prototype.indexedValueChanged=function(t,e){var n=new Ue($,t),r=new Ue($,e);return 0!==this.compare(n,r)},t.prototype.minPost=function(){return Ue.MIN},t}(),je=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,s.ZT)(e,t),Object.defineProperty(e,"__EMPTY_NODE",{get:function(){return Ae},set:function(t){Ae=t},enumerable:!1,configurable:!0}),e.prototype.compare=function(t,e){return O(t.name,e.name)},e.prototype.isDefinedOn=function(t){throw(0,o.g5)("KeyIndex.isDefinedOn not expected to be called.")},e.prototype.indexedValueChanged=function(t,e){return!1},e.prototype.minPost=function(){return Ue.MIN},e.prototype.maxPost=function(){return new Ue(D,Ae)},e.prototype.makePost=function(t,e){return(0,o.hu)("string"===typeof t,"KeyIndex indexValue must always be a string."),new Ue(t,Ae)},e.prototype.toString=function(){return".key"},e}(Ve),He=new je,Ge=function(){function t(t,e,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];var o=1;while(!t.isEmpty())if(o=e?n(t.key,e):1,r&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}return t.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_){e=e.left;while(!e.isEmpty())this.nodeStack_.push(e),e=e.right}else{e=e.right;while(!e.isEmpty())this.nodeStack_.push(e),e=e.left}return t},t.prototype.hasNext=function(){return this.nodeStack_.length>0},t.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}},t}(),qe=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:Xe.EMPTY_NODE,this.right=null!=o?o:Xe.EMPTY_NODE}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.count=function(){return this.left.count()+1+this.right.count()},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},t.prototype.minKey=function(){return this.min_().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n)),r.fixUp_()},t.prototype.removeMin_=function(){if(this.left.isEmpty())return Xe.EMPTY_NODE;var t=this;return t.left.isRed_()||t.left.left.isRed_()||(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()},t.prototype.remove=function(t,e){var n,r;if(n=this,e(t,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(t,e),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===e(t,n.key)){if(n.right.isEmpty())return Xe.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(t,e))}return n.fixUp_()},t.prototype.isRed_=function(){return this.color},t.prototype.fixUp_=function(){var t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t},t.prototype.moveRedLeft_=function(){var t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t},t.prototype.moveRedRight_=function(){var t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t},t.prototype.rotateLeft_=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight_=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip_=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth_=function(){var t=this.check_();return Math.pow(2,t)<=this.count()+1},t.prototype.check_=function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)},t.RED=!0,t.BLACK=!1,t}(),Ke=function(){function t(){}return t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new qe(t,e,null)},t.prototype.remove=function(t,e){return this},t.prototype.count=function(){return 0},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.check_=function(){return 0},t.prototype.isRed_=function(){return!1},t}(),Xe=function(){function t(e,n){void 0===n&&(n=t.EMPTY_NODE),this.comparator_=e,this.root_=n}return t.prototype.insert=function(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,qe.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,qe.BLACK,null,null))},t.prototype.get=function(t){var e,n=this.root_;while(!n.isEmpty()){if(e=this.comparator_(t,n.key),0===e)return n.value;e<0?n=n.left:e>0&&(n=n.right)}return null},t.prototype.getPredecessorKey=function(t){var e,n=this.root_,r=null;while(!n.isEmpty()){if(e=this.comparator_(t,n.key),0===e){if(n.left.isEmpty())return r?r.key:null;n=n.left;while(!n.right.isEmpty())n=n.right;return n.key}e<0?n=n.left:e>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},t.prototype.isEmpty=function(){return this.root_.isEmpty()},t.prototype.count=function(){return this.root_.count()},t.prototype.minKey=function(){return this.root_.minKey()},t.prototype.maxKey=function(){return this.root_.maxKey()},t.prototype.inorderTraversal=function(t){return this.root_.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.root_.reverseTraversal(t)},t.prototype.getIterator=function(t){return new Ge(this.root_,null,this.comparator_,!1,t)},t.prototype.getIteratorFrom=function(t,e){return new Ge(this.root_,t,this.comparator_,!1,e)},t.prototype.getReverseIteratorFrom=function(t,e){return new Ge(this.root_,t,this.comparator_,!0,e)},t.prototype.getReverseIterator=function(t){return new Ge(this.root_,null,this.comparator_,!0,t)},t.EMPTY_NODE=new Ke,t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Ye(t,e){return O(t.name,e.name)}function Je(t,e){return O(t,e)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ze(t){Re=t}var Qe,tn,en,nn=function(t){return"number"===typeof t?"number:"+B(t):"string:"+t},rn=function(t){if(t.isLeafNode()){var e=t.val();(0,o.hu)("string"===typeof e||"number"===typeof e||"object"===typeof e&&(0,o.r3)(e,".sv"),"Priority must be a string or number.")}else(0,o.hu)(t===Re||t.isEmpty(),"priority of unexpected type.");(0,o.hu)(t===Re||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},on=function(){function t(e,n){void 0===n&&(n=t.__childrenNodeConstructor.EMPTY_NODE),this.value_=e,this.priorityNode_=n,this.lazyHash_=null,(0,o.hu)(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),rn(this.priorityNode_)}return Object.defineProperty(t,"__childrenNodeConstructor",{get:function(){return Qe},set:function(t){Qe=t},enumerable:!1,configurable:!0}),t.prototype.isLeafNode=function(){return!0},t.prototype.getPriority=function(){return this.priorityNode_},t.prototype.updatePriority=function(e){return new t(this.value_,e)},t.prototype.getImmediateChild=function(e){return".priority"===e?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.getChild=function(e){return we(e)?this:".priority"===de(e)?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.hasChild=function(){return!1},t.prototype.getPredecessorChildName=function(t,e){return null},t.prototype.updateImmediateChild=function(e,n){return".priority"===e?this.updatePriority(n):n.isEmpty()&&".priority"!==e?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)},t.prototype.updateChild=function(e,n){var r=de(e);return null===r?n:n.isEmpty()&&".priority"!==r?this:((0,o.hu)(".priority"!==r||1===pe(e),".priority must be the last token in a path"),this.updateImmediateChild(r,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(fe(e),n)))},t.prototype.isEmpty=function(){return!1},t.prototype.numChildren=function(){return 0},t.prototype.forEachChild=function(t,e){return!1},t.prototype.val=function(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.priorityNode_.isEmpty()||(t+="priority:"+nn(this.priorityNode_.val())+":");var e=typeof this.value_;t+=e+":",t+="number"===e?B(this.value_):this.value_,this.lazyHash_=v(t)}return this.lazyHash_},t.prototype.getValue=function(){return this.value_},t.prototype.compareTo=function(e){return e===t.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof t.__childrenNodeConstructor?-1:((0,o.hu)(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))},t.prototype.compareToLeafNode_=function(e){var n=typeof e.value_,r=typeof this.value_,i=t.VALUE_TYPE_ORDER.indexOf(n),s=t.VALUE_TYPE_ORDER.indexOf(r);return(0,o.hu)(i>=0,"Unknown leaf type: "+n),(0,o.hu)(s>=0,"Unknown leaf type: "+r),i===s?"object"===r?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:s-i},t.prototype.withIndex=function(){return this},t.prototype.isIndexed=function(){return!0},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode()){var e=t;return this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)}return!1},t.VALUE_TYPE_ORDER=["object","boolean","number","string"],t}();function sn(t){tn=t}function an(t){en=t}var ln,un,cn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,s.ZT)(e,t),e.prototype.compare=function(t,e){var n=t.node.getPriority(),r=e.node.getPriority(),i=n.compareTo(r);return 0===i?O(t.name,e.name):i},e.prototype.isDefinedOn=function(t){return!t.getPriority().isEmpty()},e.prototype.indexedValueChanged=function(t,e){return!t.getPriority().equals(e.getPriority())},e.prototype.minPost=function(){return Ue.MIN},e.prototype.maxPost=function(){return new Ue(D,new on("[PRIORITY-POST]",en))},e.prototype.makePost=function(t,e){var n=tn(t);return new Ue(e,new on("[PRIORITY-POST]",n))},e.prototype.toString=function(){return".priority"},e}(Ve),hn=new cn,dn=Math.log(2),pn=function(){function t(t){var e=function(t){return parseInt(Math.log(t)/dn,10)},n=function(t){return parseInt(Array(t+1).join("1"),2)};this.count=e(t+1),this.current_=this.count-1;var r=n(this.count);this.bits_=t+1&r}return t.prototype.nextBitIsOne=function(){var t=!(this.bits_&1<<this.current_);return this.current_--,t},t}(),fn=function(t,e,n,r){t.sort(e);var i=function(e,r){var o,s,a=r-e;if(0===a)return null;if(1===a)return o=t[e],s=n?n(o):o,new qe(s,o.node,qe.BLACK,null,null);var l=parseInt(a/2,10)+e,u=i(e,l),c=i(l+1,r);return o=t[l],s=n?n(o):o,new qe(s,o.node,qe.BLACK,u,c)},o=function(e){for(var r=null,o=null,s=t.length,a=function(e,r){var o=s-e,a=s;s-=e;var u=i(o+1,a),c=t[o],h=n?n(c):c;l(new qe(h,c.node,r,null,u))},l=function(t){r?(r.left=t,r=t):(o=t,r=t)},u=0;u<e.count;++u){var c=e.nextBitIsOne(),h=Math.pow(2,e.count-(u+1));c?a(h,qe.BLACK):(a(h,qe.BLACK),a(h,qe.RED))}return o},s=new pn(t.length),a=o(s);return new Xe(r||e,a)},gn={},mn=function(){function t(t,e){this.indexes_=t,this.indexSet_=e}return Object.defineProperty(t,"Default",{get:function(){return(0,o.hu)(gn&&hn,"ChildrenNode.ts has not been loaded"),ln=ln||new t({".priority":gn},{".priority":hn}),ln},enumerable:!1,configurable:!0}),t.prototype.get=function(t){var e=(0,o.DV)(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e instanceof Xe?e:null},t.prototype.hasIndex=function(t){return(0,o.r3)(this.indexSet_,t.toString())},t.prototype.addIndex=function(e,n){(0,o.hu)(e!==He,"KeyIndex always exists and isn't meant to be added to the IndexMap.");var r,i=[],a=!1,l=n.getIterator(Ue.Wrap),u=l.getNext();while(u)a=a||e.isDefinedOn(u.node),i.push(u),u=l.getNext();r=a?fn(i,e.getCompare()):gn;var c=e.toString(),h=(0,s.pi)({},this.indexSet_);h[c]=e;var d=(0,s.pi)({},this.indexes_);return d[c]=r,new t(d,h)},t.prototype.addToIndexes=function(e,n){var r=this,i=(0,o.UI)(this.indexes_,(function(t,i){var s=(0,o.DV)(r.indexSet_,i);if((0,o.hu)(s,"Missing index implementation for "+i),t===gn){if(s.isDefinedOn(e.node)){var a=[],l=n.getIterator(Ue.Wrap),u=l.getNext();while(u)u.name!==e.name&&a.push(u),u=l.getNext();return a.push(e),fn(a,s.getCompare())}return gn}var c=n.get(e.name),h=t;return c&&(h=h.remove(new Ue(e.name,c))),h.insert(e,e.node)}));return new t(i,this.indexSet_)},t.prototype.removeFromIndexes=function(e,n){var r=(0,o.UI)(this.indexes_,(function(t){if(t===gn)return t;var r=n.get(e.name);return r?t.remove(new Ue(e.name,r)):t}));return new t(r,this.indexSet_)},t}(),yn=function(){function t(t,e,n){this.children_=t,this.priorityNode_=e,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&rn(this.priorityNode_),this.children_.isEmpty()&&(0,o.hu)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(t,"EMPTY_NODE",{get:function(){return un||(un=new t(new Xe(Je),null,mn.Default))},enumerable:!1,configurable:!0}),t.prototype.isLeafNode=function(){return!1},t.prototype.getPriority=function(){return this.priorityNode_||un},t.prototype.updatePriority=function(e){return this.children_.isEmpty()?this:new t(this.children_,e,this.indexMap_)},t.prototype.getImmediateChild=function(t){if(".priority"===t)return this.getPriority();var e=this.children_.get(t);return null===e?un:e},t.prototype.getChild=function(t){var e=de(t);return null===e?this:this.getImmediateChild(e).getChild(fe(t))},t.prototype.hasChild=function(t){return null!==this.children_.get(t)},t.prototype.updateImmediateChild=function(e,n){if((0,o.hu)(n,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(n);var r=new Ue(e,n),i=void 0,s=void 0;n.isEmpty()?(i=this.children_.remove(e),s=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,n),s=this.indexMap_.addToIndexes(r,this.children_));var a=i.isEmpty()?un:this.priorityNode_;return new t(i,a,s)},t.prototype.updateChild=function(t,e){var n=de(t);if(null===n)return e;(0,o.hu)(".priority"!==de(t)||1===pe(t),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(fe(t),e);return this.updateImmediateChild(n,r)},t.prototype.isEmpty=function(){return this.children_.isEmpty()},t.prototype.numChildren=function(){return this.children_.count()},t.prototype.val=function(e){if(this.isEmpty())return null;var n={},r=0,i=0,o=!0;if(this.forEachChild(hn,(function(s,a){n[s]=a.val(e),r++,o&&t.INTEGER_REGEXP_.test(s)?i=Math.max(i,Number(s)):o=!1})),!e&&o&&i<2*r){var s=[];for(var a in n)s[a]=n[a];return s}return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.getPriority().isEmpty()||(t+="priority:"+nn(this.getPriority().val())+":"),this.forEachChild(hn,(function(e,n){var r=n.hash();""!==r&&(t+=":"+e+":"+r)})),this.lazyHash_=""===t?"":v(t)}return this.lazyHash_},t.prototype.getPredecessorChildName=function(t,e,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new Ue(t,e));return i?i.name:null}return this.children_.getPredecessorKey(t)},t.prototype.getFirstChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.minKey();return n&&n.name}return this.children_.minKey()},t.prototype.getFirstChild=function(t){var e=this.getFirstChildName(t);return e?new Ue(e,this.children_.get(e)):null},t.prototype.getLastChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.maxKey();return n&&n.name}return this.children_.maxKey()},t.prototype.getLastChild=function(t){var e=this.getLastChildName(t);return e?new Ue(e,this.children_.get(e)):null},t.prototype.forEachChild=function(t,e){var n=this.resolveIndex_(t);return n?n.inorderTraversal((function(t){return e(t.name,t.node)})):this.children_.inorderTraversal(e)},t.prototype.getIterator=function(t){return this.getIteratorFrom(t.minPost(),t)},t.prototype.getIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getIteratorFrom(t,(function(t){return t}));var r=this.children_.getIteratorFrom(t.name,Ue.Wrap),i=r.peek();while(null!=i&&e.compare(i,t)<0)r.getNext(),i=r.peek();return r},t.prototype.getReverseIterator=function(t){return this.getReverseIteratorFrom(t.maxPost(),t)},t.prototype.getReverseIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getReverseIteratorFrom(t,(function(t){return t}));var r=this.children_.getReverseIteratorFrom(t.name,Ue.Wrap),i=r.peek();while(null!=i&&e.compare(i,t)>0)r.getNext(),i=r.peek();return r},t.prototype.compareTo=function(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===vn?-1:0},t.prototype.withIndex=function(e){if(e===He||this.indexMap_.hasIndex(e))return this;var n=this.indexMap_.addIndex(e,this.children_);return new t(this.children_,this.priorityNode_,n)},t.prototype.isIndexed=function(t){return t===He||this.indexMap_.hasIndex(t)},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode())return!1;var e=t;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()===e.children_.count()){var n=this.getIterator(hn),r=e.getIterator(hn),i=n.getNext(),o=r.getNext();while(i&&o){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1}return!1},t.prototype.resolveIndex_=function(t){return t===He?null:this.indexMap_.get(t.toString())},t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t}(),bn=function(t){function e(){return t.call(this,new Xe(Je),yn.EMPTY_NODE,mn.Default)||this}return(0,s.ZT)(e,t),e.prototype.compareTo=function(t){return t===this?0:1},e.prototype.equals=function(t){return t===this},e.prototype.getPriority=function(){return this},e.prototype.getImmediateChild=function(t){return yn.EMPTY_NODE},e.prototype.isEmpty=function(){return!1},e}(yn),vn=new bn;Object.defineProperties(Ue,{MIN:{value:new Ue($,yn.EMPTY_NODE)},MAX:{value:new Ue(D,vn)}}),je.__EMPTY_NODE=yn.EMPTY_NODE,on.__childrenNodeConstructor=yn,Ze(vn),an(vn);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var wn=!0;function xn(t,e){if(void 0===e&&(e=null),null===t)return yn.EMPTY_NODE;if("object"===typeof t&&".priority"in t&&(e=t[".priority"]),(0,o.hu)(null===e||"string"===typeof e||"number"===typeof e||"object"===typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"===typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!==typeof t||".sv"in t){var n=t;return new on(n,xn(e))}if(t instanceof Array||!wn){var r=yn.EMPTY_NODE;return z(t,(function(e,n){if((0,o.r3)(t,e)&&"."!==e.substring(0,1)){var i=xn(n);!i.isLeafNode()&&i.isEmpty()||(r=r.updateImmediateChild(e,i))}})),r.updatePriority(xn(e))}var i=[],s=!1,a=t;if(z(a,(function(t,e){if("."!==t.substring(0,1)){var n=xn(e);n.isEmpty()||(s=s||!n.getPriority().isEmpty(),i.push(new Ue(t,n)))}})),0===i.length)return yn.EMPTY_NODE;var l=fn(i,Ye,(function(t){return t.name}),Je);if(s){var u=fn(i,hn.getCompare());return new yn(l,xn(e),new mn({".priority":u},{".priority":hn}))}return new yn(l,xn(e),mn.Default)}sn(xn);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var kn=function(t){function e(e){var n=t.call(this)||this;return n.indexPath_=e,(0,o.hu)(!we(e)&&".priority"!==de(e),"Can't create PathIndex with empty path or .priority key"),n}return(0,s.ZT)(e,t),e.prototype.extractChild=function(t){return t.getChild(this.indexPath_)},e.prototype.isDefinedOn=function(t){return!t.getChild(this.indexPath_).isEmpty()},e.prototype.compare=function(t,e){var n=this.extractChild(t.node),r=this.extractChild(e.node),i=n.compareTo(r);return 0===i?O(t.name,e.name):i},e.prototype.makePost=function(t,e){var n=xn(t),r=yn.EMPTY_NODE.updateChild(this.indexPath_,n);return new Ue(e,r)},e.prototype.maxPost=function(){var t=yn.EMPTY_NODE.updateChild(this.indexPath_,vn);return new Ue(D,t)},e.prototype.toString=function(){return ye(this.indexPath_,0).join("/")},e}(Ve),_n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,s.ZT)(e,t),e.prototype.compare=function(t,e){var n=t.node.compareTo(e.node);return 0===n?O(t.name,e.name):n},e.prototype.isDefinedOn=function(t){return!0},e.prototype.indexedValueChanged=function(t,e){return!t.equals(e)},e.prototype.minPost=function(){return Ue.MIN},e.prototype.maxPost=function(){return Ue.MAX},e.prototype.makePost=function(t,e){var n=xn(t);return new Ue(e,n)},e.prototype.toString=function(){return".value"},e}(Ve),In=new _n,Cn="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Sn="-",Tn="z",En=786,Nn=function(){var t=0,e=[];return function(n){var r,i=n===t;t=n;var s=new Array(8);for(r=7;r>=0;r--)s[r]=Cn.charAt(n%64),n=Math.floor(n/64);(0,o.hu)(0===n,"Cannot push at time == 0");var a=s.join("");if(i){for(r=11;r>=0&&63===e[r];r--)e[r]=0;e[r]++}else for(r=0;r<12;r++)e[r]=Math.floor(64*Math.random());for(r=0;r<12;r++)a+=Cn.charAt(e[r]);return(0,o.hu)(20===a.length,"nextPushId: Length should be 20."),a}}(),An=function(t){if(t===""+G)return Sn;var e=q(t);if(null!=e)return""+(e+1);for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t.charAt(r);if(n.length<En)return n.push(Sn),n.join("");var i=n.length-1;while(i>=0&&n[i]===Tn)i--;if(-1===i)return D;var o=n[i],s=Cn.charAt(Cn.indexOf(o)+1);return n[i]=s,n.slice(0,i+1).join("")},Rn=function(t){if(t===""+H)return $;var e=q(t);if(null!=e)return""+(e-1);for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t.charAt(r);return n[n.length-1]===Sn?1===n.length?""+G:(delete n[n.length-1],n.join("")):(n[n.length-1]=Cn.charAt(Cn.indexOf(n[n.length-1])-1),n.join("")+Tn.repeat(En-n.length))};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function $n(t){return{type:"value",snapshotNode:t}}function Dn(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function On(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Fn(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function Mn(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Pn=function(){function t(t){this.index_=t}return t.prototype.updateChild=function(t,e,n,r,i,s){(0,o.hu)(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");var a=t.getImmediateChild(e);return a.getChild(r).equals(n.getChild(r))&&a.isEmpty()===n.isEmpty()?t:(null!=s&&(n.isEmpty()?t.hasChild(e)?s.trackChildChange(On(e,a)):(0,o.hu)(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?s.trackChildChange(Dn(e,n)):s.trackChildChange(Fn(e,n,a))),t.isLeafNode()&&n.isEmpty()?t:t.updateImmediateChild(e,n).withIndex(this.index_))},t.prototype.updateFullNode=function(t,e,n){return null!=n&&(t.isLeafNode()||t.forEachChild(hn,(function(t,r){e.hasChild(t)||n.trackChildChange(On(t,r))})),e.isLeafNode()||e.forEachChild(hn,(function(e,r){if(t.hasChild(e)){var i=t.getImmediateChild(e);i.equals(r)||n.trackChildChange(Fn(e,r,i))}else n.trackChildChange(Dn(e,r))}))),e.withIndex(this.index_)},t.prototype.updatePriority=function(t,e){return t.isEmpty()?yn.EMPTY_NODE:t.updatePriority(e)},t.prototype.filtersNodes=function(){return!1},t.prototype.getIndexedFilter=function(){return this},t.prototype.getIndex=function(){return this.index_},t}(),Ln=function(){function t(e){this.indexedFilter_=new Pn(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e)}return t.prototype.getStartPost=function(){return this.startPost_},t.prototype.getEndPost=function(){return this.endPost_},t.prototype.matches=function(t){return this.index_.compare(this.getStartPost(),t)<=0&&this.index_.compare(t,this.getEndPost())<=0},t.prototype.updateChild=function(t,e,n,r,i,o){return this.matches(new Ue(e,n))||(n=yn.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,n,r,i,o)},t.prototype.updateFullNode=function(t,e,n){e.isLeafNode()&&(e=yn.EMPTY_NODE);var r=e.withIndex(this.index_);r=r.updatePriority(yn.EMPTY_NODE);var i=this;return e.forEachChild(hn,(function(t,e){i.matches(new Ue(t,e))||(r=r.updateImmediateChild(t,yn.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.indexedFilter_},t.prototype.getIndex=function(){return this.index_},t.getStartPost_=function(t){if(t.hasStart()){var e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}return t.getIndex().minPost()},t.getEndPost_=function(t){if(t.hasEnd()){var e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}return t.getIndex().maxPost()},t}(),zn=function(){function t(t){this.rangedFilter_=new Ln(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft()}return t.prototype.updateChild=function(t,e,n,r,i,o){return this.rangedFilter_.matches(new Ue(e,n))||(n=yn.EMPTY_NODE),t.getImmediateChild(e).equals(n)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,n,r,i,o):this.fullLimitUpdateChild_(t,e,n,i,o)},t.prototype.updateFullNode=function(t,e,n){var r;if(e.isLeafNode()||e.isEmpty())r=yn.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){r=yn.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);var o=0;while(i.hasNext()&&o<this.limit_){var s=i.getNext(),a=void 0;if(a=this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),s)<=0:this.index_.compare(s,this.rangedFilter_.getEndPost())<=0,!a)break;r=r.updateImmediateChild(s.name,s.node),o++}}else{r=e.withIndex(this.index_),r=r.updatePriority(yn.EMPTY_NODE);var l=void 0,u=void 0,c=void 0;i=void 0;if(this.reverse_){i=r.getReverseIterator(this.index_),l=this.rangedFilter_.getEndPost(),u=this.rangedFilter_.getStartPost();var h=this.index_.getCompare();c=function(t,e){return h(e,t)}}else i=r.getIterator(this.index_),l=this.rangedFilter_.getStartPost(),u=this.rangedFilter_.getEndPost(),c=this.index_.getCompare();o=0;var d=!1;while(i.hasNext()){s=i.getNext();!d&&c(l,s)<=0&&(d=!0);a=d&&o<this.limit_&&c(s,u)<=0;a?o++:r=r.updateImmediateChild(s.name,yn.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},t.prototype.getIndex=function(){return this.index_},t.prototype.fullLimitUpdateChild_=function(t,e,n,r,i){var s;if(this.reverse_){var a=this.index_.getCompare();s=function(t,e){return a(e,t)}}else s=this.index_.getCompare();var l=t;(0,o.hu)(l.numChildren()===this.limit_,"");var u=new Ue(e,n),c=this.reverse_?l.getFirstChild(this.index_):l.getLastChild(this.index_),h=this.rangedFilter_.matches(u);if(l.hasChild(e)){var d=l.getImmediateChild(e),p=r.getChildAfterChild(this.index_,c,this.reverse_);while(null!=p&&(p.name===e||l.hasChild(p.name)))p=r.getChildAfterChild(this.index_,p,this.reverse_);var f=null==p?1:s(p,u),g=h&&!n.isEmpty()&&f>=0;if(g)return null!=i&&i.trackChildChange(Fn(e,n,d)),l.updateImmediateChild(e,n);null!=i&&i.trackChildChange(On(e,d));var m=l.updateImmediateChild(e,yn.EMPTY_NODE),y=null!=p&&this.rangedFilter_.matches(p);return y?(null!=i&&i.trackChildChange(Dn(p.name,p.node)),m.updateImmediateChild(p.name,p.node)):m}return n.isEmpty()?t:h&&s(c,u)>=0?(null!=i&&(i.trackChildChange(On(c.name,c.node)),i.trackChildChange(Dn(e,n))),l.updateImmediateChild(e,n).updateImmediateChild(c.name,yn.EMPTY_NODE)):t},t}(),Bn=function(){function t(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=hn}return t.prototype.hasStart=function(){return this.startSet_},t.prototype.hasStartAfter=function(){return this.startAfterSet_},t.prototype.hasEndBefore=function(){return this.endBeforeSet_},t.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_},t.prototype.getIndexStartValue=function(){return(0,o.hu)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},t.prototype.getIndexStartName=function(){return(0,o.hu)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:$},t.prototype.hasEnd=function(){return this.endSet_},t.prototype.getIndexEndValue=function(){return(0,o.hu)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},t.prototype.getIndexEndName=function(){return(0,o.hu)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:D},t.prototype.hasLimit=function(){return this.limitSet_},t.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},t.prototype.getLimit=function(){return(0,o.hu)(this.limitSet_,"Only valid if limit has been set"),this.limit_},t.prototype.getIndex=function(){return this.index_},t.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},t.prototype.isDefault=function(){return this.loadsAllData()&&this.index_===hn},t.prototype.copy=function(){var e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wn(t){return t.loadsAllData()?new Pn(t.getIndex()):t.hasLimit()?new zn(t):new Ln(t)}function Un(t,e){var n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function Vn(t,e){var n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function jn(t,e,n){var r=t.copy();return r.startSet_=!0,void 0===e&&(e=null),r.indexStartValue_=e,null!=n?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function Hn(t,e,n){var r;if(t.index_===He)"string"===typeof e&&(e=An(e)),r=jn(t,e,n);else{var i=void 0;i=null==n?D:An(n),r=jn(t,e,i)}return r.startAfterSet_=!0,r}function Gn(t,e,n){var r=t.copy();return r.endSet_=!0,void 0===e&&(e=null),r.indexEndValue_=e,void 0!==n?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function qn(t,e,n){var r,i;return t.index_===He?("string"===typeof e&&(e=Rn(e)),i=Gn(t,e,n)):(r=null==n?$:Rn(n),i=Gn(t,e,r)),i.endBeforeSet_=!0,i}function Kn(t,e){var n=t.copy();return n.index_=e,n}function Xn(t){var e,n={};return t.isDefault()||(t.index_===hn?e="$priority":t.index_===In?e="$value":t.index_===He?e="$key":((0,o.hu)(t.index_ instanceof kn,"Unrecognized index type!"),e=t.index_.toString()),n["orderBy"]=(0,o.Pz)(e),t.startSet_&&(n["startAt"]=(0,o.Pz)(t.indexStartValue_),t.startNameSet_&&(n["startAt"]+=","+(0,o.Pz)(t.indexStartName_))),t.endSet_&&(n["endAt"]=(0,o.Pz)(t.indexEndValue_),t.endNameSet_&&(n["endAt"]+=","+(0,o.Pz)(t.indexEndName_))),t.limitSet_&&(t.isViewFromLeft()?n["limitToFirst"]=t.limit_:n["limitToLast"]=t.limit_)),n}function Yn(t){var e={};if(t.startSet_&&(e["sp"]=t.indexStartValue_,t.startNameSet_&&(e["sn"]=t.indexStartName_)),t.endSet_&&(e["ep"]=t.indexEndValue_,t.endNameSet_&&(e["en"]=t.indexEndName_)),t.limitSet_){e["l"]=t.limit_;var n=t.viewFrom_;""===n&&(n=t.isViewFromLeft()?"l":"r"),e["vf"]=n}return t.index_!==hn&&(e["i"]=t.index_.toString()),e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Jn=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.repoInfo_=e,o.onDataUpdate_=n,o.authTokenProvider_=r,o.appCheckTokenProvider_=i,o.log_=C("p:rest:"),o.listens_={},o}return(0,s.ZT)(e,t),e.prototype.reportStats=function(t){throw new Error("Method not implemented.")},e.getListenId_=function(t,e){return void 0!==e?"tag$"+e:((0,o.hu)(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())},e.prototype.listen=function(t,n,r,i){var s=this,a=t._path.toString();this.log_("Listen called for "+a+" "+t._queryIdentifier);var l=e.getListenId_(t,r),u={};this.listens_[l]=u;var c=Xn(t._queryParams);this.restRequest_(a+".json",c,(function(t,e){var n,c=e;(404===t&&(c=null,t=null),null===t&&s.onDataUpdate_(a,c,!1,r),(0,o.DV)(s.listens_,l)===u)&&(n=t?401===t?"permission_denied":"rest_error:"+t:"ok",i(n,null))}))},e.prototype.unlisten=function(t,n){var r=e.getListenId_(t,n);delete this.listens_[r]},e.prototype.get=function(t){var e=this,n=Xn(t._queryParams),r=t._path.toString(),i=new o.BH;return this.restRequest_(r+".json",n,(function(t,n){var o=n;404===t&&(o=null,t=null),null===t?(e.onDataUpdate_(r,o,!1,null),i.resolve(o)):i.reject(new Error(o))})),i.promise},e.prototype.refreshAuthToken=function(t){},e.prototype.restRequest_=function(t,e,n){var r=this;return void 0===e&&(e={}),e["format"]="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((function(i){var a=(0,s.CR)(i,2),l=a[0],u=a[1];l&&l.accessToken&&(e["auth"]=l.accessToken),u&&u.token&&(e["ac"]=u.token);var c=(r.repoInfo_.secure?"https://":"http://")+r.repoInfo_.host+t+"?ns="+r.repoInfo_.namespace+(0,o.xO)(e);r.log_("Sending REST request for "+c);var h=new XMLHttpRequest;h.onreadystatechange=function(){if(n&&4===h.readyState){r.log_("REST Response for "+c+" received. status:",h.status,"response:",h.responseText);var t=null;if(h.status>=200&&h.status<300){try{t=(0,o.cI)(h.responseText)}catch(e){E("Failed to parse JSON response for "+c+": "+h.responseText)}n(null,t)}else 401!==h.status&&404!==h.status&&E("Got unsuccessful REST response for "+c+" Status: "+h.status),n(h.status);n=null}},h.open("GET",c,!0),h.send()}))},e}(oe),Zn=function(){function t(){this.rootNode_=yn.EMPTY_NODE}return t.prototype.getNode=function(t){return this.rootNode_.getChild(t)},t.prototype.updateSnapshot=function(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Qn(){return{value:null,children:new Map}}function tr(t,e,n){if(we(e))t.value=n,t.children.clear();else if(null!==t.value)t.value=t.value.updateChild(e,n);else{var r=de(e);t.children.has(r)||t.children.set(r,Qn());var i=t.children.get(r);e=fe(e),tr(i,e,n)}}function er(t,e){if(we(e))return t.value=null,t.children.clear(),!0;if(null!==t.value){if(t.value.isLeafNode())return!1;var n=t.value;return t.value=null,n.forEachChild(hn,(function(e,n){tr(t,new ce(e),n)})),er(t,e)}if(t.children.size>0){var r=de(e);if(e=fe(e),t.children.has(r)){var i=er(t.children.get(r),e);i&&t.children.delete(r)}return 0===t.children.size}return!0}function nr(t,e,n){null!==t.value?n(e,t.value):rr(t,(function(t,r){var i=new ce(e.toString()+"/"+t);nr(r,i,n)}))}function rr(t,e){t.children.forEach((function(t,n){e(n,t)}))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ir,or=function(){function t(t){this.collection_=t,this.last_=null}return t.prototype.get=function(){var t=this.collection_.get(),e=(0,s.pi)({},t);return this.last_&&z(this.last_,(function(t,n){e[t]=e[t]-n})),this.last_=t,e},t}(),sr=1e4,ar=3e4,lr=3e5,ur=function(){function t(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new or(t);var n=sr+(ar-sr)*Math.random();Y(this.reportStats_.bind(this),Math.floor(n))}return t.prototype.reportStats_=function(){var t=this,e=this.statsListener_.get(),n={},r=!1;z(e,(function(e,i){i>0&&(0,o.r3)(t.statsToReport_,e)&&(n[e]=i,r=!0)})),r&&this.server_.reportStats(n),Y(this.reportStats_.bind(this),Math.floor(2*Math.random()*lr))},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cr(t,e){t.statsToReport_[e]=!0}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hr(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function dr(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function pr(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(function(t){t[t["OVERWRITE"]=0]="OVERWRITE",t[t["MERGE"]=1]="MERGE",t[t["ACK_USER_WRITE"]=2]="ACK_USER_WRITE",t[t["LISTEN_COMPLETE"]=3]="LISTEN_COMPLETE"})(ir||(ir={}));var fr,gr=function(){function t(t,e,n){this.path=t,this.affectedTree=e,this.revert=n,this.type=ir.ACK_USER_WRITE,this.source=hr()}return t.prototype.operationForChild=function(e){if(we(this.path)){if(null!=this.affectedTree.value)return(0,o.hu)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new ce(e));return new t(he(),n,this.revert)}return(0,o.hu)(de(this.path)===e,"operationForChild called for unrelated child."),new t(fe(this.path),this.affectedTree,this.revert)},t}(),mr=function(){function t(t,e){this.source=t,this.path=e,this.type=ir.LISTEN_COMPLETE}return t.prototype.operationForChild=function(e){return we(this.path)?new t(this.source,he()):new t(this.source,fe(this.path))},t}(),yr=function(){function t(t,e,n){this.source=t,this.path=e,this.snap=n,this.type=ir.OVERWRITE}return t.prototype.operationForChild=function(e){return we(this.path)?new t(this.source,he(),this.snap.getImmediateChild(e)):new t(this.source,fe(this.path),this.snap)},t}(),br=function(){function t(t,e,n){this.source=t,this.path=e,this.children=n,this.type=ir.MERGE}return t.prototype.operationForChild=function(e){if(we(this.path)){var n=this.children.subtree(new ce(e));return n.isEmpty()?null:n.value?new yr(this.source,he(),n.value):new t(this.source,he(),n)}return(0,o.hu)(de(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,fe(this.path),this.children)},t.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},t}(),vr=function(){function t(t,e,n){this.node_=t,this.fullyInitialized_=e,this.filtered_=n}return t.prototype.isFullyInitialized=function(){return this.fullyInitialized_},t.prototype.isFiltered=function(){return this.filtered_},t.prototype.isCompleteForPath=function(t){if(we(t))return this.isFullyInitialized()&&!this.filtered_;var e=de(t);return this.isCompleteForChild(e)},t.prototype.isCompleteForChild=function(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)},t.prototype.getNode=function(){return this.node_},t}(),wr=function(){function t(t){this.query_=t,this.index_=this.query_._queryParams.getIndex()}return t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xr(t,e,n,r){var i=[],o=[];return e.forEach((function(e){"child_changed"===e.type&&t.index_.indexedValueChanged(e.oldSnap,e.snapshotNode)&&o.push(Mn(e.childName,e.snapshotNode))})),kr(t,i,"child_removed",e,r,n),kr(t,i,"child_added",e,r,n),kr(t,i,"child_moved",o,r,n),kr(t,i,"child_changed",e,r,n),kr(t,i,"value",e,r,n),i}function kr(t,e,n,r,i,o){var s=r.filter((function(t){return t.type===n}));s.sort((function(e,n){return Ir(t,e,n)})),s.forEach((function(n){var r=_r(t,n,o);i.forEach((function(i){i.respondsTo(n.type)&&e.push(i.createEvent(r,t.query_))}))}))}function _r(t,e,n){return"value"===e.type||"child_removed"===e.type||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function Ir(t,e,n){if(null==e.childName||null==n.childName)throw(0,o.g5)("Should only compare child_ events.");var r=new Ue(e.childName,e.snapshotNode),i=new Ue(n.childName,n.snapshotNode);return t.index_.compare(r,i)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cr(t,e){return{eventCache:t,serverCache:e}}function Sr(t,e,n,r){return Cr(new vr(e,n,r),t.serverCache)}function Tr(t,e,n,r){return Cr(t.eventCache,new vr(e,n,r))}function Er(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Nr(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ar=function(){return fr||(fr=new Xe(F)),fr},Rr=function(){function t(t,e){void 0===e&&(e=Ar()),this.value=t,this.children=e}return t.fromObject=function(e){var n=new t(null);return z(e,(function(t,e){n=n.set(new ce(t),e)})),n},t.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},t.prototype.findRootMostMatchingPathAndValue=function(t,e){if(null!=this.value&&e(this.value))return{path:he(),value:this.value};if(we(t))return null;var n=de(t),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(fe(t),e);if(null!=i){var o=ve(new ce(n),i.path);return{path:o,value:i.value}}return null}return null},t.prototype.findRootMostValueAndPath=function(t){return this.findRootMostMatchingPathAndValue(t,(function(){return!0}))},t.prototype.subtree=function(e){if(we(e))return this;var n=de(e),r=this.children.get(n);return null!==r?r.subtree(fe(e)):new t(null)},t.prototype.set=function(e,n){if(we(e))return new t(n,this.children);var r=de(e),i=this.children.get(r)||new t(null),o=i.set(fe(e),n),s=this.children.insert(r,o);return new t(this.value,s)},t.prototype.remove=function(e){if(we(e))return this.children.isEmpty()?new t(null):new t(null,this.children);var n=de(e),r=this.children.get(n);if(r){var i=r.remove(fe(e)),o=void 0;return o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&o.isEmpty()?new t(null):new t(this.value,o)}return this},t.prototype.get=function(t){if(we(t))return this.value;var e=de(t),n=this.children.get(e);return n?n.get(fe(t)):null},t.prototype.setTree=function(e,n){if(we(e))return n;var r=de(e),i=this.children.get(r)||new t(null),o=i.setTree(fe(e),n),s=void 0;return s=o.isEmpty()?this.children.remove(r):this.children.insert(r,o),new t(this.value,s)},t.prototype.fold=function(t){return this.fold_(he(),t)},t.prototype.fold_=function(t,e){var n={};return this.children.inorderTraversal((function(r,i){n[r]=i.fold_(ve(t,r),e)})),e(t,this.value,n)},t.prototype.findOnPath=function(t,e){return this.findOnPath_(t,he(),e)},t.prototype.findOnPath_=function(t,e,n){var r=!!this.value&&n(e,this.value);if(r)return r;if(we(t))return null;var i=de(t),o=this.children.get(i);return o?o.findOnPath_(fe(t),ve(e,i),n):null},t.prototype.foreachOnPath=function(t,e){return this.foreachOnPath_(t,he(),e)},t.prototype.foreachOnPath_=function(e,n,r){if(we(e))return this;this.value&&r(n,this.value);var i=de(e),o=this.children.get(i);return o?o.foreachOnPath_(fe(e),ve(n,i),r):new t(null)},t.prototype.foreach=function(t){this.foreach_(he(),t)},t.prototype.foreach_=function(t,e){this.children.inorderTraversal((function(n,r){r.foreach_(ve(t,n),e)})),this.value&&e(t,this.value)},t.prototype.foreachChild=function(t){this.children.inorderTraversal((function(e,n){n.value&&t(e,n.value)}))},t}(),$r=function(){function t(t){this.writeTree_=t}return t.empty=function(){return new t(new Rr(null))},t}();function Dr(t,e,n){if(we(e))return new $r(new Rr(n));var r=t.writeTree_.findRootMostValueAndPath(e);if(null!=r){var i=r.path,o=r.value,s=xe(i,e);return o=o.updateChild(s,n),new $r(t.writeTree_.set(i,o))}var a=new Rr(n),l=t.writeTree_.setTree(e,a);return new $r(l)}function Or(t,e,n){var r=t;return z(n,(function(t,n){r=Dr(r,ve(e,t),n)})),r}function Fr(t,e){if(we(e))return $r.empty();var n=t.writeTree_.setTree(e,new Rr(null));return new $r(n)}function Mr(t,e){return null!=Pr(t,e)}function Pr(t,e){var n=t.writeTree_.findRootMostValueAndPath(e);return null!=n?t.writeTree_.get(n.path).getChild(xe(n.path,e)):null}function Lr(t){var e=[],n=t.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(hn,(function(t,n){e.push(new Ue(t,n))})):t.writeTree_.children.inorderTraversal((function(t,n){null!=n.value&&e.push(new Ue(t,n.value))})),e}function zr(t,e){if(we(e))return t;var n=Pr(t,e);return new $r(null!=n?new Rr(n):t.writeTree_.subtree(e))}function Br(t){return t.writeTree_.isEmpty()}function Wr(t,e){return Ur(he(),t.writeTree_,e)}function Ur(t,e,n){if(null!=e.value)return n.updateChild(t,e.value);var r=null;return e.children.inorderTraversal((function(e,i){".priority"===e?((0,o.hu)(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=Ur(ve(t,e),i,n)})),n.getChild(t).isEmpty()||null===r||(n=n.updateChild(ve(t,".priority"),r)),n}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vr(t,e){return di(e,t)}function jr(t,e,n,r,i){(0,o.hu)(r>t.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=Dr(t.visibleWrites,e,n)),t.lastWriteId=r}function Hr(t,e,n,r){(0,o.hu)(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=Or(t.visibleWrites,e,n),t.lastWriteId=r}function Gr(t,e){for(var n=0;n<t.allWrites.length;n++){var r=t.allWrites[n];if(r.writeId===e)return r}return null}function qr(t,e){var n=t.allWrites.findIndex((function(t){return t.writeId===e}));(0,o.hu)(n>=0,"removeWrite called with nonexistent writeId.");var r=t.allWrites[n];t.allWrites.splice(n,1);var i=r.visible,s=!1,a=t.allWrites.length-1;while(i&&a>=0){var l=t.allWrites[a];l.visible&&(a>=n&&Kr(l,r.path)?i=!1:Ie(r.path,l.path)&&(s=!0)),a--}if(i){if(s)return Xr(t),!0;if(r.snap)t.visibleWrites=Fr(t.visibleWrites,r.path);else{var u=r.children;z(u,(function(e){t.visibleWrites=Fr(t.visibleWrites,ve(r.path,e))}))}return!0}return!1}function Kr(t,e){if(t.snap)return Ie(t.path,e);for(var n in t.children)if(t.children.hasOwnProperty(n)&&Ie(ve(t.path,n),e))return!0;return!1}function Xr(t){t.visibleWrites=Jr(t.allWrites,Yr,he()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function Yr(t){return t.visible}function Jr(t,e,n){for(var r=$r.empty(),i=0;i<t.length;++i){var s=t[i];if(e(s)){var a=s.path,l=void 0;if(s.snap)Ie(n,a)?(l=xe(n,a),r=Dr(r,l,s.snap)):Ie(a,n)&&(l=xe(a,n),r=Dr(r,he(),s.snap.getChild(l)));else{if(!s.children)throw(0,o.g5)("WriteRecord should have .snap or .children");if(Ie(n,a))l=xe(n,a),r=Or(r,l,s.children);else if(Ie(a,n))if(l=xe(a,n),we(l))r=Or(r,he(),s.children);else{var u=(0,o.DV)(s.children,de(l));if(u){var c=u.getChild(fe(l));r=Dr(r,he(),c)}}}}}return r}function Zr(t,e,n,r,i){if(r||i){var o=zr(t.visibleWrites,e);if(!i&&Br(o))return n;if(i||null!=n||Mr(o,he())){var s=function(t){return(t.visible||i)&&(!r||!~r.indexOf(t.writeId))&&(Ie(t.path,e)||Ie(e,t.path))},a=Jr(t.allWrites,s,e);c=n||yn.EMPTY_NODE;return Wr(a,c)}return null}var l=Pr(t.visibleWrites,e);if(null!=l)return l;var u=zr(t.visibleWrites,e);if(Br(u))return n;if(null!=n||Mr(u,he())){var c=n||yn.EMPTY_NODE;return Wr(u,c)}return null}function Qr(t,e,n){var r=yn.EMPTY_NODE,i=Pr(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(hn,(function(t,e){r=r.updateImmediateChild(t,e)})),r;if(n){var o=zr(t.visibleWrites,e);return n.forEachChild(hn,(function(t,e){var n=Wr(zr(o,new ce(t)),e);r=r.updateImmediateChild(t,n)})),Lr(o).forEach((function(t){r=r.updateImmediateChild(t.name,t.node)})),r}var s=zr(t.visibleWrites,e);return Lr(s).forEach((function(t){r=r.updateImmediateChild(t.name,t.node)})),r}function ti(t,e,n,r,i){(0,o.hu)(r||i,"Either existingEventSnap or existingServerSnap must exist");var s=ve(e,n);if(Mr(t.visibleWrites,s))return null;var a=zr(t.visibleWrites,s);return Br(a)?i.getChild(n):Wr(a,i.getChild(n))}function ei(t,e,n,r){var i=ve(e,n),o=Pr(t.visibleWrites,i);if(null!=o)return o;if(r.isCompleteForChild(n)){var s=zr(t.visibleWrites,i);return Wr(s,r.getNode().getImmediateChild(n))}return null}function ni(t,e){return Pr(t.visibleWrites,e)}function ri(t,e,n,r,i,o,s){var a,l=zr(t.visibleWrites,e),u=Pr(l,he());if(null!=u)a=u;else{if(null==n)return[];a=Wr(l,n)}if(a=a.withIndex(s),a.isEmpty()||a.isLeafNode())return[];var c=[],h=s.getCompare(),d=o?a.getReverseIteratorFrom(r,s):a.getIteratorFrom(r,s),p=d.getNext();while(p&&c.length<i)0!==h(p,r)&&c.push(p),p=d.getNext();return c}function ii(){return{visibleWrites:$r.empty(),allWrites:[],lastWriteId:-1}}function oi(t,e,n,r){return Zr(t.writeTree,t.treePath,e,n,r)}function si(t,e){return Qr(t.writeTree,t.treePath,e)}function ai(t,e,n,r){return ti(t.writeTree,t.treePath,e,n,r)}function li(t,e){return ni(t.writeTree,ve(t.treePath,e))}function ui(t,e,n,r,i,o){return ri(t.writeTree,t.treePath,e,n,r,i,o)}function ci(t,e,n){return ei(t.writeTree,t.treePath,e,n)}function hi(t,e){return di(ve(t.treePath,e),t.writeTree)}function di(t,e){return{treePath:t,writeTree:e}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var pi=function(){function t(){this.changeMap=new Map}return t.prototype.trackChildChange=function(t){var e=t.type,n=t.childName;(0,o.hu)("child_added"===e||"child_changed"===e||"child_removed"===e,"Only child changes supported for tracking"),(0,o.hu)(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if("child_added"===e&&"child_removed"===i)this.changeMap.set(n,Fn(n,t.snapshotNode,r.snapshotNode));else if("child_removed"===e&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===e&&"child_changed"===i)this.changeMap.set(n,On(n,r.oldSnap));else if("child_changed"===e&&"child_added"===i)this.changeMap.set(n,Dn(n,t.snapshotNode));else{if("child_changed"!==e||"child_changed"!==i)throw(0,o.g5)("Illegal combination of changes: "+t+" occurred after "+r);this.changeMap.set(n,Fn(n,t.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,t)},t.prototype.getChanges=function(){return Array.from(this.changeMap.values())},t}(),fi=function(){function t(){}return t.prototype.getCompleteChild=function(t){return null},t.prototype.getChildAfterChild=function(t,e,n){return null},t}(),gi=new fi,mi=function(){function t(t,e,n){void 0===n&&(n=null),this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=n}return t.prototype.getCompleteChild=function(t){var e=this.viewCache_.eventCache;if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);var n=null!=this.optCompleteServerCache_?new vr(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return ci(this.writes_,t,n)},t.prototype.getChildAfterChild=function(t,e,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Nr(this.viewCache_),i=ui(this.writes_,r,e,1,n,t);return 0===i.length?null:i[0]},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function yi(t){return{filter:t}}function bi(t,e){(0,o.hu)(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),(0,o.hu)(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function vi(t,e,n,r,i){var s,a,l=new pi;if(n.type===ir.OVERWRITE){var u=n;u.source.fromUser?s=_i(t,e,u.path,u.snap,r,i,l):((0,o.hu)(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered()&&!we(u.path),s=ki(t,e,u.path,u.snap,r,i,a,l))}else if(n.type===ir.MERGE){var c=n;c.source.fromUser?s=Ci(t,e,c.path,c.children,r,i,l):((0,o.hu)(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),s=Ti(t,e,c.path,c.children,r,i,a,l))}else if(n.type===ir.ACK_USER_WRITE){var h=n;s=h.revert?Ai(t,e,h.path,r,i,l):Ei(t,e,h.path,h.affectedTree,r,i,l)}else{if(n.type!==ir.LISTEN_COMPLETE)throw(0,o.g5)("Unknown operation type: "+n.type);s=Ni(t,e,n.path,r,l)}var d=l.getChanges();return wi(e,s,d),{viewCache:s,changes:d}}function wi(t,e,n){var r=e.eventCache;if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=Er(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push($n(Er(e)))}}function xi(t,e,n,r,i,s){var a=e.eventCache;if(null!=li(r,n))return e;var l=void 0,u=void 0;if(we(n))if((0,o.hu)(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){var c=Nr(e),h=c instanceof yn?c:yn.EMPTY_NODE,d=si(r,h);l=t.filter.updateFullNode(e.eventCache.getNode(),d,s)}else{var p=oi(r,Nr(e));l=t.filter.updateFullNode(e.eventCache.getNode(),p,s)}else{var f=de(n);if(".priority"===f){(0,o.hu)(1===pe(n),"Can't have a priority with additional path components");var g=a.getNode();u=e.serverCache.getNode();var m=ai(r,n,g,u);l=null!=m?t.filter.updatePriority(g,m):a.getNode()}else{var y=fe(n),b=void 0;if(a.isCompleteForChild(f)){u=e.serverCache.getNode();var v=ai(r,n,a.getNode(),u);b=null!=v?a.getNode().getImmediateChild(f).updateChild(y,v):a.getNode().getImmediateChild(f)}else b=ci(r,f,e.serverCache);l=null!=b?t.filter.updateChild(a.getNode(),f,b,y,i,s):a.getNode()}}return Sr(e,l,a.isFullyInitialized()||we(n),t.filter.filtersNodes())}function ki(t,e,n,r,i,o,s,a){var l,u=e.serverCache,c=s?t.filter:t.filter.getIndexedFilter();if(we(n))l=c.updateFullNode(u.getNode(),r,null);else if(c.filtersNodes()&&!u.isFiltered()){var h=u.getNode().updateChild(n,r);l=c.updateFullNode(u.getNode(),h,null)}else{var d=de(n);if(!u.isCompleteForPath(n)&&pe(n)>1)return e;var p=fe(n),f=u.getNode().getImmediateChild(d),g=f.updateChild(p,r);l=".priority"===d?c.updatePriority(u.getNode(),g):c.updateChild(u.getNode(),d,g,p,gi,null)}var m=Tr(e,l,u.isFullyInitialized()||we(n),c.filtersNodes()),y=new mi(i,m,o);return xi(t,m,n,i,y,a)}function _i(t,e,n,r,i,o,s){var a,l,u=e.eventCache,c=new mi(i,e,o);if(we(n))l=t.filter.updateFullNode(e.eventCache.getNode(),r,s),a=Sr(e,l,!0,t.filter.filtersNodes());else{var h=de(n);if(".priority"===h)l=t.filter.updatePriority(e.eventCache.getNode(),r),a=Sr(e,l,u.isFullyInitialized(),u.isFiltered());else{var d=fe(n),p=u.getNode().getImmediateChild(h),f=void 0;if(we(d))f=r;else{var g=c.getCompleteChild(h);f=null!=g?".priority"===ge(d)&&g.getChild(be(d)).isEmpty()?g:g.updateChild(d,r):yn.EMPTY_NODE}if(p.equals(f))a=e;else{var m=t.filter.updateChild(u.getNode(),h,f,d,c,s);a=Sr(e,m,u.isFullyInitialized(),t.filter.filtersNodes())}}}return a}function Ii(t,e){return t.eventCache.isCompleteForChild(e)}function Ci(t,e,n,r,i,o,s){var a=e;return r.foreach((function(r,l){var u=ve(n,r);Ii(e,de(u))&&(a=_i(t,a,u,l,i,o,s))})),r.foreach((function(r,l){var u=ve(n,r);Ii(e,de(u))||(a=_i(t,a,u,l,i,o,s))})),a}function Si(t,e,n){return n.foreach((function(t,n){e=e.updateChild(t,n)})),e}function Ti(t,e,n,r,i,o,s,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;var l,u=e;l=we(n)?r:new Rr(null).setTree(n,r);var c=e.serverCache.getNode();return l.children.inorderTraversal((function(n,r){if(c.hasChild(n)){var l=e.serverCache.getNode().getImmediateChild(n),h=Si(t,l,r);u=ki(t,u,new ce(n),h,i,o,s,a)}})),l.children.inorderTraversal((function(n,r){var l=!e.serverCache.isCompleteForChild(n)&&void 0===r.value;if(!c.hasChild(n)&&!l){var h=e.serverCache.getNode().getImmediateChild(n),d=Si(t,h,r);u=ki(t,u,new ce(n),d,i,o,s,a)}})),u}function Ei(t,e,n,r,i,o,s){if(null!=li(i,n))return e;var a=e.serverCache.isFiltered(),l=e.serverCache;if(null!=r.value){if(we(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return ki(t,e,n,l.getNode().getChild(n),i,o,a,s);if(we(n)){var u=new Rr(null);return l.getNode().forEachChild(He,(function(t,e){u=u.set(new ce(t),e)})),Ti(t,e,n,u,i,o,a,s)}return e}var c=new Rr(null);return r.foreach((function(t,e){var r=ve(n,t);l.isCompleteForPath(r)&&(c=c.set(t,l.getNode().getChild(r)))})),Ti(t,e,n,c,i,o,a,s)}function Ni(t,e,n,r,i){var o=e.serverCache,s=Tr(e,o.getNode(),o.isFullyInitialized()||we(n),o.isFiltered());return xi(t,s,n,r,gi,i)}function Ai(t,e,n,r,i,s){var a;if(null!=li(r,n))return e;var l=new mi(r,e,i),u=e.eventCache.getNode(),c=void 0;if(we(n)||".priority"===de(n)){var h=void 0;if(e.serverCache.isFullyInitialized())h=oi(r,Nr(e));else{var d=e.serverCache.getNode();(0,o.hu)(d instanceof yn,"serverChildren would be complete if leaf node"),h=si(r,d)}c=t.filter.updateFullNode(u,h,s)}else{var p=de(n),f=ci(r,p,e.serverCache);null==f&&e.serverCache.isCompleteForChild(p)&&(f=u.getImmediateChild(p)),c=null!=f?t.filter.updateChild(u,p,f,fe(n),l,s):e.eventCache.getNode().hasChild(p)?t.filter.updateChild(u,p,yn.EMPTY_NODE,fe(n),l,s):u,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(a=oi(r,Nr(e)),a.isLeafNode()&&(c=t.filter.updateFullNode(c,a,s)))}return a=e.serverCache.isFullyInitialized()||null!=li(r,he()),Sr(e,c,a,t.filter.filtersNodes())}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ri,$i=function(){function t(t,e){this.query_=t,this.eventRegistrations_=[];var n=this.query_._queryParams,r=new Pn(n.getIndex()),i=Wn(n);this.processor_=yi(i);var o=e.serverCache,s=e.eventCache,a=r.updateFullNode(yn.EMPTY_NODE,o.getNode(),null),l=i.updateFullNode(yn.EMPTY_NODE,s.getNode(),null),u=new vr(a,o.isFullyInitialized(),r.filtersNodes()),c=new vr(l,s.isFullyInitialized(),i.filtersNodes());this.viewCache_=Cr(c,u),this.eventGenerator_=new wr(this.query_)}return Object.defineProperty(t.prototype,"query",{get:function(){return this.query_},enumerable:!1,configurable:!0}),t}();function Di(t){return t.viewCache_.serverCache.getNode()}function Oi(t){return Er(t.viewCache_)}function Fi(t,e){var n=Nr(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!we(e)&&!n.getImmediateChild(de(e)).isEmpty())?n.getChild(e):null}function Mi(t){return 0===t.eventRegistrations_.length}function Pi(t,e){t.eventRegistrations_.push(e)}function Li(t,e,n){var r=[];if(n){(0,o.hu)(null==e,"A cancel should cancel all event registrations.");var i=t.query._path;t.eventRegistrations_.forEach((function(t){var e=t.createCancelEvent(n,i);e&&r.push(e)}))}if(e){for(var s=[],a=0;a<t.eventRegistrations_.length;++a){var l=t.eventRegistrations_[a];if(l.matches(e)){if(e.hasAnyCallback()){s=s.concat(t.eventRegistrations_.slice(a+1));break}}else s.push(l)}t.eventRegistrations_=s}else t.eventRegistrations_=[];return r}function zi(t,e,n,r){e.type===ir.MERGE&&null!==e.source.queryId&&((0,o.hu)(Nr(t.viewCache_),"We should always have a full cache before handling merges"),(0,o.hu)(Er(t.viewCache_),"Missing event cache, even though we have a server cache"));var i=t.viewCache_,s=vi(t.processor_,i,e,n,r);return bi(t.processor_,s.viewCache),(0,o.hu)(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,Wi(t,s.changes,s.viewCache.eventCache.getNode(),null)}function Bi(t,e){var n=t.viewCache_.eventCache,r=[];if(!n.getNode().isLeafNode()){var i=n.getNode();i.forEachChild(hn,(function(t,e){r.push(Dn(t,e))}))}return n.isFullyInitialized()&&r.push($n(n.getNode())),Wi(t,r,n.getNode(),e)}function Wi(t,e,n,r){var i=r?[r]:t.eventRegistrations_;return xr(t.eventGenerator_,e,n,i)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ui,Vi=function(){function t(){this.views=new Map}return t}();function ji(t){(0,o.hu)(!Ri,"__referenceConstructor has already been defined"),Ri=t}function Hi(){return(0,o.hu)(Ri,"Reference.ts has not been loaded"),Ri}function Gi(t){return 0===t.views.size}function qi(t,e,n,r){var i,a,l=e.source.queryId;if(null!==l){var u=t.views.get(l);return(0,o.hu)(null!=u,"SyncTree gave us an op for an invalid query."),zi(u,e,n,r)}var c=[];try{for(var h=(0,s.XA)(t.views.values()),d=h.next();!d.done;d=h.next()){u=d.value;c=c.concat(zi(u,e,n,r))}}catch(p){i={error:p}}finally{try{d&&!d.done&&(a=h.return)&&a.call(h)}finally{if(i)throw i.error}}return c}function Ki(t,e,n,r,i){var o=e._queryIdentifier,s=t.views.get(o);if(!s){var a=oi(n,i?r:null),l=!1;a?l=!0:r instanceof yn?(a=si(n,r),l=!1):(a=yn.EMPTY_NODE,l=!1);var u=Cr(new vr(a,l,!1),new vr(r,i,!1));return new $i(e,u)}return s}function Xi(t,e,n,r,i,o){var s=Ki(t,e,r,i,o);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,s),Pi(s,n),Bi(s,n)}function Yi(t,e,n,r){var i,o,a=e._queryIdentifier,l=[],u=[],c=eo(t);if("default"===a)try{for(var h=(0,s.XA)(t.views.entries()),d=h.next();!d.done;d=h.next()){var p=(0,s.CR)(d.value,2),f=p[0],g=p[1];u=u.concat(Li(g,n,r)),Mi(g)&&(t.views.delete(f),g.query._queryParams.loadsAllData()||l.push(g.query))}}catch(m){i={error:m}}finally{try{d&&!d.done&&(o=h.return)&&o.call(h)}finally{if(i)throw i.error}}else{g=t.views.get(a);g&&(u=u.concat(Li(g,n,r)),Mi(g)&&(t.views.delete(a),g.query._queryParams.loadsAllData()||l.push(g.query)))}return c&&!eo(t)&&l.push(new(Hi())(e._repo,e._path)),{removed:l,events:u}}function Ji(t){var e,n,r=[];try{for(var i=(0,s.XA)(t.views.values()),o=i.next();!o.done;o=i.next()){var a=o.value;a.query._queryParams.loadsAllData()||r.push(a)}}catch(l){e={error:l}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Zi(t,e){var n,r,i=null;try{for(var o=(0,s.XA)(t.views.values()),a=o.next();!a.done;a=o.next()){var l=a.value;i=i||Fi(l,e)}}catch(u){n={error:u}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i}function Qi(t,e){var n=e._queryParams;if(n.loadsAllData())return no(t);var r=e._queryIdentifier;return t.views.get(r)}function to(t,e){return null!=Qi(t,e)}function eo(t){return null!=no(t)}function no(t){var e,n;try{for(var r=(0,s.XA)(t.views.values()),i=r.next();!i.done;i=r.next()){var o=i.value;if(o.query._queryParams.loadsAllData())return o}}catch(a){e={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return null}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ro(t){(0,o.hu)(!Ui,"__referenceConstructor has already been defined"),Ui=t}function io(){return(0,o.hu)(Ui,"Reference.ts has not been loaded"),Ui}var oo=1,so=function(){function t(t){this.listenProvider_=t,this.syncPointTree_=new Rr(null),this.pendingWriteTree_=ii(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}return t}();function ao(t,e,n,r,i){return jr(t.pendingWriteTree_,e,n,r,i),i?xo(t,new yr(hr(),e,n)):[]}function lo(t,e,n,r){Hr(t.pendingWriteTree_,e,n,r);var i=Rr.fromObject(n);return xo(t,new br(hr(),e,i))}function uo(t,e,n){void 0===n&&(n=!1);var r=Gr(t.pendingWriteTree_,e),i=qr(t.pendingWriteTree_,e);if(i){var o=new Rr(null);return null!=r.snap?o=o.set(he(),!0):z(r.children,(function(t){o=o.set(new ce(t),!0)})),xo(t,new gr(r.path,o,n))}return[]}function co(t,e,n){return xo(t,new yr(dr(),e,n))}function ho(t,e,n){var r=Rr.fromObject(n);return xo(t,new br(dr(),e,r))}function po(t,e){return xo(t,new mr(dr(),e))}function fo(t,e,n){var r=To(t,n);if(r){var i=Eo(r),o=i.path,s=i.queryId,a=xe(o,e),l=new mr(pr(s),a);return No(t,o,l)}return[]}function go(t,e,n,r){var i=e._path,o=t.syncPointTree_.get(i),s=[];if(o&&("default"===e._queryIdentifier||to(o,e))){var a=Yi(o,e,n,r);Gi(o)&&(t.syncPointTree_=t.syncPointTree_.remove(i));var l=a.removed;s=a.events;var u=-1!==l.findIndex((function(t){return t._queryParams.loadsAllData()})),c=t.syncPointTree_.findOnPath(i,(function(t,e){return eo(e)}));if(u&&!c){var h=t.syncPointTree_.subtree(i);if(!h.isEmpty())for(var d=Ao(h),p=0;p<d.length;++p){var f=d[p],g=f.query,m=Io(t,f);t.listenProvider_.startListening(Ro(g),Co(t,g),m.hashFn,m.onComplete)}}if(!c&&l.length>0&&!r)if(u){var y=null;t.listenProvider_.stopListening(Ro(e),y)}else l.forEach((function(e){var n=t.queryToTagMap.get(So(e));t.listenProvider_.stopListening(Ro(e),n)}));$o(t,l)}return s}function mo(t,e,n,r){var i=To(t,r);if(null!=i){var o=Eo(i),s=o.path,a=o.queryId,l=xe(s,e),u=new yr(pr(a),l,n);return No(t,s,u)}return[]}function yo(t,e,n,r){var i=To(t,r);if(i){var o=Eo(i),s=o.path,a=o.queryId,l=xe(s,e),u=Rr.fromObject(n),c=new br(pr(a),l,u);return No(t,s,c)}return[]}function bo(t,e,n){var r=e._path,i=null,s=!1;t.syncPointTree_.foreachOnPath(r,(function(t,e){var n=xe(t,r);i=i||Zi(e,n),s=s||eo(e)}));var a,l=t.syncPointTree_.get(r);if(l?(s=s||eo(l),i=i||Zi(l,he())):(l=new Vi,t.syncPointTree_=t.syncPointTree_.set(r,l)),null!=i)a=!0;else{a=!1,i=yn.EMPTY_NODE;var u=t.syncPointTree_.subtree(r);u.foreachChild((function(t,e){var n=Zi(e,he());n&&(i=i.updateImmediateChild(t,n))}))}var c=to(l,e);if(!c&&!e._queryParams.loadsAllData()){var h=So(e);(0,o.hu)(!t.queryToTagMap.has(h),"View does not exist, but we have a tag");var d=Do();t.queryToTagMap.set(h,d),t.tagToQueryMap.set(d,h)}var p=Vr(t.pendingWriteTree_,r),f=Xi(l,e,n,p,i,a);if(!c&&!s){var g=Qi(l,e);f=f.concat(Oo(t,e,g))}return f}function vo(t,e,n){var r=!0,i=t.pendingWriteTree_,o=t.syncPointTree_.findOnPath(e,(function(t,n){var r=xe(t,e),i=Zi(n,r);if(i)return i}));return Zr(i,e,o,n,r)}function wo(t,e){var n=e._path,r=null;t.syncPointTree_.foreachOnPath(n,(function(t,e){var i=xe(t,n);r=r||Zi(e,i)}));var i=t.syncPointTree_.get(n);i?r=r||Zi(i,he()):(i=new Vi,t.syncPointTree_=t.syncPointTree_.set(n,i));var o=null!=r,s=o?new vr(r,!0,!1):null,a=Vr(t.pendingWriteTree_,e._path),l=Ki(i,e,a,o?s.getNode():yn.EMPTY_NODE,o);return Oi(l)}function xo(t,e){return ko(e,t.syncPointTree_,null,Vr(t.pendingWriteTree_,he()))}function ko(t,e,n,r){if(we(t.path))return _o(t,e,n,r);var i=e.get(he());null==n&&null!=i&&(n=Zi(i,he()));var o=[],s=de(t.path),a=t.operationForChild(s),l=e.children.get(s);if(l&&a){var u=n?n.getImmediateChild(s):null,c=hi(r,s);o=o.concat(ko(a,l,u,c))}return i&&(o=o.concat(qi(i,t,r,n))),o}function _o(t,e,n,r){var i=e.get(he());null==n&&null!=i&&(n=Zi(i,he()));var o=[];return e.children.inorderTraversal((function(e,i){var s=n?n.getImmediateChild(e):null,a=hi(r,e),l=t.operationForChild(e);l&&(o=o.concat(_o(l,i,s,a)))})),i&&(o=o.concat(qi(i,t,r,n))),o}function Io(t,e){var n=e.query,r=Co(t,n);return{hashFn:function(){var t=Di(e)||yn.EMPTY_NODE;return t.hash()},onComplete:function(e){if("ok"===e)return r?fo(t,n._path,r):po(t,n._path);var i=V(e,n);return go(t,n,null,i)}}}function Co(t,e){var n=So(e);return t.queryToTagMap.get(n)}function So(t){return t._path.toString()+"$"+t._queryIdentifier}function To(t,e){return t.tagToQueryMap.get(e)}function Eo(t){var e=t.indexOf("$");return(0,o.hu)(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new ce(t.substr(0,e))}}function No(t,e,n){var r=t.syncPointTree_.get(e);(0,o.hu)(r,"Missing sync point for query tag that we're tracking");var i=Vr(t.pendingWriteTree_,e);return qi(r,n,i,null)}function Ao(t){return t.fold((function(t,e,n){if(e&&eo(e)){var r=no(e);return[r]}var i=[];return e&&(i=Ji(e)),z(n,(function(t,e){i=i.concat(e)})),i}))}function Ro(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(io())(t._repo,t._path):t}function $o(t,e){for(var n=0;n<e.length;++n){var r=e[n];if(!r._queryParams.loadsAllData()){var i=So(r),o=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(o)}}}function Do(){return oo++}function Oo(t,e,n){var r=e._path,i=Co(t,e),s=Io(t,n),a=t.listenProvider_.startListening(Ro(e),i,s.hashFn,s.onComplete),l=t.syncPointTree_.subtree(r);if(i)(0,o.hu)(!eo(l.value),"If we're adding a query, it shouldn't be shadowed");else for(var u=l.fold((function(t,e,n){if(!we(t)&&e&&eo(e))return[no(e).query];var r=[];return e&&(r=r.concat(Ji(e).map((function(t){return t.query})))),z(n,(function(t,e){r=r.concat(e)})),r})),c=0;c<u.length;++c){var h=u[c];t.listenProvider_.stopListening(Ro(h),Co(t,h))}return a}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fo=function(){function t(t){this.node_=t}return t.prototype.getImmediateChild=function(e){var n=this.node_.getImmediateChild(e);return new t(n)},t.prototype.node=function(){return this.node_},t}(),Mo=function(){function t(t,e){this.syncTree_=t,this.path_=e}return t.prototype.getImmediateChild=function(e){var n=ve(this.path_,e);return new t(this.syncTree_,n)},t.prototype.node=function(){return vo(this.syncTree_,this.path_)},t}(),Po=function(t){return t=t||{},t["timestamp"]=t["timestamp"]||(new Date).getTime(),t},Lo=function(t,e,n){return t&&"object"===typeof t?((0,o.hu)(".sv"in t,"Unexpected leaf node or priority contents"),"string"===typeof t[".sv"]?zo(t[".sv"],e,n):"object"===typeof t[".sv"]?Bo(t[".sv"],e):void(0,o.hu)(!1,"Unexpected server value: "+JSON.stringify(t,null,2))):t},zo=function(t,e,n){switch(t){case"timestamp":return n["timestamp"];default:(0,o.hu)(!1,"Unexpected server value: "+t)}},Bo=function(t,e,n){t.hasOwnProperty("increment")||(0,o.hu)(!1,"Unexpected server value: "+JSON.stringify(t,null,2));var r=t["increment"];"number"!==typeof r&&(0,o.hu)(!1,"Unexpected increment value: "+r);var i=e.node();if((0,o.hu)(null!==i&&"undefined"!==typeof i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;var s=i,a=s.getValue();return"number"!==typeof a?r:a+r},Wo=function(t,e,n,r){return Vo(e,new Mo(n,t),r)},Uo=function(t,e,n){return Vo(t,new Fo(e),n)};function Vo(t,e,n){var r,i=t.getPriority().val(),o=Lo(i,e.getImmediateChild(".priority"),n);if(t.isLeafNode()){var s=t,a=Lo(s.getValue(),e,n);return a!==s.getValue()||o!==s.getPriority().val()?new on(a,xn(o)):t}var l=t;return r=l,o!==l.getPriority().val()&&(r=r.updatePriority(new on(o))),l.forEachChild(hn,(function(t,i){var o=Vo(i,e.getImmediateChild(t),n);o!==i&&(r=r.updateImmediateChild(t,o))})),r}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var jo=function(){function t(t,e,n){void 0===t&&(t=""),void 0===e&&(e=null),void 0===n&&(n={children:{},childCount:0}),this.name=t,this.parent=e,this.node=n}return t}();function Ho(t,e){var n=e instanceof ce?e:new ce(e),r=t,i=de(n);while(null!==i){var s=(0,o.DV)(r.node.children,i)||{children:{},childCount:0};r=new jo(i,r,s),n=fe(n),i=de(n)}return r}function Go(t){return t.node.value}function qo(t,e){t.node.value=e,ts(t)}function Ko(t){return t.node.childCount>0}function Xo(t){return void 0===Go(t)&&!Ko(t)}function Yo(t,e){z(t.node.children,(function(n,r){e(new jo(n,t,r))}))}function Jo(t,e,n,r){n&&!r&&e(t),Yo(t,(function(t){Jo(t,e,!0,r)})),n&&r&&e(t)}function Zo(t,e,n){var r=n?t:t.parent;while(null!==r){if(e(r))return!0;r=r.parent}return!1}function Qo(t){return new ce(null===t.parent?t.name:Qo(t.parent)+"/"+t.name)}function ts(t){null!==t.parent&&es(t.parent,t.name,t)}function es(t,e,n){var r=Xo(n),i=(0,o.r3)(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,ts(t)):r||i||(t.node.children[e]=n.node,t.node.childCount++,ts(t))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ns=/[\[\].#$\/\u0000-\u001F\u007F]/,rs=/[\[\].#$\u0000-\u001F\u007F]/,is=10485760,os=function(t){return"string"===typeof t&&0!==t.length&&!ns.test(t)},ss=function(t){return"string"===typeof t&&0!==t.length&&!rs.test(t)},as=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),ss(t)},ls=function(t){return null===t||"string"===typeof t||"number"===typeof t&&!A(t)||t&&"object"===typeof t&&(0,o.r3)(t,".sv")},us=function(t,e,n,r){r&&void 0===e||cs((0,o.gK)(t,"value"),e,n)},cs=function(t,e,n){var r=n instanceof ce?new Ce(n,t):n;if(void 0===e)throw new Error(t+"contains undefined "+Ne(r));if("function"===typeof e)throw new Error(t+"contains a function "+Ne(r)+" with contents = "+e.toString());if(A(e))throw new Error(t+"contains "+e.toString()+" "+Ne(r));if("string"===typeof e&&e.length>is/3&&(0,o.ug)(e)>is)throw new Error(t+"contains a string greater than "+is+" utf8 bytes "+Ne(r)+" ('"+e.substring(0,50)+"...')");if(e&&"object"===typeof e){var i=!1,s=!1;if(z(e,(function(e,n){if(".value"===e)i=!0;else if(".priority"!==e&&".sv"!==e&&(s=!0,!os(e)))throw new Error(t+" contains an invalid key ("+e+") "+Ne(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');Se(r,e),cs(t,n,r),Te(r)})),i&&s)throw new Error(t+' contains ".value" child '+Ne(r)+" in addition to actual children.")}},hs=function(t,e){var n,r;for(n=0;n<e.length;n++){r=e[n];for(var i=ye(r),o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!os(i[o]))throw new Error(t+"contains an invalid key ("+i[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}e.sort(ke);var s=null;for(n=0;n<e.length;n++){if(r=e[n],null!==s&&Ie(s,r))throw new Error(t+"contains a path "+s.toString()+" that is ancestor of another path "+r.toString());s=r}},ds=function(t,e,n,r){if(!r||void 0!==e){var i=(0,o.gK)(t,"values");if(!e||"object"!==typeof e||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");var s=[];z(e,(function(t,e){var r=new ce(t);if(cs(i,e,ve(n,r)),".priority"===ge(r)&&!ls(e))throw new Error(i+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(r)})),hs(i,s)}},ps=function(t,e,n){if(!n||void 0!==e){if(A(e))throw new Error((0,o.gK)(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!ls(e))throw new Error((0,o.gK)(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},fs=function(t,e,n){if(!n||void 0!==e)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error((0,o.gK)(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},gs=function(t,e,n,r){if((!r||void 0!==n)&&!os(n))throw new Error((0,o.gK)(t,e)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},ms=function(t,e,n,r){if((!r||void 0!==n)&&!ss(n))throw new Error((0,o.gK)(t,e)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},ys=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),ms(t,e,n,r)},bs=function(t,e){if(".info"===de(e))throw new Error(t+" failed = Can't modify data under /.info/")},vs=function(t,e){var n=e.path.toString();if("string"!==typeof e.repoInfo.host||0===e.repoInfo.host.length||!os(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==n.length&&!as(n))throw new Error((0,o.gK)(t,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},ws=function(t,e,n,r){if((!r||void 0!==n)&&"boolean"!==typeof n)throw new Error((0,o.gK)(t,e)+"must be a boolean.")},xs=function(){function t(){this.eventLists_=[],this.recursionDepth_=0}return t}();function ks(t,e){for(var n=null,r=0;r<e.length;r++){var i=e[r],o=i.getPath();null===n||_e(o,n.path)||(t.eventLists_.push(n),n=null),null===n&&(n={events:[],path:o}),n.events.push(i)}n&&t.eventLists_.push(n)}function _s(t,e,n){ks(t,n),Cs(t,(function(t){return _e(t,e)}))}function Is(t,e,n){ks(t,n),Cs(t,(function(t){return Ie(t,e)||Ie(e,t)}))}function Cs(t,e){t.recursionDepth_++;for(var n=!0,r=0;r<t.eventLists_.length;r++){var i=t.eventLists_[r];if(i){var o=i.path;e(o)?(Ss(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function Ss(t){for(var e=0;e<t.events.length;e++){var n=t.events[e];if(null!==n){t.events[e]=null;var r=n.getEventRunner();x&&I("event: "+n.toString()),K(r)}}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ts="repo_interrupt",Es=25,Ns=function(){function t(t,e,n,r){this.repoInfo_=t,this.forceRestClient_=e,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new xs,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Qn(),this.transactionQueueTree_=new jo,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return t.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},t}();function As(t,e,n){if(t.stats_=yt(t.repoInfo_),t.forceRestClient_||X())t.server_=new Jn(t.repoInfo_,(function(e,n,r,i){Ds(t,e,n,r,i)}),t.authTokenProvider_,t.appCheckProvider_),setTimeout((function(){return Fs(t,!0)}),0);else{if("undefined"!==typeof n&&null!==n){if("object"!==typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,o.Pz)(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new We(t.repoInfo_,e,(function(e,n,r,i){Ds(t,e,n,r,i)}),(function(e){Fs(t,e)}),(function(e){Ms(t,e)}),t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener((function(e){t.server_.refreshAuthToken(e)})),t.appCheckProvider_.addTokenChangeListener((function(e){t.server_.refreshAppCheckToken(e.token)})),t.statsReporter_=bt(t.repoInfo_,(function(){return new ur(t.stats_,t.server_)})),t.infoData_=new Zn,t.infoSyncTree_=new so({startListening:function(e,n,r,i){var o=[],s=t.infoData_.getNode(e._path);return s.isEmpty()||(o=co(t.infoSyncTree_,e._path,s),setTimeout((function(){i("ok")}),0)),o},stopListening:function(){}}),Ps(t,"connected",!1),t.serverSyncTree_=new so({startListening:function(e,n,r,i){return t.server_.listen(e,r,n,(function(n,r){var o=i(n,r);Is(t.eventQueue_,e._path,o)})),[]},stopListening:function(e,n){t.server_.unlisten(e,n)}})}function Rs(t){var e=t.infoData_.getNode(new ce(".info/serverTimeOffset")),n=e.val()||0;return(new Date).getTime()+n}function $s(t){return Po({timestamp:Rs(t)})}function Ds(t,e,n,r,i){t.dataUpdateCount++;var s=new ce(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;var a=[];if(i)if(r){var l=(0,o.UI)(n,(function(t){return xn(t)}));a=yo(t.serverSyncTree_,s,l,i)}else{var u=xn(n);a=mo(t.serverSyncTree_,s,u,i)}else if(r){var c=(0,o.UI)(n,(function(t){return xn(t)}));a=ho(t.serverSyncTree_,s,c)}else{var h=xn(n);a=co(t.serverSyncTree_,s,h)}var d=s;a.length>0&&(d=oa(t,s)),Is(t.eventQueue_,d,a)}function Os(t,e){t.interceptServerDataCallback_=e}function Fs(t,e){Ps(t,"connected",e),!1===e&&Us(t)}function Ms(t,e){z(e,(function(e,n){Ps(t,e,n)}))}function Ps(t,e,n){var r=new ce("/.info/"+e),i=xn(n);t.infoData_.updateSnapshot(r,i);var o=co(t.infoSyncTree_,r,i);Is(t.eventQueue_,r,o)}function Ls(t){return t.nextWriteId_++}function zs(t,e){var n=wo(t.serverSyncTree_,e);return null!=n?Promise.resolve(n):t.server_.get(e).then((function(n){var r=xn(n).withIndex(e._queryParams.getIndex()),i=co(t.serverSyncTree_,e._path,r);return _s(t.eventQueue_,e._path,i),Promise.resolve(r)}),(function(n){return Qs(t,"get for query "+(0,o.Pz)(e)+" failed: "+n),Promise.reject(new Error(n))}))}function Bs(t,e,n,r,i){Qs(t,"set",{path:e.toString(),value:n,priority:r});var o=$s(t),s=xn(n,r),a=vo(t.serverSyncTree_,e),l=Uo(s,a,o),u=Ls(t),c=ao(t.serverSyncTree_,e,l,u,!0);ks(t.eventQueue_,c),t.server_.put(e.toString(),s.val(!0),(function(n,r){var o="ok"===n;o||E("set at "+e+" failed: "+n);var s=uo(t.serverSyncTree_,u,!o);Is(t.eventQueue_,e,s),ta(t,i,n,r)}));var h=ha(t,e);oa(t,h),Is(t.eventQueue_,h,[])}function Ws(t,e,n,r){Qs(t,"update",{path:e.toString(),value:n});var i=!0,o=$s(t),s={};if(z(n,(function(n,r){i=!1,s[n]=Wo(ve(e,n),xn(r),t.serverSyncTree_,o)})),i)I("update() called with empty data.  Don't do anything."),ta(t,r,"ok",void 0);else{var a=Ls(t),l=lo(t.serverSyncTree_,e,s,a);ks(t.eventQueue_,l),t.server_.merge(e.toString(),n,(function(n,i){var o="ok"===n;o||E("update at "+e+" failed: "+n);var s=uo(t.serverSyncTree_,a,!o),l=s.length>0?oa(t,e):e;Is(t.eventQueue_,l,s),ta(t,r,n,i)})),z(n,(function(n){var r=ha(t,ve(e,n));oa(t,r)})),Is(t.eventQueue_,e,[])}}function Us(t){Qs(t,"onDisconnectEvents");var e=$s(t),n=Qn();nr(t.onDisconnect_,he(),(function(r,i){var o=Wo(r,i,t.serverSyncTree_,e);tr(n,r,o)}));var r=[];nr(n,he(),(function(e,n){r=r.concat(co(t.serverSyncTree_,e,n));var i=ha(t,e);oa(t,i)})),t.onDisconnect_=Qn(),Is(t.eventQueue_,he(),r)}function Vs(t,e,n){t.server_.onDisconnectCancel(e.toString(),(function(r,i){"ok"===r&&er(t.onDisconnect_,e),ta(t,n,r,i)}))}function js(t,e,n,r){var i=xn(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(function(n,o){"ok"===n&&tr(t.onDisconnect_,e,i),ta(t,r,n,o)}))}function Hs(t,e,n,r,i){var o=xn(n,r);t.server_.onDisconnectPut(e.toString(),o.val(!0),(function(n,r){"ok"===n&&tr(t.onDisconnect_,e,o),ta(t,i,n,r)}))}function Gs(t,e,n,r){if((0,o.xb)(n))return I("onDisconnect().update() called with empty data.  Don't do anything."),void ta(t,r,"ok",void 0);t.server_.onDisconnectMerge(e.toString(),n,(function(i,o){"ok"===i&&z(n,(function(n,r){var i=xn(r);tr(t.onDisconnect_,ve(e,n),i)})),ta(t,r,i,o)}))}function qs(t,e,n){var r;r=".info"===de(e._path)?bo(t.infoSyncTree_,e,n):bo(t.serverSyncTree_,e,n),_s(t.eventQueue_,e._path,r)}function Ks(t,e,n){var r;r=".info"===de(e._path)?go(t.infoSyncTree_,e,n):go(t.serverSyncTree_,e,n),_s(t.eventQueue_,e._path,r)}function Xs(t){t.persistentConnection_&&t.persistentConnection_.interrupt(Ts)}function Ys(t){t.persistentConnection_&&t.persistentConnection_.resume(Ts)}function Js(t,e){if(void 0===e&&(e=!1),"undefined"!==typeof console){var n;e?(t.statsListener_||(t.statsListener_=new or(t.stats_)),n=t.statsListener_.get()):n=t.stats_.get();var r=Object.keys(n).reduce((function(t,e){return Math.max(e.length,t)}),0);z(n,(function(t,e){for(var n=t,i=t.length;i<r+2;i++)n+=" ";console.log(n+e)}))}}function Zs(t,e){t.stats_.incrementCounter(e),cr(t.statsReporter_,e)}function Qs(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r="";t.persistentConnection_&&(r=t.persistentConnection_.id+":"),I.apply(void 0,(0,s.ev)([r],(0,s.CR)(e)))}function ta(t,e,n,r){e&&K((function(){if("ok"===n)e(null);else{var t=(n||"error").toUpperCase(),i=t;r&&(i+=": "+r);var o=new Error(i);o.code=t,e(o)}}))}function ea(t,e,n,r,i,s){Qs(t,"transaction on "+e);var a={path:e,update:n,onComplete:r,status:null,order:b(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},l=na(t,e,void 0);a.currentInputSnapshot=l;var u=a.update(l.val());if(void 0===u)a.unwatcher(),a.currentOutputSnapshotRaw=null,a.currentOutputSnapshotResolved=null,a.onComplete&&a.onComplete(null,!1,a.currentInputSnapshot);else{cs("transaction failed: Data returned ",u,a.path),a.status=0;var c=Ho(t.transactionQueueTree_,e),h=Go(c)||[];h.push(a),qo(c,h);var d=void 0;if("object"===typeof u&&null!==u&&(0,o.r3)(u,".priority"))d=(0,o.DV)(u,".priority"),(0,o.hu)(ls(d),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.");else{var p=vo(t.serverSyncTree_,e)||yn.EMPTY_NODE;d=p.getPriority().val()}var f=$s(t),g=xn(u,d),m=Uo(g,l,f);a.currentOutputSnapshotRaw=g,a.currentOutputSnapshotResolved=m,a.currentWriteId=Ls(t);var y=ao(t.serverSyncTree_,e,m,a.currentWriteId,a.applyLocally);Is(t.eventQueue_,e,y),ra(t,t.transactionQueueTree_)}}function na(t,e,n){return vo(t.serverSyncTree_,e,n)||yn.EMPTY_NODE}function ra(t,e){if(void 0===e&&(e=t.transactionQueueTree_),e||ca(t,e),Go(e)){var n=la(t,e);(0,o.hu)(n.length>0,"Sending zero length transaction queue");var r=n.every((function(t){return 0===t.status}));r&&ia(t,Qo(e),n)}else Ko(e)&&Yo(e,(function(e){ra(t,e)}))}function ia(t,e,n){for(var r=n.map((function(t){return t.currentWriteId})),i=na(t,e,r),s=i,a=i.hash(),l=0;l<n.length;l++){var u=n[l];(0,o.hu)(0===u.status,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;var c=xe(e,u.path);s=s.updateChild(c,u.currentOutputSnapshotRaw)}var h=s.val(!0),d=e;t.server_.put(d.toString(),h,(function(r){Qs(t,"transaction put response",{path:d.toString(),status:r});var i=[];if("ok"===r){for(var o=[],s=function(e){n[e].status=2,i=i.concat(uo(t.serverSyncTree_,n[e].currentWriteId)),n[e].onComplete&&o.push((function(){return n[e].onComplete(null,!0,n[e].currentOutputSnapshotResolved)})),n[e].unwatcher()},a=0;a<n.length;a++)s(a);ca(t,Ho(t.transactionQueueTree_,e)),ra(t,t.transactionQueueTree_),Is(t.eventQueue_,e,i);for(a=0;a<o.length;a++)K(o[a])}else{if("datastale"===r)for(a=0;a<n.length;a++)3===n[a].status?n[a].status=4:n[a].status=0;else{E("transaction at "+d.toString()+" failed: "+r);for(a=0;a<n.length;a++)n[a].status=4,n[a].abortReason=r}oa(t,e)}}),a)}function oa(t,e){var n=aa(t,e),r=Qo(n),i=la(t,n);return sa(t,i,r),r}function sa(t,e,n){if(0!==e.length){for(var r=[],i=[],s=e.filter((function(t){return 0===t.status})),a=s.map((function(t){return t.currentWriteId})),l=function(s){var l,u=e[s],c=xe(n,u.path),h=!1;if((0,o.hu)(null!==c,"rerunTransactionsUnderNode_: relativePath should not be null."),4===u.status)h=!0,l=u.abortReason,i=i.concat(uo(t.serverSyncTree_,u.currentWriteId,!0));else if(0===u.status)if(u.retryCount>=Es)h=!0,l="maxretry",i=i.concat(uo(t.serverSyncTree_,u.currentWriteId,!0));else{var d=na(t,u.path,a);u.currentInputSnapshot=d;var p=e[s].update(d.val());if(void 0!==p){cs("transaction failed: Data returned ",p,u.path);var f=xn(p),g="object"===typeof p&&null!=p&&(0,o.r3)(p,".priority");g||(f=f.updatePriority(d.getPriority()));var m=u.currentWriteId,y=$s(t),b=Uo(f,d,y);u.currentOutputSnapshotRaw=f,u.currentOutputSnapshotResolved=b,u.currentWriteId=Ls(t),a.splice(a.indexOf(m),1),i=i.concat(ao(t.serverSyncTree_,u.path,b,u.currentWriteId,u.applyLocally)),i=i.concat(uo(t.serverSyncTree_,m,!0))}else h=!0,l="nodata",i=i.concat(uo(t.serverSyncTree_,u.currentWriteId,!0))}Is(t.eventQueue_,n,i),i=[],h&&(e[s].status=2,function(t){setTimeout(t,Math.floor(0))}(e[s].unwatcher),e[s].onComplete&&("nodata"===l?r.push((function(){return e[s].onComplete(null,!1,e[s].currentInputSnapshot)})):r.push((function(){return e[s].onComplete(new Error(l),!1,null)}))))},u=0;u<e.length;u++)l(u);ca(t,t.transactionQueueTree_);for(u=0;u<r.length;u++)K(r[u]);ra(t,t.transactionQueueTree_)}}function aa(t,e){var n,r=t.transactionQueueTree_;n=de(e);while(null!==n&&void 0===Go(r))r=Ho(r,n),e=fe(e),n=de(e);return r}function la(t,e){var n=[];return ua(t,e,n),n.sort((function(t,e){return t.order-e.order})),n}function ua(t,e,n){var r=Go(e);if(r)for(var i=0;i<r.length;i++)n.push(r[i]);Yo(e,(function(e){ua(t,e,n)}))}function ca(t,e){var n=Go(e);if(n){for(var r=0,i=0;i<n.length;i++)2!==n[i].status&&(n[r]=n[i],r++);n.length=r,qo(e,n.length>0?n:void 0)}Yo(e,(function(e){ca(t,e)}))}function ha(t,e){var n=Qo(aa(t,e)),r=Ho(t.transactionQueueTree_,e);return Zo(r,(function(e){da(t,e)})),da(t,r),Jo(r,(function(e){da(t,e)})),n}function da(t,e){var n=Go(e);if(n){for(var r=[],i=[],s=-1,a=0;a<n.length;a++)3===n[a].status||(1===n[a].status?((0,o.hu)(s===a-1,"All SENT items should be at beginning of queue."),s=a,n[a].status=3,n[a].abortReason="set"):((0,o.hu)(0===n[a].status,"Unexpected transaction status in abort"),n[a].unwatcher(),i=i.concat(uo(t.serverSyncTree_,n[a].currentWriteId,!0)),n[a].onComplete&&r.push(n[a].onComplete.bind(null,new Error("set"),!1,null))));-1===s?qo(e,void 0):n.length=s+1,Is(t.eventQueue_,Qo(e),i);for(a=0;a<r.length;a++)K(r[a])}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pa(t){for(var e="",n=t.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(o){}e+="/"+i}return e}function fa(t){var e,n,r={};"?"===t.charAt(0)&&(t=t.substring(1));try{for(var i=(0,s.XA)(t.split("&")),o=i.next();!o.done;o=i.next()){var a=o.value;if(0!==a.length){var l=a.split("=");2===l.length?r[decodeURIComponent(l[0])]=decodeURIComponent(l[1]):E("Invalid query segment '"+a+"' in query '"+t+"'")}}}catch(u){e={error:u}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}var ga=function(t,e){var n=ma(t),r=n.namespace;"firebase.com"===n.domain&&T(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||T("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||N();var i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new ht(n.host,n.secure,r,e,i,"",r!==n.subdomain),path:new ce(n.pathString)}},ma=function(t){var e="",n="",r="",i="",o="",s=!0,a="https",l=443;if("string"===typeof t){var u=t.indexOf("//");u>=0&&(a=t.substring(0,u-1),t=t.substring(u+2));var c=t.indexOf("/");-1===c&&(c=t.length);var h=t.indexOf("?");-1===h&&(h=t.length),e=t.substring(0,Math.min(c,h)),c<h&&(i=pa(t.substring(c,h)));var d=fa(t.substring(Math.min(t.length,h)));u=e.indexOf(":"),u>=0?(s="https"===a||"wss"===a,l=parseInt(e.substring(u+1),10)):u=e.length;var p=e.slice(0,u);if("localhost"===p.toLowerCase())n="localhost";else if(p.split(".").length<=2)n=p;else{var f=e.indexOf(".");r=e.substring(0,f).toLowerCase(),n=e.substring(f+1),o=r}"ns"in d&&(o=d["ns"])}return{host:e,port:l,domain:n,subdomain:r,secure:s,scheme:a,pathString:i,namespace:o}},ya=function(){function t(t,e,n,r){this.eventType=t,this.eventRegistration=e,this.snapshot=n,this.prevName=r}return t.prototype.getPath=function(){var t=this.snapshot.ref;return"value"===this.eventType?t._path:t.parent._path},t.prototype.getEventType=function(){return this.eventType},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+(0,o.Pz)(this.snapshot.exportVal())},t}(),ba=function(){function t(t,e,n){this.eventRegistration=t,this.error=e,this.path=n}return t.prototype.getPath=function(){return this.path},t.prototype.getEventType=function(){return"cancel"},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.path.toString()+":cancel"},t}(),va=function(){function t(t,e){this.snapshotCallback=t,this.cancelCallback=e}return t.prototype.onValue=function(t,e){this.snapshotCallback.call(null,t,e)},t.prototype.onCancel=function(t){return(0,o.hu)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,t)},Object.defineProperty(t.prototype,"hasCancelCallback",{get:function(){return!!this.cancelCallback},enumerable:!1,configurable:!0}),t.prototype.matches=function(t){return this.snapshotCallback===t.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===t.snapshotCallback.userCallback&&this.snapshotCallback.context===t.snapshotCallback.context},t}(),wa=function(){function t(t,e){this._repo=t,this._path=e}return t.prototype.cancel=function(){var t=new o.BH;return Vs(this._repo,this._path,t.wrapCallback((function(){}))),t.promise},t.prototype.remove=function(){bs("OnDisconnect.remove",this._path);var t=new o.BH;return js(this._repo,this._path,null,t.wrapCallback((function(){}))),t.promise},t.prototype.set=function(t){bs("OnDisconnect.set",this._path),us("OnDisconnect.set",t,this._path,!1);var e=new o.BH;return js(this._repo,this._path,t,e.wrapCallback((function(){}))),e.promise},t.prototype.setWithPriority=function(t,e){bs("OnDisconnect.setWithPriority",this._path),us("OnDisconnect.setWithPriority",t,this._path,!1),ps("OnDisconnect.setWithPriority",e,!1);var n=new o.BH;return Hs(this._repo,this._path,t,e,n.wrapCallback((function(){}))),n.promise},t.prototype.update=function(t){bs("OnDisconnect.update",this._path),ds("OnDisconnect.update",t,this._path,!1);var e=new o.BH;return Gs(this._repo,this._path,t,e.wrapCallback((function(){}))),e.promise},t}(),xa=function(){function t(t,e,n,r){this._repo=t,this._path=e,this._queryParams=n,this._orderByCalled=r}return Object.defineProperty(t.prototype,"key",{get:function(){return we(this._path)?null:ge(this._path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Ca(this._repo,this._path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_queryIdentifier",{get:function(){var t=Yn(this._queryParams),e=P(t);return"{}"===e?"default":e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_queryObject",{get:function(){return Yn(this._queryParams)},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){if(e=(0,o.m9)(e),!(e instanceof t))return!1;var n=this._repo===e._repo,r=_e(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i},t.prototype.toJSON=function(){return this.toString()},t.prototype.toString=function(){return this._repo.toString()+me(this._path)},t}();function ka(t,e){if(!0===t._orderByCalled)throw new Error(e+": You can't combine multiple orderBy calls.")}function _a(t){var e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===He){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){var s=t.getIndexStartName();if(s!==$)throw new Error(r);if("string"!==typeof e)throw new Error(i)}if(t.hasEnd()){var a=t.getIndexEndName();if(a!==D)throw new Error(r);if("string"!==typeof n)throw new Error(i)}}else if(t.getIndex()===hn){if(null!=e&&!ls(e)||null!=n&&!ls(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,o.hu)(t.getIndex()instanceof kn||t.getIndex()===In,"unknown index type."),null!=e&&"object"===typeof e||null!=n&&"object"===typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Ia(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var Ca=function(t){function e(e,n){return t.call(this,e,n,new Bn,!1)||this}return(0,s.ZT)(e,t),Object.defineProperty(e.prototype,"parent",{get:function(){var t=be(this._path);return null===t?null:new e(this._repo,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){var t=this;while(null!==t.parent)t=t.parent;return t},enumerable:!1,configurable:!0}),e}(xa),Sa=function(){function t(t,e,n){this._node=t,this.ref=e,this._index=n}return Object.defineProperty(t.prototype,"priority",{get:function(){return this._node.getPriority().val()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this.ref.key},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._node.numChildren()},enumerable:!1,configurable:!0}),t.prototype.child=function(e){var n=new ce(e),r=Na(this.ref,e);return new t(this._node.getChild(n),r,hn)},t.prototype.exists=function(){return!this._node.isEmpty()},t.prototype.exportVal=function(){return this._node.val(!0)},t.prototype.forEach=function(e){var n=this;if(this._node.isLeafNode())return!1;var r=this._node;return!!r.forEachChild(this._index,(function(r,i){return e(new t(i,Na(n.ref,r),hn))}))},t.prototype.hasChild=function(t){var e=new ce(t);return!this._node.getChild(e).isEmpty()},t.prototype.hasChildren=function(){return!this._node.isLeafNode()&&!this._node.isEmpty()},t.prototype.toJSON=function(){return this.exportVal()},t.prototype.val=function(){return this._node.val()},t}();function Ta(t,e){return t=(0,o.m9)(t),t._checkNotDeleted("ref"),void 0!==e?Na(t._root,e):t._root}function Ea(t,e){t=(0,o.m9)(t),t._checkNotDeleted("refFromURL");var n=ga(e,t._repo.repoInfo_.nodeAdmin);vs("refFromURL",n);var r=n.repoInfo;return t._repo.repoInfo_.isCustomHost()||r.host===t._repo.repoInfo_.host||T("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),Ta(t,n.path.toString())}function Na(t,e){return t=(0,o.m9)(t),null===de(t._path)?ys("child","path",e,!1):ms("child","path",e,!1),new Ca(t._repo,ve(t._path,e))}function Aa(t,e){t=(0,o.m9)(t),bs("push",t._path),us("push",e,t._path,!0);var n,r=Rs(t._repo),i=Nn(r),s=Na(t,i),a=Na(t,i);return n=null!=e?$a(a,e).then((function(){return a})):Promise.resolve(a),s.then=n.then.bind(n),s.catch=n.then.bind(n,void 0),s}function Ra(t){return bs("remove",t._path),$a(t,null)}function $a(t,e){t=(0,o.m9)(t),bs("set",t._path),us("set",e,t._path,!1);var n=new o.BH;return Bs(t._repo,t._path,e,null,n.wrapCallback((function(){}))),n.promise}function Da(t,e){t=(0,o.m9)(t),bs("setPriority",t._path),ps("setPriority",e,!1);var n=new o.BH;return Bs(t._repo,ve(t._path,".priority"),e,null,n.wrapCallback((function(){}))),n.promise}function Oa(t,e,n){if(bs("setWithPriority",t._path),us("setWithPriority",e,t._path,!1),ps("setWithPriority",n,!1),".length"===t.key||".keys"===t.key)throw"setWithPriority failed: "+t.key+" is a read-only object.";var r=new o.BH;return Bs(t._repo,t._path,e,n,r.wrapCallback((function(){}))),r.promise}function Fa(t,e){ds("update",e,t._path,!1);var n=new o.BH;return Ws(t._repo,t._path,e,n.wrapCallback((function(){}))),n.promise}function Ma(t){return t=(0,o.m9)(t),zs(t._repo,t).then((function(e){return new Sa(e,new Ca(t._repo,t._path),t._queryParams.getIndex())}))}var Pa=function(){function t(t){this.callbackContext=t}return t.prototype.respondsTo=function(t){return"value"===t},t.prototype.createEvent=function(t,e){var n=e._queryParams.getIndex();return new ya("value",this,new Sa(t.snapshotNode,new Ca(e._repo,e._path),n))},t.prototype.getEventRunner=function(t){var e=this;return"cancel"===t.getEventType()?function(){return e.callbackContext.onCancel(t.error)}:function(){return e.callbackContext.onValue(t.snapshot,null)}},t.prototype.createCancelEvent=function(t,e){return this.callbackContext.hasCancelCallback?new ba(this,t,e):null},t.prototype.matches=function(e){return e instanceof t&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))},t.prototype.hasAnyCallback=function(){return null!==this.callbackContext},t}(),La=function(){function t(t,e){this.eventType=t,this.callbackContext=e}return t.prototype.respondsTo=function(t){var e="children_added"===t?"child_added":t;return e="children_removed"===e?"child_removed":e,this.eventType===e},t.prototype.createCancelEvent=function(t,e){return this.callbackContext.hasCancelCallback?new ba(this,t,e):null},t.prototype.createEvent=function(t,e){(0,o.hu)(null!=t.childName,"Child events should have a childName.");var n=Na(new Ca(e._repo,e._path),t.childName),r=e._queryParams.getIndex();return new ya(t.type,this,new Sa(t.snapshotNode,n,r),t.prevName)},t.prototype.getEventRunner=function(t){var e=this;return"cancel"===t.getEventType()?function(){return e.callbackContext.onCancel(t.error)}:function(){return e.callbackContext.onValue(t.snapshot,t.prevName)}},t.prototype.matches=function(e){return e instanceof t&&(this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)))},t.prototype.hasAnyCallback=function(){return!!this.callbackContext},t}();function za(t,e,n,r,i){var o;if("object"===typeof r&&(o=void 0,i=r),"function"===typeof r&&(o=r),i&&i.onlyOnce){var s=n,a=function(e,n){Ks(t._repo,t,u),s(e,n)};a.userCallback=n.userCallback,a.context=n.context,n=a}var l=new va(n,o||void 0),u="value"===e?new Pa(l):new La(e,l);return qs(t._repo,t,u),function(){return Ks(t._repo,t,u)}}function Ba(t,e,n,r){return za(t,"value",e,n,r)}function Wa(t,e,n,r){return za(t,"child_added",e,n,r)}function Ua(t,e,n,r){return za(t,"child_changed",e,n,r)}function Va(t,e,n,r){return za(t,"child_moved",e,n,r)}function ja(t,e,n,r){return za(t,"child_removed",e,n,r)}function Ha(t,e,n){var r=null,i=n?new va(n):null;"value"===e?r=new Pa(i):e&&(r=new La(e,i)),Ks(t._repo,t,r)}var Ga=function(){function t(){}return t}(),qa=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return(0,s.ZT)(e,t),e.prototype._apply=function(t){us("endAt",this._value,t._path,!0);var e=Gn(t._queryParams,this._value,this._key);if(Ia(e),_a(e),t._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new xa(t._repo,t._path,e,t._orderByCalled)},e}(Ga);function Ka(t,e){return gs("endAt","key",e,!0),new qa(t,e)}var Xa=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return(0,s.ZT)(e,t),e.prototype._apply=function(t){us("endBefore",this._value,t._path,!1);var e=qn(t._queryParams,this._value,this._key);if(Ia(e),_a(e),t._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new xa(t._repo,t._path,e,t._orderByCalled)},e}(Ga);function Ya(t,e){return gs("endBefore","key",e,!0),new Xa(t,e)}var Ja=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return(0,s.ZT)(e,t),e.prototype._apply=function(t){us("startAt",this._value,t._path,!0);var e=jn(t._queryParams,this._value,this._key);if(Ia(e),_a(e),t._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new xa(t._repo,t._path,e,t._orderByCalled)},e}(Ga);function Za(t,e){return void 0===t&&(t=null),gs("startAt","key",e,!0),new Ja(t,e)}var Qa=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return(0,s.ZT)(e,t),e.prototype._apply=function(t){us("startAfter",this._value,t._path,!1);var e=Hn(t._queryParams,this._value,this._key);if(Ia(e),_a(e),t._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new xa(t._repo,t._path,e,t._orderByCalled)},e}(Ga);function tl(t,e){return gs("startAfter","key",e,!0),new Qa(t,e)}var el=function(t){function e(e){var n=t.call(this)||this;return n._limit=e,n}return(0,s.ZT)(e,t),e.prototype._apply=function(t){if(t._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new xa(t._repo,t._path,Un(t._queryParams,this._limit),t._orderByCalled)},e}(Ga);function nl(t){if("number"!==typeof t||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new el(t)}var rl=function(t){function e(e){var n=t.call(this)||this;return n._limit=e,n}return(0,s.ZT)(e,t),e.prototype._apply=function(t){if(t._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new xa(t._repo,t._path,Vn(t._queryParams,this._limit),t._orderByCalled)},e}(Ga);function il(t){if("number"!==typeof t||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new rl(t)}var ol=function(t){function e(e){var n=t.call(this)||this;return n._path=e,n}return(0,s.ZT)(e,t),e.prototype._apply=function(t){ka(t,"orderByChild");var e=new ce(this._path);if(we(e))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");var n=new kn(e),r=Kn(t._queryParams,n);return _a(r),new xa(t._repo,t._path,r,!0)},e}(Ga);function sl(t){if("$key"===t)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===t)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===t)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return ms("orderByChild","path",t,!1),new ol(t)}var al=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,s.ZT)(e,t),e.prototype._apply=function(t){ka(t,"orderByKey");var e=Kn(t._queryParams,He);return _a(e),new xa(t._repo,t._path,e,!0)},e}(Ga);function ll(){return new al}var ul=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,s.ZT)(e,t),e.prototype._apply=function(t){ka(t,"orderByPriority");var e=Kn(t._queryParams,hn);return _a(e),new xa(t._repo,t._path,e,!0)},e}(Ga);function cl(){return new ul}var hl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,s.ZT)(e,t),e.prototype._apply=function(t){ka(t,"orderByValue");var e=Kn(t._queryParams,In);return _a(e),new xa(t._repo,t._path,e,!0)},e}(Ga);function dl(){return new hl}var pl=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return(0,s.ZT)(e,t),e.prototype._apply=function(t){if(us("equalTo",this._value,t._path,!1),t._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(t._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new qa(this._value,this._key)._apply(new Ja(this._value,this._key)._apply(t))},e}(Ga);function fl(t,e){return gs("equalTo","key",e,!0),new pl(t,e)}function gl(t){for(var e,n,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var a=(0,o.m9)(t);try{for(var l=(0,s.XA)(r),u=l.next();!u.done;u=l.next()){var c=u.value;a=c._apply(a)}}catch(h){e={error:h}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(e)throw e.error}}return a}ji(Ca),ro(Ca);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var ml="FIREBASE_DATABASE_EMULATOR_HOST",yl={},bl=!1;function vl(t,e,n,r){t.repoInfo_=new ht(e+":"+n,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams),r&&(t.authTokenProvider_=r)}function wl(t,e,n,r,i){var o=r||t.options.databaseURL;void 0===o&&(t.options.projectId||T("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),I("Using default host for project ",t.options.projectId),o=t.options.projectId+"-default-rtdb.firebaseio.com");var s,a=ga(o,i),l=a.repoInfo,u=void 0;"undefined"!==typeof process&&(u={NODE_ENV:"production",BASE_URL:"/"}[ml]),u?(s=!0,o="http://"+u+"?ns="+l.namespace,a=ga(o,i),l=a.repoInfo):s=!a.repoInfo.secure;var c=i&&s?new Q(Q.OWNER):new Z(t.name,t.options,e);vs("Invalid Firebase Database URL",a),we(a.path)||T("Database URL must point to the root of a Firebase Database (not including a child path).");var h=kl(l,t,c,new J(t.name,n));return new Il(h,t)}function xl(t,e){var n=yl[e];n&&n[t.key]===t||T("Database "+e+"("+t.repoInfo_+") has already been deleted."),Xs(t),delete n[t.key]}function kl(t,e,n,r){var i=yl[e.name];i||(i={},yl[e.name]=i);var o=i[t.toURLString()];return o&&T("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new Ns(t,bl,n,r),i[t.toURLString()]=o,o}function _l(t){bl=t}var Il=function(){function t(t,e){this._repoInternal=t,this.app=e,this["type"]="database",this._instanceStarted=!1}return Object.defineProperty(t.prototype,"_repo",{get:function(){return this._instanceStarted||(As(this._repoInternal,this.app.options.appId,this.app.options["databaseAuthVariableOverride"]),this._instanceStarted=!0),this._repoInternal},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_root",{get:function(){return this._rootInternal||(this._rootInternal=new Ca(this._repo,he())),this._rootInternal},enumerable:!1,configurable:!0}),t.prototype._delete=function(){return null!==this._rootInternal&&(xl(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()},t.prototype._checkNotDeleted=function(t){null===this._rootInternal&&T("Cannot call "+t+" on a deleted database.")},t}();function Cl(t,e,n,r){void 0===r&&(r={}),t=(0,o.m9)(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&T("Cannot call useEmulator() after instance has already been initialized.");var i=t._repoInternal,s=void 0;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&T('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new Q(Q.OWNER);else if(r.mockUserToken){var a="string"===typeof r.mockUserToken?r.mockUserToken:(0,o.Sg)(r.mockUserToken,t.app.options.projectId);s=new Q(a)}vl(i,e,n,s)}function Sl(t){t=(0,o.m9)(t),t._checkNotDeleted("goOffline"),Xs(t._repo)}function Tl(t){t=(0,o.m9)(t),t._checkNotDeleted("goOnline"),Ys(t._repo)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var El={".sv":"timestamp"};function Nl(){return El}function Al(t){return{".sv":{increment:t}}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Rl=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}();function $l(t,e,n){var r;if(t=(0,o.m9)(t),bs("Reference.transaction",t._path),".length"===t.key||".keys"===t.key)throw"Reference.transaction failed: "+t.key+" is a read-only object.";var i=null===(r=null===n||void 0===n?void 0:n.applyLocally)||void 0===r||r,s=new o.BH,a=function(e,n,r){var i=null;e?s.reject(e):(i=new Sa(r,new Ca(t._repo,t._path),hn),s.resolve(new Rl(n,i)))},l=Ba(t,(function(){}));return ea(t._repo,t._path,e,a,l,i),s.promise}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Dl=function(){function t(t){this._delegate=t}return t.prototype.cancel=function(t){(0,o.Dv)("OnDisconnect.cancel",0,1,arguments.length),(0,o.Wj)("OnDisconnect.cancel","onComplete",t,!0);var e=this._delegate.cancel();return t&&e.then((function(){return t(null)}),(function(e){return t(e)})),e},t.prototype.remove=function(t){(0,o.Dv)("OnDisconnect.remove",0,1,arguments.length),(0,o.Wj)("OnDisconnect.remove","onComplete",t,!0);var e=this._delegate.remove();return t&&e.then((function(){return t(null)}),(function(e){return t(e)})),e},t.prototype.set=function(t,e){(0,o.Dv)("OnDisconnect.set",1,2,arguments.length),(0,o.Wj)("OnDisconnect.set","onComplete",e,!0);var n=this._delegate.set(t);return e&&n.then((function(){return e(null)}),(function(t){return e(t)})),n},t.prototype.setWithPriority=function(t,e,n){(0,o.Dv)("OnDisconnect.setWithPriority",2,3,arguments.length),(0,o.Wj)("OnDisconnect.setWithPriority","onComplete",n,!0);var r=this._delegate.setWithPriority(t,e);return n&&r.then((function(){return n(null)}),(function(t){return n(t)})),r},t.prototype.update=function(t,e){if((0,o.Dv)("OnDisconnect.update",1,2,arguments.length),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,E("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}(0,o.Wj)("OnDisconnect.update","onComplete",e,!0);var i=this._delegate.update(t);return e&&i.then((function(){return e(null)}),(function(t){return e(t)})),i},t}(),Ol=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return(0,o.Dv)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}(),Fl=function(){function t(t,e){this._database=t,this._delegate=e}return t.prototype.val=function(){return(0,o.Dv)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()},t.prototype.exportVal=function(){return(0,o.Dv)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()},t.prototype.toJSON=function(){return(0,o.Dv)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()},t.prototype.exists=function(){return(0,o.Dv)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()},t.prototype.child=function(e){return(0,o.Dv)("DataSnapshot.child",0,1,arguments.length),e=String(e),ms("DataSnapshot.child","path",e,!1),new t(this._database,this._delegate.child(e))},t.prototype.hasChild=function(t){return(0,o.Dv)("DataSnapshot.hasChild",1,1,arguments.length),ms("DataSnapshot.hasChild","path",t,!1),this._delegate.hasChild(t)},t.prototype.getPriority=function(){return(0,o.Dv)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority},t.prototype.forEach=function(e){var n=this;return(0,o.Dv)("DataSnapshot.forEach",1,1,arguments.length),(0,o.Wj)("DataSnapshot.forEach","action",e,!1),this._delegate.forEach((function(r){return e(new t(n._database,r))}))},t.prototype.hasChildren=function(){return(0,o.Dv)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()},Object.defineProperty(t.prototype,"key",{get:function(){return this._delegate.key},enumerable:!1,configurable:!0}),t.prototype.numChildren=function(){return(0,o.Dv)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size},t.prototype.getRef=function(){return(0,o.Dv)("DataSnapshot.ref",0,0,arguments.length),new Pl(this._database,this._delegate.ref)},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),t}(),Ml=function(){function t(t,e){this.database=t,this._delegate=e}return t.prototype.on=function(e,n,r,i){var s,a=this;(0,o.Dv)("Query.on",2,4,arguments.length),(0,o.Wj)("Query.on","callback",n,!1);var l=t.getCancelAndContextArgs_("Query.on",r,i),u=function(t,e){n.call(l.context,new Fl(a.database,t),e)};u.userCallback=n,u.context=l.context;var c=null===(s=l.cancel)||void 0===s?void 0:s.bind(l.context);switch(e){case"value":return Ba(this._delegate,u,c),n;case"child_added":return Wa(this._delegate,u,c),n;case"child_removed":return ja(this._delegate,u,c),n;case"child_changed":return Ua(this._delegate,u,c),n;case"child_moved":return Va(this._delegate,u,c),n;default:throw new Error((0,o.gK)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},t.prototype.off=function(t,e,n){if((0,o.Dv)("Query.off",0,3,arguments.length),fs("Query.off",t,!0),(0,o.Wj)("Query.off","callback",e,!0),(0,o.lb)("Query.off","context",n,!0),e){var r=function(){};r.userCallback=e,r.context=n,Ha(this._delegate,t,r)}else Ha(this._delegate,t)},t.prototype.get=function(){var t=this;return Ma(this._delegate).then((function(e){return new Fl(t.database,e)}))},t.prototype.once=function(e,n,r,i){var s=this;(0,o.Dv)("Query.once",1,4,arguments.length),(0,o.Wj)("Query.once","callback",n,!0);var a=t.getCancelAndContextArgs_("Query.once",r,i),l=new o.BH,u=function(t,e){var r=new Fl(s.database,t);n&&n.call(a.context,r,e),l.resolve(r)};u.userCallback=n,u.context=a.context;var c=function(t){a.cancel&&a.cancel.call(a.context,t),l.reject(t)};switch(e){case"value":Ba(this._delegate,u,c,{onlyOnce:!0});break;case"child_added":Wa(this._delegate,u,c,{onlyOnce:!0});break;case"child_removed":ja(this._delegate,u,c,{onlyOnce:!0});break;case"child_changed":Ua(this._delegate,u,c,{onlyOnce:!0});break;case"child_moved":Va(this._delegate,u,c,{onlyOnce:!0});break;default:throw new Error((0,o.gK)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return l.promise},t.prototype.limitToFirst=function(e){return(0,o.Dv)("Query.limitToFirst",1,1,arguments.length),new t(this.database,gl(this._delegate,nl(e)))},t.prototype.limitToLast=function(e){return(0,o.Dv)("Query.limitToLast",1,1,arguments.length),new t(this.database,gl(this._delegate,il(e)))},t.prototype.orderByChild=function(e){return(0,o.Dv)("Query.orderByChild",1,1,arguments.length),new t(this.database,gl(this._delegate,sl(e)))},t.prototype.orderByKey=function(){return(0,o.Dv)("Query.orderByKey",0,0,arguments.length),new t(this.database,gl(this._delegate,ll()))},t.prototype.orderByPriority=function(){return(0,o.Dv)("Query.orderByPriority",0,0,arguments.length),new t(this.database,gl(this._delegate,cl()))},t.prototype.orderByValue=function(){return(0,o.Dv)("Query.orderByValue",0,0,arguments.length),new t(this.database,gl(this._delegate,dl()))},t.prototype.startAt=function(e,n){return void 0===e&&(e=null),(0,o.Dv)("Query.startAt",0,2,arguments.length),new t(this.database,gl(this._delegate,Za(e,n)))},t.prototype.startAfter=function(e,n){return void 0===e&&(e=null),(0,o.Dv)("Query.startAfter",0,2,arguments.length),new t(this.database,gl(this._delegate,tl(e,n)))},t.prototype.endAt=function(e,n){return void 0===e&&(e=null),(0,o.Dv)("Query.endAt",0,2,arguments.length),new t(this.database,gl(this._delegate,Ka(e,n)))},t.prototype.endBefore=function(e,n){return void 0===e&&(e=null),(0,o.Dv)("Query.endBefore",0,2,arguments.length),new t(this.database,gl(this._delegate,Ya(e,n)))},t.prototype.equalTo=function(e,n){return(0,o.Dv)("Query.equalTo",1,2,arguments.length),new t(this.database,gl(this._delegate,fl(e,n)))},t.prototype.toString=function(){return(0,o.Dv)("Query.toString",0,0,arguments.length),this._delegate.toString()},t.prototype.toJSON=function(){return(0,o.Dv)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()},t.prototype.isEqual=function(e){if((0,o.Dv)("Query.isEqual",1,1,arguments.length),!(e instanceof t)){var n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)},t.getCancelAndContextArgs_=function(t,e,n){var r={cancel:void 0,context:void 0};if(e&&n)r.cancel=e,(0,o.Wj)(t,"cancel",r.cancel,!0),r.context=n,(0,o.lb)(t,"context",r.context,!0);else if(e)if("object"===typeof e&&null!==e)r.context=e;else{if("function"!==typeof e)throw new Error((0,o.gK)(t,"cancelOrContext")+" must either be a cancel callback or a context object.");r.cancel=e}return r},Object.defineProperty(t.prototype,"ref",{get:function(){return new Pl(this.database,new Ca(this._delegate._repo,this._delegate._path))},enumerable:!1,configurable:!0}),t}(),Pl=function(t){function e(e,n){var r=t.call(this,e,new xa(n._repo,n._path,new Bn,!1))||this;return r.database=e,r._delegate=n,r}return(0,s.ZT)(e,t),e.prototype.getKey=function(){return(0,o.Dv)("Reference.key",0,0,arguments.length),this._delegate.key},e.prototype.child=function(t){return(0,o.Dv)("Reference.child",1,1,arguments.length),"number"===typeof t&&(t=String(t)),new e(this.database,Na(this._delegate,t))},e.prototype.getParent=function(){(0,o.Dv)("Reference.parent",0,0,arguments.length);var t=this._delegate.parent;return t?new e(this.database,t):null},e.prototype.getRoot=function(){return(0,o.Dv)("Reference.root",0,0,arguments.length),new e(this.database,this._delegate.root)},e.prototype.set=function(t,e){(0,o.Dv)("Reference.set",1,2,arguments.length),(0,o.Wj)("Reference.set","onComplete",e,!0);var n=$a(this._delegate,t);return e&&n.then((function(){return e(null)}),(function(t){return e(t)})),n},e.prototype.update=function(t,e){if((0,o.Dv)("Reference.update",1,2,arguments.length),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,E("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}bs("Reference.update",this._delegate._path),(0,o.Wj)("Reference.update","onComplete",e,!0);var i=Fa(this._delegate,t);return e&&i.then((function(){return e(null)}),(function(t){return e(t)})),i},e.prototype.setWithPriority=function(t,e,n){(0,o.Dv)("Reference.setWithPriority",2,3,arguments.length),(0,o.Wj)("Reference.setWithPriority","onComplete",n,!0);var r=Oa(this._delegate,t,e);return n&&r.then((function(){return n(null)}),(function(t){return n(t)})),r},e.prototype.remove=function(t){(0,o.Dv)("Reference.remove",0,1,arguments.length),(0,o.Wj)("Reference.remove","onComplete",t,!0);var e=Ra(this._delegate);return t&&e.then((function(){return t(null)}),(function(e){return t(e)})),e},e.prototype.transaction=function(t,e,n){var r=this;(0,o.Dv)("Reference.transaction",1,3,arguments.length),(0,o.Wj)("Reference.transaction","transactionUpdate",t,!1),(0,o.Wj)("Reference.transaction","onComplete",e,!0),ws("Reference.transaction","applyLocally",n,!0);var i=$l(this._delegate,t,{applyLocally:n}).then((function(t){return new Ol(t.committed,new Fl(r.database,t.snapshot))}));return e&&i.then((function(t){return e(null,t.committed,t.snapshot)}),(function(t){return e(t,!1,null)})),i},e.prototype.setPriority=function(t,e){(0,o.Dv)("Reference.setPriority",1,2,arguments.length),(0,o.Wj)("Reference.setPriority","onComplete",e,!0);var n=Da(this._delegate,t);return e&&n.then((function(){return e(null)}),(function(t){return e(t)})),n},e.prototype.push=function(t,n){var r=this;(0,o.Dv)("Reference.push",0,2,arguments.length),(0,o.Wj)("Reference.push","onComplete",n,!0);var i=Aa(this._delegate,t),s=i.then((function(t){return new e(r.database,t)}));n&&s.then((function(){return n(null)}),(function(t){return n(t)}));var a=new e(this.database,i);return a.then=s.then.bind(s),a.catch=s.catch.bind(s,void 0),a},e.prototype.onDisconnect=function(){return bs("Reference.onDisconnect",this._delegate._path),new Dl(new wa(this._delegate._repo,this._delegate._path))},Object.defineProperty(e.prototype,"key",{get:function(){return this.getKey()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this.getParent()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this.getRoot()},enumerable:!1,configurable:!0}),e}(Ml),Ll=function(){function t(t,e){var n=this;this._delegate=t,this.app=e,this.INTERNAL={delete:function(){return n._delegate._delete()}}}return t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),Cl(this._delegate,t,e,n)},t.prototype.ref=function(t){if((0,o.Dv)("database.ref",0,1,arguments.length),t instanceof Pl){var e=Ea(this._delegate,t.toString());return new Pl(this,e)}e=Ta(this._delegate,t);return new Pl(this,e)},t.prototype.refFromURL=function(t){var e="database.refFromURL";(0,o.Dv)(e,1,1,arguments.length);var n=Ea(this._delegate,t);return new Pl(this,n)},t.prototype.goOffline=function(){return(0,o.Dv)("database.goOffline",0,0,arguments.length),Sl(this._delegate)},t.prototype.goOnline=function(){return(0,o.Dv)("database.goOnline",0,0,arguments.length),Tl(this._delegate)},t.ServerValue={TIMESTAMP:Nl(),increment:function(t){return Al(t)}},t}(),zl=function(){Ut.forceDisallow(),Pt.forceAllow()},Bl=function(){Pt.forceDisallow()},Wl=function(){return Ut["isAvailable"]()},Ul=function(t,e){var n=t._delegate._repo.persistentConnection_;n.securityDebugCallback_=e},Vl=function(t,e){Js(t._delegate._repo,e)},jl=function(t,e){Zs(t._delegate._repo,e)},Hl=function(t){return t._delegate._repo.dataUpdateCount},Gl=function(t,e){return Os(t._delegate._repo,e)};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ql(t){var e=t.app,n=t.url,r=t.version,o=t.customAuthImpl,s=t.namespace,a=t.nodeAdmin,l=void 0!==a&&a;h(r);var u=new i.zt("auth-internal",new i.H0("database-standalone"));return u.setComponent(new i.wA("auth-internal",(function(){return o}),"PRIVATE")),{instance:new Ll(wl(e,u,void 0,n,l),e),namespace:s}}var Kl=Object.freeze({__proto__:null,forceLongPolling:zl,forceWebSockets:Bl,isWebSocketsAvailable:Wl,setSecurityDebugCallback:Ul,stats:Vl,statsIncrementCounter:jl,dataUpdateCount:Hl,interceptServerData:Gl,initStandalone:ql}),Xl=We;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */We.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},We.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};var Yl=ie,Jl=function(t){var e=We.prototype.put;return We.prototype.put=function(n,r,i,o){void 0!==o&&(o=t()),e.call(this,n,r,i,o)},function(){We.prototype.put=e}},Zl=ht,Ql=function(t){return t._delegate._queryIdentifier},tu=function(t){_l(t)},eu=Object.freeze({__proto__:null,DataConnection:Xl,RealTimeConnection:Yl,hijackHash:Jl,ConnectionTarget:Zl,queryIdentifier:Ql,forceRestClient:tu}),nu=Ll.ServerValue;function ru(e){h(e.SDK_VERSION);var n=e.INTERNAL.registerComponent(new i.wA("database",(function(t,e){var n=e.instanceIdentifier,r=t.getProvider("app").getImmediate(),i=t.getProvider("auth-internal"),o=t.getProvider("app-check-internal");return new Ll(wl(r,i,o,n),r)}),"PUBLIC").setServiceProps({Reference:Pl,Query:Ml,Database:Ll,DataSnapshot:Fl,enableLogging:_,INTERNAL:Kl,ServerValue:nu,TEST_ACCESS:eu}).setMultipleInstances(!0));e.registerVersion(l,u),(0,o.Yr)()&&(t.exports=n)}ru(r.Z)},7e3:function(t,e,n){"use strict";n.d(e,{Am:function(){return p},Ub:function(){return d},Yd:function(){return h},in:function(){return o}});var r;n(560);
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var o,s=[];(function(t){t[t["DEBUG"]=0]="DEBUG",t[t["VERBOSE"]=1]="VERBOSE",t[t["INFO"]=2]="INFO",t[t["WARN"]=3]="WARN",t[t["ERROR"]=4]="ERROR",t[t["SILENT"]=5]="SILENT"})(o||(o={}));var a={debug:o.DEBUG,verbose:o.VERBOSE,info:o.INFO,warn:o.WARN,error:o.ERROR,silent:o.SILENT},l=o.INFO,u=(r={},r[o.DEBUG]="log",r[o.VERBOSE]="log",r[o.INFO]="info",r[o.WARN]="warn",r[o.ERROR]="error",r),c=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var o=(new Date).toISOString(),s=u[e];if(!s)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[s].apply(console,i(["["+o+"]  "+t.name+":"],n))}},h=function(){function t(t){this.name=t,this._logLevel=l,this._logHandler=c,this._userLogHandler=null,s.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in o))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"===typeof t?a[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!==typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,i([this,o.DEBUG],t)),this._logHandler.apply(this,i([this,o.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,i([this,o.VERBOSE],t)),this._logHandler.apply(this,i([this,o.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,i([this,o.INFO],t)),this._logHandler.apply(this,i([this,o.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,i([this,o.WARN],t)),this._logHandler.apply(this,i([this,o.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,i([this,o.ERROR],t)),this._logHandler.apply(this,i([this,o.ERROR],t))},t}();function d(t){s.forEach((function(e){e.setLogLevel(t)}))}function p(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=a[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],s=2;s<arguments.length;s++)i[s-2]=arguments[s];var a=i.map((function(t){if(null==t)return null;if("string"===typeof t)return t;if("number"===typeof t||"boolean"===typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(e){return null}})).filter((function(t){return t})).join(" ");n>=(null!==r&&void 0!==r?r:e.logLevel)&&t({level:o[n].toLowerCase(),message:a,args:i,type:e.name})}},r=0,i=s;r<i.length;r++){var l=i[r];n(l)}}},9658:function(t,e,n){"use strict";n.d(e,{BH:function(){return m},DV:function(){return F},Dv:function(){return j},GJ:function(){return D},LL:function(){return S},Pz:function(){return A},Sg:function(){return y},UG:function(){return w},UI:function(){return P},US:function(){return u},Wj:function(){return G},Yr:function(){return _},ZB:function(){return f},b$:function(){return k},cI:function(){return N},dS:function(){return K},g5:function(){return s},gK:function(){return H},gQ:function(){return z},h$:function(){return c},hu:function(){return o},jU:function(){return x},lb:function(){return q},m9:function(){return Y},ne:function(){return B},p$:function(){return p},r3:function(){return O},uI:function(){return v},ug:function(){return X},w9:function(){return $},xO:function(){return L},xb:function(){return M}});n(3429),n(560);var r=n(199),i={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},o=function(t,e){if(!t)throw s(e)},s=function(t){return new Error("Firebase Database ("+i.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)},a=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296===(64512&i)&&r+1<t.length&&56320===(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},l=function(t){var e=[],n=0,r=0;while(n<t.length){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){o=t[n++];var s=t[n++],a=t[n++],l=((7&i)<<18|(63&o)<<12|(63&s)<<6|63&a)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(1023&l))}else{o=t[n++],s=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return e.join("")},u={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],s=i+1<t.length,a=s?t[i+1]:0,l=i+2<t.length,u=l?t[i+2]:0,c=o>>2,h=(3&o)<<4|a>>4,d=(15&a)<<2|u>>6,p=63&u;l||(p=64,s||(d=64)),r.push(n[c],n[h],n[d],n[p])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(a(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):l(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],s=i<t.length,a=s?n[t.charAt(i)]:0;++i;var l=i<t.length,u=l?n[t.charAt(i)]:64;++i;var c=i<t.length,h=c?n[t.charAt(i)]:64;if(++i,null==o||null==a||null==u||null==h)throw Error();var d=o<<2|a>>4;if(r.push(d),64!==u){var p=a<<4&240|u>>2;if(r.push(p),64!==h){var f=u<<6&192|h;r.push(f)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},c=function(t){var e=a(t);return u.encodeByteArray(e,!0)},h=function(t){return c(t).replace(/\./g,"")},d=function(t){try{return u.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function p(t){return f(void 0,t)}function f(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:var n=e;return new Date(n.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var r in e)e.hasOwnProperty(r)&&g(r)&&(t[r]=f(t[r],e[r]));return t}function g(t){return"__proto__"!==t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var m=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"===typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n={alg:"none",type:"JWT"},i=e||"demo-project",o=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var a=(0,r.pi)({iss:"https://securetoken.google.com/"+i,aud:i,iat:o,exp:o+3600,auth_time:o,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t),l="";return[h(JSON.stringify(n)),h(JSON.stringify(a)),l].join(".")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b(){return"undefined"!==typeof navigator&&"string"===typeof navigator["userAgent"]?navigator["userAgent"]:""}function v(){return"undefined"!==typeof window&&!!(window["cordova"]||window["phonegap"]||window["PhoneGap"])&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(b())}function w(){try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(t){return!1}}function x(){return"object"===typeof self&&self.self===self}function k(){return"object"===typeof navigator&&"ReactNative"===navigator["product"]}function _(){return!0===i.NODE_CLIENT||!0===i.NODE_ADMIN}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var I="FirebaseError",C=function(t){function e(n,r,i){var o=t.call(this,r)||this;return o.code=n,o.customData=i,o.name=I,Object.setPrototypeOf(o,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,S.prototype.create),o}return(0,r.ZT)(e,t),e}(Error),S=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],s=o?T(o,r):"Error",a=this.serviceName+": "+s+" ("+i+").",l=new C(i,a,r);return l},t}();function T(t,e){return t.replace(E,(function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"}))}var E=/\{\$([^}]+)}/g;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N(t){return JSON.parse(t)}function A(t){return JSON.stringify(t)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var R=function(t){var e={},n={},r={},i="";try{var o=t.split(".");e=N(d(o[0])||""),n=N(d(o[1])||""),i=o[2],r=n["d"]||{},delete n["d"]}catch(s){}return{header:e,claims:n,data:r,signature:i}},$=function(t){var e=R(t),n=e.claims;return!!n&&"object"===typeof n&&n.hasOwnProperty("iat")},D=function(t){var e=R(t).claims;return"object"===typeof e&&!0===e["admin"]};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function O(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function F(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0}function M(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function P(t,e,n){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function L(t){for(var e=[],n=function(t,n){Array.isArray(n)?n.forEach((function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))})):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))},r=0,i=Object.entries(t);r<i.length;r++){var o=i[r],s=o[0],a=o[1];n(s,a)}return e.length?"&"+e.join("&"):""}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var z=function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"===typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,s,a=this.chain_[0],l=this.chain_[1],u=this.chain_[2],c=this.chain_[3],h=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(o=c^l&(u^c),s=1518500249):(o=l^u^c,s=1859775393):r<60?(o=l&u|c&(l|u),s=2400959708):(o=l^u^c,s=3395469782);i=(a<<5|a>>>27)+o+h+s+n[r]&4294967295;h=c,c=u,u=4294967295&(l<<30|l>>>2),l=a,a=i}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+l&4294967295,this.chain_[2]=this.chain_[2]+u&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;while(r<e){if(0===o)while(r<=n)this.compress_(t,r),r+=this.blockSize;if("string"===typeof t){while(r<e)if(i[o]=t.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}else while(r<e)if(i[o]=t[r],++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t},t}();function B(t,e){var n=new W(t,e);return n.subscribe.bind(n)}var W=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");r=U(t,["next","error","complete"])?t:{next:t,error:e,complete:n},void 0===r.next&&(r.next=V),void 0===r.error&&(r.error=V),void 0===r.complete&&(r.complete=V);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(r){"undefined"!==typeof console&&console.error&&console.error(r)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function U(t,e){if("object"!==typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"===typeof t[i])return!0}return!1}function V(){}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var j=function(t,e,n,r){var i;if(r<e?i="at least "+e:r>n&&(i=0===n?"none":"no more than "+n),i){var o=t+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".";throw new Error(o)}};function H(t,e){return t+" failed: "+e+" argument "}function G(t,e,n,r){if((!r||n)&&"function"!==typeof n)throw new Error(H(t,e)+"must be a valid function.")}function q(t,e,n,r){if((!r||n)&&("object"!==typeof n||null===n))throw new Error(H(t,e)+"must be a valid context object.")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var K=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);if(i>=55296&&i<=56319){var s=i-55296;r++,o(r<t.length,"Surrogate pair missing trail surrogate.");var a=t.charCodeAt(r)-56320;i=65536+(s<<10)+a}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},X=function(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Y(t){return t&&t._delegate?t._delegate:t}},6:function(t,e,n){"use strict";n.d(e,{FBF:function(){return x_},wOQ:function(){return Oh}});var r={};n.r(r),n.d(r,{assertParamsValid:function(){return qa},computeFlatOffset:function(){return sl},computeOutShape:function(){return Xa},getNormalizedAxes:function(){return Qa},isSliceContinous:function(){return ol},maskToAxes:function(){return Ka},parseSliceParams:function(){return al},sliceInfo:function(){return ll},startForAxis:function(){return rl},startIndicesWithElidedDims:function(){return tl},stopForAxis:function(){return il},stopIndicesWithElidedDims:function(){return el},stridesForAxis:function(){return nl},stridesWithElidedDims:function(){return Ya}});var i={};n.r(i),n.d(i,{collectGatherOpShapeInfo:function(){return Xf},computeOutShape:function(){return Kf},segOpComputeOptimalWindowSize:function(){return qf}});var o={};n.r(o),n.d(o,{ERF_A1:function(){return hf},ERF_A2:function(){return df},ERF_A3:function(){return pf},ERF_A4:function(){return ff},ERF_A5:function(){return gf},ERF_P:function(){return cf},PARALLELIZE_THRESHOLD:function(){return Xp},RowPartitionType:function(){return jp},SELU_SCALE:function(){return uf},SELU_SCALEALPHA:function(){return lf},applyActivation:function(){return pd},assertAndGetBroadcastShape:function(){return ba},assertAxesAreInnerMostDims:function(){return hc},assertParamsConsistent:function(){return Up},assignToTypedArray:function(){return xf},axesAreInnerMostDims:function(){return ac},calculateShapes:function(){return af},checkEinsumDimSizes:function(){return Af},checkPadOnDimRoundingMode:function(){return Fl},combineLocations:function(){return lc},combineRaggedTensorToTensorShapes:function(){return Hp},complexWithEvenIndex:function(){return bf},complexWithOddIndex:function(){return vf},computeConv2DInfo:function(){return wl},computeConv3DInfo:function(){return xl},computeDefaultPad:function(){return Il},computeDilation2DInfo:function(){return yl},computeOptimalWindowSize:function(){return Yp},computeOutAndReduceShapes:function(){return uc},computeOutShape:function(){return Vp},computePool2DInfo:function(){return bl},computePool3DInfo:function(){return vl},convertConv2DDataFormat:function(){return Ol},decodeEinsumEquation:function(){return Ef},eitherStridesOrDilationsAreOne:function(){return $l},expandShapeToKeepDim:function(){return cc},exponent:function(){return _f},exponents:function(){return kf},fromStringArrayToUint8:function(){return Jf},fromUint8ToStringArray:function(){return Yf},getAxesPermutation:function(){return dc},getBroadcastDims:function(){return ma},getComplexWithIndex:function(){return wf},getEinsumComputePath:function(){return Rf},getEinsumPermutation:function(){return Nf},getFusedBiasGradient:function(){return dd},getFusedDyActivation:function(){return hd},getImageCenter:function(){return Jp},getInnerMostAxes:function(){return fc},getPermuted:function(){return Qp},getRaggedRank:function(){return qp},getReductionAxes:function(){return ya},getReshaped:function(){return Zp},getReshapedPermuted:function(){return tf},getRowPartitionTypesHelper:function(){return Gp},getSliceBeginCoords:function(){return ef},getSliceSize:function(){return nf},getSparseFillEmptyRowsIndicesDenseShapeMismatch:function(){return Ff},getSparseFillEmptyRowsNegativeIndexErrorMessage:function(){return Mf},getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:function(){return Pf},getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:function(){return Bf},getSparseReshapeInputOutputMismatchErrorMessage:function(){return Uf},getSparseReshapeInputOutputMultipleErrorMessage:function(){return Wf},getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:function(){return Lf},getSparseReshapeNegativeOutputDimErrorMessage:function(){return zf},getSparseSegmentReductionIndicesOutOfRangeErrorMessage:function(){return Gf},getSparseSegmentReductionNegativeSegmentIdsErrorMessage:function(){return Vf},getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:function(){return jf},getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:function(){return Hf},getUndoAxesPermutation:function(){return pc},isIdentityPermutation:function(){return $f},log:function(){return Sr},mergeRealAndImagArrays:function(){return mf},prepareAndValidate:function(){return rf},prepareSplitSize:function(){return Of},segment_util:function(){return i},shouldFuse:function(){return fd},slice_util:function(){return r},splitRealAndImagArrays:function(){return yf},stridesOrDilationsArePositive:function(){return Dl},tupleValuesAreOne:function(){return Rl},upcastType:function(){return zi},validateDefaultValueShape:function(){return Kp},validateInput:function(){return sf},validateUpdateShape:function(){return of},warn:function(){return Cr}});var s={};n.r(s),n.d(s,{addImpl:function(){return yT},bincountImpl:function(){return _E},bincountReduceImpl:function(){return IE},bitwiseAndImpl:function(){return TE},castImpl:function(){return dT},ceilImpl:function(){return $E},concatImpl:function(){return zE},equalImpl:function(){return zN},expImpl:function(){return YN},expm1Impl:function(){return eA},floorImpl:function(){return kA},gatherNdImpl:function(){return $A},gatherV2Impl:function(){return FA},greaterEqualImpl:function(){return WA},greaterImpl:function(){return LA},lessEqualImpl:function(){return eR},lessImpl:function(){return ZA},linSpaceImpl:function(){return iR},logImpl:function(){return aR},maxImpl:function(){return IR},maximumImpl:function(){return TR},minimumImpl:function(){return jR},multiplyImpl:function(){return NN},negImpl:function(){return n$},notEqualImpl:function(){return f$},prodImpl:function(){return A$},raggedGatherImpl:function(){return B$},raggedRangeImpl:function(){return j$},raggedTensorToTensorImpl:function(){return J$},rangeImpl:function(){return tD},rsqrtImpl:function(){return bD},scatterImpl:function(){return xD},sigmoidImpl:function(){return rT},simpleAbsImpl:function(){return TT},sliceImpl:function(){return bE},sparseFillEmptyRowsImpl:function(){return qD},sparseReshapeImpl:function(){return YD},sparseSegmentReductionImpl:function(){return QD},sqrtImpl:function(){return lO},staticRegexReplaceImpl:function(){return gO},stridedSliceImpl:function(){return wO},stringNGramsImpl:function(){return IO},stringSplitImpl:function(){return EO},stringToHashBucketFastImpl:function(){return RO},subImpl:function(){return aA},tileImpl:function(){return BO},topKImpl:function(){return HO},transposeImpl:function(){return MT},uniqueImpl:function(){return iF}});n(560);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const a=1e-7,l=1e-4;class u{constructor(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}get(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)}set(t,e){this.dataIdsCount++,this.data.set(t,e)}has(t){return this.data.has(t)}delete(t){return this.dataIdsCount--,this.data.delete(t)}numDataIds(){return this.dataIdsCount}}class c{refCount(t){return h("refCount")}incRef(t){return h("incRef")}timerAvailable(){return!0}time(t){return h("time")}read(t){return h("read")}readSync(t){return h("readSync")}readToGPU(t,e){return h("readToGPU")}numDataIds(){return h("numDataIds")}disposeData(t,e){return h("disposeData")}write(t,e,n){return h("write")}move(t,e,n,r,i){return h("move")}createTensorFromGPUData(t,e,n){return h("createTensorFromGPUData")}memory(){return h("memory")}floatPrecision(){return h("floatPrecision")}epsilon(){return 32===this.floatPrecision()?a:l}dispose(){return h("dispose")}}function h(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}n(5847),n(4224),n(1121),n(7133);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function d(t){let e=t.length,n=0;while(e>0)n=Math.random()*e|0,e--,g(t,e,n)}function p(t,e,n){return Math.max(t,Math.min(e,n))}function f(t){return t%2===0?t:t+1}function g(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function m(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function y(t,e){if(!t)throw new Error("string"===typeof e?e:e())}function b(t,e,n=""){y(x(t,e),(()=>n+` Shapes ${t} and ${e} must match`))}function v(t){y(null!=t,(()=>"The input to the tensor constructor must be a non-null value."))}function w(t){if(0===t.length)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function x(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function k(t){return t%1===0}function _(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function I(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function C(t,e=(t=>0),n,r){return new Promise(((i,o)=>{let s=0;const a=()=>{if(t())return void i();s++;const l=e(s);null!=n&&s>=n?o():null!=r?r(a,l):setTimeout(a,l)};a()}))}function S(t,e){let n=1,r=-1;for(let o=0;o<t.length;++o)if(t[o]>=0)n*=t[o];else if(-1===t[o]){if(-1!==r)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${o}`);r=o}else if(t[o]<0)throw Error(`Shapes can not be < 0. Found ${t[o]} at dim ${o}`);if(-1===r){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(0===n)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const i=t.slice();return i[r]=e/n,i}function T(t,e){const n=e.length;return t=null==t?e.map(((t,e)=>e)):[].concat(t),y(t.every((t=>t>=-n&&t<n)),(()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`)),y(t.every((t=>k(t))),(()=>`All values in axis param must be integers but got axis ${t}`)),t.map((t=>t<0?n+t:t))}function E(t,e){const n=[],r=[],i=null!=e&&Array.isArray(e)&&0===e.length,o=null==e||i?null:T(e,t).sort();let s=0;for(let a=0;a<t.length;++a){if(null!=o){if(o[s]===a&&1!==t[a])throw new Error(`Can't squeeze axis ${a} since its dim '${t[a]}' is not 1`);(null==o[s]||o[s]>a)&&1===t[a]&&(n.push(t[a]),r.push(a)),o[s]<=a&&s++}1!==t[a]&&(n.push(t[a]),r.push(a))}return{newShape:n,keptDims:r}}function N(t,e){return A(t,e)}function A(t,e){let n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else if("bool"===t)n=new Uint8Array(e);else{if("string"!==t)throw new Error(`Unknown data type ${t}`);n=new Array(e)}return n}function R(t,e){for(let n=0;n<t.length;n++){const r=t[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${e} being uploaded contains ${r}.`)}}function $(t){return"bool"===t||"complex64"===t||"float32"===t||"int32"===t||"string"===t}function D(t,e){return"complex64"!==e&&(("float32"!==e||"complex64"===t)&&(("int32"!==e||"float32"===t||"complex64"===t)&&("bool"!==e||"bool"!==t)))}function O(t){if("float32"===t||"int32"===t)return 4;if("complex64"===t)return 8;if("bool"===t)return 1;throw new Error(`Unknown dtype ${t}`)}function F(t){if(null==t)return 0;let e=0;return t.forEach((t=>e+=t.length)),e}function M(t){return"string"===typeof t||t instanceof String}function P(t){return"boolean"===typeof t}function L(t){return"number"===typeof t}function z(t){return Array.isArray(t)?z(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":L(t)?"float32":M(t)?"string":P(t)?"bool":"float32"}function B(t){return!!(t&&t.constructor&&t.call&&t.apply)}function W(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function U(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function V(t,e,n,r=!1){const i=new Array;if(1===e.length){const o=e[0]*(r?2:1);for(let e=0;e<o;e++)i[e]=n[t+e]}else{const o=e[0],s=e.slice(1),a=s.reduce(((t,e)=>t*e))*(r?2:1);for(let e=0;e<o;e++)i[e]=V(t+e*a,s,n,r)}return i}function j(t,e,n=!1){if(0===t.length)return e[0];const r=t.reduce(((t,e)=>t*e))*(n?2:1);if(0===r)return[];if(r!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return V(0,t,e,n)}function H(t,e){if(Array.isArray(t))return t;if("float32"===e)return t instanceof Float32Array?t:new Float32Array(t);if("int32"===e)return t instanceof Int32Array?t:new Int32Array(t);if("bool"===e||"string"===e)return Uint8Array.from(new Int32Array(t));throw new Error(`Unknown dtype ${e}`)}function G(t,e){const n=q(t,e);for(let r=0;r<n.length;r++)n[r]=1;return n}function q(t,e){if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e)return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function K(t,e){const n=t.reduce(((t,e)=>t*e),1);if(null==e||"float32"===e)return j(t,new Float32Array(n));if("int32"===e)return j(t,new Int32Array(n));if("bool"===e)return j(t,new Uint8Array(n));throw new Error(`Unknown data type ${e}`)}function X(t){t.forEach((e=>{y(Number.isInteger(e)&&e>=0,(()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`))}))}function Y(t,e,n){if(0===e)return 0;if(1===e)return t[0];let r=t[t.length-1];for(let i=0;i<t.length-1;++i)r+=n[i]*t[i];return r}function J(t,e,n){if(0===e)return[];if(1===e)return[t];const r=new Array(e);for(let i=0;i<r.length-1;++i)r[i]=Math.floor(t/n[i]),t-=r[i]*n[i];return r[r.length-1]=t,r}function Z(t){return t&&t.then&&"function"===typeof t.then}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const Q="tfjsflags";class tt{constructor(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=et,this.populateURLFlags()}setPlatform(t,e){null!=this.platform&&(it().getBool("IS_TEST")||it().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${t}.`)),this.platformName=t,this.platform=e}registerFlag(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},null!=this.urlFlags[t]){const e=this.urlFlags[t];it().getBool("IS_TEST")||it().getBool("PROD")||console.warn(`Setting feature override from URL ${t}: ${e}.`),this.set(t,e)}}async getAsync(t){return t in this.flags||(this.flags[t]=await this.evaluateFlag(t)),this.flags[t]}get(t){if(t in this.flags)return this.flags[t];const e=this.evaluateFlag(t);if(Z(e))throw new Error(`Flag ${t} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[t]=e,this.flags[t]}getNumber(t){return this.get(t)}getBool(t){return this.get(t)}getString(t){return this.get(t)}getFlags(){return this.flags}get features(){return this.flags}set(t,e){if(null==this.flagRegistry[t])throw new Error(`Cannot set flag ${t} as it has not been registered.`);this.flags[t]=e,null!=this.flagRegistry[t].setHook&&this.flagRegistry[t].setHook(e)}evaluateFlag(t){if(null==this.flagRegistry[t])throw new Error(`Cannot evaluate flag '${t}': no evaluation function found.`);return this.flagRegistry[t].evaluationFn()}setFlags(t){this.flags=Object.assign({},t)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if("undefined"===typeof this.global||"undefined"===typeof this.global.location||"undefined"===typeof this.global.location.search)return;const t=this.getQueryParams(this.global.location.search);if(Q in t){const e=t[Q].split(",");e.forEach((t=>{const[e,n]=t.split(":");this.urlFlags[e]=rt(e,n)}))}}}function et(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,((t,...n)=>(nt(e,n[0],n[1]),n.join("=")))),e}function nt(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function rt(t,e){const n=e.toLowerCase();return"true"===n||"false"===n?"true"===n:""+ +n===n?+n:e}function it(){return st}let ot,st=null;function at(t){st=t}function lt(){if(null==ot){let t;if("undefined"!==typeof window)t=window;else if("undefined"!==typeof n.g)t=n.g;else if("undefined"!==typeof process)t=process;else{if("undefined"===typeof self)throw new Error("Could not find a global object");t=self}ot=t}return ot}function ut(){const t=lt();return null==t._tfGlobals&&(t._tfGlobals=new Map),t._tfGlobals}function ct(t,e){const n=ut();if(n.has(t))return n.get(t);{const r=e();return n.set(t,r),n.get(t)}}const ht="Abs",dt="Acos",pt="Acosh",ft="Add",gt="AddN",mt="All",yt="Any",bt="ArgMax",vt="ArgMin",wt="Asin",xt="Asinh",kt="Atan",_t="Atanh",It="Atan2",Ct="AvgPool",St="AvgPoolGrad",Tt="AvgPool3D",Et="AvgPool3DGrad",Nt="BatchMatMul",At="BatchToSpaceND",Rt="Bincount",$t="BitwiseAnd",Dt="BroadcastTo",Ot="BroadcastArgs",Ft="Cast",Mt="Ceil",Pt="ClipByValue",Lt="Complex",zt="ComplexAbs",Bt="Concat",Wt="Conv2D",Ut="Conv2DBackpropFilter",Vt="Conv2DBackpropInput",jt="Conv3D",Ht="Conv3DBackpropFilterV2",Gt="Conv3DBackpropInputV2",qt="Cos",Kt="Cosh",Xt="Cumprod",Yt="Cumsum",Jt="CropAndResize",Zt="DenseBincount",Qt="DepthToSpace",te="DepthwiseConv2dNative",ee="DepthwiseConv2dNativeBackpropFilter",ne="DepthwiseConv2dNativeBackpropInput",re="Diag",ie="Dilation2D",oe="Dilation2DBackpropInput",se="Dilation2DBackpropFilter",ae="Draw",le="RealDiv",ue="Einsum",ce="Elu",he="EluGrad",de="Erf",pe="Equal",fe="Exp",ge="ExpandDims",me="Expm1",ye="FFT",be="Fill",ve="FlipLeftRight",we="Floor",xe="FloorDiv",ke="FusedBatchNorm",_e="GatherV2",Ie="GatherNd",Ce="Greater",Se="GreaterEqual",Te="Identity",Ee="IFFT",Ne="Imag",Ae="IsFinite",Re="IsInf",$e="IsNan",De="LeakyRelu",Oe="Less",Fe="LessEqual",Me="LinSpace",Pe="Log",Le="Log1p",ze="LogicalAnd",Be="LogicalNot",We="LogicalOr",Ue="LogSoftmax",Ve="LRN",je="LRNGrad",He="Max",Ge="Maximum",qe="MaxPool",Ke="MaxPoolGrad",Xe="MaxPool3D",Ye="MaxPool3DGrad",Je="MaxPoolWithArgmax",Ze="Mean",Qe="Min",tn="Minimum",en="MirrorPad",nn="Mod",rn="Multinomial",on="Multiply",sn="Neg",an="NotEqual",ln="NonMaxSuppressionV3",un="NonMaxSuppressionV4",cn="NonMaxSuppressionV5",hn="OnesLike",dn="OneHot",pn="Pack",fn="PadV2",gn="Pow",mn="Prelu",yn="Prod",bn="RaggedGather",vn="RaggedRange",wn="RaggedTensorToTensor",xn="Range",kn="Real",_n="Reciprocal",In="Relu",Cn="Reshape",Sn="ResizeNearestNeighbor",Tn="ResizeNearestNeighborGrad",En="ResizeBilinear",Nn="ResizeBilinearGrad",An="Relu6",Rn="Reverse",$n="Round",Dn="Rsqrt",On="ScatterNd",Fn="TensorScatterUpdate",Mn="SearchSorted",Pn="Select",Ln="Selu",zn="Slice",Bn="Sin",Wn="Sinh",Un="Sign",Vn="Sigmoid",jn="Softplus",Hn="Sqrt",Gn="Sum",qn="SpaceToBatchND",Kn="SplitV",Xn="Softmax",Yn="SparseFillEmptyRows",Jn="SparseReshape",Zn="SparseSegmentMean",Qn="SparseSegmentSum",tr="SparseToDense",er="SquaredDifference",nr="Square",rr="StaticRegexReplace",ir="StridedSlice",or="StringNGrams",sr="StringSplit",ar="StringToHashBucketFast",lr="Sub",ur="Tan",cr="Tanh",hr="Tile",dr="TopK",pr="Transform",fr="Transpose",gr="Unique",mr="Unpack",yr="UnsortedSegmentSum",br="ZerosLike",vr="Step",wr="FromPixels",xr="RotateWithOffset",kr="_FusedMatMul",_r="FusedConv2D",Ir="FusedDepthwiseConv2D";
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Cr(...t){it().getBool("IS_TEST")||it().getBool("PROD")||console.warn(...t)}function Sr(...t){it().getBool("IS_TEST")||it().getBool("PROD")||console.log(...t)}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const Tr=ct("kernelRegistry",(()=>new Map)),Er=ct("gradRegistry",(()=>new Map));function Nr(t,e){const n=Or(t,e);return Tr.get(n)}function Ar(t){return Er.get(t)}function Rr(t){const e=Tr.entries(),n=[];while(1){const{done:r,value:i}=e.next();if(r)break;const[o,s]=i,[a]=o.split("_");a===t&&n.push(s)}return n}function $r(t){const{kernelName:e,backendName:n}=t,r=Or(e,n);Tr.has(r)&&Cr(`The kernel '${e}' for backend '${n}' is already registered`),Tr.set(r,t)}function Dr(t){const{kernelName:e}=t;Er.has(e)&&it().getBool("DEBUG")&&Cr(`Overriding the gradient for '${e}'`),Er.set(e,t)}function Or(t,e){return`${e}_${t}`}
/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Fr(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}var Mr=n(9438),Pr=n.n(Mr);
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const Lr=Pr()||Mr;function zr(t){return Lr.fromString(t,!0,16)}const Br=zr("c3a5c85c97cb3127"),Wr=zr("b492b66fbe98f273"),Ur=zr("9ae16a3b2f90404f");function Vr(t){return t.xor(t.shru(47))}function jr(t,e,n){const r=t.slice(e,e+n);return Lr.fromBytes(Array.from(r),!0,!0)}function Hr(t,e){return jr(t,e,8)}function Gr(t,e){return jr(t,e,4)}function qr(t,e){return 0===e?t:t.shru(e).or(t.shl(64-e))}function Kr(t,e,n=zr("9ddfea08eb382d69")){let r=t.xor(e).mul(n);r=r.xor(r.shru(47));let i=e.xor(r).mul(n);return i=i.xor(i.shru(47)),i=i.mul(n),i}function Xr(t,e,n,r,i,o){i=i.add(t),o=qr(o.add(i).add(r),21);const s=i;return i=i.add(e),i=i.add(n),o=o.add(qr(i,44)),[i.add(r),o.add(s)]}function Yr(t,e,n,r){return Xr(Hr(t,e),Hr(t,e+8),Hr(t,e+16),Hr(t,e+24),n,r)}function Jr(t,e=t.length){if(e>=8){const n=Ur.add(2*e),r=Hr(t,0).add(Ur),i=Hr(t,e-8),o=qr(i,37).mul(n).add(r),s=qr(r,25).add(i).mul(n);return Kr(o,s,n)}if(e>=4){const n=Ur.add(2*e),r=Gr(t,0);return Kr(r.shl(3).add(e),Gr(t,e-4),n)}if(e>0){const n=t[0],r=t[e>>1],i=t[e-1],o=n+(r<<8),s=e+(i<<2);return Vr(Ur.mul(o).xor(Br.mul(s))).mul(Ur)}return Ur}function Zr(t,e=t.length){const n=Ur.add(2*e),r=Hr(t,0).mul(Wr),i=Hr(t,8),o=Hr(t,e-8).mul(n),s=Hr(t,e-16).mul(Ur);return Kr(qr(r.add(i),43).add(qr(o,30)).add(s),r.add(qr(i.add(Ur),18)).add(o),n)}function Qr(t,e=t.length){const n=Ur.add(2*e),r=Hr(t,0).mul(Ur),i=Hr(t,8),o=Hr(t,e-8).mul(n),s=Hr(t,e-16).mul(Ur),a=qr(r.add(i),43).add(qr(o,30)).add(s),l=Kr(a,r.add(qr(i.add(Ur),18)).add(o),n),u=Hr(t,16).mul(n),c=Hr(t,24),h=a.add(Hr(t,e-32)).mul(n),d=l.add(Hr(t,e-24)).mul(n);return Kr(qr(u.add(c),43).add(qr(h,30)).add(d),u.add(qr(c.add(r),18)).add(h),n)}function ti(t,e=t.length){const n=Lr.fromNumber(81,!0);if(e<=32)return e<=16?Jr(t,e):Zr(t,e);if(e<=64)return Qr(t,e);let r=n,i=n.mul(Wr).add(113),o=Vr(i.mul(Ur).add(113)).mul(Ur),s=[Lr.UZERO,Lr.UZERO],a=[Lr.UZERO,Lr.UZERO];r=r.mul(Ur).add(Hr(t,0));let l=0;const u=64*(e-1>>6),c=u+(e-1&63)-63;do{r=qr(r.add(i).add(s[0]).add(Hr(t,l+8)),37).mul(Wr),i=qr(i.add(s[1]).add(Hr(t,l+48)),42).mul(Wr),r=r.xor(a[1]),i=i.add(s[0]).add(Hr(t,l+40)),o=qr(o.add(a[0]),33).mul(Wr),s=Yr(t,l,s[1].mul(Wr),r.add(a[0])),a=Yr(t,l+32,o.add(a[1]),i.add(Hr(t,l+16))),[o,r]=[r,o],l+=64}while(l!==u);const h=Wr.add(o.and(255).shl(1));return l=c,a[0]=a[0].add(e-1&63),s[0]=s[0].add(a[0]),a[0]=a[0].add(s[0]),r=qr(r.add(i).add(s[0]).add(Hr(t,l+8)),37).mul(h),i=qr(i.add(s[1]).add(Hr(t,l+48)),42).mul(h),r=r.xor(a[1].mul(9)),i=i.add(s[0].mul(9).add(Hr(t,l+40))),o=qr(o.add(a[0]),33).mul(h),s=Yr(t,l,s[1].mul(h),r.add(a[0])),a=Yr(t,l+32,o.add(a[1]),i.add(Hr(t,l+16))),[o,r]=[r,o],Kr(Kr(s[0],a[0],h).add(Vr(i).mul(Br)).add(o),Kr(s[1],a[1],h).add(r),h)}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function ei(t,e){return"string"===e?oi(t):ri([t],e)}function ni(t,e){return t instanceof Float32Array&&"float32"===e||t instanceof Int32Array&&"int32"===e||t instanceof Uint8Array&&"bool"===e}function ri(t,e){if("string"===e)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=li(t)),it().getBool("DEBUG")&&R(t,e),ni(t,e))return t;if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e){const e=new Uint8Array(t.length);for(let n=0;n<e.length;++n)0!==Math.round(t[n])&&(e[n]=1);return e}throw new Error(`Unknown data type ${e}`)}function ii(){return it().platform.now()}function oi(t,e="utf-8"){return e=e||"utf-8",it().platform.encode(t,e)}function si(t,e="utf-8"){return e=e||"utf-8",it().platform.decode(t,e)}function ai(t){return null!=it().platform.isTypedArray?it().platform.isTypedArray(t):Fr(t)}function li(t,e=[],n=!1){if(null==e&&(e=[]),"boolean"===typeof t||"number"===typeof t||"string"===typeof t||Z(t)||null==t||ai(t)&&n)e.push(t);else if(Array.isArray(t)||ai(t))for(let r=0;r<t.length;++r)li(t[r],e,n);else{let r=-1;for(const e of Object.keys(t))/^([1-9]+[0-9]*|0)$/.test(e)&&(r=Math.max(r,Number(e)));for(let i=0;i<=r;i++)li(t[i],e,n)}return e}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class ui{constructor(t,e){this.backendTimer=t,this.logger=e,null==e&&(this.logger=new hi)}profileKernel(t,e,n){let r;const i=()=>{r=n()};let o;const s=ii();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(i);else{i();for(const t of r)t.dataSync();o=Promise.resolve({kernelMs:ii()-s})}if(it().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let l=0;l<r.length;l++){const e=r[l];e.data().then((n=>{ci(n,e.dtype,t)}))}const a={kernelName:t,outputs:r,inputs:e,timeMs:o.then((t=>t.kernelMs)),extraInfo:o.then((t=>null!=t.getExtraProfileInfo?t.getExtraProfileInfo():""))};return a}logKernelProfile(t){const{kernelName:e,outputs:n,timeMs:r,inputs:i,extraInfo:o}=t;n.forEach((t=>{Promise.all([t.data(),r,o]).then((n=>{this.logger.logKernelProfile(e,t,n[0],n[1],i,n[2])}))}))}}function ci(t,e,n){if("float32"!==e)return!1;for(let r=0;r<t.length;r++){const e=t[r];if(isNaN(e)||!isFinite(e))return console.warn(`Found ${e} in the result of '${n}'`),!0}return!1}class hi{logKernelProfile(t,e,n,r,i,o){const s="number"===typeof r?I(`${r}ms`,9):r["error"],a=I(t,25),l=e.rank,u=e.size,c=I(e.shape.toString(),14);let h="";for(const d in i){const t=i[d];if(null!=t){const n=t.shape||e.shape,r=n.length;h+=`${d}: ${r}D ${r>0?n:""} `}}console.log(`%c${a}\t%c${s}\t%c${l}D ${c}\t%c${u}\t%c${h}\t%c${o}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function di(t,e,n){const r={},i={};for(let l=0;l<e.length;l++)r[e[l].id]=!0;for(let l=0;l<t.length;l++){const n=t[l],o=n.inputs;for(const t in o){const s=o[t];let a=!1;for(let t=0;t<e.length;t++)if(r[s.id]){n.outputs.forEach((t=>r[t.id]=!0)),a=!0,i[n.id]=!0;break}if(a)break}}const o={};o[n.id]=!0;const s={};for(let l=t.length-1;l>=0;l--){const e=t[l],n=e.inputs;for(let t=0;t<e.outputs.length;t++)if(o[e.outputs[t].id]){for(const t in n)o[n[t].id]=!0,s[e.id]=!0;break}}const a=[];for(let l=0;l<t.length;l++){const e=t[l];if(i[e.id]&&s[e.id]){const t={};for(const i in e.inputs){const n=e.inputs[i];r[n.id]&&(t[i]=n)}const n=Object.assign({},e);n.inputs=t,n.outputs=e.outputs,a.push(n)}}return a}function pi(t,e,n,r){for(let i=e.length-1;i>=0;i--){const o=e[i],s=[];if(o.outputs.forEach((e=>{const n=t[e.id];null!=n?s.push(n):s.push(null)})),null==o.gradient)throw new Error(`Cannot compute gradient: gradient function not found for ${o.kernelName}.`);const a=o.gradient(s);for(const e in o.inputs){if(!(e in a))throw new Error(`Cannot backprop through input ${e}. Available gradients found: ${Object.keys(a)}.`);const i=n((()=>a[e]()));if("float32"!==i.dtype)throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input ${e} must have 'float32' dtype, but has '${i.dtype}'`);const s=o.inputs[e];if(!x(i.shape,s.shape))throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input '${e}' has shape '${i.shape}', which does not match the shape of the input '${s.shape}'`);if(null==t[s.id])t[s.id]=i;else{const e=t[s.id];t[s.id]=r(e,i),e.dispose()}}}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const fi=20,gi=3,mi=7;function yi(t,e,n,r){const i=U(e),o=bi(t,e,n,i),s=e.length,a=xi(t,e,n,i,o),l=["Tensor"];return r&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${s}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(a.map((t=>"    "+t)).join("\n")),l.join("\n")}function bi(t,e,n,r){const i=w(e),o=r[r.length-1],s=new Array(o).fill(0),a=e.length,l="complex64"===n?ki(t):t;if(a>1)for(let u=0;u<i/o;u++){const t=u*o;for(let e=0;e<o;e++)s[e]=Math.max(s[e],vi(l[t+e],0,n).length)}return s}function vi(t,e,n){let r;return r=Array.isArray(t)?`${parseFloat(t[0].toFixed(mi))} + ${parseFloat(t[1].toFixed(mi))}j`:M(t)?`'${t}'`:"bool"===n?wi(t):parseFloat(t.toFixed(mi)).toString(),I(r,e)}function wi(t){return 0===t?"false":"true"}function xi(t,e,n,r,i,o=!0){const s="complex64"===n?2:1,a=e[0],l=e.length;if(0===l){if("complex64"===n){const e=ki(t);return[vi(e[0],0,n)]}return"bool"===n?[wi(t[0])]:[t[0].toString()]}if(1===l){if(a>fi){const e=gi*s;let r=Array.from(t.slice(0,e)),o=Array.from(t.slice((a-gi)*s,a*s));return"complex64"===n&&(r=ki(r),o=ki(o)),["["+r.map(((t,e)=>vi(t,i[e],n))).join(", ")+", ..., "+o.map(((t,e)=>vi(t,i[a-gi+e],n))).join(", ")+"]"]}const e="complex64"===n?ki(t):Array.from(t);return["["+e.map(((t,e)=>vi(t,i[e],n))).join(", ")+"]"]}const u=e.slice(1),c=r.slice(1),h=r[0]*s,d=[];if(a>fi){for(let e=0;e<gi;e++){const r=e*h,o=r+h;d.push(...xi(t.slice(r,o),u,n,c,i,!1))}d.push("...");for(let e=a-gi;e<a;e++){const r=e*h,o=r+h;d.push(...xi(t.slice(r,o),u,n,c,i,e===a-1))}}else for(let g=0;g<a;g++){const e=g*h,r=e+h;d.push(...xi(t.slice(e,r),u,n,c,i,g===a-1))}const p=2===l?",":"";d[0]="["+(a>0?d[0]+p:"");for(let g=1;g<d.length-1;g++)d[g]=" "+d[g]+p;let f=",\n";for(let g=2;g<l;g++)f+="\n";return d[d.length-1]=" "+d[d.length-1]+"]"+(o?"":f),d}function ki(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class _i{constructor(t,e,n){if(this.dtype=e,this.shape=t.slice(),this.size=w(t),null!=n){const t=n.length;y(t===this.size,(()=>`Length of values '${t}' does not match the size inferred by the shape '${this.size}'.`))}if("complex64"===e)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||A(e,this.size),this.strides=U(t)}set(t,...e){0===e.length&&(e=[0]),y(e.length===this.rank,(()=>`The number of provided coordinates (${e.length}) must match the rank (${this.rank})`));const n=this.locToIndex(e);this.values[n]=t}get(...t){0===t.length&&(t=[0]);let e=0;for(const r of t){if(r<0||r>=this.shape[e]){const e=`Requested out of range element at ${t}.   Buffer shape=${this.shape}`;throw new Error(e)}e++}let n=t[t.length-1];for(let r=0;r<t.length-1;++r)n+=this.strides[r]*t[r];return this.values[n]}locToIndex(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];let e=t[t.length-1];for(let n=0;n<t.length-1;++n)e+=this.strides[n]*t[n];return e}indexToLoc(t){if(0===this.rank)return[];if(1===this.rank)return[t];const e=new Array(this.shape.length);for(let n=0;n<e.length-1;++n)e[n]=Math.floor(t/this.strides[n]),t-=e[n]*this.strides[n];return e[e.length-1]=t,e}get rank(){return this.shape.length}toTensor(){return Ii().makeTensor(this.values,this.shape,this.dtype)}}let Ii=null,Ci=null,Si=null;function Ti(t){Ii=t}function Ei(t){Ci=t}function Ni(t){Si=t}class Ai{constructor(t,e,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=w(t),this.strides=U(t),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const t=await this.data();return Ci.buffer(this.shape,this.dtype,t)}bufferSync(){return Ci.buffer(this.shape,this.dtype,this.dataSync())}async array(){const t=await this.data();return j(this.shape,t,"complex64"===this.dtype)}arraySync(){return j(this.shape,this.dataSync(),"complex64"===this.dtype)}async data(){this.throwIfDisposed();const t=Ii().read(this.dataId);if("string"===this.dtype){const n=await t;try{return n.map((t=>si(t)))}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return t}dataToGPU(t){return this.throwIfDisposed(),Ii().readToGPU(this.dataId,t)}dataSync(){this.throwIfDisposed();const t=Ii().readSync(this.dataId);if("string"===this.dtype)try{return t.map((t=>si(t)))}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}async bytes(){this.throwIfDisposed();const t=await Ii().read(this.dataId);return"string"===this.dtype?t:new Uint8Array(t.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Ii().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(t=!1){return Ci.print(this,t)}clone(){return this.throwIfDisposed(),Ci.clone(this)}toString(t=!1){const e=this.dataSync();return yi(e,this.shape,this.dtype,t)}cast(t){return this.throwIfDisposed(),Ci.cast(this,t)}variable(t=!0,e,n){return this.throwIfDisposed(),Ii().makeVariable(this,t,e,n)}}function Ri(){return ct("Tensor",(()=>Ai))}Object.defineProperty(Ai,Symbol.hasInstance,{value:t=>!!t&&null!=t.data&&null!=t.dataSync&&null!=t.throwIfDisposed}),Ri();class $i extends Ai{constructor(t,e,n,r){super(t.shape,t.dtype,t.dataId,r),this.trainable=e,this.name=n}assign(t){if(t.dtype!==this.dtype)throw new Error(`dtype of the new value (${t.dtype}) and previous value (${this.dtype}) must match`);if(!x(t.shape,this.shape))throw new Error(`shape of the new value (${t.shape}) and previous value (${this.shape}) must match`);Ii().disposeTensor(this),this.dataId=t.dataId,Ii().incRef(this,null)}dispose(){Ii().disposeVariable(this),this.isDisposedInternal=!0}}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
var Di,Oi,Fi,Mi,Pi;Object.defineProperty($i,Symbol.hasInstance,{value:t=>t instanceof Ai&&null!=t.assign&&t.assign instanceof Function}),function(t){t["R0"]="R0",t["R1"]="R1",t["R2"]="R2",t["R3"]="R3",t["R4"]="R4",t["R5"]="R5",t["R6"]="R6"}(Di||(Di={})),function(t){t["float32"]="float32",t["int32"]="int32",t["bool"]="int32",t["complex64"]="complex64"}(Oi||(Oi={})),function(t){t["float32"]="float32",t["int32"]="int32",t["bool"]="bool",t["complex64"]="complex64"}(Fi||(Fi={})),function(t){t["float32"]="float32",t["int32"]="float32",t["bool"]="float32",t["complex64"]="complex64"}(Mi||(Mi={})),function(t){t["float32"]="complex64",t["int32"]="complex64",t["bool"]="complex64",t["complex64"]="complex64"}(Pi||(Pi={}));const Li={float32:Mi,int32:Oi,bool:Fi,complex64:Pi};function zi(t,e){if("string"===t||"string"===e){if("string"===t&&"string"===e)return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return Li[t][e]}function Bi(t){return zi(t,"int32")}function Wi(t){return null!=t&&"object"===typeof t&&"texture"in t&&t.texture instanceof WebGLTexture}function Ui(t){return"undefined"!==typeof GPUBuffer&&null!=t&&"object"===typeof t&&"buffer"in t&&t.buffer instanceof GPUBuffer}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Vi(t,e){if(t.dtype===e.dtype)return[t,e];const n=zi(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function ji(t,e){return e.some((e=>e.id===t.id))}function Hi(t){const e=[],n=new Set;return Gi(t,e,n),e}function Gi(t,e,n){if(null==t)return;if(t instanceof Ai)return void e.push(t);if(!qi(t))return;const r=t;for(const i in r){const t=r[i];n.has(t)||(n.add(t),Gi(t,e,n))}}function qi(t){return Array.isArray(t)||"object"===typeof t}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Ki(t){return null!=t.kernelName}class Xi{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map((t=>t.name))))}}}dispose(){for(const t in this.registeredVariables)this.registeredVariables[t].dispose()}}class Yi{constructor(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Xi}async ready(){if(null!=this.pendingBackendInit)return this.pendingBackendInit.then((()=>{}));if(null!=this.backendInstance)return;const t=this.getSortedBackends();for(let e=0;e<t.length;e++){const n=t[e],r=await this.initializeBackend(n).success;if(r)return void await this.setBackend(n)}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(null!=this.pendingBackendInit)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(null==this.backendInstance){const{name:t,asyncInit:e}=this.initializeBackendsAndReturnBest();if(e)throw new Error(`The highest priority backend '${t}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(t)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(t){if(!(t in this.registry)){if(!(t in this.registryFactory))return null;{const{asyncInit:e}=this.initializeBackend(t);if(e)return null}}return this.registry[t]}findBackendFactory(t){return t in this.registryFactory?this.registryFactory[t].factory:null}registerBackend(t,e,n=1){return t in this.registryFactory?(Cr(`${t} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[t]={factory:e,priority:n},!0)}async setBackend(t){if(null==this.registryFactory[t])throw new Error(`Backend name '${t}' not found in registry`);if(this.backendName=t,null==this.registry[t]){this.backendInstance=null;const{success:e,asyncInit:n}=this.initializeBackend(t),r=n?await e:e;if(!r)return!1}return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new ui(this.backendInstance),!0}setupRegisteredKernels(){const t=Rr(this.backendName);t.forEach((t=>{null!=t.setupFunc&&t.setupFunc(this.backendInstance)}))}disposeRegisteredKernels(t){const e=Rr(t);e.forEach((e=>{null!=e.disposeFunc&&e.disposeFunc(this.registry[t])}))}initializeBackend(t){const e=this.registryFactory[t];if(null==e)throw new Error(`Cannot initialize backend ${t}, no registration found.`);try{const n=e.factory();if(!n||n instanceof c||"function"!==typeof n.then)return this.registry[t]=n,{success:!0,asyncInit:!1};{const e=++this.pendingBackendInitId,r=n.then((n=>!(e<this.pendingBackendInitId)&&(this.registry[t]=n,this.pendingBackendInit=null,!0))).catch((n=>(e<this.pendingBackendInitId||(this.pendingBackendInit=null,Cr(`Initialization of backend ${t} failed`),Cr(n.stack||n.message)),!1)));return this.pendingBackendInit=r,{success:r,asyncInit:!0}}}catch(n){return Cr(`Initialization of backend ${t} failed`),Cr(n.stack||n.message),{success:!1,asyncInit:!1}}}removeBackend(t){if(!(t in this.registryFactory))throw new Error(`${t} backend not found in registry`);this.backendName===t&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(((t,e)=>this.registryFactory[e].priority-this.registryFactory[t].priority))}initializeBackendsAndReturnBest(){const t=this.getSortedBackends();for(let e=0;e<t.length;e++){const n=t[e],{success:r,asyncInit:i}=this.initializeBackend(n);if(i||r)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(t,e){const n=this.state.tensorInfo.get(e),r=n.backend,i=this.readSync(e),o=r.refCount(e);r.disposeData(e,!0),n.backend=t,t.move(e,i,n.shape,n.dtype,o),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(t,e){let n,r=null;if(null==e){if("function"!==typeof t)throw new Error("Please provide a function to tidy()");e=t}else{if("string"!==typeof t&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!==typeof e)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=t}return this.scopedRun((()=>this.startScope(r)),(()=>this.endScope(n)),(()=>(n=e(),n instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n)))}scopedRun(t,e,n){t();try{const t=n();return e(),t}catch(r){throw e(),r}}nextTensorId(){return Yi.nextTensorId++}nextVariableId(){return Yi.nextVariableId++}clone(t){const e=Qi.runKernel(Te,{x:t}),n={x:t},r=t=>({x:()=>{const e="float32",n={x:t},r={dtype:e};return Qi.runKernel(Ft,n,r)}}),i=[];return this.addTapeNode(this.state.activeScope.name,n,[e],r,i,{}),e}runKernel(t,e,n){null==this.backendName&&this.backend;const r=null!=Nr(t,this.backendName);if(!r)throw new Error(`Kernel '${t}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:t,inputs:e,attrs:n})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(t,e,n){const r=this.backend.numDataIds();let i=0;n.forEach((t=>{i+="complex64"===t.dtype?3:1}));const o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],s=r-e-i-o;if(s>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${s} data ids) after running '${t}'`)}runKernelFunc(t){let e,n=[];const r=this.isTapeOn(),i=this.state.numBytes,o=this.state.numTensors;let s,a;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;const l=Ki(t)?t.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(Ki(t)){const{kernelName:e,inputs:i,attrs:o}=t;null==this.backendName&&this.backend;const l=Nr(e,this.backendName);y(null!=l,(()=>`Cannot find registered kernel '${e}' for backend '${this.backendName}'`)),s=()=>{const t=this.backend.numDataIds();a=l.kernelFunc({inputs:i,attrs:o,backend:this.backend});const s=Array.isArray(a)?a:[a];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(e,t,s);const u=s.map((t=>null!=t.rank?t:this.makeTensorFromTensorInfo(t)));if(r){const t=this.getTensorsForGradient(e,i,u);n=this.saveTensorsForBackwardMode(t)}return u}}else{const{forwardFunc:e}=t,i=t=>{r&&(n=t.map((t=>this.keep(this.clone(t)))))};s=()=>{const t=this.backend.numDataIds();a=this.tidy((()=>e(this.backend,i)));const n=Array.isArray(a)?a:[a];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(l,t,n),n}}const{inputs:u,attrs:c}=t,h=Ki(t)?null:t.backwardsFunc;let d;return this.scopedRun((()=>this.state.kernelDepth++),(()=>this.state.kernelDepth--),(()=>{this.ENV.getBool("DEBUG")||this.state.profiling?(d=this.profiler.profileKernel(l,u,(()=>s())),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(d),e=d.outputs):e=s()})),r&&this.addTapeNode(l,u,e,h,n,c),this.state.profiling&&this.state.activeProfile.kernels.push({name:l,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-o,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(u).map((t=>null!=u[t]?u[t].shape:null)),outputShapes:e.map((t=>t.shape)),kernelTimeMs:d.timeMs,extraInfo:d.extraInfo}),Array.isArray(a)?e:e[0]}saveTensorsForBackwardMode(t){const e=t.map((t=>this.keep(this.clone(t))));return e}getTensorsForGradient(t,e,n){const r=Ar(t);if(null!=r){const t=r.inputsToSave||[],i=r.outputsToSave||[];let o;r.saveAllInputs?(y(Array.isArray(e),(()=>"saveAllInputs is true, expected inputs to be an array.")),o=Object.keys(e).map((t=>e[t]))):o=t.map((t=>e[t]));const s=n.filter(((t,e)=>i[e]));return o.concat(s)}return[]}makeTensor(t,e,n,r){if(null==t)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;let i=t;"string"===n&&M(t[0])&&(i=t.map((t=>oi(t))));const o=r.write(i,e,n),s=new Ai(e,n,o,this.nextTensorId());if(this.trackTensor(s,r),"string"===n){const t=this.state.tensorInfo.get(o),e=F(i);this.state.numBytes+=e-t.bytes,t.bytes=e}return s}makeTensorFromDataId(t,e,n,r){n=n||"float32";const i={dataId:t,shape:e,dtype:n};return this.makeTensorFromTensorInfo(i,r)}makeTensorFromTensorInfo(t,e){const{dataId:n,shape:r,dtype:i}=t,o=new Ai(r,i,n,this.nextTensorId());return this.trackTensor(o,e),o}makeVariable(t,e=!0,n,r){n=n||this.nextVariableId().toString(),null!=r&&r!==t.dtype&&(t=t.cast(r));const i=new $i(t,e,n,this.nextTensorId());if(null!=this.state.registeredVariables[i.name])throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(t,e){this.state.numTensors++,"string"===t.dtype&&this.state.numStringTensors++;let n=0;"complex64"!==t.dtype&&"string"!==t.dtype&&(n=t.size*O(t.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(t.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:n})),t instanceof $i||this.track(t)}incRef(t,e){this.trackTensor(t,e),this.backend.incRef(t.dataId)}removeDataId(t,e){this.state.tensorInfo.has(t)&&this.state.tensorInfo.get(t).backend===e&&(this.state.tensorInfo.delete(t),this.state.numDataBuffers--)}disposeTensor(t){if(!this.state.tensorInfo.has(t.dataId))return;const e=this.state.tensorInfo.get(t.dataId);if(this.state.numTensors--,"string"===t.dtype&&(this.state.numStringTensors--,this.state.numBytes-=e.bytes),"complex64"!==t.dtype&&"string"!==t.dtype){const e=t.size*O(t.dtype);this.state.numBytes-=e}e.backend.disposeData(t.dataId)&&this.removeDataId(t.dataId,e.backend)}disposeVariables(){for(const t in this.state.registeredVariables){const e=this.state.registeredVariables[t];this.disposeVariable(e)}}disposeVariable(t){this.disposeTensor(t),null!=this.state.registeredVariables[t.name]&&delete this.state.registeredVariables[t.name]}memory(){const t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,null==t.reasons&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}async profile(t){this.state.profiling=!0;const e=this.state.numBytes,n=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map((t=>t.totalBytesSnapshot))),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-n;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}addTapeNode(t,e,n,r,i,o){const s={id:this.state.nextTapeNodeId++,kernelName:t,inputs:e,outputs:n,saved:i},a=Ar(t);null!=a&&(r=a.gradFunc),null!=r&&(s.gradient=t=>(t=t.map(((t,e)=>{if(null==t){const t=n[e],r=q(t.size,t.dtype);return this.makeTensor(r,t.shape,t.dtype)}return t})),r(t.length>1?t:t[0],i,o))),this.state.activeTape.push(s)}keep(t){return t.kept=!0,t}startTape(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(t){const e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e}endScope(t){const e=Hi(t),n=new Set(e.map((t=>t.id)));for(let i=0;i<this.state.activeScope.track.length;i++){const t=this.state.activeScope.track[i];t.kept||n.has(t.id)||t.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],e.forEach((t=>{t.kept||t.scopeId!==r.id||this.track(t)}))}gradients(t,e,n,r=!1){if(y(e.length>0,(()=>"gradients() received an empty list of xs.")),null!=n&&"float32"!==n.dtype)throw new Error(`dy must have 'float32' dtype, but has '${n.dtype}'`);const i=this.scopedRun((()=>this.startTape()),(()=>this.endTape()),(()=>this.tidy("forward",t)));y(i instanceof Ai,(()=>"The result y returned by f() must be a tensor."));const o=di(this.state.activeTape,e,i);if(!r&&0===o.length&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(()=>{const t={};t[i.id]=null==n?Ji(i.shape):n,pi(t,o,(t=>this.tidy(t)),to);const r=e.map((e=>t[e.id]));return 0===this.state.gradientDepth&&(this.state.activeTape.forEach((t=>{for(const e of t.saved)e.dispose()})),this.state.activeTape=null),{value:i,grads:r}}))}customGrad(t){return y(B(t),(()=>"The f passed in customGrad(f) must be a function.")),(...e)=>{let n;y(e.every((t=>t instanceof Ai)),(()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors"));const r={};e.forEach(((t,e)=>{r[e]=t}));const i=(r,i)=>(n=t(...e,i),y(n.value instanceof Ai,(()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor")),y(B(n.gradFunc),(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function.")),n.value),o=(t,r)=>{const i=n.gradFunc(t,r),o=Array.isArray(i)?i:[i];y(o.length===e.length,(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...).")),y(o.every((t=>t instanceof Ai)),(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."));const s={};return o.forEach(((t,e)=>{s[e]=()=>t})),s};return this.runKernelFunc({forwardFunc:i,backwardsFunc:o,inputs:r})}}readSync(t){const e=this.state.tensorInfo.get(t);return e.backend.readSync(t)}read(t){const e=this.state.tensorInfo.get(t);return e.backend.read(t)}readToGPU(t,e){const n=this.state.tensorInfo.get(t);return n.backend.readToGPU(t,e)}async time(t){const e=ii(),n=await this.backend.time(t);return n.wallMs=ii()-e,n}track(t){return null!=this.state.activeScope&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Xi;for(const t in this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}function Ji(t){const e=G(w(t),"float32");return Qi.makeTensor(e,t,"float32")}function Zi(){const t=lt();if(null==t._tfengine){const e=new tt(t);t._tfengine=new Yi(e)}return at(t._tfengine.ENV),Ti((()=>t._tfengine)),t._tfengine}Yi.nextTensorId=0,Yi.nextVariableId=0;const Qi=Zi();function to(t,e){const n={a:t,b:e};return Qi.runKernel(ft,n)}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function eo(){return"undefined"!==typeof navigator&&null!=navigator}let no;function ro(t){if(void 0!==no)return no;if(t||eo()){if(t||(t=navigator),"ReactNative"===t.product)return!0;const e=t.userAgent||t.vendor||("undefined"!==typeof window?window.opera:"");if(!e){const e=t;return e.userAgentData&&e.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function io(){return"undefined"!==typeof window&&null!=window.document||"undefined"!==typeof WorkerGlobalScope}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const oo=it();oo.registerFlag("DEBUG",(()=>!1),(t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),oo.registerFlag("IS_BROWSER",(()=>io())),oo.registerFlag("IS_NODE",(()=>"undefined"!==typeof process&&"undefined"!==typeof process.versions&&"undefined"!==typeof process.versions.node)),oo.registerFlag("IS_CHROME",(()=>"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor))),oo.registerFlag("IS_SAFARI",(()=>"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor))),oo.registerFlag("PROD",(()=>!1)),oo.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(()=>oo.getBool("DEBUG"))),oo.registerFlag("DEPRECATION_WARNINGS_ENABLED",(()=>!0)),oo.registerFlag("IS_TEST",(()=>!1)),oo.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",(()=>oo.getBool("DEBUG"))),oo.registerFlag("WRAP_TO_IMAGEBITMAP",(()=>!1)),oo.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",(()=>!1)),oo.registerFlag("USE_SETTIMEOUTCUSTOM",(()=>!1));n(3429);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function so(t,e){let n=t;if(ai(t))return"string"===e?[]:[t.length];if(Wi(t)){const e=t.channels||"RGBA";return[t.height,t.width*e.length]}if(Ui(t))return[t.buffer.size/(null==e?4:O(e))];if(!Array.isArray(t))return[];const r=[];while(Array.isArray(n)||ai(n)&&"string"!==e)r.push(n.length),n=n[0];return Array.isArray(t)&&it().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&ao(t,r,[]),r}function ao(t,e,n){if(n=n||[],!Array.isArray(t)&&!ai(t))return void y(0===e.length,(()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`));y(e.length>0,(()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`)),y(t.length===e[0],(()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`));const r=e.slice(1);for(let i=0;i<t.length;++i)ao(t[i],r,n.concat(i))}function lo(t,e,n,r){if("string_or_numeric"!==t){if(null==t)throw new Error("Expected dtype cannot be null.");if("numeric"!==t&&t!==e||"numeric"===t&&"string"===e)throw new Error(`Argument '${n}' passed to '${r}' must be ${t} tensor, but got ${e} tensor`)}}function uo(t,e,n,r="numeric"){if(t instanceof Ri())return lo(r,t.dtype,e,n),t;let i=z(t);if("string"!==i&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),lo(r,i,e,n),null==t||!ai(t)&&!Array.isArray(t)&&"number"!==typeof t&&"boolean"!==typeof t&&"string"!==typeof t){const r=null==t?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${r}'`)}const o=so(t,i);ai(t)||Array.isArray(t)||(t=[t]);const s=!0,a="string"!==i?ri(t,i):li(t,[],s);return Qi.makeTensor(a,o,i)}function co(t,e,n,r="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);const i=t;return i.map(((t,i)=>uo(t,`${e}[${i}]`,n,r)))}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const ho="__op";function po(t){const e=Object.keys(t);if(1!==e.length)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+=ho;const i=(...t)=>{Qi.startScope(n);try{const e=r(...t);return Z(e)&&console.error("Cannot return a Promise inside of tidy."),Qi.endScope(e),e}catch(e){throw Qi.endScope(null),e}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function fo(t,e){const n=uo(t,"real","complex"),r=uo(e,"imag","complex");b(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, must match in call to tf.complex().`);const i={real:n,imag:r};return Qi.runKernel(Lt,i)}const go=po({complex_:fo});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function mo(t,e,n,r){if(null==r)r=z(t);else if("complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(Ui(t)||Wi(t)){if("float32"!==r&&"int32"!==r)throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return Qi.backend.createTensorFromGPUData(t,e||n,r)}if(!ai(t)&&!Array.isArray(t)&&"number"!==typeof t&&"boolean"!==typeof t&&"string"!==typeof t)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=e){X(e);const t=w(e),r=w(n);y(t===r,(()=>`Based on the provided shape, [${e}], the tensor should have ${t} values but has ${r}`));for(let i=0;i<n.length;++i){const t=n[i],r=i!==n.length-1||t!==w(e.slice(i));y(n[i]===e[i]||!r,(()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `))}}return ai(t)||Array.isArray(t)||(t=[t]),e=e||n,t="string"!==r?ri(t,r):li(t,[],!0),Qi.makeTensor(t,e,r)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function yo(t,e,n){const r=so(t,n);return mo(t,e,r,n)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const bo={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class vo{static join(t){return new vo(t).slice()}constructor(t){if(this.shards=[],this.previousShardIndex=0,null==t)return;if(t instanceof Array||(t=[t]),t=t.map((t=>ai(t)?t.buffer:t)),0===t.length)return;this.bufferUniformSize=t[0].byteLength;let e=0;for(let n=0;n<t.length;n++){const r=t[n];n!==t.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const i=e+r.byteLength;this.shards.push({buffer:r,start:e,end:i}),e=i}0===this.shards.length&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(t=0,e=this.byteLength){if(0===this.shards.length)return new ArrayBuffer(0);if(t=isNaN(Number(t))?0:t,e=isNaN(Number(e))?0:e,t=Math.max(0,t),e=Math.min(this.byteLength,e),e<=t)return new ArrayBuffer(0);const n=this.findShardForByte(t);if(-1===n)throw new Error(`Could not find start shard for byte ${t}`);const r=e-t,i=new ArrayBuffer(r),o=new Uint8Array(i);let s=0;for(let a=n;a<this.shards.length;a++){const n=this.shards[a],r=t+s,i=r-n.start,l=s,u=Math.min(e,n.end),c=u-n.start,h=new Uint8Array(n.buffer,i,c-i);if(o.set(h,l),s+=h.length,e<n.end)break}return i}findShardForByte(t){if(0===this.shards.length||t<0||t>=this.byteLength)return-1;if(null!=this.bufferUniformSize)return this.previousShardIndex=Math.floor(t/this.bufferUniformSize),this.previousShardIndex;function e(e){return t<e.start?-1:t>=e.end?1:0}if(0===e(this.shards[this.previousShardIndex]))return this.previousShardIndex;const n=wo(this.shards,e);return-1===n?-1:(this.previousShardIndex=n,this.previousShardIndex)}}function wo(t,e){let n=0,r=t.length;while(n<=r){const i=Math.floor((r-n)/2)+n,o=e(t[i]);if(0===o)return i;o<0?r=i:n=i+1}return-1}function xo(t){it().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function ko(){return Qi}function _o(){return Qi.memory()}function Io(t,e){return Qi.tidy(t,e)}function Co(t){const e=Hi(t);e.forEach((t=>t.dispose()))}function So(t){return Qi.keep(t)}function To(t,e,n=1){return Qi.registerBackend(t,e,n)}function Eo(){return Qi.backend}Ni(xo);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const No=4;async function Ao(t,e){const n=[],r=[],i=Array.isArray(t)?t.map((t=>t.name)):Object.keys(t);for(let s=0;s<i.length;++s){const o=i[s],a=Array.isArray(t)?t[s].tensor:t[o];if("float32"!==a.dtype&&"int32"!==a.dtype&&"bool"!==a.dtype&&"string"!==a.dtype&&"complex64"!==a.dtype)throw new Error(`Unsupported dtype in weight '${o}': ${a.dtype}`);const l={name:o,shape:a.shape,dtype:a.dtype};if("string"===a.dtype){const t=new Promise((async t=>{const e=await a.bytes(),n=e.reduce(((t,e)=>t+e.length),0)+No*e.length,r=new Uint8Array(n);let i=0;for(let o=0;o<e.length;o++){const t=e[o],n=new Uint8Array(new Uint32Array([t.length]).buffer);r.set(n,i),i+=No,r.set(t,i),i+=t.length}t(r)}));r.push(t)}else r.push(a.data());null!=e&&(l.group=e),n.push(l)}const o=await Promise.all(r);return{data:Oo(o),specs:n}}function Ro(t,e){const n=new vo(t),r={};let i=0;for(const o of e){const t=$o(o,((t,e)=>n.slice(i+t,i+e)));r[o.name]=Do(o,n.slice(i,i+t)),i+=t}return r}function $o(t,e){const n=w(t.shape);let r;if("quantization"in t){const e=t.quantization;r=bo[e.dtype]}else{if("string"===t.dtype){let t=0;for(let r=0;r<n;r++)t+=No+new Uint32Array(e(t,t+No))[0];return t}r=bo[t.dtype]}return n*r}function Do(t,e){const n=t.name,r=t.dtype,i=t.shape,o=w(i);let s,a=0;if("quantization"in t){const i=t.quantization;if("uint8"===i.dtype||"uint16"===i.dtype){if(!("min"in i)||!("scale"in i))throw new Error(`Weight ${t.name} with quantization ${i.dtype} doesn't have corresponding metadata min and scale.`)}else{if("float16"!==i.dtype)throw new Error(`Weight ${t.name} has unknown quantization dtype ${i.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);if("float32"!==r)throw new Error(`Weight ${t.name} is quantized with ${i.dtype} which only supports weights of type float32 not ${r}.`)}const l=bo[i.dtype],u="uint8"===i.dtype?new Uint8Array(e):new Uint16Array(e);if("float32"===r)if("uint8"===i.dtype||"uint16"===i.dtype){s=new Float32Array(u.length);for(let t=0;t<u.length;t++){const e=u[t];s[t]=e*i.scale+i.min}}else{if("float16"!==i.dtype)throw new Error(`Unsupported quantization type ${i.dtype} for weight type float32.`);{const t=Ko();s=t(u)}}else{if("int32"!==r)throw new Error(`Unsupported dtype in weight '${n}': ${r}`);if("uint8"!==i.dtype&&"uint16"!==i.dtype)throw new Error(`Unsupported quantization type ${i.dtype} for weight type int32.`);s=new Int32Array(u.length);for(let t=0;t<u.length;t++){const e=u[t];s[t]=Math.round(e*i.scale+i.min)}}a+=o*l}else if("string"===r){const n=w(t.shape);s=[];for(let t=0;t<n;t++){const t=new Uint32Array(e.slice(a,a+No))[0];a+=No;const n=new Uint8Array(e.slice(a,a+t));s.push(n),a+=t}}else{const t=bo[r];if("float32"===r)s=new Float32Array(e);else if("int32"===r)s=new Int32Array(e);else{if("bool"!==r){if("complex64"===r){s=new Float32Array(e);const t=new Float32Array(s.length/2),n=new Float32Array(s.length/2);for(let e=0;e<t.length;e++)t[e]=s[2*e],n[e]=s[2*e+1];const r=yo(t,i,"float32"),o=yo(n,i,"float32"),a=go(r,o);return r.dispose(),o.dispose(),a}throw new Error(`Unsupported dtype in weight '${n}': ${r}`)}s=new Uint8Array(e)}a+=o*t}return yo(s,i,r)}function Oo(t){if(null===t)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach((t=>{if(e+=t.byteLength,n.push(t.byteLength===t.buffer.byteLength?t:new t.constructor(t)),!(t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${t.constructor.name}`)}));const r=new Uint8Array(e);let i=0;return n.forEach((t=>{r.set(new Uint8Array(t.buffer),i),i+=t.byteLength})),r.buffer}const Fo="undefined"!==typeof Buffer&&("undefined"===typeof Blob||"undefined"===typeof atob||"undefined"===typeof btoa);function Mo(t){return Fo?Buffer.byteLength(t,"utf8"):new Blob([t]).size}function Po(t){if(Fo)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let r=0,i=e.length;r<i;r++)n+=String.fromCharCode(e[r]);return btoa(n)}function Lo(t){if(Fo){const e=Buffer.from(t,"base64");return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;++r)n.set([e.charCodeAt(r)],r);return n.buffer}function zo(t){return vo.join(t)}function Bo(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return null!=t.signature&&(n.signature=t.signature),null!=t.userDefinedMetadata&&(n.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(n.modelInitializer=t.modelInitializer),null!=t.initializerSignature&&(n.initializerSignature=t.initializerSignature),null!=t.trainingConfig&&(n.trainingConfig=t.trainingConfig),n}function Wo(t,e,n){const r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(null!=t.trainingConfig&&(r.trainingConfig=t.trainingConfig),null!=t.weightsManifest){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=e,r.weightData=n}return null!=t.signature&&(r.signature=t.signature),null!=t.userDefinedMetadata&&(r.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(r.modelInitializer=t.modelInitializer),null!=t.initializerSignature&&(r.initializerSignature=t.initializerSignature),r}async function Uo(t,e){let n,r;return null!=t.weightsManifest&&([n,r]=await e(t.weightsManifest)),Wo(t,n,r)}function Vo(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==t.modelTopology?0:Mo(JSON.stringify(t.modelTopology)),weightSpecsBytes:null==t.weightSpecs?0:Mo(JSON.stringify(t.weightSpecs)),weightDataBytes:null==t.weightData?0:new vo(t.weightData).byteLength}}function jo(t){const e=[];for(const n of t)e.push(...n.weights);return e}function Ho(){const t=t=>{let e=t<<13,n=0;while(0===(8388608&e))n-=8388608,e<<=1;return e&=-8388609,n+=947912704,e|n},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}function Go(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}function qo(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}function Ko(){const t=Ho(),e=Go(),n=qo();return r=>{const i=new ArrayBuffer(4*r.length),o=new Uint32Array(i);for(let s=0;s<r.length;s++){const i=r[s],a=t[n[i>>10]+(1023&i)]+e[i>>10];o[s]=a}return new Float32Array(i)}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Xo{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return null==Xo.instance&&(Xo.instance=new Xo),Xo.instance}static registerSaveRouter(t){Xo.getInstance().saveRouters.push(t)}static registerLoadRouter(t){Xo.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return Xo.getHandlers(t,"save")}static getLoadHandlers(t,e){return Xo.getHandlers(t,"load",e)}static getHandlers(t,e,n){const r=[],i="load"===e?Xo.getInstance().loadRouters:Xo.getInstance().saveRouters;return i.forEach((e=>{const i=e(t,n);null!==i&&r.push(i)})),r}}const Yo=t=>Xo.getSaveHandlers(t),Jo=(t,e)=>Xo.getLoadHandlers(t,e),Zo="tensorflowjs",Qo=1,ts="models_store",es="model_info_store";function ns(){if(!it().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t="undefined"===typeof window?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(null==e)throw new Error("The current browser does not appear to support IndexedDB.");return e}function rs(t){const e=t.result;e.createObjectStore(ts,{keyPath:"modelPath"}),e.createObjectStore(es,{keyPath:"modelPath"})}class is{constructor(t){if(this.indexedDB=ns(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,t)}async load(){return this.databaseAction(this.modelPath)}databaseAction(t,e){return new Promise(((t,n)=>{const r=this.indexedDB.open(Zo,Qo);r.onupgradeneeded=()=>rs(r),r.onsuccess=()=>{const i=r.result;if(null==e){const e=i.transaction(ts,"readonly"),r=e.objectStore(ts),o=r.get(this.modelPath);o.onsuccess=()=>{if(null==o.result)return i.close(),n(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));t(o.result.modelArtifacts)},o.onerror=t=>(i.close(),n(o.error)),e.oncomplete=()=>i.close()}else{e.weightData=vo.join(e.weightData);const r=Vo(e),s=i.transaction(es,"readwrite");let a,l,u=s.objectStore(es);try{a=u.put({modelPath:this.modelPath,modelArtifactsInfo:r})}catch(o){return n(o)}a.onsuccess=()=>{l=i.transaction(ts,"readwrite");const a=l.objectStore(ts);let c;try{c=a.put({modelPath:this.modelPath,modelArtifacts:e,modelArtifactsInfo:r})}catch(o){return n(o)}c.onsuccess=()=>t({modelArtifactsInfo:r}),c.onerror=t=>{u=s.objectStore(es);const e=u.delete(this.modelPath);e.onsuccess=()=>(i.close(),n(c.error)),e.onerror=t=>(i.close(),n(c.error))}},a.onerror=t=>(i.close(),n(a.error)),s.oncomplete=()=>{null==l?i.close():l.oncomplete=()=>i.close()}}},r.onerror=t=>n(r.error)}))}}is.URL_SCHEME="indexeddb://";const os=t=>it().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(is.URL_SCHEME)?ss(t.slice(is.URL_SCHEME.length)):null;function ss(t){return new is(t)}function as(t){return t.startsWith(is.URL_SCHEME)?t.slice(is.URL_SCHEME.length):t}Xo.registerSaveRouter(os),Xo.registerLoadRouter(os);class ls{constructor(){this.indexedDB=ns()}async listModels(){return new Promise(((t,e)=>{const n=this.indexedDB.open(Zo,Qo);n.onupgradeneeded=()=>rs(n),n.onsuccess=()=>{const r=n.result,i=r.transaction(es,"readonly"),o=i.objectStore(es),s=o.getAll();s.onsuccess=()=>{const e={};for(const t of s.result)e[t.modelPath]=t.modelArtifactsInfo;t(e)},s.onerror=t=>(r.close(),e(s.error)),i.oncomplete=()=>r.close()},n.onerror=t=>e(n.error)}))}async removeModel(t){return t=as(t),new Promise(((e,n)=>{const r=this.indexedDB.open(Zo,Qo);r.onupgradeneeded=()=>rs(r),r.onsuccess=()=>{const i=r.result,o=i.transaction(es,"readwrite"),s=o.objectStore(es),a=s.get(t);let l;a.onsuccess=()=>{if(null==a.result)return i.close(),n(new Error(`Cannot find model with path '${t}' in IndexedDB.`));{const r=s.delete(t),o=()=>{l=i.transaction(ts,"readwrite");const r=l.objectStore(ts),o=r.delete(t);o.onsuccess=()=>e(a.result.modelArtifactsInfo),o.onerror=t=>n(a.error)};r.onsuccess=o,r.onerror=t=>(o(),i.close(),n(a.error))}},a.onerror=t=>(i.close(),n(a.error)),o.oncomplete=()=>{null==l?i.close():l.oncomplete=()=>i.close()}},r.onerror=t=>n(r.error)}))}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const us="/",cs="tensorflowjs_models",hs="info",ds="model_topology",ps="weight_specs",fs="weight_data",gs="model_metadata";function ms(t){return{info:[cs,t,hs].join(us),topology:[cs,t,ds].join(us),weightSpecs:[cs,t,ps].join(us),weightData:[cs,t,fs].join(us),modelMetadata:[cs,t,gs].join(us)}}function ys(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function bs(t){const e=t.split(us);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(us)}function vs(t){return t.startsWith(ws.URL_SCHEME)?t.slice(ws.URL_SCHEME.length):t}class ws{constructor(t){if(!it().getBool("IS_BROWSER")||"undefined"===typeof window||"undefined"===typeof window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=ms(this.modelPath)}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),i=Vo(t),o=vo.join(t.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(i)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,Po(o));const e={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,signature:null!=t.signature?t.signature:void 0,userDefinedMetadata:null!=t.userDefinedMetadata?t.userDefinedMetadata:void 0,modelInitializer:null!=t.modelInitializer?t.modelInitializer:void 0,initializerSignature:null!=t.initializerSignature?t.initializerSignature:void 0,trainingConfig:null!=t.trainingConfig?t.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(e)),{modelArtifactsInfo:i}}catch(e){throw ys(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${i.modelTopologyBytes}, weightSpecsBytes=${i.weightSpecsBytes}, weightDataBytes=${i.weightDataBytes}.`)}}}async load(){const t=JSON.parse(this.LS.getItem(this.keys.info));if(null==t)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if("JSON"!==t.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const e={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(null==n)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);e.modelTopology=n;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(null==r)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);e.weightSpecs=r;const i=this.LS.getItem(this.keys.modelMetadata);if(null!=i){const t=JSON.parse(i);e.format=t.format,e.generatedBy=t.generatedBy,e.convertedBy=t.convertedBy,null!=t.signature&&(e.signature=t.signature),null!=t.userDefinedMetadata&&(e.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(e.modelInitializer=t.modelInitializer),null!=t.initializerSignature&&(e.initializerSignature=t.initializerSignature),null!=t.trainingConfig&&(e.trainingConfig=t.trainingConfig)}const o=this.LS.getItem(this.keys.weightData);if(null==o)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return e.weightData=Lo(o),e}}ws.URL_SCHEME="localstorage://";const xs=t=>it().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(ws.URL_SCHEME)?ks(t.slice(ws.URL_SCHEME.length)):null;function ks(t){return new ws(t)}Xo.registerSaveRouter(xs),Xo.registerLoadRouter(xs);class _s{constructor(){y(it().getBool("IS_BROWSER"),(()=>"Current environment is not a web browser")),y("undefined"===typeof window||"undefined"!==typeof window.localStorage,(()=>"Current browser does not appear to support localStorage")),this.LS=window.localStorage}async listModels(){const t={},e=cs+us,n=us+hs;for(let r=0;r<this.LS.length;++r){const i=this.LS.key(r);if(i.startsWith(e)&&i.endsWith(n)){const e=bs(i);t[e]=JSON.parse(this.LS.getItem(i))}}return t}async removeModel(t){t=vs(t);const e=ms(t);if(null==this.LS.getItem(e.info))throw new Error(`Cannot find model at path '${t}'`);const n=JSON.parse(this.LS.getItem(e.info));return ys(e),n}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const Is="://";class Cs{constructor(){this.managers={}}static getInstance(){return null==Cs.instance&&(Cs.instance=new Cs),Cs.instance}static registerManager(t,e){y(null!=t,(()=>"scheme must not be undefined or null.")),t.endsWith(Is)&&(t=t.slice(0,t.indexOf(Is))),y(t.length>0,(()=>"scheme must not be an empty string."));const n=Cs.getInstance();y(null==n.managers[t],(()=>`A model store manager is already registered for scheme '${t}'.`)),n.managers[t]=e}static getManager(t){const e=Cs.getInstance().managers[t];if(null==e)throw new Error(`Cannot find model manager for scheme '${t}'`);return e}static getSchemes(){return Object.keys(Cs.getInstance().managers)}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Ss{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(t,e){return fetch(t,e)}now(){return performance.now()}encode(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error(`Browser's encoder only supports utf-8, but got ${e}`);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}decode(t,e){return new TextDecoder(e).decode(t)}setTimeoutCustom(t,e){"undefined"!==typeof window&&it().getBool("USE_SETTIMEOUTCUSTOM")?(this.functionRefs.push(t),setTimeout((()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")}),e),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",(t=>{if(t.source===window&&t.data.name===this.messageName){t.stopPropagation();const e=this.functionRefs[t.data.index];e(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}}),!0))):setTimeout(t,e)}isTypedArray(t){return Fr(t)}}if(it().get("IS_BROWSER")){it().setPlatform("browser",new Ss);try{Cs.registerManager(ws.URL_SCHEME,new _s)}catch(JX){}try{Cs.registerManager(is.URL_SCHEME,new ls)}catch(JX){}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const Ts={importFetch:()=>n(5410)};let Es;class Ns{constructor(){this.util=n(8628),this.textEncoder=new this.util.TextEncoder}fetch(t,e){return null!=it().global.fetch?it().global.fetch(t,e):(null==Es&&(Es=Ts.importFetch()),Es(t,e))}now(){const t=process.hrtime();return 1e3*t[0]+t[1]/1e6}encode(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error(`Node built-in encoder only supports utf-8, but got ${e}`);return this.textEncoder.encode(t)}decode(t,e){return 0===t.length?"":new this.util.TextDecoder(e).decode(t)}isTypedArray(t){return this.util.types.isFloat32Array(t)||this.util.types.isInt32Array(t)||this.util.types.isUint8Array(t)||this.util.types.isUint8ClampedArray(t)}}
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function As(t,e="float32",n){return e=e||"float32",X(t),new _i(t,e,n)}
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Rs(t,e){const n=uo(t,"x","cast");if(!$(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if("string"===e&&"string"!==n.dtype||"string"!==e&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");const r={x:n},i={dtype:e};return Qi.runKernel(Ft,r,i)}it().get("IS_NODE")&&!it().get("IS_BROWSER")&&it().setPlatform("node",new Ns);const $s=po({cast_:Rs});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Ds(t){const e=uo(t,"x","clone","string_or_numeric"),n={x:e};return Qi.runKernel(Te,n)}const Os=po({clone_:Ds});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Fs(t,e=!1){console.log(t.toString(e))}
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Zi();const Ms={buffer:As,cast:$s,clone:Os,print:Fs};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Ps(t,e){let n=uo(t,"a","add"),r=uo(e,"b","add");[n,r]=Vi(n,r);const i={a:n,b:r};return Qi.runKernel(ft,i)}Ei(Ms);const Ls=po({add_:Ps});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function zs(t,e){let n=uo(t,"a","floorDiv"),r=uo(e,"b","floorDiv");[n,r]=Vi(n,r);const i={a:n,b:r};return Qi.runKernel(xe,i)}const Bs=po({floorDiv_:zs});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Ws(t,e){let n=uo(t,"a","div"),r=uo(e,"b","div");if([n,r]=Vi(n,r),"int32"===n.dtype&&"int32"===r.dtype)return Bs(n,r);const i={a:n,b:r},o={};return Qi.runKernel(le,i,o)}const Us=po({div_:Ws});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Vs(t,e){let n=uo(t,"a","mul"),r=uo(e,"b","mul");[n,r]=Vi(n,r);const i={a:n,b:r};return Qi.runKernel(on,i)}const js=po({mul_:Vs});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Hs(t){const e=uo(t,"x","sqrt","float32"),n={x:e};return Qi.runKernel(Hn,n)}const Gs=po({sqrt_:Hs});
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function qs(t){const e=uo(t,"x","square"),n={};return Qi.runKernel("Square",{x:e},n)}const Ks=po({square_:qs});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Xs(t){const e=uo(t,"x","zerosLike"),n={x:e};return Qi.runKernel(br,n)}const Ys=po({zerosLike_:Xs});function Js(t,e){y(B(t),(()=>"The f passed in variableGrads(f) must be a function")),y(null==e||Array.isArray(e)&&e.every((t=>t instanceof $i)),(()=>"The varList passed in variableGrads(f, varList) must be an array of variables"));const n=null!=e;if(!n){e=[];for(const t in Qi.registeredVariables)e.push(Qi.registeredVariables[t])}const r=n?e.filter((t=>!t.trainable)):null,i=e.length;e=e.filter((t=>t.trainable)),y(e.length>0,(()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${i} variables is trainable.`));const o=!0,{value:s,grads:a}=Qi.gradients(t,e,null,o);y(a.some((t=>null!=t)),(()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize().")),y(0===s.rank,(()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${s.rank} tensor`));const l={};return e.forEach(((t,e)=>{null!=a[e]&&(l[t.name]=a[e])})),null!=r&&r.forEach((t=>l[t.name]=null)),{value:s,grads:l}}function Zs(t){return Qi.customGrad(t)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Qs(t,e){if((ai(t)&&"string"!==e||Array.isArray(t))&&"complex64"!==e)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===e&&ai(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");const n=[],r=[];return mo(t,n,r,e)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const ta=new Map,ea=new Map;class na{getClassName(){return this.constructor.className}static fromConfig(t,e){return new t(e)}}class ra{constructor(){this.classNameMap={}}static getMap(){return null==ra.instance&&(ra.instance=new ra),ra.instance}static register(t){ra.getMap().classNameMap[t.className]=[t,t.fromConfig]}}function ia(t,e,n){y(null!=t.className,(()=>"Class being registered does not have the static className property defined.")),y("string"===typeof t.className,(()=>"className is required to be a string, but got type "+typeof t.className)),y(t.className.length>0,(()=>"Class being registered has an empty-string as its className, which is disallowed.")),"undefined"===typeof e&&(e="Custom"),"undefined"===typeof n&&(n=t.className);const r=n,i=e+">"+r;return ra.register(t),ta.set(i,t),ea.set(t,i),t}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class oa extends na{minimize(t,e=!1,n){const{value:r,grads:i}=this.computeGradients(t,n);if(null!=n){const t=n.map((t=>({name:t.name,tensor:i[t.name]})));this.applyGradients(t)}else this.applyGradients(i);return Co(i),e?r:(r.dispose(),null)}get iterations(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(t,e){return Js(t,e)}dispose(){null!=this.iterations_&&Co(this.iterations_)}async saveIterations(){return null==this.iterations_&&(this.iterations_=0),{name:"iter",tensor:Qs(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(t){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(t){return this.iterations_=(await t[0].tensor.data())[0],t.slice(1)}}Object.defineProperty(oa,Symbol.hasInstance,{value:t=>null!=t.minimize&&null!=t.computeGradients&&null!=t.applyGradients});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class sa extends oa{static get className(){return"Adadelta"}constructor(t,e,n=null){super(),this.learningRate=t,this.rho=e,this.epsilon=n,this.accumulatedGrads=[],this.accumulatedUpdates=[],null==n&&(this.epsilon=Qi.backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map((t=>t.name)):Object.keys(t);e.forEach(((e,n)=>{const r=Qi.registeredVariables[e],i=!1;null==this.accumulatedGrads[n]&&(this.accumulatedGrads[n]={originalName:`${e}/accum_grad`,variable:Io((()=>Ys(r).variable(i)))}),null==this.accumulatedUpdates[n]&&(this.accumulatedUpdates[n]={originalName:`${e}/accum_var`,variable:Io((()=>Ys(r).variable(i)))});const o=Array.isArray(t)?t[n].tensor:t[e];if(null==o)return;const s=this.accumulatedGrads[n].variable,a=this.accumulatedUpdates[n].variable;Io((()=>{const t=Ls(js(s,this.rho),js(Ks(o),1-this.rho)),e=js(Us(Gs(Ls(a,this.epsilon)),Gs(Ls(s,this.epsilon))),o),n=Ls(js(a,this.rho),js(Ks(e),1-this.rho));s.assign(t),a.assign(n);const i=Ls(js(e,-this.learningRate),r);r.assign(i)}))})),this.incrementIterations()}dispose(){null!=this.accumulatedUpdates&&(Co(this.accumulatedGrads.map((t=>t.variable))),Co(this.accumulatedUpdates.map((t=>t.variable))))}async getWeights(){const t=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(t.map((t=>({name:t.originalName,tensor:t.variable}))))}async setWeights(t){t=await this.extractIterations(t);const e=t.length/2,n=!1;this.accumulatedGrads=t.slice(0,e).map((t=>({originalName:t.name,variable:t.tensor.variable(n)}))),this.accumulatedUpdates=t.slice(e,2*e).map((t=>({originalName:t.name,variable:t.tensor.variable(n)})))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(t,e){return new t(e["learningRate"],e["rho"],e["epsilon"])}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function aa(t,e,n){X(t),n=n||z(e);const r={shape:t,value:e,dtype:n};return Qi.runKernel(be,{},r)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class la extends oa{static get className(){return"Adagrad"}constructor(t,e=.1){super(),this.learningRate=t,this.initialAccumulatorValue=e,this.accumulatedGrads=[]}applyGradients(t){const e=Array.isArray(t)?t.map((t=>t.name)):Object.keys(t);e.forEach(((e,n)=>{const r=Qi.registeredVariables[e];if(null==this.accumulatedGrads[n]){const t=!1;this.accumulatedGrads[n]={originalName:`${e}/accumulator`,variable:Io((()=>aa(r.shape,this.initialAccumulatorValue).variable(t)))}}const i=Array.isArray(t)?t[n].tensor:t[e];if(null==i)return;const o=this.accumulatedGrads[n].variable;Io((()=>{const t=Ls(o,Ks(i));o.assign(t);const e=Ls(js(Us(i,Gs(Ls(t,Qi.backend.epsilon()))),-this.learningRate),r);r.assign(e)}))})),this.incrementIterations()}dispose(){null!=this.accumulatedGrads&&Co(this.accumulatedGrads.map((t=>t.variable)))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map((t=>({name:t.originalName,tensor:t.variable}))))}async setWeights(t){t=await this.extractIterations(t);const e=!1;this.accumulatedGrads=t.map((t=>({originalName:t.name,variable:t.tensor.variable(e)})))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(t,e){return new t(e["learningRate"],e["initialAccumulatorValue"])}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function ua(t,e){let n=uo(t,"base","pow"),r=uo(e,"exp","pow");[n,r]=Vi(n,r);const i={a:n,b:r};return Qi.runKernel(gn,i)}const ca=po({pow_:ua});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function ha(t,e){let n=uo(t,"a","sub"),r=uo(e,"b","sub");[n,r]=Vi(n,r);const i={a:n,b:r};return Qi.runKernel(lr,i)}const da=po({sub_:ha});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class pa extends oa{static get className(){return"Adam"}constructor(t,e,n,r=null){super(),this.learningRate=t,this.beta1=e,this.beta2=n,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],Io((()=>{this.accBeta1=Qs(e).variable(),this.accBeta2=Qs(n).variable()})),null==r&&(this.epsilon=Qi.backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map((t=>t.name)):Object.keys(t);Io((()=>{const n=da(1,this.accBeta1),r=da(1,this.accBeta2);e.forEach(((e,i)=>{const o=Qi.registeredVariables[e],s=!1;null==this.accumulatedFirstMoment[i]&&(this.accumulatedFirstMoment[i]={originalName:`${e}/m`,variable:Io((()=>Ys(o).variable(s)))}),null==this.accumulatedSecondMoment[i]&&(this.accumulatedSecondMoment[i]={originalName:`${e}/v`,variable:Io((()=>Ys(o).variable(s)))});const a=Array.isArray(t)?t[i].tensor:t[e];if(null==a)return;const l=this.accumulatedFirstMoment[i].variable,u=this.accumulatedSecondMoment[i].variable,c=Ls(js(l,this.beta1),js(a,1-this.beta1)),h=Ls(js(u,this.beta2),js(Ks(a),1-this.beta2)),d=Us(c,n),p=Us(h,r);l.assign(c),u.assign(h);const f=Ls(js(Us(d,Ls(Gs(p),this.epsilon)),-this.learningRate),o);o.assign(f)})),this.accBeta1.assign(js(this.accBeta1,this.beta1)),this.accBeta2.assign(js(this.accBeta2,this.beta2))})),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&Co(this.accumulatedFirstMoment.map((t=>t.variable))),null!=this.accumulatedSecondMoment&&Co(this.accumulatedSecondMoment.map((t=>t.variable)))}async getWeights(){const t=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(t.map((t=>({name:t.originalName,tensor:t.variable}))))}async setWeights(t){t=await this.extractIterations(t),Io((()=>{this.accBeta1.assign(ca(this.beta1,this.iterations_+1)),this.accBeta2.assign(ca(this.beta2,this.iterations_+1))}));const e=t.length/2,n=!1;this.accumulatedFirstMoment=t.slice(0,e).map((t=>({originalName:t.name,variable:t.tensor.variable(n)}))),this.accumulatedSecondMoment=t.slice(e,2*e).map((t=>({originalName:t.name,variable:t.tensor.variable(n)})))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(t,e){return new t(e["learningRate"],e["beta1"],e["beta2"],e["epsilon"])}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function fa(t){const e=uo(t,"x","abs");if("complex64"===e.dtype){const t={x:e};return Qi.runKernel(zt,t)}{const t={x:e};return Qi.runKernel(ht,t)}}const ga=po({abs_:fa});
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function ma(t,e){const n=t.length,r=[];for(let i=0;i<n;i++){const o=n-1-i,s=t[o]||1,a=e[e.length-1-i]||1;a>1&&1===s&&r.unshift(o)}return r}function ya(t,e){const n=[];for(let r=0;r<e.length;r++){const i=t[t.length-r-1],o=e.length-r-1,s=e[o];(null==i||1===i&&s>1)&&n.unshift(o)}return n}function ba(t,e){const n=Math.max(t.length,e.length),r=new Array(n);for(let i=0;i<n;i++){let o=t[t.length-i-1];null==o&&(o=1);let s=e[e.length-i-1];if(null==s&&(s=1),1===o)r[n-i-1]=s;else if(1===s)r[n-i-1]=o;else{if(o!==s){const n=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(n)}r[n-i-1]=o}}return r}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function va(t,e){let n=uo(t,"a","maximum"),r=uo(e,"b","maximum");[n,r]=Vi(n,r),"bool"===n.dtype&&(n=$s(n,"int32"),r=$s(r,"int32")),ba(n.shape,r.shape);const i={a:n,b:r};return Qi.runKernel(Ge,i)}const wa=po({maximum_:va});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class xa extends oa{static get className(){return"Adamax"}constructor(t,e,n,r=null,i=0){super(),this.learningRate=t,this.beta1=e,this.beta2=n,this.epsilon=r,this.decay=i,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],Io((()=>{this.iteration=Qs(0).variable(),this.accBeta1=Qs(e).variable()})),null==r&&(this.epsilon=Qi.backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map((t=>t.name)):Object.keys(t);Io((()=>{const n=da(1,this.accBeta1),r=Us(-this.learningRate,Ls(js(this.iteration,this.decay),1));e.forEach(((e,i)=>{const o=Qi.registeredVariables[e],s=!1;null==this.accumulatedFirstMoment[i]&&(this.accumulatedFirstMoment[i]={originalName:`${e}/m`,variable:Ys(o).variable(s)}),null==this.accumulatedWeightedInfNorm[i]&&(this.accumulatedWeightedInfNorm[i]={originalName:`${e}/v`,variable:Ys(o).variable(s)});const a=Array.isArray(t)?t[i].tensor:t[e];if(null==a)return;const l=this.accumulatedFirstMoment[i].variable,u=this.accumulatedWeightedInfNorm[i].variable,c=Ls(js(l,this.beta1),js(a,1-this.beta1)),h=js(u,this.beta2),d=ga(a),p=wa(h,d);l.assign(c),u.assign(p);const f=Ls(js(Us(r,n),Us(c,Ls(p,this.epsilon))),o);o.assign(f)})),this.iteration.assign(Ls(this.iteration,1)),this.accBeta1.assign(js(this.accBeta1,this.beta1))})),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&Co(this.accumulatedFirstMoment.map((t=>t.variable))),null!=this.accumulatedWeightedInfNorm&&Co(this.accumulatedWeightedInfNorm.map((t=>t.variable)))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(t,e){return new t(e["learningRate"],e["beta1"],e["beta2"],e["epsilon"],e["decay"])}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class ka extends oa{static get className(){return"SGD"}constructor(t){super(),this.learningRate=t,this.setLearningRate(t)}applyGradients(t){const e=Array.isArray(t)?t.map((t=>t.name)):Object.keys(t);e.forEach(((e,n)=>{const r=Array.isArray(t)?t[n].tensor:t[e];if(null==r)return;const i=Qi.registeredVariables[e];Io((()=>{const t=Ls(js(this.c,r),i);i.assign(t)}))})),this.incrementIterations()}setLearningRate(t){this.learningRate=t,null!=this.c&&this.c.dispose(),this.c=So(Qs(-t))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(t){if(t=await this.extractIterations(t),0!==t.length)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(t,e){return new t(e["learningRate"])}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class _a extends ka{static get className(){return"Momentum"}constructor(t,e,n=!1){super(t),this.learningRate=t,this.momentum=e,this.useNesterov=n,this.accumulations=[],this.m=Qs(this.momentum)}applyGradients(t){const e=Array.isArray(t)?t.map((t=>t.name)):Object.keys(t);e.forEach(((e,n)=>{const r=Qi.registeredVariables[e];if(null==this.accumulations[n]){const t=!1;this.accumulations[n]={originalName:`${e}/momentum`,variable:Io((()=>Ys(r).variable(t)))}}const i=this.accumulations[n].variable,o=Array.isArray(t)?t[n].tensor:t[e];null!=o&&Io((()=>{let t;const e=Ls(js(this.m,i),o);t=this.useNesterov?Ls(js(this.c,Ls(o,js(e,this.m))),r):Ls(js(this.c,e),r),i.assign(e),r.assign(t)}))})),this.incrementIterations()}dispose(){this.m.dispose(),null!=this.accumulations&&Co(this.accumulations.map((t=>t.variable)))}setMomentum(t){this.momentum=t}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map((t=>({name:t.originalName,tensor:t.variable}))))}async setWeights(t){t=await this.extractIterations(t);const e=!1;this.accumulations=t.map((t=>({originalName:t.name,variable:t.tensor.variable(e)})))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(t,e){return new t(e["learningRate"],e["momentum"],e["useNesterov"])}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Ia extends oa{static get className(){return"RMSProp"}constructor(t,e=.9,n=0,r=null,i=!1){if(super(),this.learningRate=t,this.decay=e,this.momentum=n,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=i,null==r&&(this.epsilon=Qi.backend.epsilon()),null==t)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(t){const e=Array.isArray(t)?t.map((t=>t.name)):Object.keys(t);e.forEach(((e,n)=>{const r=Qi.registeredVariables[e],i=!1;null==this.accumulatedMeanSquares[n]&&(this.accumulatedMeanSquares[n]={originalName:`${e}/rms`,variable:Io((()=>Ys(r).variable(i)))}),null==this.accumulatedMoments[n]&&(this.accumulatedMoments[n]={originalName:`${e}/momentum`,variable:Io((()=>Ys(r).variable(i)))}),null==this.accumulatedMeanGrads[n]&&this.centered&&(this.accumulatedMeanGrads[n]={originalName:`${e}/mg`,variable:Io((()=>Ys(r).variable(i)))});const o=Array.isArray(t)?t[n].tensor:t[e];if(null==o)return;const s=this.accumulatedMeanSquares[n].variable,a=this.accumulatedMoments[n].variable;Io((()=>{const t=Ls(js(s,this.decay),js(Ks(o),1-this.decay));if(this.centered){const e=this.accumulatedMeanGrads[n].variable,i=Ls(js(e,this.decay),js(o,1-this.decay)),l=Us(js(o,this.learningRate),Gs(da(t,Ls(Ks(i),this.epsilon)))),u=Ls(js(a,this.momentum),l);s.assign(t),e.assign(i),a.assign(u);const c=da(r,u);r.assign(c)}else{const t=Ls(js(s,this.decay),js(Ks(o),1-this.decay)),e=Ls(js(a,this.momentum),Us(js(o,this.learningRate),Gs(Ls(t,this.epsilon))));s.assign(t),a.assign(e);const n=da(r,e);r.assign(n)}}))})),this.incrementIterations()}dispose(){null!=this.accumulatedMeanSquares&&Co(this.accumulatedMeanSquares.map((t=>t.variable))),null!=this.accumulatedMeanGrads&&this.centered&&Co(this.accumulatedMeanGrads.map((t=>t.variable))),null!=this.accumulatedMoments&&Co(this.accumulatedMoments.map((t=>t.variable)))}async getWeights(){const t=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&t.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(t.map((t=>({name:t.originalName,tensor:t.variable}))))}async setWeights(t){t=await this.extractIterations(t);const e=this.centered?t.length/3:t.length/2,n=!1;this.accumulatedMeanSquares=t.slice(0,e).map((t=>({originalName:t.name,variable:t.tensor.variable(n)}))),this.accumulatedMoments=t.slice(e,2*e).map((t=>({originalName:t.name,variable:t.tensor.variable(n)}))),this.centered&&(this.accumulatedMeanGrads=t.slice(2*e,3*e).map((t=>({originalName:t.name,variable:t.tensor.variable(n)}))))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(t,e){return new t(e["learningRate"],e["decay"],e["momentum"],e["epsilon"],e["centered"])}}
/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const Ca=[sa,la,pa,xa,_a,Ia,ka];function Sa(){for(const t of Ca)ia(t)}n(8858),n(1318),n(3228);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const Ta="model",Ea=".json",Na=".weights.bin";function Aa(t){return new Promise((t=>setTimeout(t))).then(t)}class Ra{constructor(t){if(!it().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(Ra.URL_SCHEME)&&(t=t.slice(Ra.URL_SCHEME.length)),null!=t&&0!==t.length||(t=Ta),this.modelJsonFileName=t+Ea,this.weightDataFileName=t+Na}async save(t){if("undefined"===typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");const e=vo.join(t.weightData),n=window.URL.createObjectURL(new Blob([e],{type:"application/octet-stream"}));if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const e=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],r=Bo(t,e),i=window.URL.createObjectURL(new Blob([JSON.stringify(r)],{type:"application/json"})),o=null==this.modelJsonAnchor?document.createElement("a"):this.modelJsonAnchor;if(o.download=this.modelJsonFileName,o.href=i,await Aa((()=>o.dispatchEvent(new MouseEvent("click")))),null!=t.weightData){const t=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor;t.download=this.weightDataFileName,t.href=n,await Aa((()=>t.dispatchEvent(new MouseEvent("click"))))}return{modelArtifactsInfo:Vo(t)}}}}Ra.URL_SCHEME="downloads://";const $a=t=>it().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Ra.URL_SCHEME)?Da(t.slice(Ra.URL_SCHEME.length)):null;function Da(t="model"){return new Ra(t)}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Oa(t,e,n,r){s(t),n=null==n?0:n,r=null==r?1:r,a(n,r);let i=0;const o=o=>(o.then((o=>{const s=n+ ++i/t.length*(r-n);return e(s),o})),o);function s(t){y(null!=t&&Array.isArray(t)&&t.length>0,(()=>"promises must be a none empty array"))}function a(t,e){y(t>=0&&t<=1,(()=>`Progress fraction must be in range [0, 1], but got startFraction ${t}`)),y(e>=0&&e<=1,(()=>`Progress fraction must be in range [0, 1], but got endFraction ${e}`)),y(e>=t,(()=>`startFraction must be no more than endFraction, but got startFraction ${t} and endFraction ${e}`))}return Promise.all(t.map(o))}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
async function Fa(t,e){null==e&&(e={});const n=null==e.fetchFunc?it().platform.fetch:e.fetchFunc,r=t.map((t=>n(t,e.requestInit,{isBinary:!0}))),i=0,o=.5,s=null==e.onProgress?await Promise.all(r):await Oa(r,e.onProgress,i,o),a=s.map((t=>t.arrayBuffer())),l=.5,u=1,c=null==e.onProgress?await Promise.all(a):await Oa(a,e.onProgress,l,u);return c}function Ma(t,e){var n;const r=null==e.fetchFunc?it().platform.fetch:e.fetchFunc;let i,o=0;return null===(n=e.onProgress)||void 0===n||n.call(e,0),new ReadableStream({pull:async n=>{var s;while(o<t.length){if(!i){const n=(await r(t[o],e.requestInit,{isBinary:!0})).body;i=n.getReader()}const{done:a,value:l}=await i.read();if(!a)return void n.enqueue(l);o++,i=void 0,null===(s=e.onProgress)||void 0===s||s.call(e,o/t.length)}n.close()}})}Xo.registerSaveRouter($a);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const Pa="application/octet-stream",La="application/json";class za{constructor(t,e){if(this.DEFAULT_METHOD="POST",null==e&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.weightUrlConverter=e.weightUrlConverter,null!=e.fetchFunc?(y("function"===typeof e.fetchFunc,(()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)")),this.fetch=e.fetchFunc):this.fetch=it().platform.fetch,y(null!=t&&t.length>0,(()=>"URL path for http must not be null, undefined or empty.")),Array.isArray(t)&&y(2===t.length,(()=>`URL paths for http must have a length of 2, (actual length is ${t.length}).`)),this.path=t,null!=e.requestInit&&null!=e.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{},this.loadOptions=e}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);e.body=new FormData;const n=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],r=Bo(t,n);if(e.body.append("model.json",new Blob([JSON.stringify(r)],{type:La}),"model.json"),null!=t.weightData){const n=vo.join(t.weightData);e.body.append("model.weights.bin",new Blob([n],{type:Pa}),"model.weights.bin")}const i=await this.fetch(this.path,e);if(i.ok)return{modelArtifactsInfo:Vo(t),responses:[i]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${i.status}.`)}async loadModelJSON(){const t=await this.fetch(this.path,this.requestInit);if(!t.ok)throw new Error(`Request to ${this.path} failed with status code ${t.status}. Please verify this URL points to the model JSON of the model to load.`);let e;try{e=await t.json()}catch(i){let t=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?t+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":t+=" Please make sure the server is serving valid JSON for this request.",new Error(t)}const n=e.modelTopology,r=e.weightsManifest;if(null==n&&null==r)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return e}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const t=await this.loadModelJSON();return Uo(t,(t=>this.loadWeights(t)))}async loadStream(){const t=await this.loadModelJSON(),e=await this.getWeightUrls(t.weightsManifest),n=jo(t.weightsManifest),r=()=>Ma(e,this.loadOptions);return Object.assign(Object.assign({},t),{weightSpecs:n,getWeightStream:r})}async getWeightUrls(t){const e=Array.isArray(this.path)?this.path[1]:this.path,[n,r]=Ba(e),i=this.weightPathPrefix||n,o=[],s=[];for(const a of t)for(const t of a.paths)null!=this.weightUrlConverter?s.push(this.weightUrlConverter(t)):o.push(i+t+r);return this.weightUrlConverter&&o.push(...await Promise.all(s)),o}async loadWeights(t){const e=await this.getWeightUrls(t),n=jo(t),r=await Fa(e,this.loadOptions);return[n,r]}}function Ba(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),r=t.substring(0,e),i=n>e?t.substring(n):"";return[r+"/",i]}function Wa(t){return null!=t.match(za.URL_SCHEME_REGEX)}za.URL_SCHEME_REGEX=/^https?:\/\//;const Ua=(t,e)=>{if("undefined"===typeof fetch&&(null==e||null==e.fetchFunc))return null;{let n=!0;if(n=Array.isArray(t)?t.every((t=>Wa(t))):Wa(t),n)return Va(t,e)}return null};function Va(t,e){return new za(t,e)}function ja(t,e){return Va(t,e)}Xo.registerSaveRouter(Ua),Xo.registerLoadRouter(Ua);
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const Ha=-2,Ga=-1;function qa(t,e,n){const r=t.shape.length;y(r===e.length,(()=>`Error in slice${r}D: Length of begin ${e} must match the rank of the array (${r}).`)),y(r===n.length,(()=>`Error in slice${r}D: Length of size ${n} must match the rank of the array (${r}).`));for(let i=0;i<r;++i)y(e[i]+n[i]<=t.shape[i],(()=>`Error in slice${r}D: begin[${i}] + size[${i}] (${e[i]+n[i]}) would overflow input.shape[${i}] (${t.shape[i]})`))}function Ka(t){const e=[];let n=0;while(t>0)1&t&&e.push(n),t/=2,n++;return e}function Xa(t,e,n){const r=[];for(let i=0;i<t.length;i++)r[i]=Math.ceil((e[i]-t[i])/n[i]);return r}function Ya(t,e,n,r){const i=[...t];for(let o=i.length;o<r.length;o++)i.push(1);for(let o=0;o<n;o++)0===o?i[e]=1:(i.splice(e,0,1),i.pop());return i}function Ja(t,e,n){return n<=t?n:n-(e-1)}function Za(t,e){const n=[];for(let r=0;r<t;r++)n.push(e+r);return n}function Qa(t,e,n,r,i,o,s,a,l){const u=t.length;let c=new Array(u),h=new Array(u),d=new Array(u);if(e.length&&n>0){const l=e[0],u=n+1;c=tl(s,l,u,r,t),h=el(a,l,u,i,t),d=Ya(o,l,u,t)}else for(let p=0;p<u;p++)c[p]=rl(s,r,o,t,p,l),h[p]=il(a,i,o,t,p,l),d[p]=nl(o,p,l);return{begin:c,end:h,strides:d}}function tl(t,e,n,r,i){const o=[...i],s=Za(n,e);for(let a=0;a<o.length;a++)if(s.indexOf(a)>-1)o[a]=0;else{const i=Ja(e,n,a);let s=r[i];t&1<<i&&(s=0),o[a]=s}return o}function el(t,e,n,r,i){const o=[...i],s=Za(n,e);for(let a=0;a<o.length;a++)if(s.indexOf(a)>-1)o[a]=Number.MAX_SAFE_INTEGER;else{const i=Ja(e,n,a);let s=r[i];t&1<<i&&(s=Number.MAX_SAFE_INTEGER),o[a]=s}for(let a=0;a<o.length;a++){const t=i[a];o[a]<0&&(o[a]+=t),o[a]=p(0,o[a],i[a])}return o}function nl(t,e,n){let r=t[e];return(n&1<<e||null==r)&&(r=1),r}function rl(t,e,n,r,i,o){let s=e[i];const a=n[i]||1;(t&1<<i||o&1<<i||null==s)&&(s=a>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);const l=r[i];return s<0&&(s+=l),s=p(0,s,l-1),s}function il(t,e,n,r,i,o){let s=e[i];const a=n[i]||1;(t&1<<i||o&1<<i||null==s)&&(s=a>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);const l=r[i];return s<0&&(s+=l),s=a>0?p(0,s,l):p(-1,s,l-1),s}function ol(t,e,n){let r=n.length;for(let i=0;i<n.length;i++)if(n[i]>1){r=i;break}for(let i=r+1;i<n.length;i++)if(e[i]>0||n[i]!==t[i])return!1;return!0}function sl(t,e){let n=t.length>0?t[t.length-1]:1;for(let r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function al(t,e,n){let r;const i=t.shape.length;let o;return r="number"===typeof e?[e,...new Array(i-1).fill(0)]:e.length<i?e.concat(new Array(i-e.length).fill(0)):e.slice(),r.forEach((t=>{y(-1!==t,(()=>"slice() does not support negative begin indexing."))})),o=null==n?new Array(i).fill(-1):"number"===typeof n?[n,...new Array(i-1).fill(-1)]:n.length<i?n.concat(new Array(i-n.length).fill(-1)):n,o=o.map(((e,n)=>e>=0?e:(y(-1===e,(()=>`Negative size values should be exactly -1 but got ${e} for the slice() size at index ${n}.`)),t.shape[n]-r[n]))),[r,o]}function ll(t,e,n,r,i,o,s,a,l){let u;if(null==r?(u=new Array(e.length),u.fill(1)):u=r,null!=s&&0!==(s&s-1))throw new Error("Multiple ellipses in slice is not allowed.");let c=!1;const h={dims:u.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:u.slice(),beginMask:i,endMask:o,ellipsisMask:s,newAxisMask:a,shrinkAxisMask:l};for(let v=0;v<h.dims;v++)c&&0!==(1<<v&a)&&h.numAddAxisAfterEllipsis++,1<<v&s&&(c=!0);c||(h.ellipsisMask|=1<<h.dims,h.dims++);const d={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};ul(h,d);let p=!0,f=!0,g=!0;const m=[],y=[];for(let v=0;v<t.length;++v){if(0===d.strides[v])throw Error(`strides[${v}] must be non-zero`);const e=!!(d.shrinkAxisMask&1<<v),n=t[v];if(-1===n){m.push(e?1:-1);continue}const r=[d.beginMask&1<<v,d.endMask&1<<v],i=[d.strides[v]>0?0:-1,d.strides[v]>0?n:n-1];if(e&&d.strides[v]<=0)throw Error("only stride 1 allowed on non-range indexing.");g=g&&1===d.strides[v];const o=!!(d.beginMask&1<<v&&d.endMask&1<<v);if(d.beginValid&&d.endValid){if(e){const t=d.begin[v]<0?n+d.begin[v]:d.begin[v];if(d.begin[v]=t,d.end[v]=d.begin[v]+1,t<0||t>=n)throw Error(`slice index ${d.begin[v]} of dimension ${v} out of bounds.`)}else d.begin[v]=cl(d.begin[v],0,d.strides[v],n,r,i),d.end[v]=cl(d.end[v],1,d.strides[v],n,r,i);const t=1===d.strides[v]&&0===d.begin[v]&&d.end[v]===n;p=p&&t,f=f&&(0===v&&1===d.strides[v]||t)}else p=p&&1===d.strides[v]&&o,f=f&&(0===v&&1===d.strides[v]||o);let s,a=!1;if(d.beginValid&&d.endValid?(s=d.end[v]-d.begin[v],a=!0):e?(s=1,a=!0):o&&n>=0&&(s=d.strides[v]<0?-n:n,a=!0),a){let t;t=0===s||s<0!==d.strides[v]<0?0:Math.trunc(s/d.strides[v])+(s%d.strides[v]!==0?1:0),m.push(t)}else m.push(-1)}for(let v=0;v<d.finalShapeGatherIndices.length;++v){const t=d.finalShapeGatherIndices[v];t>=0?y.push(m[t]):t===Ha&&y.push(1)}const b=y.filter(((t,e)=>d.finalShapeGatherIndices[e]!==Ha));return{finalShapeSparse:b,finalShape:y,isIdentity:p,sliceDim0:f,isSimpleSlice:g,begin:d.begin,end:d.end,strides:d.strides}}function ul(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=null!=t.begin,e.endValid=null!=t.end,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let r=0;r<t.dims;r++)if(1<<r&t.ellipsisMask){const i=Math.min(e.dims-(t.dims-r)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<i;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&t.newAxisMask)e.finalShapeGatherIndices.push(Ha),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);null!=t.begin&&(e.begin[n]=t.begin[r]),null!=t.end&&(e.end[n]=t.end[r]),e.strides[n]=t.strides[r],t.beginMask&1<<r&&(e.beginMask|=1<<n),t.endMask&1<<r&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<r?(e.finalShapeGatherIndices.push(Ga),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(r)),e.inputShapeGatherIndicesSparse[n]=r,n++}}function cl(t,e,n,r,i,o){if(i[e])return n>0?o[e]:o[e+1&1];{const e=t<0?r+t:t;return e<o[0]?o[0]:e>o[1]?o[1]:e}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function hl(t,e=null,n=!1){const r=uo(t,"x","all","bool"),i={x:r},o={axis:e,keepDims:n};return Qi.runKernel(mt,i,o)}const dl=po({all_:hl});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function pl(t,e=null,n=!1){const r=uo(t,"x","any","bool"),i={x:r},o={axis:e,keepDims:n};return Qi.runKernel(yt,i,o)}const fl=po({any_:pl});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function gl(t,e=0){const n=uo(t,"x","argMax"),r={x:n},i={axis:e};return Qi.runKernel(bt,r,i)}const ml=po({argMax_:gl});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function yl(t,e,n,r,i="NHWC",o){const s=t[3],a=[...e,s],l=Ol(i);return wl(t,a,n,o,r,null,null,l)}function bl(t,e,n,r,i,o,s="channelsLast"){const[a,l]=Cl(e);let u;if("channelsLast"===s)u=[a,l,t[3],t[3]];else{if("channelsFirst"!==s)throw new Error(`Unknown dataFormat ${s}`);u=[a,l,t[1],t[1]]}return wl(t,u,n,r,i,o,!1,s)}function vl(t,e,n,r,i,o,s="NDHWC"){const[a,l,u]=Sl(e);let c,h;if("NDHWC"===s)h="channelsLast",c=[a,l,u,t[4],t[4]];else{if("NCDHW"!==s)throw new Error(`Unknown dataFormat ${s}`);h="channelsFirst",c=[a,l,u,t[1],t[1]]}return xl(t,c,n,r,i,!1,h,o)}function wl(t,e,n,r,i,o,s=!1,a="channelsLast"){let[l,u,c,h]=[-1,-1,-1,-1];if("channelsLast"===a)[l,u,c,h]=t;else{if("channelsFirst"!==a)throw new Error(`Unknown dataFormat ${a}`);[l,h,u,c]=t}const[d,p,,f]=e,[g,m]=Cl(n),[y,b]=Cl(r),v=Tl(d,y),w=Tl(p,b),{padInfo:x,outHeight:k,outWidth:_}=El(i,u,c,g,m,v,w,o,a),I=s?f*h:f;let C;return"channelsFirst"===a?C=[l,I,k,_]:"channelsLast"===a&&(C=[l,k,_,I]),{batchSize:l,dataFormat:a,inHeight:u,inWidth:c,inChannels:h,outHeight:k,outWidth:_,outChannels:I,padInfo:x,strideHeight:g,strideWidth:m,filterHeight:d,filterWidth:p,effectiveFilterHeight:v,effectiveFilterWidth:w,dilationHeight:y,dilationWidth:b,inShape:t,outShape:C,filterShape:e}}function xl(t,e,n,r,i,o=!1,s="channelsLast",a){let[l,u,c,h,d]=[-1,-1,-1,-1,-1];if("channelsLast"===s)[l,u,c,h,d]=t;else{if("channelsFirst"!==s)throw new Error(`Unknown dataFormat ${s}`);[l,d,u,c,h]=t}const[p,f,g,,m]=e,[y,b,v]=Sl(n),[w,x,k]=Sl(r),_=Tl(p,w),I=Tl(f,x),C=Tl(g,k),{padInfo:S,outDepth:T,outHeight:E,outWidth:N}=Nl(i,u,c,h,y,b,v,_,I,C,a),A=o?m*d:m;let R;return"channelsFirst"===s?R=[l,A,T,E,N]:"channelsLast"===s&&(R=[l,T,E,N,A]),{batchSize:l,dataFormat:s,inDepth:u,inHeight:c,inWidth:h,inChannels:d,outDepth:T,outHeight:E,outWidth:N,outChannels:A,padInfo:S,strideDepth:y,strideHeight:b,strideWidth:v,filterDepth:p,filterHeight:f,filterWidth:g,effectiveFilterDepth:_,effectiveFilterHeight:I,effectiveFilterWidth:C,dilationDepth:w,dilationHeight:x,dilationWidth:k,inShape:t,outShape:R,filterShape:e}}function kl(t,e,n,r,i){null==r&&(r=Il(t,e,n));const o=t[0],s=t[1],a=Al((o-e+2*r)/n+1,i),l=Al((s-e+2*r)/n+1,i);return[a,l]}function _l(t,e,n,r,i,o){null==i&&(i=Il(t,e[0],r[0]));const s=[0,0,0,n];for(let a=0;a<3;a++)t[a]+2*i>=e[a]&&(s[a]=Al((t[a]-e[a]+2*i)/r[a]+1,o));return s}function Il(t,e,n,r=1){const i=Tl(e,r);return Math.floor((t[0]*(n-1)-n+i)/2)}function Cl(t){return"number"===typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}function Sl(t){return"number"===typeof t?[t,t,t]:t}function Tl(t,e){return e<=1?t:t+(t-1)*(e-1)}function El(t,e,n,r,i,o,s,a,l){let u,c,h;if("number"===typeof t){const i=0===t?"VALID":"NUMBER";u={top:t,bottom:t,left:t,right:t,type:i};const s=kl([e,n],o,r,t,a);c=s[0],h=s[1]}else if("same"===t){c=Math.ceil(e/r),h=Math.ceil(n/i);const t=Math.max(0,(c-1)*r+o-e),a=Math.max(0,(h-1)*i+s-n),l=Math.floor(t/2),d=t-l,p=Math.floor(a/2),f=a-p;u={top:l,bottom:d,left:p,right:f,type:"SAME"}}else if("valid"===t)u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((e-o+1)/r),h=Math.ceil((n-s+1)/i);else{if("object"!==typeof t)throw Error(`Unknown padding parameter: ${t}`);{const d="channelsLast"===l?t[1][0]:t[2][0],p="channelsLast"===l?t[1][1]:t[2][1],f="channelsLast"===l?t[2][0]:t[3][0],g="channelsLast"===l?t[2][1]:t[3][1],m=0===d&&0===p&&0===f&&0===g?"VALID":"EXPLICIT";u={top:d,bottom:p,left:f,right:g,type:m},c=Al((e-o+d+p)/r+1,a),h=Al((n-s+f+g)/i+1,a)}}return{padInfo:u,outHeight:c,outWidth:h}}function Nl(t,e,n,r,i,o,s,a,l,u,c){let h,d,p,f;if("valid"===t&&(t=0),"number"===typeof t){const g=0===t?"VALID":"NUMBER";h={top:t,bottom:t,left:t,right:t,front:t,back:t,type:g};const m=_l([e,n,r,1],[a,l,u],1,[i,o,s],t,c);d=m[0],p=m[1],f=m[2]}else{if("same"!==t)throw Error(`Unknown padding parameter: ${t}`);{d=Math.ceil(e/i),p=Math.ceil(n/o),f=Math.ceil(r/s);const t=(d-1)*i+a-e,c=(p-1)*o+l-n,g=(f-1)*s+u-r,m=Math.floor(t/2),y=t-m,b=Math.floor(c/2),v=c-b,w=Math.floor(g/2),x=g-w;h={top:b,bottom:v,left:w,right:x,front:m,back:y,type:"SAME"}}}return{padInfo:h,outDepth:d,outHeight:p,outWidth:f}}function Al(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function Rl(t){const[e,n,r]=Cl(t);return 1===e&&1===n&&1===r}function $l(t,e){return Rl(t)||Rl(e)}function Dl(t){return Cl(t).every((t=>t>0))}function Ol(t){if("NHWC"===t)return"channelsLast";if("NCHW"===t)return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function Fl(t,e,n){if(null!=n){if("string"===typeof e)throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if("number"===typeof e)y(k(e),(()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`));else{if("object"!==typeof e)throw Error(`Error in ${t}: Unknown padding parameter: ${e}`);e.forEach((e=>{e.forEach((e=>{y(k(e),(()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`))}))}))}}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Ml(t,e){const n=uo(t,"x","reshape","string_or_numeric"),r={x:n},i={shape:e};return Qi.runKernel(Cn,r,i)}const Pl=po({reshape_:Ml});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Ll(t,e,n,r,i){const o=uo(t,"x","avgPool","float32"),s=1;y($l(n,s),(()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`));let a=o,l=!1;3===o.rank&&(l=!0,a=Pl(o,[1,o.shape[0],o.shape[1],o.shape[2]])),y(4===a.rank,(()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`)),Fl("avgPool",r,i);const u={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:i};let h=Qi.runKernel(Ct,u,c);return h=$s(h,o.dtype),l?Pl(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const zl=po({avgPool_:Ll});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Bl(t,e,n,r,i,o="NDHWC"){const s=uo(t,"x","avgPool3d","float32");let a=s,l=!1;4===s.rank&&(l=!0,a=Pl(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),y(5===a.rank,(()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`)),y("NDHWC"===o,(()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`)),y("number"===typeof n&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,(()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`)),Fl("avgPool3d",r,i);const u={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:i,dataFormat:o};let h=Qi.runKernel(Tt,u,c);return h=$s(h,a.dtype),l?Pl(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const Wl=po({avgPool3d_:Bl});function Ul(t){let e;return e=0===t.rank||1===t.rank?Pl(t,[1,1,1,t.size]):2===t.rank?Pl(t,[1,1,t.shape[0],t.shape[1]]):3===t.rank?Pl(t,[1,t.shape[0],t.shape[1],t.shape[2]]):t,e}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Vl(t,e,n,r,i,o){null==o&&(o=.001);const s=uo(t,"x","batchNorm"),a=uo(e,"mean","batchNorm"),l=uo(n,"variance","batchNorm");let u,c;null!=i&&(u=uo(i,"scale","batchNorm")),null!=r&&(c=uo(r,"offset","batchNorm")),y(a.rank===l.rank,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),y(null==c||a.rank===c.rank,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),y(null==u||a.rank===u.rank,(()=>"Batch normalization gradient requires mean and scale to have equal ranks."));const h=Ul(s),d={x:h,scale:u,offset:c,mean:a,variance:l},p={varianceEpsilon:o},f=Qi.runKernel(ke,d,p);return Pl(f,s.shape)}const jl=po({batchNorm_:Vl});function Hl(t,e,n,r,i,o){const s=uo(t,"x","batchNorm"),a=uo(e,"mean","batchNorm"),l=uo(n,"variance","batchNorm");let u,c;return null!=i&&(u=uo(i,"scale","batchNorm")),null!=r&&(c=uo(r,"offset","batchNorm")),y(2===s.rank,(()=>`Error in batchNorm2D: x must be rank 2 but got rank ${s.rank}.`)),y(2===a.rank||1===a.rank,(()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`)),y(2===l.rank||1===l.rank,(()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`)),null!=u&&y(2===u.rank||1===u.rank,(()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`)),null!=c&&y(2===c.rank||1===c.rank,(()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${c.rank}.`)),jl(s,a,l,c,u,o)}const Gl=po({batchNorm2d_:Hl});function ql(t,e,n,r,i,o){const s=uo(t,"x","batchNorm"),a=uo(e,"mean","batchNorm"),l=uo(n,"variance","batchNorm");let u,c;return null!=i&&(u=uo(i,"scale","batchNorm")),null!=r&&(c=uo(r,"offset","batchNorm")),y(3===s.rank,(()=>`Error in batchNorm3D: x must be rank 3 but got rank ${s.rank}.`)),y(3===a.rank||1===a.rank,(()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`)),y(3===l.rank||1===l.rank,(()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`)),null!=u&&y(3===u.rank||1===u.rank,(()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`)),null!=c&&y(3===c.rank||1===c.rank,(()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${c.rank}.`)),jl(s,a,l,c,u,o)}const Kl=po({batchNorm3d_:ql});function Xl(t,e,n,r,i,o){const s=uo(t,"x","batchNorm"),a=uo(e,"mean","batchNorm"),l=uo(n,"variance","batchNorm");let u,c;return null!=i&&(u=uo(i,"scale","batchNorm")),null!=r&&(c=uo(r,"offset","batchNorm")),y(4===s.rank,(()=>`Error in batchNorm4D: x must be rank 4 but got rank ${s.rank}.`)),y(4===a.rank||1===a.rank,(()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`)),y(4===l.rank||1===l.rank,(()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`)),null!=u&&y(4===u.rank||1===u.rank,(()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`)),null!=c&&y(4===c.rank||1===c.rank,(()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${c.rank}.`)),jl(s,a,l,c,u,o)}const Yl=po({batchNorm4d_:Xl});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Jl(t,e){let n=uo(t,"broadcastTo","x");const r=n.shape;if(X(e),e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const t=n.shape.slice();while(t.length<e.length)t.unshift(1);n=Pl(n,t)}const i=n.shape,o=Array.from(e);for(let u=e.length-1;u>=0;u--)if(i[u]===e[u])o[u]=1;else if(1!==n.shape[u])throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${e}].`);const s=o.map(((t,e)=>t>1?e:-1)).filter((t=>t>=0));if(0===s.length)return Os(n);const a={x:n},l={reps:o};return Qi.runKernel(hr,a,l)}const Zl=po({broadcastTo_:Jl});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Ql(t,e,n){const r=uo(t,"x","clipByValue");if(y(e<=n,(()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`)),e===n)return aa(r.shape,e,r.dtype);const i={x:r},o={clipValueMin:e,clipValueMax:n};return Qi.runKernel(Pt,i,o)}const tu=po({clipByValue_:Ql});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function eu(t,e=0){y(t.length>=1,(()=>"Pass at least one tensor to concat"));const n=co(t,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach((t=>{if("complex64"!==t.dtype)throw new Error(`Cannot concatenate complex64 tensors with a tensor\n          with dtype ${t.dtype}. `)})),1===n.length)return Os(n[0]);const r=n,i={axis:e};return Qi.runKernel(Bt,r,i)}const nu=po({concat_:eu});function ru(t){return nu(t,0)}const iu=po({concat1d_:ru});function ou(t,e){return nu(t,e)}const su=po({concat2d_:ou});function au(t,e){return nu(t,e)}const lu=po({concat3d_:au});function uu(t,e){return nu(t,e)}const cu=po({concat4d_:uu});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function hu(t,e,n,r,i="NHWC",o=[1,1],s){const a=uo(t,"x","conv2d","float32"),l=uo(e,"filter","conv2d","float32");let u=a,c=!1;3===a.rank&&(c=!0,u=Pl(a,[1,a.shape[0],a.shape[1],a.shape[2]])),y(4===u.rank,(()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`)),y(4===l.rank,(()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`)),Fl("conv2d",r,s);const h="NHWC"===i?u.shape[3]:u.shape[1];y(h===l.shape[2],(()=>`Error in conv2d: depth of input (${h}) must match input depth for filter ${l.shape[2]}.`)),y($l(n,o),(()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`)),y(Dl(o),(()=>"Error in conv2D: Dilated rates should be larger than 0.")),y(Dl(n),(()=>"Error in conv2D: Strides should be larger than 0."));const d={x:u,filter:l},p={strides:n,pad:r,dataFormat:i,dilations:o,dimRoundingMode:s},f=Qi.runKernel(Wt,d,p);return c?Pl(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const du=po({conv2d_:hu});function pu(t,e,n,r,i="NWC",o=1,s){const a=uo(t,"x","conv1d"),l=uo(e,"filter","conv1d");let u=a,c=!1;2===a.rank&&(c=!0,u=Pl(a,[1,a.shape[0],a.shape[1]])),y(3===u.rank,(()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`)),y(3===l.rank,(()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`)),Fl("conv1d",r,s),y(u.shape[2]===l.shape[1],(()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${l.shape[1]}.`)),y($l(n,o),(()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${o}'`)),y(Dl(o),(()=>"Error in conv1D: Dilated rates should be larger than 0.")),y(Dl(n),(()=>"Error in conv1D: Stride should be larger than 0.")),y("NWC"===i,(()=>`Error in conv1d: got dataFormat of ${i} but only NWC is currently supported.`));const h=Pl(l,[1,l.shape[0],l.shape[1],l.shape[2]]),d=Pl(u,[u.shape[0],1,u.shape[1],u.shape[2]]),p=[1,n],f=[1,o],g="NHWC",m=du(d,h,p,r,g,f,s);return Pl(m,c?[m.shape[2],m.shape[3]]:[m.shape[0],m.shape[2],m.shape[3]])}const fu=po({conv1d_:pu});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function gu(t,e,n,r,i,o="NHWC",s){y(t.length===e.rank,(()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`));let a=t,l=e,u=!1;3===e.rank&&(u=!0,l=Pl(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,t[0],t[1],t[2]]),y(4===a.length,(()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`)),y(4===l.rank,(()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`)),y(4===n.rank,(()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`));const c="NHWC"===o?a[3]:a[1],h="NHWC"===o?l.shape[3]:l.shape[1];y(c===n.shape[2],(()=>`Error in conv2dDerInput: depth of input (${c}) must match input depth for filter ${n.shape[2]}.`)),y(h===n.shape[3],(()=>`Error in conv2dDerInput: depth of output (${h}) must match output depth for filter ${n.shape[3]}.`)),Fl("conv2dDerInput",i,s);const d={dy:l,filter:n},p={strides:r,pad:i,dataFormat:o,dimRoundingMode:s,inputShape:a},f=Qi.runKernel(Vt,d,p);return u?Pl(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const mu=po({conv2DBackpropInput_:gu});function yu(t,e,n,r,i,o){const s=uo(t,"x","conv2dTranspose"),a=uo(e,"filter","conv2dTranspose");return mu(n,s,a,r,i,"NHWC",o)}const bu=po({conv2dTranspose_:yu});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function vu(t,e,n,r,i="NDHWC",o=[1,1,1]){const s=uo(t,"x","conv3d"),a=uo(e,"filter","conv3d");let l=s,u=!1;4===s.rank&&(u=!0,l=Pl(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),y(5===l.rank,(()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`)),y(5===a.rank,(()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`)),y(l.shape[4]===a.shape[3],(()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${a.shape[3]}.`)),y($l(n,o),(()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`)),y("NDHWC"===i,(()=>`Error in conv3d: got dataFormat of ${i} but only NDHWC is currently supported.`)),y(Dl(o),(()=>"Error in conv3D: Dilated rates should be larger than 0.")),y(Dl(n),(()=>"Error in conv3D: Strides should be larger than 0."));const c={x:l,filter:a},h={strides:n,pad:r,dataFormat:i,dilations:o},d=Qi.runKernel(jt,c,h);return u?Pl(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const wu=po({conv3d_:vu});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function xu(t,e,n,r,i){y(t.length===e.rank,(()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`));let o=t,s=e,a=!1;4===e.rank&&(a=!0,s=Pl(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),o=[1,t[0],t[1],t[2],t[3]]);const l=o[4],u=s.shape[4];y(5===o.length,(()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${o.length}.`)),y(5===s.rank,(()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${s.rank}`)),y(5===n.rank,(()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`)),y(l===n.shape[3],(()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`)),y(u===n.shape[4],(()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${n.shape[4]}.`));const c={dy:s,filter:n},h={pad:i,strides:r,inputShape:o},d=Qi.runKernel(Gt,c,h);return a?Pl(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const ku=po({conv3DBackpropInput_:xu});function _u(t,e,n,r,i){const o=uo(t,"x","conv3dTranspose"),s=uo(e,"filter","conv3dTranspose");return ku(n,o,s,r,i)}const Iu=po({conv3dTranspose_:_u});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Cu(t,e,n,r=!1){const i=uo(t,"x","denseBincount"),o=uo(e,"weights","denseBincount");y("int32"===i.dtype,(()=>`Error in denseBincount: input dtype must be int32, but got ${i.dtype}`)),y(i.rank<=2,(()=>`Error in denseBincount: input must be at most rank 2, but got rank ${i.rank}.`)),y(n>=0,(()=>`size must be non-negative, but got ${n}.`)),y(o.size===i.size||0===o.size,(()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${i.shape}, weights shape: ${o.shape}.`));const s={x:i,weights:o},a={size:n,binaryOutput:r};return Qi.runKernel(Zt,s,a)}const Su=po({denseBincount_:Cu});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Tu(t,e,n,r,i="NHWC",o=[1,1],s){const a=uo(t,"x","depthwiseConv2d","float32"),l=uo(e,"filter","depthwiseConv2d","float32");let u=a,c=!1;3===a.rank&&(c=!0,u=Pl(a,[1,a.shape[0],a.shape[1],a.shape[2]])),y(4===u.rank,(()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`)),y(4===l.rank,(()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`));const h="NHWC"===i?u.shape[3]:u.shape[1];y(h===l.shape[2],(()=>`Error in depthwiseConv2d: number of input channels (${h}) must match the inChannels dimension in filter ${l.shape[2]}.`)),Fl("depthwiseConv2d",r,s);const d={x:u,filter:l},p={strides:n,pad:r,dataFormat:i,dilations:o,dimRoundingMode:s},f=Qi.runKernel(te,d,p);return c?Pl(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const Eu=po({depthwiseConv2d_:Tu});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Nu(t){const e=uo(t,"x","elu","float32"),n={x:e};return Qi.runKernel(ce,n)}const Au=po({elu_:Nu});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Ru(t,e){let n=uo(t,"a","equal","string_or_numeric"),r=uo(e,"b","equal","string_or_numeric");[n,r]=Vi(n,r),ba(n.shape,r.shape);const i={a:n,b:r};return Qi.runKernel(pe,i)}const $u=po({equal_:Ru});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Du(t){const e=uo(t,"x","exp"),n={x:e};return Qi.runKernel(fe,n)}const Ou=po({exp_:Du});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Fu(t,e=0){const n=uo(t,"x","expandDims","string_or_numeric");y(e<=n.rank,(()=>"Axis must be <= rank of the tensor"));const r={input:n},i={dim:e};return Qi.runKernel(ge,r,i)}const Mu=po({expandDims_:Fu});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Pu(t,e){const n=uo(t,"x","tile","string_or_numeric");y(n.rank===e.length,(()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`));const r={x:n},i={reps:e};return Qi.runKernel(hr,r,i)}const Lu=po({tile_:Pu});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function zu(t,e,n,r="float32"){null==e&&(e=t);const i=As([t,e],r),o=t<=e?t:e;for(let a=0;a<o;++a)i.set(1,a,a);const s=Pl(i.toTensor(),[t,e]);if(null==n)return s;if(1===n.length)return Lu(Mu(s,0),[n[0],1,1]);if(2===n.length)return Lu(Mu(Mu(s,0),0),[n[0],n[1],1,1]);if(3===n.length)return Lu(Mu(Mu(Mu(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const Bu=po({eye_:zu});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Wu(t){const e=uo(t,"x","floor","float32"),n={x:e};return Qi.runKernel(we,n)}const Uu=po({floor_:Wu});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Vu(t,e,n=0,r=0){const i=uo(t,"x","gather"),o=uo(e,"indices","gather","int32"),s={x:i,indices:o},a={axis:n,batchDims:r};return Qi.runKernel(_e,s,a)}const ju=po({gather_:Vu});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Hu(t,e){let n=uo(t,"a","greater","string_or_numeric"),r=uo(e,"b","greater","string_or_numeric");[n,r]=Vi(n,r),ba(n.shape,r.shape);const i={a:n,b:r};return Qi.runKernel(Ce,i)}const Gu=po({greater_:Hu});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function qu(t,e){let n=uo(t,"a","greaterEqual","string_or_numeric"),r=uo(e,"b","greaterEqual","string_or_numeric");[n,r]=Vi(n,r),ba(n.shape,r.shape);const i={a:n,b:r};return Qi.runKernel(Se,i)}const Ku=po({greaterEqual_:qu});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Xu(t,e=.2){const n=uo(t,"x","leakyRelu"),r={x:n},i={alpha:e};return Qi.runKernel(De,r,i)}const Yu=po({leakyRelu_:Xu});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Ju(t){const e=uo(t,"x","log","float32"),n={x:e};return Qi.runKernel(Pe,n)}const Zu=po({log_:Ju});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Qu(t){const e=uo(t,"x","log1p"),n={x:e};return Qi.runKernel(Le,n)}const tc=po({log1p_:Qu});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function ec(t,e=null,n=!1){const r=uo(t,"x","max"),i={x:r},o={reductionIndices:e,keepDims:n};return Qi.runKernel(He,i,o)}const nc=po({max_:ec});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function rc(t,e=null,n=!1){let r=uo(t,"x","sum");"bool"===r.dtype&&(r=$s(r,"int32"));const i={x:r},o={axis:e,keepDims:n};return Qi.runKernel(Gn,i,o)}const ic=po({sum_:rc});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function oc(t,e=-1){const n=uo(t,"logits","logSoftmax");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);const r=Zs(((t,n)=>{const r=!0,i=nc(t,e,!0),o=da(t,i),s=da($s(o,"float32"),Zu(ic(Ou(o),e,r)));n([s]);const a=(t,n)=>{const[r]=n,i=!0,o=Ou(r);return da(t,js(ic(t,e,i),o))};return{value:s,gradFunc:a}}));return r(n)}const sc=po({logSoftmax_:oc});
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function ac(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function lc(t,e,n){const r=t.length+e.length,i=[];let o=0,s=0;for(let a=0;a<r;a++)-1===n.indexOf(a)?i.push(t[o++]):i.push(e[s++]);return i}function uc(t,e){const n=[],r=t.length;for(let o=0;o<r;o++)-1===e.indexOf(o)&&n.push(t[o]);const i=e.map((e=>t[e]));return[n,i]}function cc(t,e){const n=e.map((t=>1));return lc(t,n,e)}function hc(t,e,n){y(ac(e,n),(()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`))}function dc(t,e){if(ac(t,e))return null;const n=[];for(let r=0;r<e;++r)-1===t.indexOf(r)&&n.push(r);return t.forEach((t=>n.push(t))),n}function pc(t){return t.map(((t,e)=>[e,t])).sort(((t,e)=>t[1]-e[1])).map((t=>t[0]))}function fc(t,e){const n=[];for(let r=e-t;r<e;++r)n.push(r);return n}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function gc(t,e=null,n=!1){const r=uo(t,"x","logSumExp"),i=T(e,r.shape),o=nc(r,i,!0),s=da(r,o),a=Ou(s),l=ic(a,i),u=Zu(l),c=Ls(Pl(o,u.shape),u);if(n){const t=cc(c.shape,i);return Pl(c,t)}return c}const mc=po({logSumExp_:gc});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function yc(t,e){const n=uo(t,"a","logicalAnd","bool"),r=uo(e,"b","logicalAnd","bool");ba(n.shape,r.shape);const i={a:n,b:r};return Qi.runKernel(ze,i)}const bc=po({logicalAnd_:yc});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function vc(t,e,n=!1,r=!1){let i=uo(t,"a","matMul"),o=uo(e,"b","matMul");[i,o]=Vi(i,o);const s={a:i,b:o},a={transposeA:n,transposeB:r};return Qi.runKernel(Nt,s,a)}const wc=po({matMul_:vc});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function xc(t,e,n,r,i){const o=uo(t,"x","maxPool"),s=1;let a=o,l=!1;3===o.rank&&(l=!0,a=Pl(o,[1,o.shape[0],o.shape[1],o.shape[2]])),y(4===a.rank,(()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`)),y($l(n,s),(()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`)),Fl("maxPool",r,i);const u={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:i},h=Qi.runKernel(qe,u,c);return l?Pl(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const kc=po({maxPool_:xc});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function _c(t,e=[1,1,1],n,r,i,o="NDHWC"){const s=uo(t,"x","maxPool3d");let a=s,l=!1;4===s.rank&&(l=!0,a=Pl(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),y(5===a.rank,(()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`)),y("NDHWC"===o,(()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`)),Fl("maxPool3d",r,i);const u={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:i,dataFormat:o},h=Qi.runKernel(Xe,u,c);return l?Pl(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const Ic=po({maxPool3d_:_c});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Cc(t,e=null,n=!1){const r=uo(t,"x","mean"),i={x:r},o={axis:e,keepDims:n};return Qi.runKernel(Ze,i,o)}const Sc=po({mean_:Cc});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Tc(t,e=null,n=!1){const r=uo(t,"x","min"),i={x:r},o={axis:e,keepDims:n};return Qi.runKernel(Qe,i,o)}const Ec=po({min_:Tc});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Nc(t,e){let n=uo(t,"a","minimum"),r=uo(e,"b","minimum");[n,r]=Vi(n,r),"bool"===n.dtype&&(n=$s(n,"int32"),r=$s(r,"int32")),ba(n.shape,r.shape);const i={a:n,b:r};return Qi.runKernel(tn,i)}const Ac=po({minimum_:Nc});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Rc(t,e=null,n=!1){t=uo(t,"x","moments");const r=T(e,t.shape),i=Sc(t,r,n);let o=i.shape;n||(o=cc(i.shape,r));const s=Ks(da($s(t,"float32"),Pl(i,o))),a=Sc(s,r,n);return{mean:i,variance:a}}const $c=po({moments_:Rc});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Dc(t){const e=uo(t,"x","neg"),n={x:e};return Qi.runKernel(sn,n)}const Oc=po({neg_:Dc});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Fc(t,e){let n=uo(t,"a","notEqual","string_or_numeric"),r=uo(e,"b","notEqual","string_or_numeric");[n,r]=Vi(n,r),ba(n.shape,r.shape);const i={a:n,b:r};return Qi.runKernel(an,i)}const Mc=po({notEqual_:Fc});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Pc(t,e,n=1,r=0,i="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const o=uo(t,"indices","oneHot","int32"),s={indices:o},a={dtype:i,depth:e,onValue:n,offValue:r};return Qi.runKernel(dn,s,a)}const Lc=po({oneHot_:Pc});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function zc(t,e="float32"){if(X(t),"complex64"===e){const e=zc(t,"float32"),n=zc(t,"float32");return go(e,n)}const n=q(w(t),e);return Qi.makeTensor(n,t,e)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Bc(t,e="float32"){if(X(t),"complex64"===e){const e=Bc(t,"float32"),n=zc(t,"float32");return go(e,n)}const n=G(w(t),e);return Qi.makeTensor(n,t,e)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Wc(t){const e=uo(t,"x","onesLike"),n={x:e};return Qi.runKernel(hn,n)}const Uc=po({onesLike_:Wc});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Vc(t,e,n=0){const r=uo(t,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const i={paddings:e,constantValue:n},o={x:r};return Qi.runKernel(fn,o,i)}const jc=po({pad_:Vc});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Hc(t,e){const n=uo(t,"x","prelu"),r=uo(e,"alpha","prelu"),i={x:n,alpha:r};return Qi.runKernel(mn,i)}const Gc=po({prelu_:Hc});var qc=n(4332);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Kc{constructor(t,e,n,r,i){this.mean=t,this.stdDev=e,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);const o=i||Math.random();this.random=qc.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const t=this.nextVal;return this.nextVal=NaN,t}let t,e,n=!1;while(!n){let r,i,o;do{r=2*this.random()-1,i=2*this.random()-1,o=r*r+i*i}while(o>=1||0===o);const s=Math.sqrt(-2*Math.log(o)/o);t=this.mean+this.stdDev*r*s,e=this.mean+this.stdDev*i*s,this.truncated&&!this.isValidTruncated(t)||(n=!0)}return this.truncated&&!this.isValidTruncated(e)||(this.nextVal=this.convertValue(e)),this.convertValue(t)}convertValue(t){return null==this.dtype||"float32"===this.dtype?t:Math.round(t)}isValidTruncated(t){return t<=this.upper&&t>=this.lower}}class Xc{constructor(t=0,e=1,n,r){if(this.canReturnFloat=()=>null==this.dtype||"float32"===this.dtype,this.min=t,this.range=e-t,this.dtype=n,null==r&&(r=Math.random()),"number"===typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${t} - ${e} <= 1 and dtype is not float`);this.random=qc.alea(r)}convertValue(t){return this.canReturnFloat()?t:Math.round(t)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Yc(t,e=0,n=1,r,i){if(X(t),null!=r&&"bool"===r)throw new Error(`Unsupported data type ${r}`);const o=new Kc(e,n,r,!1,i),s=As(t,r);for(let a=0;a<s.values.length;a++)s.values[a]=o.nextValue();return s.toTensor()}const Jc=po({randomNormal_:Yc});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Zc(t,e=0,n=1,r="float32",i){X(t);const o=As(t,r),s=new Xc(e,n,null,i);for(let a=0;a<o.values.length;a++)o.values[a]=s.nextValue();return o.toTensor()}const Qc=po({randomUniform_:Zc});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function th(t,e,n=1,r="float32"){if(0===n)throw new Error("Cannot have a step of zero");const i={start:t,stop:e,step:n,dtype:r};return Qi.runKernel(xn,{},i)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function eh(t){const e=uo(t,"x","relu"),n={x:e};return Qi.runKernel(In,n)}const nh=po({relu_:eh});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function rh(t,e){const n=uo(t,"x","reverse"),r={x:n},i={dims:e};return Qi.runKernel(Rn,r,i)}const ih=po({reverse_:rh});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function oh(t){const e=uo(t,"x","selu"),n={x:e};return Qi.runKernel(Ln,n)}const sh=po({selu_:oh});function ah(t,e,n,r,i,o=[1,1],s="NHWC"){const a=uo(t,"x","separableConv2d"),l=uo(e,"depthwiseFilter","separableConv2d"),u=uo(n,"pointwiseFilter","separableConv2d");let c=a,h=!1;if(3===a.rank&&(h=!0,c=Pl(a,[1,a.shape[0],a.shape[1],a.shape[2]])),"NCHW"===s)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");y(4===c.rank,(()=>`Error in separableConv2d: input must be rank 4, but got rank ${c.rank}.`)),y(4===l.rank,(()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`)),y(4===u.rank,(()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`)),y(1===u.shape[0],(()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`)),y(1===u.shape[1],(()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`));const d=l.shape[2],p=l.shape[3];y(u.shape[2]===d*p,(()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${d*p}, but got ${u.shape[2]}.`));const f=Eu(c,l,r,i,s,o),g=1,m=du(f,u,g,"valid",s);return h?Pl(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const lh=po({separableConv2d_:ah});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function uh(t){const e=uo(t,"x","sigmoid","float32"),n={x:e};return Qi.runKernel(Vn,n)}const ch=po({sigmoid_:uh});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function hh(t,e,n){const r=uo(t,"x","slice","string_or_numeric");if(0===r.rank)throw new Error("Slicing scalar is not possible");const i={x:r},o={begin:e,size:n};return Qi.runKernel(zn,i,o)}const dh=po({slice_:hh});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function ph(t,e,n){const r=uo(t,"x","slice1d");return y(1===r.rank,(()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`)),dh(r,[e],[n])}const fh=po({slice1d_:ph});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function gh(t,e,n){const r=uo(t,"x","slice2d");return y(2===r.rank,(()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`)),dh(r,e,n)}const mh=po({slice2d_:gh});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function yh(t,e,n){const r=uo(t,"x","slice3d");return y(3===r.rank,(()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`)),dh(r,e,n)}const bh=po({slice3d_:yh});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function vh(t,e,n){const r=uo(t,"x","slice4d");return y(4===r.rank,(()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`)),dh(r,e,n)}const wh=po({slice4d_:vh});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function xh(t,e=-1){const n=uo(t,"logits","softmax","float32");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const r={logits:n},i={dim:e};return Qi.runKernel(Xn,r,i)}const kh=po({softmax_:xh});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function _h(t){const e=uo(t,"x","softplus"),n={x:e};return Qi.runKernel(jn,n)}const Ih=po({softplus_:_h});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Ch(t,e,n=0){const r=uo(t,"x","split"),i={x:r},o={numOrSizeSplits:e,axis:n};return Qi.runKernel(Kn,i,o)}const Sh=po({split_:Ch});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Th(t,e){const n=uo(t,"x","squeeze","string_or_numeric");return Pl(n,E(n.shape,e).newShape)}const Eh=po({squeeze_:Th});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Nh(t,e=0){const n=co(t,"tensors","stack","string_or_numeric");y(n.length>=1,(()=>"Pass at least one tensor to tf.stack")),n.length>0&&y(e<=n[0].rank,(()=>"Axis must be <= rank of the tensor"));const r=n,i={axis:e};return Qi.runKernel(pn,r,i)}const Ah=po({stack_:Nh});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Rh(t){const e=uo(t,"x","tanh","float32"),n={x:e};return Qi.runKernel(cr,n)}const $h=po({tanh_:Rh});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Dh(t,e){v(t);const n=so(t,e);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");const r=null;return mo(t,r,n,e)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Oh(t,e,n){if(v(t),null!=e&&3!==e.length)throw new Error("tensor3d() requires shape to have three numbers");const r=so(t,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return mo(t,e,r,n)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Fh(t,e=0,n=1,r,i){if(X(t),null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");const o=new Kc(e,n,r,!0,i),s=As(t,r);for(let a=0;a<s.values.length;a++)s.values[a]=o.nextValue();return s.toTensor()}const Mh=po({truncatedNormal_:Fh});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Ph(t,e=0){const n=uo(t,"x","unstack","string_or_numeric");y(e>=-n.shape.length&&e<n.shape.length,(()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`));const r={value:n},i={axis:e};return Qi.runKernel(mr,r,i)}const Lh=po({unstack_:Ph});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function zh(t,e=!0,n,r){return Qi.makeVariable(t,e,n,r)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Bh(t,e,n){const r=uo(e,"a","where"),i=uo(n,"b","where"),o=uo(t,"condition","where","bool"),s=ba(ba(o.shape,r.shape),i.shape),a=Zl(o,s),l=Zl(r,s),u=Zl(i,s),c={condition:a,t:l,e:u};return Qi.runKernel(Pn,c)}const Wh=po({where_:Bh});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Uh(t){const e=uo(t,"input","imag"),n={input:e};return Qi.runKernel(Ne,n)}const Vh=po({imag_:Uh});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function jh(t){const e=uo(t,"input","real"),n={input:e};return Qi.runKernel(kn,n)}const Hh=po({real_:jh});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Gh(t,e,n){const r=uo(t,"x","transpose");if(null==e&&(e=r.shape.map(((t,e)=>e)).reverse()),y(r.rank===e.length,(()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${e}.`)),e.forEach((t=>{y(t>=0&&t<r.rank,(()=>"All entries in 'perm' must be between 0 and "+(r.rank-1)+` but got ${e}`))})),r.rank<=1)return r.clone();const i={x:r},o={perm:e};return"complex64"===r.dtype?Io((()=>{let t=Hh(r),e=Vh(r);return t=Qi.runKernel(fr,{x:t},o),e=Qi.runKernel(fr,{x:e},o),n&&(e=Oc(e)),go(t,e)})):Qi.runKernel(fr,i,o)}const qh=po({transpose_:Gh});
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Kh(t,e){if(null==e)return t.shape.slice();if(x(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let r=0;r<t.shape.length;r++)null==e[r]&&null!=t.shape[r]?n.push(t.shape[r]):n.push(e[r]);return n}return e}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Xh(t,e,n,r){const i=uo(t,"x","dropout");if(y("float32"===i.dtype,(()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${i.dtype} tensor instead.`)),y(e>=0&&e<1,(()=>`rate must be a float in the range [0, 1), but got ${e}.`)),0===e)return t instanceof Ai?i.clone():i;const o=Kh(i,n),s=1-e,a=Us(Uu(Ls(Qc(o,0,1,"float32",r),s)),s);return js(i,a)}const Yh=po({dropout_:Xh});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Jh(t){y("complex64"===t.dtype,(()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`));const e={input:t};return Qi.runKernel(ye,e)}const Zh=po({fft_:Jh});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Qh(t,e){y("float32"===t.dtype,(()=>`The dtype for rfft() must be real value but got ${t.dtype}`));let n=t.shape[t.shape.length-1];const r=t.size/n;let i;if(null!=e&&e<n){const r=t.shape.map((t=>0)),o=t.shape.map((t=>t));o[t.shape.length-1]=e,i=dh(t,r,o),n=e}else if(null!=e&&e>n){const r=t.shape.map((t=>t));r[t.shape.length-1]=e-n,i=nu([t,zc(r)],t.shape.length-1),n=e}else i=t;const o=Ys(i),s=Pl(go(i,o),[r,n]),a=Zh(s),l=Math.floor(n/2)+1,u=Hh(a),c=Vh(a),h=Sh(u,[l,n-l],u.shape.length-1),d=Sh(c,[l,n-l],c.shape.length-1),p=i.shape.slice();return p[i.shape.length-1]=l,Pl(go(h[0],d[0]),p)}const td=po({rfft_:Qh});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function ed(t){y("complex64"===t.dtype,(()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`));const e={input:t};return Qi.runKernel(Ee,e)}const nd=po({ifft_:ed});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function rd(t){const e=t.shape[t.shape.length-1],n=t.size/e;let r;if(e<=2){const i=Pl(t,[n,e]);r=nd(i)}else{const i=[n,2*(e-1)],o=Pl(Hh(t),[n,e]),s=Pl(Vh(t),[n,e]),a=ih(dh(o,[0,1],[n,e-2]),1),l=js(ih(dh(s,[0,1],[n,e-2]),1),Qs(-1)),u=nu([o,a],1),c=nu([s,l],1),h=Pl(go(u,c),[i[0],i[1]]);r=nd(h)}if(r=Hh(r),3===t.rank&&0!==t.shape[0]){const e=r,n=t.shape[0];r=Pl(r,[n,r.shape[0]/n,r.shape[1]]),e.dispose()}return r}const id=po({irfft_:rd});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function od(t,e,n,r,i,o="NHWC",s){let a=t;3===t.rank&&(a=Pl(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;3===l.rank&&(l=Pl(e,[1,e.shape[0],e.shape[1],e.shape[2]])),y(4===a.rank,(()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`)),y(4===l.rank,(()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`)),y(4===n.length,(()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`));const u="NHWC"===o?a.shape[3]:a.shape[1],c="NHWC"===o?l.shape[3]:l.shape[1];y(u===n[2],(()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${n[2]}.`)),y(c===n[3],(()=>`Error in conv2dDerFilter: depth of dy (${c}) must match output depth for filter (${n[3]}).`)),Fl("conv2dDerFilter",i,s);const h={x:a,dy:l},d={strides:r,pad:i,dataFormat:o,dimRoundingMode:s,filterShape:n};return Qi.runKernel(Ut,h,d)}const sd=po({conv2DBackpropFilter_:od});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function ad(t){const e=uo(t,"x","relu6"),n={x:e};return Qi.runKernel(An,n)}const ld=po({relu6_:ad});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function ud(t,e=0){const n=uo(t,"x","step"),r={x:n},i={alpha:e};return Qi.runKernel(vr,r,i)}const cd=po({step_:ud});
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function hd(t,e,n){if(null==n||"linear"===n)return t;if("relu"===n)return js(t,cd(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function dd(t,e){let n=e;const r=ya(t.shape,e.shape);return r.length>0&&(n=ic(n,r)),Pl(n,t.shape)}function pd(t,e,n,r){if("linear"===e)return t;if("relu"===e)return nh(t);if("elu"===e)return Au(t);if("relu6"===e)return ld(t);if("prelu"===e)return Gc(t,n);if("leakyrelu"===e)return Yu(t,r);if("sigmoid"===e)return ch(t);throw new Error(`Unknown fused activation ${e}.`)}const fd=(t,e)=>{const n=t>0;return!n||"linear"===e};
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function gd({x:t,filter:e,strides:n,pad:r,dataFormat:i="NHWC",dilations:o=[1,1],dimRoundingMode:s,bias:a,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(l=l||"linear",!1===fd(Qi.state.gradientDepth,l)){y("NHWC"===i,(()=>`Error in fused conv2d: got dataFormat of ${i} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`));let h=du(t,e,n,r,i,o,s);return null!=a&&(h=Ls(h,a)),pd(h,l,u,c)}const h=uo(t,"x","conv2d","float32"),d=uo(e,"filter","conv2d","float32");let p=h,f=!1;3===h.rank&&(f=!0,p=Pl(h,[1,h.shape[0],h.shape[1],h.shape[2]])),y(4===p.rank,(()=>`Error in fused conv2d: input must be rank 4, but got rank ${p.rank}.`)),y(4===d.rank,(()=>`Error in fused conv2d: filter must be rank 4, but got rank ${d.rank}.`)),Fl("fused conv2d",r,s);const g="NHWC"===i?p.shape[3]:p.shape[1];y(d.shape[2]===g,(()=>`Error in conv2d: depth of input (${g}) must match input depth for filter ${d.shape[2]}.`)),y($l(n,o),(()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`));const m=wl(p.shape,d.shape,n,o,r,s);let b,v;if(null!=a&&(b=uo(a,"bias","fused conv2d"),[b]=Vi(b,h),"NHWC"===i?ba(m.outShape,b.shape):(y(b.shape.length<=1,(()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${b.shape.length}.`)),y(0===b.shape.length||b.shape[0]===m.outChannels||1===b.shape[0],(()=>`Error in fused conv2d: bias shape (${b.shape}) is not compatible with the number of output channels (${m.outChannels})`)))),null!=u){const t=u.shape;if(y(t.length<=1||3===t.length,(()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${t.length}.`)),1===t.length)y(1===t[0]||t[0]===m.outChannels,(()=>`Error in fused conv2d: PReLU activation weights (${t}) is not compatible with the number of output channels (${m.outChannels}).`));else if(3===t.length)try{ba(t,m.outShape)}catch(_){const e=`Error in fused conv2d: PReLU activation weights (${t}) is not compatible with the output shape of the conv2d (${m.outShape}).`;throw Error(e)}v=uo(u,"prelu weights","fused conv2d")}const w=(t,e)=>{y("NHWC"===i,(()=>`Error in gradient of fused conv2D: got dataFormat of ${i} but only NHWC is currently supported.`));const[s,a,u,c]=e,h=hd(t,u,l);y(Rl(o),(()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${o}'`));const d=mu(a.shape,h,s,n,r),p=sd(a,h,s.shape,n,r),f=[d,p];if(null!=c){const t=dd(c,h);f.push(t)}return f},x={x:p,filter:d,bias:b,preluActivationWeights:v},k={strides:n,pad:r,dataFormat:i,dilations:o,dimRoundingMode:s,activation:l,leakyreluAlpha:c};if(null==a){const t=Zs(((t,e,n)=>{let r=Qi.runKernel(_r,x,k);return n([e,t,r]),f&&(r=Pl(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:w}}));return t(p,d)}{const t=Zs(((t,e,n,r)=>{let i=Qi.runKernel(_r,x,k);return r([e,t,i,n]),f&&(i=Pl(i,[i.shape[1],i.shape[2],i.shape[3]])),{value:i,gradFunc:w}}));return t(p,d,b)}}const md=po({fusedConv2d_:gd});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function yd(t,e,n,r,i,o=[1,1],s){let a=t;3===t.rank&&(a=Pl(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;3===l.rank&&(l=Pl(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={x:a,dy:l},c={strides:r,pad:i,dimRoundingMode:s,dilations:o,filterShape:n};return Qi.runKernel(ee,u,c)}const bd=po({depthwiseConv2dNativeBackpropFilter_:yd});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function vd(t,e,n,r,i,o=[1,1],s){let a=e,l=!1;3===e.rank&&(l=!0,a=Pl(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={dy:a,filter:n},c={strides:r,pad:i,dimRoundingMode:s,dilations:o,inputShape:t},h=Qi.runKernel(ne,u,c);return l?Pl(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const wd=po({depthwiseConv2dNativeBackpropInput_:vd});
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function xd({a:t,b:e,transposeA:n=!1,transposeB:r=!1,bias:i,activation:o="linear",preluActivationWeights:s,leakyreluAlpha:a=.2}){if(!1===fd(Qi.state.gradientDepth,o)){let l=wc(t,e,n,r);return null!=i&&(l=Ls(l,i)),pd(l,o,s,a)}let l=uo(t,"a","fused matMul"),u=uo(e,"b","fused matMul");[l,u]=Vi(l,u);const c=n?l.shape[l.rank-2]:l.shape[l.rank-1],h=r?u.shape[u.rank-1]:u.shape[u.rank-2],d=n?l.shape[l.rank-1]:l.shape[l.rank-2],p=r?u.shape[u.rank-2]:u.shape[u.rank-1],f=l.shape.slice(0,-2),g=u.shape.slice(0,-2),m=w(f),b=w(g);y(c===h,(()=>`Error in fused matMul: inner shapes (${c}) and (${h}) of Tensors with shapes ${l.shape} and ${u.shape} and transposeA=${n} and transposeB=${r} must match.`));const v=ba(l.shape.slice(0,-2),u.shape.slice(0,-2)),x=v.concat([d,p]),k=Pl(l,n?[m,c,d]:[m,d,c]),_=Pl(u,r?[b,p,h]:[b,h,p]);let I,C;null!=i&&(I=uo(i,"bias","fused matMul"),[I]=Vi(I,l),ba(x,I.shape)),null!=s&&(C=uo(s,"prelu weights","fused matMul"));const S=(t,e)=>{const[s,a,l,u]=e,c=hd(Pl(t,l.shape),l,o);let h,d;if(n||r?!n&&r?(h=wc(c,a,!1,!1),d=wc(c,s,!0,!1)):n&&!r?(h=wc(a,c,!1,!0),d=wc(s,c,!1,!1)):(h=wc(a,c,!0,!0),d=wc(c,s,!0,!0)):(h=wc(c,a,!1,!0),d=wc(s,c,!0,!1)),null!=i){const t=dd(u,c);return[h,d,t]}return[h,d]},T={a:k,b:_,bias:I,preluActivationWeights:C},E={transposeA:n,transposeB:r,activation:o,leakyreluAlpha:a};if(null==i){const t=Zs(((t,e,n)=>{const r=Qi.runKernel(kr,T,E);return n([t,e,r]),{value:Pl(r,x),gradFunc:S}}));return t(k,_)}{const t=Zs(((t,e,n,r)=>{const i=Qi.runKernel(kr,T,E);return r([t,e,i,n]),{value:Pl(i,x),gradFunc:S}}));return t(k,_,I)}}const kd=po({fusedMatMul_:xd});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function _d(t,e,n){if(v(t),null!=e&&2!==e.length)throw new Error("tensor2d() requires shape to have two numbers");const r=so(t,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return mo(t,e,r,n)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Id(t,e,n,r,i="bilinear",o=0){const s=uo(t,"image","cropAndResize"),a=uo(e,"boxes","cropAndResize","float32"),l=uo(n,"boxInd","cropAndResize","int32"),u=a.shape[0];y(4===s.rank,(()=>`Error in cropAndResize: image must be rank 4,but got rank ${s.rank}.`)),y(2===a.rank&&4===a.shape[1],(()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${a.shape}.`)),y(1===l.rank&&l.shape[0]===u,(()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${a.shape}.`)),y(2===r.length,(()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`)),y(r[0]>=1&&r[1]>=1,(()=>`cropSize must be atleast [1,1], but was ${r}`)),y("bilinear"===i||"nearest"===i,(()=>`method must be bilinear or nearest, but was ${i}`));const c={image:s,boxes:a,boxInd:l},h={method:i,extrapolationValue:o,cropSize:r},d=Qi.runKernel(Jt,c,h);return d}const Cd=po({cropAndResize_:Id});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Sd(t){const e=uo(t,"image","flipLeftRight","float32");y(4===e.rank,(()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`));const n={image:e},r=Qi.runKernel(ve,n,{});return r}const Td=po({flipLeftRight_:Sd});
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Ed(t){const e=uo(t,"image","grayscaleToRGB"),n=e.rank-1,r=e.shape[n];y(e.rank>=2,(()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`)),y(1===r,(()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`));const i=new Array(e.rank);return i.fill(1,0,n),i[n]=3,Lu(e,i)}const Nd=po({grayscaleToRGB_:Ed});
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Ad(t,...e){const n=e.map(((t,e)=>uo(t,`tensors${e}`,"einsum"))),r={equation:t};return Qi.runKernel(ue,n,r)}const Rd=po({einsum_:Ad});
/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function $d(t){const e=uo(t,"image","RGBToGrayscale"),n=e.rank-1,r=e.shape[n];y(e.rank>=2,(()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`)),y(3===r,(()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${r}.`));const i=e.dtype,o=$s(e,"float32"),s=Dh([.2989,.587,.114]);let a;switch(e.rank){case 2:a=Rd("ij,j->i",o,s);break;case 3:a=Rd("ijk,k->ij",o,s);break;case 4:a=Rd("ijkl,l->ijk",o,s);break;case 5:a=Rd("ijklm,m->ijkl",o,s);break;case 6:a=Rd("ijklmn,n->ijklm",o,s);break;default:throw new Error("Not a valid tensor rank.")}return a=Mu(a,-1),$s(a,i)}const Dd=po({rgbToGrayscale_:$d});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Od(t,e,n=0,r=.5){const i=uo(t,"image","rotateWithOffset","float32");y(4===i.rank,(()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${i.rank}.`));const o={image:i},s={radians:e,fillValue:n,center:r},a=Qi.runKernel(xr,o,s);return a}const Fd=po({rotateWithOffset_:Od});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Md(t,e,n,r,i,o){null==r&&(r=.5),null==i&&(i=Number.NEGATIVE_INFINITY),null==o&&(o=0);const s=t.shape[0];return n=Math.min(n,s),y(0<=r&&r<=1,(()=>`iouThreshold must be in [0, 1], but was '${r}'`)),y(2===t.rank,(()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`)),y(4===t.shape[1],(()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`)),y(1===e.rank,(()=>"scores must be a 1D tensor")),y(e.shape[0]===s,(()=>`scores has incompatible shape with boxes. Expected ${s}, but was ${e.shape[0]}`)),y(0<=o&&o<=1,(()=>`softNmsSigma must be in [0, 1], but was '${o}'`)),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:o}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Pd(t,e,n,r=.5,i=Number.NEGATIVE_INFINITY){const o=uo(t,"boxes","nonMaxSuppression","float32"),s=uo(e,"scores","nonMaxSuppression","float32"),a=Md(o,s,n,r,i);n=a.maxOutputSize,r=a.iouThreshold,i=a.scoreThreshold;const l={maxOutputSize:n,iouThreshold:r,scoreThreshold:i};return Qi.runKernel(ln,{boxes:o,scores:s},l)}const Ld=po({nonMaxSuppression_:Pd});
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function zd(t,e,n){const r=Bd(t,e,n),i=r<0?-(r+1):r;t.splice(i,0,e)}function Bd(t,e,n){return Ud(t,e,n||Wd)}function Wd(t,e){return t>e?1:t<e?-1:0}function Ud(t,e,n){let r=0,i=t.length,o=0,s=!1;while(r<i){o=r+(i-r>>>1);const a=n(e,t[o]);a>0?r=o+1:(i=o,s=!a)}return s?r:-r-1}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Vd(t,e,n,r,i){return Gd(t,e,n,r,i,0)}function jd(t,e,n,r,i,o){return Gd(t,e,n,r,i,0,!1,o,!0)}function Hd(t,e,n,r,i,o){return Gd(t,e,n,r,i,o,!0)}function Gd(t,e,n,r,i,o,s=!1,a=!1,l=!1){const u=[];for(let m=0;m<e.length;m++)e[m]>i&&u.push({score:e[m],boxIndex:m,suppressBeginIndex:0});u.sort(Xd);const c=o>0?-.5/o:0,h=[],d=[];while(h.length<n&&u.length>0){const e=u.pop(),{score:n,boxIndex:o,suppressBeginIndex:s}=e;if(n<i)break;let a=!1;for(let l=h.length-1;l>=s;--l){const n=qd(t,o,h[l]);if(n>=r){a=!0;break}if(e.score=e.score*Kd(r,c,n),e.score<=i)break}e.suppressBeginIndex=h.length,a||(e.score===n?(h.push(o),d.push(e.score)):e.score>i&&zd(u,e,Xd))}const p=h.length,f=n-p;a&&f>0&&(h.push(...new Array(f).fill(0)),d.push(...new Array(f).fill(0)));const g={selectedIndices:h};return s&&(g["selectedScores"]=d),l&&(g["validOutputs"]=p),g}function qd(t,e,n){const r=t.subarray(4*e,4*e+4),i=t.subarray(4*n,4*n+4),o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),u=Math.min(i[0],i[2]),c=Math.min(i[1],i[3]),h=Math.max(i[0],i[2]),d=Math.max(i[1],i[3]),p=(a-o)*(l-s),f=(h-u)*(d-c);if(p<=0||f<=0)return 0;const g=Math.max(o,u),m=Math.max(s,c),y=Math.min(a,h),b=Math.min(l,d),v=Math.max(y-g,0)*Math.max(b-m,0);return v/(p+f-v)}function Kd(t,e,n){const r=Math.exp(e*n*n);return n<=t?r:0}function Xd(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
async function Yd(t,e,n,r=.5,i=Number.NEGATIVE_INFINITY){const o=uo(t,"boxes","nonMaxSuppressionAsync"),s=uo(e,"scores","nonMaxSuppressionAsync"),a=Md(o,s,n,r,i);n=a.maxOutputSize,r=a.iouThreshold,i=a.scoreThreshold;const l=await Promise.all([o.data(),s.data()]),u=l[0],c=l[1],{selectedIndices:h}=Vd(u,c,n,r,i);return o!==t&&o.dispose(),s!==e&&s.dispose(),Dh(h,"int32")}const Jd=Yd;
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Zd(t,e,n,r=.5,i=Number.NEGATIVE_INFINITY,o=0){const s=uo(t,"boxes","nonMaxSuppression"),a=uo(e,"scores","nonMaxSuppression"),l=Md(s,a,n,r,i,o);n=l.maxOutputSize,r=l.iouThreshold,i=l.scoreThreshold,o=l.softNmsSigma;const u={boxes:s,scores:a},c={maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:o},h=Qi.runKernel(cn,u,c);return{selectedIndices:h[0],selectedScores:h[1]}}const Qd=po({nonMaxSuppressionWithScore_:Zd});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
async function tp(t,e,n,r=.5,i=Number.NEGATIVE_INFINITY,o=0){const s=uo(t,"boxes","nonMaxSuppressionAsync"),a=uo(e,"scores","nonMaxSuppressionAsync"),l=Md(s,a,n,r,i,o);n=l.maxOutputSize,r=l.iouThreshold,i=l.scoreThreshold,o=l.softNmsSigma;const u=await Promise.all([s.data(),a.data()]),c=u[0],h=u[1],{selectedIndices:d,selectedScores:p}=Hd(c,h,n,r,i,o);return s!==t&&s.dispose(),a!==e&&a.dispose(),{selectedIndices:Dh(d,"int32"),selectedScores:Dh(p)}}const ep=tp;
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function np(t,e,n,r=.5,i=Number.NEGATIVE_INFINITY,o=!1){const s=uo(t,"boxes","nonMaxSuppression"),a=uo(e,"scores","nonMaxSuppression"),l=Md(s,a,n,r,i,null),u=l.maxOutputSize,c=l.iouThreshold,h=l.scoreThreshold,d={boxes:s,scores:a},p={maxOutputSize:u,iouThreshold:c,scoreThreshold:h,padToMaxOutputSize:o},f=Qi.runKernel(un,d,p);return{selectedIndices:f[0],validOutputs:f[1]}}const rp=po({nonMaxSuppressionPadded_:np});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
async function ip(t,e,n,r=.5,i=Number.NEGATIVE_INFINITY,o=!1){const s=uo(t,"boxes","nonMaxSuppressionAsync"),a=uo(e,"scores","nonMaxSuppressionAsync"),l=Md(s,a,n,r,i,null),u=l.maxOutputSize,c=l.iouThreshold,h=l.scoreThreshold,[d,p]=await Promise.all([s.data(),a.data()]),{selectedIndices:f,validOutputs:g}=jd(d,p,u,c,h,o);return s!==t&&s.dispose(),a!==e&&a.dispose(),{selectedIndices:Dh(f,"int32"),validOutputs:Qs(g,"int32")}}const op=ip;
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function sp(t,e,n=!1,r=!1){const i=uo(t,"images","resizeBilinear");y(3===i.rank||4===i.rank,(()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${i.rank}.`)),y(2===e.length,(()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`)),y(!1===r||!1===n,(()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false."));let o=i,s=!1;3===i.rank&&(s=!0,o=Pl(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const[]=e,a={images:o},l={alignCorners:n,halfPixelCenters:r,size:e},u=Qi.runKernel(En,a,l);return s?Pl(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const ap=po({resizeBilinear_:sp});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function lp(t,e,n=!1,r=!1){const i=uo(t,"images","resizeNearestNeighbor");y(3===i.rank||4===i.rank,(()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${i.rank}.`)),y(2===e.length,(()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`)),y("float32"===i.dtype||"int32"===i.dtype,(()=>"`images` must have `int32` or `float32` as dtype")),y(!1===r||!1===n,(()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false."));let o=i,s=!1;3===i.rank&&(s=!0,o=Pl(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const[]=e,a={images:o},l={alignCorners:n,halfPixelCenters:r,size:e},u=Qi.runKernel(Sn,a,l);return s?Pl(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const up=po({resizeNearestNeighbor_:lp});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function cp(t,e,n){const r=uo(t,"x","bincount"),i=uo(e,"weights","bincount");y("int32"===r.dtype,(()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`)),y(n>=0,(()=>`size must be non-negative, but got ${n}.`)),y(i.size===r.size||0===i.size,(()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${i.shape}.`));const o={x:r,weights:i},s={size:n};return Qi.runKernel(Rt,o,s)}const hp=po({bincount_:cp});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function dp(t,e){let n=uo(t,"a","lessEqual","string_or_numeric"),r=uo(e,"b","lessEqual","string_or_numeric");[n,r]=Vi(n,r),ba(n.shape,r.shape);const i={a:n,b:r};return Qi.runKernel(Fe,i)}const pp=po({lessEqual_:dp});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function fp(t){const e=uo(t,"x","round"),n={x:e};return Qi.runKernel($n,n)}const gp=po({round_:fp});
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function mp(t,e="binary",n=!1,r=.5){const i=uo(t,"image","threshold"),o=.2989,s=.587,a=.114,l=i.shape[0]*i.shape[1];let u,c,h,d,p=js(Dh([r]),255);if(y(3===i.rank,(()=>`Error in threshold: image must be rank 3,but got rank ${i.rank}.`)),y(3===i.shape[2]||1===i.shape[2],(()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${i.shape[2]}.`)),y("int32"===i.dtype||"float32"===i.dtype,(()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${i.dtype}.`)),y("otsu"===e||"binary"===e,(()=>`Method must be binary or otsu, but was ${e}`)),3===i.shape[2]){[u,c,h]=Sh(i,[1,1,1],-1);const t=js(u,o),e=js(c,s),n=js(h,a);d=Ls(Ls(t,e),n)}else d=t;if("otsu"===e){const t=hp($s(gp(d),"int32"),yo([]),256);p=yp(t,l)}const f=n?pp(d,p):Gu(d,p),g=$s(js(f,255),"int32");return g}function yp(t,e){let n,r,i,o,s,a,l=Dh([-1]),u=Dh([0]),c=Dh([0]);for(let h=0;h<t.size-1;h++){n=dh(t,0,h+1),r=dh(t,h+1),s=Us(ic(n),e),a=Us(ic(r),e);const d=ic(js(n,th(0,n.size)));i=Us(d,ic(n));const p=aa(r.shape,n.size),f=Ls(th(0,r.size),p),g=js(r,f);o=Us(ic(g),ic(r));const m=da(i,o),y=da(i,o),b=js(s,a);c=js(js(b,m),y);const v=Gu(c,u);u=Wh(v,c,u),l=Wh(v,Dh([h]),l)}return l}const bp=po({threshold_:mp});
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function vp(t,e,n="nearest",r="constant",i=0,o){const s=uo(t,"image","transform","float32"),a=uo(e,"transforms","transform","float32");y(4===s.rank,(()=>`Error in transform: image must be rank 4,but got rank ${s.rank}.`)),y(2===a.rank&&(a.shape[0]===s.shape[0]||1===a.shape[0])&&8===a.shape[1],(()=>"Error in transform: Input transform should be batch x 8 or 1 x 8")),y(null==o||2===o.length,(()=>`Error in transform: outputShape must be [height, width] or null, but got ${o}.`));const l={image:s,transforms:a},u={interpolation:n,fillMode:r,fillValue:i,outputShape:o};return Qi.runKernel(pr,l,u)}const wp=po({transform_:vp});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function xp(t,e){let n=uo(t,"a","less","string_or_numeric"),r=uo(e,"b","less","string_or_numeric");[n,r]=Vi(n,r),ba(n.shape,r.shape);const i={a:n,b:r};return Qi.runKernel(Oe,i)}const kp=po({less_:xp});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function _p(t,e,n){const r=uo(t,"a","bandPart");y(r.rank>=2,(()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`));const i=r.shape,[o,s]=r.shape.slice(-2);let a,l;"number"===typeof e?(y(e%1===0,(()=>`bandPart(): numLower must be an integer, got ${e}.`)),y(e<=o,(()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${o}).`)),a=uo(e<0?o:e,"numLower","bandPart")):(y("int32"===e.dtype,(()=>"bandPart(): numLower's dtype must be an int32.")),a=Wh(kp(e,0),o,Ac(e,o))),"number"===typeof n?(y(n%1===0,(()=>`bandPart(): numUpper must be an integer, got ${n}.`)),y(n<=s,(()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${s}).`)),l=uo(n<0?s:n,"numUpper","bandPart")):(y("int32"===n.dtype,(()=>"bandPart(): numUpper's dtype must be an int32.")),l=Wh(kp(n,0),s,Ac(n,s)));const u=Pl(th(0,o,1,"int32"),[-1,1]),c=th(0,s,1,"int32"),h=da(u,c),d=bc(pp(h,a),Ku(h,Oc(l))),p=zc([o,s],r.dtype);return Pl(Ah(Lh(Pl(r,[-1,o,s])).map((t=>Wh(d,t,p)))),i)}const Ip=po({bandPart_:_p});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Cp(t,e="euclidean",n=null,r=!1){t=uo(t,"x","norm");const i=Sp(t,e,n);let o=i.shape;if(r){const e=T(n,t.shape);o=cc(i.shape,e)}return Pl(i,o)}function Sp(t,e,n=null){if(0===t.rank)return ga(t);if(1!==t.rank&&null===n)return Sp(Pl(t,[-1]),e,n);if(1===t.rank||"number"===typeof n||Array.isArray(n)&&1===n.length){if(1===e)return ic(ga(t),n);if(e===1/0)return nc(ga(t),n);if(e===-1/0)return Ec(ga(t),n);if("euclidean"===e||2===e)return Gs(ic(ca(ga(t),Qs(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&2===n.length){if(1===e)return nc(ic(ga(t),n[0]),n[1]-1);if(e===1/0)return nc(ic(ga(t),n[1]),n[0]);if(e===-1/0)return Ec(ic(ga(t),n[1]),n[0]);if("fro"===e||"euclidean"===e)return Gs(ic(Ks(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const Tp=po({norm_:Cp});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Ep(t){let e;if(Array.isArray(t)){e=!1,y(null!=t&&t.length>0,(()=>"Gram-Schmidt process: input must not be null, undefined, or empty"));const n=t[0].shape[0];for(let e=1;e<t.length;++e)y(t[e].shape[0]===n,(()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[e].shape[0]} vs. ${n})`))}else e=!0,t=Sh(t,t.shape[0],0).map((t=>Eh(t,[0])));y(t.length<=t[0].shape[0],(()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`));const n=[],r=t;for(let i=0;i<t.length;++i)n.push(Qi.tidy((()=>{let t=r[i];if(i>0)for(let e=0;e<i;++e){const r=js(ic(js(n[e],t)),n[e]);t=da(t,r)}return Us(t,Tp(t,"euclidean"))})));return e?Ah(n,0):n}const Np=po({gramSchmidt_:Ep});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Ap(t,e=!1){if(y(t.rank>=2,(()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`)),2===t.rank)return Rp(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce(((t,e)=>t*e)),r=Lh(Pl(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),i=[],o=[];r.forEach((t=>{const[n,r]=Rp(t,e);i.push(n),o.push(r)}));const s=Pl(Ah(i,0),t.shape),a=Pl(Ah(o,0),t.shape);return[s,a]}}function Rp(t,e=!1){return Qi.tidy((()=>{y(2===t.shape.length,(()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`));const n=t.shape[0],r=t.shape[1];let i=Bu(n),o=Os(t);const s=_d([[1]],[1,1]);let a=Os(s);const l=n>=r?r:n;for(let t=0;t<l;++t){const e=o,l=a,u=i;[a,o,i]=Qi.tidy((()=>{const e=dh(o,[t,t],[n-t,1]),l=Tp(e),u=dh(o,[t,t],[1,1]),c=Wh(Gu(u,0),_d([[-1]]),_d([[1]])),h=da(u,js(c,l)),d=Us(e,h);a=1===d.shape[0]?Os(s):nu([s,dh(d,[1,0],[d.shape[0]-1,d.shape[1]])],0);const p=Oc(Us(wc(c,h),l)),f=dh(o,[t,0],[n-t,r]),g=js(p,a),m=qh(a);if(0===t)o=da(f,wc(g,wc(m,f)));else{const e=da(f,wc(g,wc(m,f)));o=nu([dh(o,[0,0],[t,r]),e],0)}const y=qh(g),b=dh(i,[0,t],[n,i.shape[1]-t]);if(0===t)i=da(b,wc(wc(b,a),y));else{const e=da(b,wc(wc(b,a),y));i=nu([dh(i,[0,0],[n,t]),e],1)}return[a,o,i]})),Co([e,l,u])}return!e&&n>r&&(i=dh(i,[0,0],[n,r]),o=dh(o,[0,0],[r,r])),[i,o]}))}const $p=po({qr_:Ap});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
var Dp;(function(t){t[t["NONE"]=0]="NONE",t[t["MEAN"]=1]="MEAN",t[t["SUM"]=2]="SUM",t[t["SUM_BY_NONZERO_WEIGHTS"]=3]="SUM_BY_NONZERO_WEIGHTS"})(Dp||(Dp={}));
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Op(t,e){let n=uo(t,"a","squaredDifference"),r=uo(e,"b","squaredDifference");[n,r]=Vi(n,r),ba(n.shape,r.shape);const i={a:n,b:r},o={};return Qi.runKernel(er,i,o)}const Fp=po({squaredDifference_:Op});const Mp={flipLeftRight:Td,grayscaleToRGB:Nd,resizeNearestNeighbor:up,resizeBilinear:ap,rgbToGrayscale:Dd,rotateWithOffset:Fd,cropAndResize:Cd,nonMaxSuppression:Ld,nonMaxSuppressionAsync:Jd,nonMaxSuppressionWithScore:Qd,nonMaxSuppressionWithScoreAsync:ep,nonMaxSuppressionPadded:rp,nonMaxSuppressionPaddedAsync:op,threshold:bp,transform:wp},Pp={bandPart:Ip,gramSchmidt:Np,qr:$p};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Lp{static sgd(t){return new ka(t)}static momentum(t,e,n=!1){return new _a(t,e,n)}static rmsprop(t,e=.9,n=0,r=null,i=!1){return new Ia(t,e,n,r,i)}static adam(t=.001,e=.9,n=.999,r=null){return new pa(t,e,n,r)}static adadelta(t=.001,e=.95,n=null){return new sa(t,e,n)}static adamax(t=.002,e=.9,n=.999,r=null,i=0){return new xa(t,e,n,r,i)}static adagrad(t,e=.1){return new la(t,e)}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const zp=Lp;n(88);
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const Bp=(()=>"undefined"!==typeof requestAnimationFrame?requestAnimationFrame:"undefined"!==typeof setImmediate?setImmediate:t=>t())();function Wp(){return new Promise((t=>Bp((()=>t()))))}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Up(t,e){const n=t[0].length;t.forEach(((t,e)=>{y(t.length===n,(()=>`Error in concat${n}D: rank of tensors[${e}] must be the same as the rank of the rest (${n})`))})),y(e>=0&&e<n,(()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`));const r=t[0];t.forEach(((t,i)=>{for(let o=0;o<n;o++)y(o===e||t[o]===r[o],(()=>`Error in concat${n}D: Shape of tensors[${i}] (${t}) does not match the shape of the rest (${r}) along the non-concatenated axis ${i}.`))}))}function Vp(t,e){const n=t[0].slice();for(let r=1;r<t.length;r++)n[e]+=t[r][e];return n}
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
var jp;function Hp(t,e,n){let r=new Array;if(null==n&&null==e)return r;if(null==e)while(r.length<t+n.length)r.push(-1);else r=e.slice();if(null==n)return r;if(t+n.length!==r.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${r.length}`);for(let i=1;i<n.length;++i){const o=n[i],s=r[r.length-n.length+i],a=r[s];if(o>=0)if(a>=0){if(a!==o)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${i+t}] = ${o} but shape[${i+t}] = ${a}`)}else r[s]=o}return r}function Gp(t){const e={FIRST_DIM_SIZE:jp.FIRST_DIM_SIZE,VALUE_ROWIDS:jp.VALUE_ROWIDS,ROW_LENGTHS:jp.ROW_LENGTHS,ROW_SPLITS:jp.ROW_SPLITS,ROW_LIMITS:jp.ROW_LIMITS,ROW_STARTS:jp.ROW_STARTS},n=[];for(const r of t){if(!(r in e))break;n.push(e[r])}return n}function qp(t){return 0===t.length?0:t[0]===jp.FIRST_DIM_SIZE?t.length-1:t.length}function Kp(t,e){if(null==t||null==e)return;const n=t.length,r=e.length;if(n>=r)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${r})`);for(let i=0;i<Math.min(n,r-1);++i){const n=t[i],r=e[i+1];if(n>=0&&r>=0&&1!==n&&n!==r)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${i-t.length}] = ${n} but ragged tensor input.flatValues.shape[${i-t.length}] = ${r}`)}}(function(t){t[t["FIRST_DIM_SIZE"]=0]="FIRST_DIM_SIZE",t[t["VALUE_ROWIDS"]=1]="VALUE_ROWIDS",t[t["ROW_LENGTHS"]=2]="ROW_LENGTHS",t[t["ROW_SPLITS"]=3]="ROW_SPLITS",t[t["ROW_LIMITS"]=4]="ROW_LIMITS",t[t["ROW_STARTS"]=5]="ROW_STARTS"})(jp||(jp={}));
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const Xp=30;function Yp(t){return t<=Xp?t:W(t,Math.floor(Math.sqrt(t)))}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Jp(t,e,n){const r=n*("number"===typeof t?t:t[0]),i=e*("number"===typeof t?t:t[1]);return[r,i]}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Zp(t,e,n,r=!0){let i=[];if(r)i=i.concat(e.slice(0)),i.push(t[0]/n),i=i.concat(t.slice(1));else{i=i.concat(t[0]);const n=e.length;for(let r=0;r<n;++r)i=i.concat([t[r+1]/e[r],e[r]]);i=i.concat(t.slice(n+1))}return i}function Qp(t,e,n=!0){const r=[];if(n){r.push(e);for(let n=e+1;n<t;++n)n<=2*e?(r.push(n),r.push(n-(e+1))):r.push(n)}else{const n=[],i=[];for(let r=1;r<t;++r)r>=2*e+1||r%2===1?i.push(r):n.push(r);r.push(...n),r.push(0),r.push(...i)}return r}function tf(t,e,n,r=!0){const i=[];r?i.push(t[0]/n):i.push(t[0]*n);for(let o=1;o<t.length;++o)o<=e.length?r?i.push(e[o-1]*t[o]):i.push(t[o]/e[o-1]):i.push(t[o]);return i}function ef(t,e){const n=[0];for(let r=0;r<e;++r)n.push(t[r][0]);return n}function nf(t,e,n){const r=t.slice(0,1);for(let i=0;i<n;++i)r.push(t[i+1]-e[i][0]-e[i][1]);return r}function rf(t,e){const n=t.shape.length,r=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if("int32"!==e.dtype)throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[r-1]} vs. ${n}`);if(0===w(t.shape))throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const i=e.shape,o=i[i.length-1];let s=1;for(let h=0;h<i.length-1;++h)s*=i[h];const a=t.shape,l=i.slice();l.pop();let u=1;for(let h=o;h<n;++h)u*=a[h],l.push(a[h]);const c=[...U(t.shape).map((t=>t/u)),1].slice(0,o);return[l,s,u,c]}function of(t,e,n){const r=e.rank>1?e.shape[e.rank-1]:1,i=e.rank>1?e.rank-1:1,o=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${r}, and batchDim: ${i}.`;if(n.rank<i)throw new Error(o+` update.rank < ${i}. `);if(t.length<r+(n.rank-i))throw new Error(o+` Output shape length < ${r+(n.rank-i)}`);if(n.rank!==i+t.length-r)throw new Error(o+" update.rank != "+(i+t.length-r));for(let s=0;s<i;++s)if(n.shape[s]!==e.shape[s])throw new Error(o+` updates.shape[${s}] (${n.shape[s]}) != indices.shape[${s}] (${e.shape[s]}).`);for(let s=0;s<n.rank-i;++s)if(n.shape[s+i]!==t[s+r])throw new Error(o+` updates.shape[${s+i}] (${n.shape[s+i]}) != shape[${s+i}] (${t[s+i]})`)}function sf(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if("int32"!==e.dtype)throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(0===n.length){if(0===e.size)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(0===t.size)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}of(n,e,t)}function af(t,e,n){const r=e.shape.length,i=r>1?e.shape[r-1]:1,o=n.length;let s=1;for(let h=i;h<o;++h)s*=n[h];const a=i<1?1:i,l=w(e.shape)/a,u=[...U(n.slice(0,i)),1],c=w(n);return{sliceRank:i,numUpdates:l,sliceSize:s,strides:u,outputSize:c}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const lf=1.7580993408473768,uf=1.0507009873554805,cf=.3275911,hf=.254829592,df=-.284496736,pf=1.421413741,ff=-1.453152027,gf=1.061405429;
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function mf(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(2*t.length);for(let r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function yf(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}function bf(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let i=0;i<t.length;i+=4)n[Math.floor(i/4)]=t[i],r[Math.floor(i/4)]=t[i+1];return{real:n,imag:r}}function vf(t){const e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let i=2;i<t.length;i+=4)n[Math.floor(i/4)]=t[i],r[Math.floor(i/4)]=t[i+1];return{real:n,imag:r}}function wf(t,e){const n=t[2*e],r=t[2*e+1];return{real:n,imag:r}}function xf(t,e,n,r){t[2*r]=e,t[2*r+1]=n}function kf(t,e){const n=new Float32Array(t/2),r=new Float32Array(t/2);for(let i=0;i<Math.ceil(t/2);i++){const o=(e?2:-2)*Math.PI*(i/t);n[i]=Math.cos(o),r[i]=Math.sin(o)}return{real:n,imag:r}}function _f(t,e,n){const r=(n?2:-2)*Math.PI*(t/e),i=Math.cos(r),o=Math.sin(r);return{real:i,imag:o}}
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const If="->",Cf=/->/g,Sf=",",Tf="...";function Ef(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace(Cf,"").length)/If.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${If}").`);const[r,i]=t.split(If);y(-1===r.indexOf(Tf),(()=>`The ellipsis notation ("${Tf}") is not supported yet.`));const o=r.split(Sf),s=o.length;if(e!==s)throw new Error(`Expected ${s} input tensors, received ${e}`);if(s>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let d=0;d<i.length;++d){const t=i[d];if(!o.some((e=>-1!==e.indexOf(t))))throw new Error(`Output subscripts contain the label ${t} not present in the input subscripts.`);-1===a.indexOf(t)&&a.push(t)}for(let d=0;d<r.length;++d){const t=r[d];-1===a.indexOf(t)&&t!==Sf&&a.push(t)}const l=new Array(o.length);for(let d=0;d<s;++d){if(new Set(o[d].split("")).size!==o[d].length)throw new Error(`Found duplicate axes in input component ${o[d]}. Support for duplicate axes in input is not implemented yet.`);l[d]=[];for(let t=0;t<o[d].length;++t)l[d].push(a.indexOf(o[d][t]))}const u=a.length,c=i.length,h=[];for(let d=c;d<u;++d)h.push(d);return{allDims:a,summedDims:h,idDims:l}}function Nf(t,e){let n=new Array(t);n.fill(-1);for(let i=0;i<e.length;++i)n[e[i]]=i;const r=[];for(let i=0;i<t;++i)-1===n[i]&&r.push(i);return n=n.filter((t=>-1!==t)),{permutationIndices:n,expandDims:r}}function Af(t,e,n){const r=new Array(t);for(let i=0;i<n.length;++i){const t=n[i].shape;for(let n=0;n<e[i].length;++n)void 0===r[e[i][n]]?r[e[i][n]]=t[n]:y(r[e[i][n]]===t[n],(()=>`Expected dimension ${r[e[i][n]]} at axis ${n} of input shaped ${JSON.stringify(t)}, but got dimension ${t[n]}`))}}function Rf(t,e){const n=t,r=[];let i=0;0===t.length&&n.push(-1),i=t.length+1;for(let s=0;s<i;++s)r.push([]);const o=[];for(let s=0;s<n.length;++s){const t=n[s],i=Df(e,t);for(const e of i)-1===o.indexOf(e)&&(r[s].push(e),o.push(e))}return{path:n,steps:r}}function $f(t){return t.every(((t,e)=>t===e))}function Df(t,e){const n=[];for(let r=0;r<t.length;++r)0!==t[r].length&&-1===t[r].indexOf(e)&&-1!==e||n.push(r);return n}function Of(t,e,n=0){let r=[];if("number"===typeof e)y(t.shape[n]%e===0,(()=>"Number of splits must evenly divide the axis.")),r=new Array(e).fill(t.shape[n]/e);else{const i=e.reduce(((t,e)=>(-1===e&&(t+=1),t)),0);y(i<=1,(()=>"There should be only one negative value in split array."));const o=e.indexOf(-1);if(-1!==o){const r=e.reduce(((t,e)=>e>0?t+e:t));e[o]=t.shape[n]-r}y(t.shape[n]===e.reduce(((t,e)=>t+e)),(()=>"The sum of sizes must match the size of the axis dimension.")),r=e}return r}
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Ff(t){return`Received SparseTensor with denseShape[0] = 0 but\n  indices.shape[0] = ${t}`}function Mf(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function Pf(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Lf(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function zf(t,e){return`size ${t} must be non-negative, not ${e}`}function Bf(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function Wf(t,e){const n=w(t),r=w(e);return`Input to reshape is a SparseTensor with ${n}\n  dense values, but the requested shape requires a multiple of ${r}. inputShape=${t} outputShape= ${e}`}function Uf(t,e){const n=w(t),r=w(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${r}. inputShape=${t} outputShape=${e}`}
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Vf(){return"segment ids must be >= 0"}function jf(){return"segment ids are not increasing"}function Hf(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function Gf(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function qf(t,e){let n,r=!1;t<=Xp?(n=t,r=!0):n=W(t,Math.floor(Math.sqrt(t)));while(!r)n>e||n===t?r=!0:n=W(t,n+1);return n}function Kf(t,e,n){const r=[],i=t.length;for(let o=0;o<i;o++)o!==e?r.push(t[o]):r.push(n);return r}function Xf(t,e,n,r){const i=e.shape.length,o=t.shape.length;if(0!==r&&(r<-i||r>i))throw new Error(`Expect batchDims in the range of [-${i}, ${i}], but got ${r}`);if(r<0&&(r+=i),r>o)throw new Error(`batchDims (${r}) must be less than rank(x) (\n    ${o}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let h=0;h<r;++h)if(t.shape[h]!==e.shape[h])throw new Error(`x.shape[${h}]: ${t.shape[h]} should be equal to indices.shape[${h}]: ${e.shape[h]}.`);const s=t.shape[n],a=[];let l=1,u=1,c=1;for(let h=0;h<r;++h)a.push(t.shape[h]),l*=t.shape[h];for(let h=r;h<n;h++)a.push(t.shape[h]),u*=t.shape[h];for(let h=r;h<i;h++)a.push(e.shape[h]);for(let h=n+1;h<o;h++)a.push(t.shape[h]),c*=t.shape[h];return{batchSize:l,sliceSize:c,outerSize:u,dimSize:s,outputShape:a}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Yf(t){try{return t.map((t=>si(t)))}catch(JX){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${JX}`)}}function Jf(t){return t.map((t=>oi(t)))}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Zf(t,e){const n=[];for(let o=0;o<e.length;o++)e[o]&&n.push(o);const r=As(t,"int32"),i=As([n.length,t.length],"int32");for(let o=0;o<n.length;o++){const e=r.indexToLoc(n[o]),s=o*t.length;i.values.set(e,s)}return i.toTensor()}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Sa();
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const Qf={kernelName:ht,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>js(t,cd($s(n,"float32"),-1))}}},tg={kernelName:dt,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=Ks($s(n,"float32")),r=Gs(da(Qs(1),e));return Oc(Us(t,r))}}}},eg={kernelName:pt,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=Gs(da(Ks($s(n,"float32")),1));return Us(t,e)}}}},ng={kernelName:ft,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=ba(n.shape,r.shape),o=()=>{let e=t;const r=ya(n.shape,i);return r.length>0&&(e=ic(e,r)),Pl(e,n.shape)},s=()=>{let e=t;const n=ya(r.shape,i);return n.length>0&&(e=ic(e,n)),Pl(e,r.shape)};return{a:o,b:s}}},rg={kernelName:gt,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach(((e,r)=>{n[r]=()=>t.clone()})),n}},ig={kernelName:bt,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ys(n)}}},og={kernelName:vt,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ys(n)}}},sg={kernelName:wt,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Us(t,Gs(da(Qs(1),Ks($s(n,"float32")))))}}},ag={kernelName:xt,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=Gs(Ls(Qs(1),Ks($s(n,"float32"))));return Us(t,e)}}}},lg={kernelName:It,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=ba(n.shape,r.shape),o=()=>{const e=Ls(Ks(n),Ks(r));let o=js(t,Us(r,e));const s=ya(n.shape,i);return s.length>0&&(o=ic(o,s)),Pl(o,n.shape)},s=()=>{const e=Ls(Ks(n),Ks(r));let o=Oc(js(t,Us(n,e)));const s=ya(r.shape,i);return s.length>0&&(o=ic(o,s)),Pl(o,r.shape)};return{a:o,b:s}}},ug={kernelName:kt,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Us(t,Ls(Ks($s(n,"float32")),1))}}},cg={kernelName:_t,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Us(t,da(Qs(1),Ks($s(n,"float32"))))}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function hg(t,e,n,r,i,o){const s=uo(t,"dy","avgPool3dGrad"),a=uo(e,"input","avgPool3dGrad");let l=s,u=a,c=!1;4===a.rank&&(c=!0,l=Pl(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]]),u=Pl(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),y(5===l.rank,(()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`)),y(5===u.rank,(()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${u.rank}.`)),Fl("avgPool3dGrad",i,o);const h={dy:l,input:u},d={filterSize:n,strides:r,pad:i,dimRoundingMode:o},p=Qi.runKernel(Et,h,d);return c?Pl(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const dg=po({avgPool3dGrad_:hg}),pg={kernelName:Tt,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:i,strides:o,pad:s,dimRoundingMode:a}=n;return{x:()=>dg(t,r,i,o,s,a)}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function fg(t,e,n,r,i){const o=uo(t,"dy","avgPoolGrad"),s=uo(e,"input","avgPoolGrad");y(s.rank===o.rank,(()=>`Rank of input (${s.rank}) does not match rank of dy (${o.rank})`));let a=s,l=o,u=!1;3===s.rank&&(u=!0,a=Pl(s,[1,s.shape[0],s.shape[1],s.shape[2]]),l=Pl(o,[1,o.shape[0],o.shape[1],o.shape[2]])),y(4===l.rank,(()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`)),y(4===a.rank,(()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`));const c={dy:l,input:a},h={filterSize:n,strides:r,pad:i},d=Qi.runKernel(St,c,h);return u?Pl(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const gg=po({avgPoolGrad_:fg}),mg={kernelName:Ct,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:i,strides:o,pad:s}=n;return{x:()=>gg(t,r,i,o,s)}}},yg={kernelName:Nt,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[r,i]=e,{transposeA:o,transposeB:s}=n;return o||s?!o&&s?{a:()=>wc(t,i,!1,!1),b:()=>wc(t,r,!0,!1)}:o&&!s?{a:()=>wc(i,t,!1,!0),b:()=>wc(r,t,!1,!1)}:{a:()=>wc(i,t,!0,!0),b:()=>wc(t,r,!0,!0)}:{a:()=>wc(t,i,!1,!0),b:()=>wc(r,t,!0,!1)}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function bg(t,e,n){const r=uo(t,"x","spaceToBatchND");y(r.rank>=1+e.length,(()=>`input rank ${r.rank} should be > than [blockShape] ${e.length}`)),y(n.length===e.length,(()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`)),y(r.shape.reduce(((t,r,i)=>i>0&&i<=e.length?t&&(r+n[i-1][0]+n[i-1][1])%e[i-1]===0:t),!0),(()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`));const i={x:r},o={blockShape:e,paddings:n};return Qi.runKernel(qn,i,o)}const vg=po({spaceToBatchND_:bg}),wg={kernelName:At,gradFunc:(t,e,n)=>{const{blockShape:r,crops:i}=n;return{x:()=>vg(t,r,i)}}},xg={kernelName:Dt,gradFunc:(t,e,n)=>{const r=n,i=r.inputShape,o=r.shape,s=Array.from(o);for(let l=i.length-1;l>=0;l--)if(i[l]===o[l])s[l]=1;else if(1!==i[l])throw new Error(`broadcastTo(): [${i}] cannot be broadcast to [${o}].`);const a=[];for(let l=0;l<s.length;l++)s[l]>1&&a.push(l);return{x:()=>ic(t,a,!0)}}},kg={kernelName:Ft,gradFunc:t=>({x:()=>t.clone()})},_g={kernelName:Mt,gradFunc:t=>({x:()=>Ys(t)})},Ig={kernelName:Pt,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{clipValueMin:i,clipValueMax:o}=n;return{x:()=>Wh(bc(Ku(r,i),pp(r,o)),t,Ys(t))}}},Cg={kernelName:zt,inputsToSave:["x"],gradFunc:Qf.gradFunc},Sg={kernelName:Bt,saveAllInputs:!0,gradFunc:(t,e,n)=>{const r=e.map((t=>t.shape)),{axis:i}=n,o=T(i,e[0].shape)[0],s=r.map((t=>t[o])),a=Sh(t,s,o);return a.map((t=>()=>t))}},Tg={kernelName:Wt,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,i]=e,{dilations:o,strides:s,pad:a,dataFormat:l}=n;return y(Rl(o),(()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${o}'`)),{x:()=>mu(r.shape,t,i,s,a,l),filter:()=>sd(r,t,i.shape,s,a,l)}}},Eg={kernelName:Vt,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[r,i]=e,{strides:o,pad:s,dataFormat:a,dimRoundingMode:l}=n;return{dy:()=>du(t,i,o,s,a,1,l),filter:()=>sd(t,r,i.shape,o,s,a,l)}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Ng(t,e,n,r,i){let o=t;4===t.rank&&(o=Pl(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let s=e;4===s.rank&&(s=Pl(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),y(5===o.rank,(()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${o.shape}.`)),y(5===s.rank,(()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${s.shape}.`)),y(5===n.length,(()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`)),y(o.shape[4]===n[3],(()=>`Error in conv3dDerFilter: depth of input ${o.shape[4]}) must match input depth in filter (${n[3]}.`)),y(s.shape[4]===n[4],(()=>`Error in conv3dDerFilter: depth of dy (${s.shape[4]}) must match output depth for filter (${n[4]}).`));const a={x:o,dy:s},l={strides:r,pad:i,filterShape:n};return Qi.runKernel(Ht,a,l)}const Ag=po({conv3DBackpropFilter_:Ng}),Rg={kernelName:jt,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:i,pad:o}=n;y(Rl(r),(()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`));const[s,a]=e;return{x:()=>ku(s.shape,t,a,i,o),filter:()=>Ag(s,t,a.shape,i,o)}}};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function $g(t){const e=uo(t,"x","sin","float32"),n={x:e};return Qi.runKernel(Bn,n)}const Dg=po({sin_:$g}),Og={kernelName:qt,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>js(Oc(Dg($s(n,"float32"))),t)}}};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Fg(t){const e=uo(t,"x","sinh"),n={x:e};return Qi.runKernel(Wn,n)}const Mg=po({sinh_:Fg}),Pg={kernelName:Kt,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>js(Mg($s(n,"float32")),t)}}};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Lg(t,e=0,n=!1,r=!1){const i=uo(t,"x","cumsum"),o={x:i},s={axis:e,exclusive:n,reverse:r};return Qi.runKernel(Yt,o,s)}const zg=po({cumsum_:Lg}),Bg={kernelName:Yt,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:i,exclusive:o,reverse:s}=n;return{x:()=>{const e=dc([i],r.rank);let n=zg(t,i,o,!s);return null!=e&&(n=qh(n,e)),n}}}},Wg={kernelName:te,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:i,pad:o,dimRoundingMode:s}=n,a=null==r?[1,1]:r;y(Rl(a),(()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`));const[l,u]=e;return y(4===l.rank,(()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`)),y(4===u.rank,(()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${u.rank}.`)),y(l.shape[3]===u.shape[2],(()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${u.shape[2]}.`)),y($l(i,a),(()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${i} and dilations '${a}'.`)),Fl("depthwiseConv2d",o,s),{x:()=>wd(l.shape,t,u,i,o,a,s),filter:()=>bd(l,t,u.shape,i,o,a,s)}}},Ug={kernelName:ie,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,i]=e,o={x:r,filter:i,dy:t},s={x:r,filter:i,dy:t};return{x:()=>Qi.runKernel(oe,o,n),filter:()=>Qi.runKernel(se,s,n)}}},Vg={kernelName:ce,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,r={dy:t,y:n};return{x:()=>Qi.runKernel(he,r)}}},jg={kernelName:de,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=js(Ou(Oc(Ks(n))),2/Math.sqrt(Math.PI));return{x:()=>js(t,r)}}},Hg={kernelName:fe,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>js(t,n)}}},Gg={kernelName:ge,inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>Pl(t,n.shape)}}},qg={kernelName:me,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>js(t,Ou(n))}}},Kg={kernelName:we,gradFunc:t=>({x:()=>Ys(t)})},Xg={kernelName:xe,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=ba(n.shape,r.shape),o=()=>{const e=Us(t,$s(r,"float32")),o=ya(n.shape,i);return o.length>0?Pl(ic(e,o),n.shape):e},s=()=>{let e=js(t,$s(n,"float32"));const o=ya(r.shape,i);o.length>0&&(e=Pl(ic(e,o),r.shape));const s=Ks(r);return Oc(Us(e,$s(s,"float32")))};return{a:o,b:s}}};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Yg(t){const e=uo(t,"x","rsqrt","float32"),n={x:e};return Qi.runKernel(Dn,n)}const Jg=po({rsqrt_:Yg}),Zg={kernelName:ke,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:r}=n,[i,o,s,a]=e,l=null==a?Qs(1):a,u=ya(o.shape,i.shape),c=[];if(1===o.rank){for(let t=0;t<i.shape.length-1;++t)c.push(i.shape[t]);c.push(1)}const h=da(i,o),d=js(t,l),p=Jg(Ls(s,Qs(r))),f=js(js(js(p,p),p),Qs(-.5)),g=()=>1===o.rank?Pl(js(js(t,Lu(Pl(p,[1,1,1,o.shape[0]]),c)),l),i.shape):Pl(js(js(t,p),l),i.shape),m=()=>{let t=js(js(p,Qs(-1)),d);return 1===o.rank&&(t=ic(t,u)),Pl(t,o.shape)},y=()=>{let t=js(js(f,h),d);return 1===o.rank&&(t=ic(t,u)),Pl(t,o.shape)},b=()=>{const e=js(h,p);let n=js(t,e);return 1===o.rank&&(n=ic(n,u)),Pl(n,o.shape)},v=()=>{let e=t;return 1===o.rank&&(e=ic(e,u)),Pl(e,o.shape)};return{x:g,mean:m,variance:y,scale:b,offset:v}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Qg(t,e,n){const r=uo(t,"x","unsortedSegmentSum"),i=uo(e,"segmentIds","unsortedSegmentSum","int32");y(k(n),(()=>"numSegments must be of dtype int"));const o={x:r,segmentIds:i},s={numSegments:n};return Qi.runKernel(yr,o,s)}const tm=po({unsortedSegmentSum_:Qg}),em={kernelName:_e,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[r,i]=e,{axis:o,batchDims:s}=n,a=T(o,r.shape)[0],l=(t,e,n)=>()=>{const r=t.shape,i=e.size,s=r.slice(0,a),l=s.length,u=r.slice(o,r.length).slice(1),c=u.length,h=nm(0,l),d=nm(l+1,l+1+c),p=rm([s,[i],u]),f=Pl(n,p),g=Pl(e,[i]),m=rm([[l],h,d]),y=qh(f,m);let b=tm(y,g,t.shape[a]);const v=pc(m);return b=qh(b,v),b};if(1===s){const e=r.shape[0],n=r.split(e,0),o=()=>{const e=Ah(n.map(((e,n)=>l(e,i.slice(n,1),t.slice(n,1))())));return e.reshape(r.shape)};return{x:o,indices:()=>i}}return{x:l(r,i,t),indices:()=>i}}};function nm(t,e){const n=[];for(let r=t;r<e;++r)n.push(r);return n}function rm(t){const e=[];for(let n=0;n<t.length;++n)for(let r=0;r<t[n].length;++r)e.push(t[n][r]);return e}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const im={kernelName:Se,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>Ys(n),b:()=>Ys(r)}}},om={kernelName:Te,gradFunc:t=>({x:()=>$s(t,"float32")})},sm={kernelName:Ae,gradFunc:t=>({x:()=>Ys(t)})},am={kernelName:Re,gradFunc:t=>({x:()=>Ys(t)})},lm={kernelName:$e,gradFunc:t=>({x:()=>Ys(t)})},um={kernelName:De,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{alpha:i}=n,o=Gu(r,0);return{x:()=>Wh(o,t,js(t,i))}}},cm={kernelName:Le,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Us(t,Ls(n,1))}}},hm={kernelName:Pe,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Us(t,$s(n,"float32"))}}},dm={kernelName:Ue,inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{axis:i}=n;return{logits:()=>{const e=!0,n=Ou(r);return da(t,js(ic(t,i,e),n))}}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function pm(t,e,n,r=5,i=1,o=1,s=.5){const a={x:t,y:e,dy:n},l={depthRadius:r,bias:i,alpha:o,beta:s};return Qi.runKernel(je,a,l)}const fm=po({localResponseNormalizationBackprop_:pm}),gm={kernelName:Ve,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,i]=e,{depthRadius:o,bias:s,alpha:a,beta:l}=n;return{x:()=>fm(r,i,t,o,s,a,l)}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function mm(t,e,n,r){return e.rank<n.rank&&(e=Pl(e,cc(e.shape,r))),t.rank<n.rank&&(t=Pl(t,cc(t.shape,r))),{x:()=>{const r=js(t,$s($u(n,e),t.dtype));return r}}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const ym={kernelName:He,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{reductionIndices:i}=r,o=e[0],s=e[1],a=T(i,o.shape),l=mm(t,s,o,a);return{x:()=>l["x"]()}}},bm={kernelName:Ge,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=()=>js(t,$s(Ku(n,r),"float32")),o=()=>js(t,$s(kp(n,r),"float32"));return{a:i,b:o}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function vm(t,e,n,r,i,o,s){const a=uo(t,"dy","maxPool3dGrad"),l=uo(e,"input","maxPool3dGrad"),u=uo(n,"output","maxPool3dGrad");let c=a,h=l,d=u,p=!1;4===l.rank&&(p=!0,c=Pl(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),h=Pl(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),d=Pl(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),y(5===c.rank,(()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${c.rank}.`)),y(5===h.rank,(()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${h.rank}.`)),y(5===d.rank,(()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${d.rank}.`)),Fl("maxPool3dGrad",o,s);const f={dy:c,input:h,output:d},g={filterSize:r,strides:i,pad:o,dimRoundingMode:s},m=Qi.runKernel(Ye,f,g);return p?Pl(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}const wm=po({maxPool3dGrad_:vm}),xm={kernelName:Xe,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,i]=e,{filterSize:o,strides:s,pad:a,dimRoundingMode:l}=n;return{x:()=>wm(t,r,i,o,s,a,l)}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function km(t,e,n,r,i,o,s){const a=uo(t,"dy","maxPoolGrad"),l=uo(e,"input","maxPoolGrad"),u=uo(n,"output","maxPoolGrad");y(l.rank===a.rank,(()=>`Rank of input (${l.rank}) does not match rank of dy (${a.rank})`)),y(4===a.rank,(()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`)),y(4===l.rank,(()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`)),Fl("maxPoolGrad",o,s);const c={dy:a,input:l,output:u},h={filterSize:r,strides:i,pad:o,dimRoundingMode:s};return Qi.runKernel(Ke,c,h)}const _m=po({maxPoolGrad_:km}),Im={kernelName:qe,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,i]=e,{filterSize:o,strides:s,pad:a}=n;return{x:()=>_m(t,r,i,o,s,a)}}},Cm={kernelName:Ze,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:i}=n,o=T(i,r.shape),s=uc(r.shape,o),a=s[1],l=w(a),u=()=>{const e=r.shape.slice();o.forEach((t=>{e[t]=1}));const n=Pl(t,e),i=Us(js(n,Bc(r.shape,"float32")),l);return i};return{x:u}}},Sm={kernelName:Qe,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{axis:i}=r,[o,s]=e,a=T(i,o.shape),l=mm(t,s,o,a);return{x:()=>l["x"]()}}},Tm={kernelName:tn,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=()=>js(t,$s(pp(n,r),"float32")),o=()=>js(t,$s(Gu(n,r),"float32"));return{a:i,b:o}}},Em={kernelName:en,inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:i}=n,o=i.map((t=>t[0]));return{x:()=>dh(t,o,r.shape)}}},Nm={kernelName:nn,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=ba(n.shape,r.shape),o=()=>{const e=ya(n.shape,i);return e.length>0?Pl(ic(t,e),n.shape):t},s=()=>{const e=js(t,Oc(Uu(Us(n,r)))),o=ya(r.shape,i);return o.length>0?Pl(ic(e,o),r.shape):e};return{a:o,b:s}}},Am={kernelName:on,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=ba(n.shape,r.shape),o=()=>{const e=js(t,$s(r,"float32")),o=ya(n.shape,i);return o.length>0?Pl(ic(e,o),n.shape):e},s=()=>{const e=js(t,$s(n,"float32")),o=ya(r.shape,i);return o.length>0?Pl(ic(e,o),r.shape):e};return{a:o,b:s}}},Rm={kernelName:sn,gradFunc:t=>({x:()=>Oc(t)})},$m={kernelName:dn,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>zc(n.shape,"float32")}}},Dm={kernelName:hn,gradFunc:t=>({x:()=>Ys(t)})},Om={kernelName:pn,saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:r}=n,i=Lh(t,r);return i.map((t=>()=>t))}},Fm={kernelName:fn,inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:i}=n,o=i.map((t=>t[0]));return{x:()=>dh(t,o,r.shape)}}},Mm={kernelName:gn,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,r,i]=e,o=n,s=r,a=ba(o.shape,s.shape),l=()=>{const e=$s(s,"float32");let n=js(t,js(e,ca(o,da(e,Qs(1)))));const r=ya(o.shape,a);return r.length>0&&(n=ic(n,r)),Pl(n,o.shape)},u=()=>{const e=Gu(o,0),n=Wh(e,Zu(o),Ys(o));let r=js(t,js(i,n));const l=ya(s.shape,a);return l.length>0&&(r=ic(r,l)),Pl(r,s.shape)};return{a:l,b:u}}},Pm={kernelName:mn,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,r]=e,i=Gu(n,0);return{x:()=>Wh(i,t,js(t,r)),alpha:()=>{let e=Wh(i,Ys(t),js(t,n));const o=ya(r.shape,t.shape);return o.length>0&&(e=ic(e,o)),Pl(e,r.shape)}}}};
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Lm(t,e=0,n=!1,r=!1){const i=uo(t,"x","cumprod"),o={x:i},s={axis:e,exclusive:n,reverse:r};return Qi.runKernel(Xt,o,s)}const zm=po({cumprod_:Lm});
/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Bm(t,e,n){const r=t.shape.slice();r[n]=1;const i=Pl(e,r),o=zm(t,n,!0,!1),s=zm(t,n,!0,!0),a=js(o,s);return js(i,a)}function Wm(t,e,n){const r=t.shape.length,i=r-n.length,o=dc(n,r);let s=t;null!=o&&(s=qh(t,o));const a=s.shape.slice(),l=a.splice(r-n.length,n.length),u=l.reduce(((t,e)=>t*e),1);a.push(u);const c=s.reshape(a);let h=Bm(c,e,i);if(h=h.reshape(s.shape),null!=o){const t=pc(o);h=qh(h,t)}return h}const Um={kernelName:yn,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:i}=n;let o=[];return o=void 0===i||null===i?r.shape.map(((t,e)=>e)):"number"===typeof i?[i]:i,{x:()=>Wm(r,t,o)}}},Vm={kernelName:le,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=ba(n.shape,r.shape),o=()=>{const e=Us(t,$s(r,"float32")),o=ya(n.shape,i);return o.length>0?Pl(ic(e,o),n.shape):e},s=()=>{let e=js(t,$s(n,"float32"));const o=ya(r.shape,i);o.length>0&&(e=Pl(ic(e,o),r.shape));const s=Ks(r);return Oc(Us(e,$s(s,"float32")))};return{a:o,b:s}}},jm={kernelName:_n,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Us(t,Oc(Ks(n)))}}},Hm={kernelName:An,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=js(pp(n,6),cd(n));return{x:()=>js(t,$s(r,"float32"))}}},Gm={kernelName:In,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>js(t,$s(cd(n),"float32"))}}},qm={kernelName:Cn,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Pl(t,n.shape)}}},Km={kernelName:En,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[r]=e,i={dy:t,images:r},o=()=>Qi.runKernel(Nn,i,n);return{images:o}}},Xm={kernelName:Sn,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[r]=e,i={dy:t,images:r},o=()=>Qi.runKernel(Tn,i,n);return{images:o}}},Ym={kernelName:Rn,gradFunc:(t,e,n)=>{const{dims:r}=n,i=T(r,t.shape);return{x:()=>ih(t,i)}}},Jm={kernelName:$n,gradFunc:t=>({x:()=>Ys(t)})},Zm={kernelName:Dn,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Oc(Us(t,js(ca(n,1.5),2)))}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Qm(t){const e=uo(t,"x","logicalNot","bool"),n={x:e};return Qi.runKernel(Be,n)}const ty=po({logicalNot_:Qm}),ey={kernelName:Pn,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>$s(Ys(n),"float32"),t:()=>js(t,$s(n,t.dtype)),e:()=>js(t,$s(ty(n),t.dtype))}}},ny={kernelName:Ln,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=Gu(n,Qs(0)),r=Qs(lf),i=Qs(uf),o=js(t,i),s=js(js(t,r),Ou($s(n,"float32")));return Wh(e,o,s)}}}},ry={kernelName:Vn,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>js(t,js(n,da(Qs(1),n)))}}},iy={kernelName:Un,gradFunc:t=>({x:()=>Ys(t)})};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function oy(t){const e=uo(t,"x","cos","float32"),n={x:e};return Qi.runKernel(qt,n)}const sy=po({cos_:oy}),ay={kernelName:Bn,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>js(sy($s(n,"float32")),t)}}};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function ly(t){const e=uo(t,"x","cosh","float32"),n={x:e};return Qi.runKernel(Kt,n)}const uy=po({cosh_:ly}),cy={kernelName:Wn,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>js(uy($s(n,"float32")),t)}}},hy={kernelName:zn,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{begin:i,size:o}=n,s=r.shape,[a,l]=al(r,i,o),u=[];for(let c=0;c<t.rank;c++)u.push([a[c],s[c]-a[c]-l[c]]);return{x:()=>jc(t,u)}}},dy={kernelName:Xn,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{dim:i}=n,o=!0,s=js(t,r);return{logits:()=>da(s,js(ic(s,[i],o),r))}}},py={kernelName:jn,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>js(t,ch(n))}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function fy(t,e,n){const r=uo(t,"x","batchToSpaceND"),i=e.reduce(((t,e)=>t*e));y(r.rank>=1+e.length,(()=>`input rank is ${r.rank} but should be > than blockShape.length ${e.length}`)),y(n.length===e.length,(()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`)),y(r.shape[0]%i===0,(()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${i}`));const o={x:r},s={blockShape:e,crops:n};return Qi.runKernel(At,o,s)}const gy=po({batchToSpaceND_:fy}),my={kernelName:qn,gradFunc:(t,e,n)=>{const{blockShape:r,paddings:i}=n;return{x:()=>gy(t,r,i)}}},yy={kernelName:Kn,gradFunc:(t,e,n)=>{const{axis:r}=n;return{x:()=>nu(t,r)}}},by={kernelName:Hn,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Us(t,js(Gs($s(n,"float32")),2))}}},vy={kernelName:nr,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>js(t,js($s(n,"float32"),2))}}},wy={kernelName:er,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=Qs(2),o=()=>js(t,js(i,da(n,r))),s=()=>js(t,js(i,da(r,n)));return{a:o,b:s}}},xy={kernelName:vr,gradFunc:t=>({x:()=>Ys(t)})},ky={kernelName:lr,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=ba(n.shape,r.shape),o=()=>{let e=t;const r=ya(n.shape,i);return r.length>0&&(e=ic(e,r)),Pl(e,n.shape)},s=()=>{let e=t;const n=ya(r.shape,i);return n.length>0&&(e=ic(e,n)),Pl(Oc(e),r.shape)};return{a:o,b:s}}},_y={kernelName:Gn,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,i=r.shape.slice(),{axis:o}=n,s=T(o,r.shape);s.forEach((t=>{i[t]=1}));const a=Pl(t,i),l=js(a,Bc(r.shape,"float32"));return{x:()=>l}}},Iy={kernelName:ur,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Us(t,Ks(sy(n)))}}},Cy={kernelName:cr,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>js(da(Qs(1),Ks(n)),t)}}},Sy={kernelName:hr,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{reps:i}=n,o=()=>{let e=Ys(r);if(1===r.rank)for(let n=0;n<i[0];++n)e=Ls(e,dh(t,[n*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(let n=0;n<i[0];++n)for(let o=0;o<i[1];++o)e=Ls(e,dh(t,[n*r.shape[0],o*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(let n=0;n<i[0];++n)for(let o=0;o<i[1];++o)for(let s=0;s<i[2];++s)e=Ls(e,dh(t,[n*r.shape[0],o*r.shape[1],s*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error(`Gradient for tile operation is not implemented for rank-${r.rank} tensors yet.`);for(let n=0;n<i[0];++n)for(let o=0;o<i[1];++o)for(let s=0;s<i[2];++s)for(let a=0;a<i[3];++a)e=Ls(e,dh(t,[n*r.shape[0],o*r.shape[1],s*r.shape[2],a*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return e};return{x:o}}},Ty={kernelName:fr,gradFunc:(t,e,n)=>{const r=n,{perm:i}=r,o=pc(i);return{x:()=>qh(t,o)}}},Ey={kernelName:mr,gradFunc:(t,e,n)=>{const r=n,{axis:i}=r;return{value:()=>Ah(t,i)}}},Ny={kernelName:yr,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e,r=()=>Ay(t,n);return{x:r}}};function Ay(t,e){const n=wa(e,Ys(e)),r=ju(t,n);let i=Ku(e,Qs(0,"int32"));const o=r.rank-i.rank;for(let a=0;a<o;++a)i=Mu(i,a+1);i=bc(i,Bc(r.shape,"bool"));const s=Ys(r);return Wh(i,r,s)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const Ry={kernelName:br,gradFunc:t=>({x:()=>Ys(t)})},$y=[Qf,tg,eg,ng,rg,ig,og,sg,ag,lg,ug,cg,pg,mg,yg,wg,xg,kg,_g,Ig,Cg,Sg,Eg,Tg,Rg,Og,Pg,Bg,Wg,Ug,Vm,Vg,jg,Hg,Gg,qg,Xg,Kg,Zg,em,im,om,sm,am,lm,um,cm,hm,dm,gm,ym,ym,bm,xm,Im,Cm,Sm,Tm,Em,Nm,Am,Rm,$m,Dm,Om,Fm,Fm,Mm,Pm,Um,jm,Hm,Gm,qm,Km,Xm,Ym,Jm,Zm,ey,ny,ry,iy,ay,cy,hy,dy,py,my,my,yy,yy,by,wy,vy,xy,ky,_y,Iy,Cy,Sy,Ty,Ey,Ny,Ry];for(const ZX of $y)Dr(ZX);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Dy(t){const e=uo(t,"x","acos"),n={x:e};return Qi.runKernel(dt,n)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.abs=function(){return this.throwIfDisposed(),ga(this)};const Oy=po({acos_:Dy});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Fy(t){const e=uo(t,"x","acosh"),n={x:e};return Qi.runKernel(pt,n)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.acos=function(){return this.throwIfDisposed(),Oy(this)};const My=po({acosh_:Fy});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Py(t,e=0){const n=uo(t,"x","argMin"),r={x:n},i={axis:e};return Qi.runKernel(vt,r,i)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.acosh=function(){return this.throwIfDisposed(),My(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.add=function(t){return this.throwIfDisposed(),Ls(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.all=function(t,e){return this.throwIfDisposed(),dl(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.any=function(t,e){return this.throwIfDisposed(),fl(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.argMax=function(t){return this.throwIfDisposed(),ml(this,t)};const Ly=po({argMin_:Py});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function zy(t){const e=uo(t,"x","asin"),n={x:e};return Qi.runKernel(wt,n)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.argMin=function(t){return this.throwIfDisposed(),Ly(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.asScalar=function(){return this.throwIfDisposed(),y(1===this.size,(()=>"The array must have only 1 element.")),Pl(this,[])},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.asType=function(t){return this.throwIfDisposed(),$s(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.as1D=function(){return this.throwIfDisposed(),Pl(this,[this.size])},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.as2D=function(t,e){return this.throwIfDisposed(),Pl(this,[t,e])},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.as3D=function(t,e,n){return this.throwIfDisposed(),Pl(this,[t,e,n])},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.as4D=function(t,e,n,r){return this.throwIfDisposed(),Pl(this,[t,e,n,r])},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.as5D=function(t,e,n,r,i){return this.throwIfDisposed(),Pl(this,[t,e,n,r,i])};const By=po({asin_:zy});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Wy(t){const e=uo(t,"x","asinh"),n={x:e};return Qi.runKernel(xt,n)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.asin=function(){return this.throwIfDisposed(),By(this)};const Uy=po({asinh_:Wy});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Vy(t){const e=uo(t,"x","atan"),n={x:e};return Qi.runKernel(kt,n)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.asinh=function(){return this.throwIfDisposed(),Uy(this)};const jy=po({atan_:Vy});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Hy(t,e){let n=uo(t,"a","atan2"),r=uo(e,"b","atan2");[n,r]=Vi(n,r);const i={a:n,b:r};return Qi.runKernel(It,i)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.atan=function(){return this.throwIfDisposed(),jy(this)};const Gy=po({atan2_:Hy});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function qy(t){const e=uo(t,"x","atanh"),n={x:e};return Qi.runKernel(_t,n)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.atan2=function(t){return this.throwIfDisposed(),Gy(this,t)};const Ky=po({atanh_:qy});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Xy(t){const e=uo(t,"x","ceil","float32"),n={x:e};return Qi.runKernel(Mt,n)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.atanh=function(){return this.throwIfDisposed(),Ky(this)},Ri().prototype.avgPool=function(t,e,n,r){return this.throwIfDisposed(),zl(this,t,e,n,r)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),gy(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.batchNorm=function(t,e,n,r,i){return this.throwIfDisposed(),jl(this,t,e,n,r,i)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.broadcastTo=function(t){return this.throwIfDisposed(),Zl(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.cast=function(t){return this.throwIfDisposed(),$s(this,t)};const Yy=po({ceil_:Xy});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Jy(t,e,n="NHWC"){const r=uo(t,"x","depthToSpace","float32"),i="NHWC"===n?r.shape[1]:r.shape[2],o="NHWC"===n?r.shape[2]:r.shape[3],s="NHWC"===n?r.shape[3]:r.shape[1];y(e>1,(()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`)),y(i*e>=0,(()=>`Negative dimension size caused by overflow when multiplying\n    ${i} and ${e}  for depthToSpace with input shape\n    ${r.shape}`)),y(o*e>=0,(()=>`Negative dimension size caused by overflow when multiplying\n    ${o} and ${e} for depthToSpace with input shape\n        ${r.shape}`)),y(s%(e*e)===0,(()=>`Dimension size must be evenly divisible by ${e*e} but is ${s} for depthToSpace with input shape ${r.shape}`));const a={x:r},l={blockSize:e,dataFormat:n};return Qi.runKernel(Qt,a,l)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.ceil=function(){return this.throwIfDisposed(),Yy(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.clipByValue=function(t,e){return this.throwIfDisposed(),tu(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof Ai&&(t=[t]),nu([this,...t],e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.conv1d=function(t,e,n,r,i,o){return this.throwIfDisposed(),fu(this,t,e,n,r,i,o)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.conv2dTranspose=function(t,e,n,r,i){return this.throwIfDisposed(),bu(this,t,e,n,r,i)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.conv2d=function(t,e,n,r,i,o){return this.throwIfDisposed(),du(this,t,e,n,r,i,o)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.cos=function(){return this.throwIfDisposed(),sy(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.cosh=function(){return this.throwIfDisposed(),uy(this)},
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.cumprod=function(t,e,n){return this.throwIfDisposed(),zm(this,t,e,n)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),zg(this,t,e,n)};const Zy=po({depthToSpace_:Jy});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Qy(t,e,n,r,i=[1,1],o="NHWC"){const s=uo(t,"x","dilation2d"),a=uo(e,"filter","dilation2d");y(3===s.rank||4===s.rank,(()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${s.rank}.`)),y(3===a.rank,(()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`)),y("NHWC"===o,(()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${o}`));let l=s,u=!1;3===s.rank&&(l=Pl(s,[1,s.shape[0],s.shape[1],s.shape[2]]),u=!0),y(l.shape[3]===a.shape[2],(()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${a.shape[2]}`));const c={x:l,filter:a},h={strides:n,pad:r,dilations:i},d=Qi.runKernel(ie,c,h);return u?Pl(d,[d.shape[1],d.shape[2],d.shape[3]]):d}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),Zy(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.depthwiseConv2d=function(t,e,n,r,i,o){return this.throwIfDisposed(),Eu(this,t,e,n,r,i,o)};const tb=po({dilation2d_:Qy});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function eb(t,e){let n=uo(t,"a","div"),r=uo(e,"b","div");[n,r]=Vi(n,r);const i=Us(n,r),o=Ys(i),s=$u(r,o);return Wh(s,o,i)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.dilation2d=function(t,e,n,r,i){return this.throwIfDisposed(),tb(this,t,e,n,r,i)};const nb=po({divNoNan_:eb});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function rb(t,e){const n=uo(t,"t1","dot"),r=uo(e,"t2","dot");y((1===n.rank||2===n.rank)&&(1===r.rank||2===r.rank),(()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`));const i=1===n.rank?n.size:n.shape[1],o=1===r.rank?r.size:r.shape[0];if(y(i===o,(()=>`Error in dot: inner dimensions of inputs must match, but got ${i} and ${o}.`)),1===n.rank&&1===r.rank){const t=Pl(n,[1,-1]),e=Pl(r,[-1,1]),i=wc(t,e);return Pl(i,[])}if(1===n.rank&&2===r.rank){const t=Pl(n,[1,-1]),e=Pl(r,[r.shape[0],r.shape[1]]),i=wc(t,e);return Pl(i,[i.size])}if(2===n.rank&&1===r.rank){const t=Pl(r,[-1,1]),e=wc(n,t);return Pl(e,[e.size])}{const t=Pl(r,[r.shape[0],r.shape[1]]),e=wc(n,t);return e}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.divNoNan=function(t){return this.throwIfDisposed(),nb(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.div=function(t){return this.throwIfDisposed(),Us(this,t)};const ib=po({dot_:rb});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function ob(t){let e=uo(t,"x","erf");y("int32"===e.dtype||"float32"===e.dtype,(()=>"Input dtype must be `int32` or `float32`.")),"int32"===e.dtype&&(e=$s(e,"float32"));const n={x:e};return Qi.runKernel(de,n)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.dot=function(t){return this.throwIfDisposed(),ib(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.elu=function(){return this.throwIfDisposed(),Au(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.equal=function(t){return this.throwIfDisposed(),$u(this,t)};const sb=po({erf_:ob});
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function ab(t,e=null,n=!1){return Tp(t,"euclidean",e,n)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.erf=function(){return this.throwIfDisposed(),sb(this)};const lb=po({euclideanNorm_:ab});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function ub(t){const e=uo(t,"x","expm1"),n={x:e};return Qi.runKernel(me,n)}
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.euclideanNorm=function(t,e){return this.throwIfDisposed(),lb(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.exp=function(){return this.throwIfDisposed(),Ou(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.expandDims=function(t){return this.throwIfDisposed(),Mu(this,t)};const cb=po({expm1_:ub});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function hb(t){const e=uo(t,"x","isFinite"),n={x:e};return Qi.runKernel(Ae,n)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.expm1=function(){return this.throwIfDisposed(),cb(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.fft=function(){return this.throwIfDisposed(),Zh(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.flatten=function(){return this.throwIfDisposed(),Pl(this,[this.size])},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.floor=function(){return this.throwIfDisposed(),Uu(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.floorDiv=function(t){return this.throwIfDisposed(),Bs(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.gather=function(t,e,n){return this.throwIfDisposed(),ju(this,t,e,n)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.greaterEqual=function(t){return this.throwIfDisposed(),Ku(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.greater=function(t){return this.throwIfDisposed(),Gu(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.ifft=function(){return this.throwIfDisposed(),nd(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.irfft=function(){return this.throwIfDisposed(),id(this)};const db=po({isFinite_:hb});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function pb(t){const e=uo(t,"x","isInf"),n={x:e};return Qi.runKernel(Re,n)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.isFinite=function(){return this.throwIfDisposed(),db(this)};const fb=po({isInf_:pb});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function gb(t){const e=uo(t,"x","isNaN"),n={x:e};return Qi.runKernel($e,n)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.isInf=function(){return this.throwIfDisposed(),fb(this)};const mb=po({isNaN_:gb});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function yb(t,e=5,n=1,r=1,i=.5){const o=uo(t,"x","localResponseNormalization");y(4===o.rank||3===o.rank,(()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ${o.rank}.`)),y(k(e),(()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`));let s=o,a=!1;3===o.rank&&(a=!0,s=Pl(o,[1,o.shape[0],o.shape[1],o.shape[2]]));const l={x:s},u={depthRadius:e,bias:n,alpha:r,beta:i},c=Qi.runKernel(Ve,l,u);return a?Pl(c,[c.shape[1],c.shape[2],c.shape[3]]):c}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.isNaN=function(){return this.throwIfDisposed(),mb(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.leakyRelu=function(t){return this.throwIfDisposed(),Yu(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.lessEqual=function(t){return this.throwIfDisposed(),pp(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.less=function(t){return this.throwIfDisposed(),kp(this,t)};const bb=po({localResponseNormalization_:yb});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function vb(t){const e=uo(t,"x","logSigmoid"),n=Zs((t=>{const e=Oc(Ih(Oc(t))),n=e=>{const n=js(e,ch(Oc(t)));return n};return{value:e,gradFunc:n}}));return n(e)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.localResponseNormalization=function(t,e,n,r){return this.throwIfDisposed(),bb(this,t,e,n,r)};const wb=po({logSigmoid_:vb});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function xb(t,e){const n=uo(t,"a","logicalOr","bool"),r=uo(e,"b","logicalOr","bool");ba(n.shape,r.shape);const i={a:n,b:r};return Qi.runKernel(We,i)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.logSigmoid=function(){return this.throwIfDisposed(),wb(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.logSoftmax=function(t){return this.throwIfDisposed(),sc(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.logSumExp=function(t,e){return this.throwIfDisposed(),mc(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.log=function(){return this.throwIfDisposed(),Zu(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.log1p=function(){return this.throwIfDisposed(),tc(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.logicalAnd=function(t){return this.throwIfDisposed(),bc(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.logicalNot=function(){return this.throwIfDisposed(),ty(this)};const kb=po({logicalOr_:xb});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function _b(t,e){const n=uo(t,"a","logicalXor","bool"),r=uo(e,"b","logicalXor","bool");return ba(n.shape,r.shape),bc(kb(t,e),ty(bc(t,e)))}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.logicalOr=function(t){return this.throwIfDisposed(),kb(this,t)};const Ib=po({logicalXor_:_b});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Cb(t,e,n){y("reflect"===n||"symmetric"===n,(()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`));const r=uo(t,"x","mirrorPad");if(0===r.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");y(e.length===r.rank,(()=>`Padding doesn't match input. Must be ${r.rank}. Got ${e.length}.`));const i="reflect"===n?1:0;for(let a=0;a<r.rank;a++)y(2===e[a].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),y(e[a][0]>=0&&e[a][0]<=r.shape[a]-i&&e[a][1]>=0&&e[a][1]<=r.shape[a]-i,(()=>`Padding in dimension ${a} cannot be greater than or equal to ${r.shape[a]-i} or less than 0 for input of shape ${r.shape}`));const o={paddings:e,mode:n},s={x:r};return Qi.runKernel(en,s,o)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.logicalXor=function(t){return this.throwIfDisposed(),Ib(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.matMul=function(t,e,n){return this.throwIfDisposed(),wc(this,t,e,n)},Ri().prototype.maxPool=function(t,e,n,r){return this.throwIfDisposed(),kc(this,t,e,n,r)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.max=function(t,e){return this.throwIfDisposed(),nc(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.maximum=function(t){return this.throwIfDisposed(),wa(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.mean=function(t,e){return this.throwIfDisposed(),Sc(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.min=function(t,e){return this.throwIfDisposed(),Ec(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.minimum=function(t){return this.throwIfDisposed(),Ac(this,t)};const Sb=po({mirrorPad_:Cb});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Tb(t,e){let n=uo(t,"a","mod"),r=uo(e,"b","mod");[n,r]=Vi(n,r);const i={a:n,b:r};return Qi.runKernel(nn,i)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.mirrorPad=function(t,e){return this.throwIfDisposed(),Sb(this,t,e)};const Eb=po({mod_:Tb});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Nb(t,e,n,r,i,o,s){null==i&&(i=[1,1]),null==o&&(o=1),0===r&&(r="valid");const a=uo(t,"x","maxPool");let l=a,u=!1;3===a.rank&&(u=!0,l=Pl(a,[1,a.shape[0],a.shape[1],a.shape[2]])),y($l(o,i),(()=>`Error in pool: Either strides or dilations must be 1. Got strides ${o} and dilations '${i}'`));const c=bl(l.shape,e,o,i,r),h=[c.dilationHeight,c.dilationWidth];let d;d="same"===r?Rb([c.filterHeight,c.filterWidth],h):[[0,0],[0,0]];const p=1===h[0]&&1===h[1],[f,g]=Ab([c.inHeight,c.inWidth],h,d),m=p?r:"valid",b=p?l:vg(l,h,f),v="avg"===n?()=>zl(b,e,o,m,s):()=>kc(b,e,o,m,s),w=v(),x=p?w:gy(w,h,g);return u?Pl(x,[x.shape[1],x.shape[2],x.shape[3]]):x}function Ab(t,e,n){const r=n.map((t=>t[0])),i=n.map((t=>t[1])),o=t.concat(r,i),s=e.map(((t,e)=>(t-o[e]%t)%t)),a=i.map(((t,e)=>t+s[e])),l=e.map(((t,e)=>[r[e],a[e]])),u=e.map(((t,e)=>[0,s[e]]));return[l,u]}function Rb(t,e){const n=t.map(((t,n)=>t+(t-1)*(e[n]-1))),r=n.map((t=>t-1)),i=r.map((t=>Math.floor(t/2))),o=r.map(((t,e)=>t-i[e]));return r.map(((t,e)=>[i[e],o[e]]))}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.mod=function(t){return this.throwIfDisposed(),Eb(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.mul=function(t){return this.throwIfDisposed(),js(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.neg=function(){return this.throwIfDisposed(),Oc(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.norm=function(t,e,n){return this.throwIfDisposed(),Tp(this,t,e,n)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.notEqual=function(t){return this.throwIfDisposed(),Mc(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.oneHot=function(t,e=1,n=0){return this.throwIfDisposed(),Lc(this,t,e,n)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.onesLike=function(){return this.throwIfDisposed(),Uc(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.pad=function(t,e){return this.throwIfDisposed(),jc(this,t,e)};const $b=po({pool_:Nb});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Db(t,e=null,n=!1){let r=uo(t,"x","prod");"bool"===r.dtype&&(r=$s(r,"int32"));const i={x:r},o={axis:e,keepDims:n};return Qi.runKernel(yn,i,o)}Ri().prototype.pool=function(t,e,n,r,i,o){return this.throwIfDisposed(),$b(this,t,e,n,r,i,o)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.pow=function(t){return this.throwIfDisposed(),ca(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.prelu=function(t){return this.throwIfDisposed(),Gc(this,t)};const Ob=po({prod_:Db});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Fb(t){const e=uo(t,"x","reciprocal"),n={x:e};return Qi.runKernel(_n,n)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.prod=function(t,e){return this.throwIfDisposed(),Ob(this,t,e)};const Mb=po({reciprocal_:Fb});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Pb(t){const e=uo(t,"x","sign"),n={x:e};return Qi.runKernel(Un,n)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.reciprocal=function(){return this.throwIfDisposed(),Mb(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.relu=function(){return this.throwIfDisposed(),nh(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.relu6=function(){return this.throwIfDisposed(),ld(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.reshapeAs=function(t){return this.throwIfDisposed(),Pl(this,t.shape)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.reshape=function(t){return this.throwIfDisposed(),Pl(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.resizeBilinear=function(t,e,n){return this.throwIfDisposed(),ap(this,t,e,n)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.resizeNearestNeighbor=function(t,e,n){return this.throwIfDisposed(),up(this,t,e,n)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.reverse=function(t){return this.throwIfDisposed(),ih(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.rfft=function(){return this.throwIfDisposed(),td(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.round=function(){return this.throwIfDisposed(),gp(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.rsqrt=function(){return this.throwIfDisposed(),Jg(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.selu=function(){return this.throwIfDisposed(),sh(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.separableConv2d=function(t,e,n,r,i,o){return this.throwIfDisposed(),lh(this,t,e,n,r,i,o)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.sigmoid=function(){return this.throwIfDisposed(),ch(this)};const Lb=po({sign_:Pb});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function zb(t,e,n,r,i=0,o=0,s=0,a=0,l=0){const u=uo(t,"x","stridedSlice","string_or_numeric"),c={x:u},h={begin:e,end:n,strides:r,beginMask:i,endMask:o,ellipsisMask:s,newAxisMask:a,shrinkAxisMask:l};return Qi.runKernel(ir,c,h)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.sign=function(){return this.throwIfDisposed(),Lb(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.sin=function(){return this.throwIfDisposed(),Dg(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.sinh=function(){return this.throwIfDisposed(),Mg(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.slice=function(t,e){return this.throwIfDisposed(),dh(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.softmax=function(t){return this.throwIfDisposed(),kh(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.softplus=function(){return this.throwIfDisposed(),Ih(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),vg(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.split=function(t,e){return this.throwIfDisposed(),Sh(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.sqrt=function(){return this.throwIfDisposed(),Gs(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.square=function(){return this.throwIfDisposed(),Ks(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.squaredDifference=function(t){return this.throwIfDisposed(),Fp(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.squeeze=function(t){return this.throwIfDisposed(),Eh(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.stack=function(t,e){this.throwIfDisposed();const n=t instanceof Ai?[this,t]:[this,...t];return Ah(n,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.step=function(t){return this.throwIfDisposed(),cd(this,t)};const Bb=po({stridedSlice_:zb});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Wb(t){const e=uo(t,"x","tan","float32"),n={x:e};return Qi.runKernel(ur,n)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.stridedSlice=function(t,e,n,r,i,o,s,a){return this.throwIfDisposed(),Bb(this,t,e,n,r,i,o,s,a)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.sub=function(t){return this.throwIfDisposed(),da(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.sum=function(t,e){return this.throwIfDisposed(),ic(this,t,e)};const Ub=po({tan_:Wb});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Vb(t,e=1,n=!0){const r=uo(t,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");const i=r.shape[r.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>i)throw new Error(`'k' passed to topk() must be <= the last dimension (${i}) but got ${e}`);const o={x:r},s={k:e,sorted:n},[a,l]=Qi.runKernel(dr,o,s);return{values:a,indices:l}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.tan=function(){return this.throwIfDisposed(),Ub(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.tanh=function(){return this.throwIfDisposed(),$h(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.tile=function(t){return this.throwIfDisposed(),Lu(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.toBool=function(){return this.throwIfDisposed(),$s(this,"bool")},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.toFloat=function(){return this.throwIfDisposed(),$s(this,"float32")},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.toInt=function(){return this.throwIfDisposed(),$s(this,"int32")};const jb=po({topk_:Vb});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Hb(t,e=0){const n=uo(t,"x","unique","string_or_numeric");y(n.rank>0,(()=>"The input tensor must be at least 1D"));const r={x:n},i={axis:e},[o,s]=Qi.runKernel(gr,r,i);return{values:o,indices:s}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.topk=function(t,e){return this.throwIfDisposed(),jb(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.transpose=function(t){return this.throwIfDisposed(),qh(this,t)};const Gb=po({unique_:Hb});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.unique=function(t){return this.throwIfDisposed(),Gb(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),tm(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.unstack=function(t){return this.throwIfDisposed(),Lh(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.where=function(t,e){return this.throwIfDisposed(),Wh(t,this,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Ri().prototype.zerosLike=function(){return this.throwIfDisposed(),Ys(this)};
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
class qb extends Error{constructor(t){super(t),Object.setPrototypeOf(this,qb.prototype)}}class Kb extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Kb.prototype)}}class Xb extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Xb.prototype)}}class Yb extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Yb.prototype)}}class Jb extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Jb.prototype)}}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
class Zb{constructor(t){this.maxEntries=t||100,this.cache=new Map}get(t){let e;return this.cache.has(t)&&(e=this.cache.get(t),this.cache.delete(t),this.cache.set(t,e)),e}put(t,e){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxEntries){const t=this.cache.keys().next().value;this.cache.delete(t)}this.cache.set(t,e)}getMaxEntries(){return this.maxEntries}setMaxEntries(t){if(t<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${t}.`);if(this.maxEntries>t)for(let e=0;e<this.maxEntries-t;e++){const t=this.cache.keys().next().value;this.cache.delete(t)}this.maxEntries=t}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function Qb(t,e){if(Array.isArray(t)){let n=[];for(let r=0;r<e;r++)n=n.concat(t);return n}{const n=new Array(e);return n.fill(t),n}}function tv(t,e){if(!t)throw new Jb(e)}function ev(t,e){let n=0;for(const r of t)r===e&&n++;return n}function nv(t){return 1===t.length?t[0]:t}function rv(t){return Array.isArray(t)?t:[t]}function iv(t){const e=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2"),n=e.replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==n[0]?n:"private"+n}function ov(t){return t.length<=1||-1===t.indexOf("_")?t:t.replace(/[_]+(\w|$)/g,((t,e)=>e.toUpperCase()))}let sv={};function av(t){if(null===t||void 0===t)return null;const e={};return e["className"]=t.getClassName(),e["config"]=t.getConfig(),e}function lv(t){if(null!=t&&"object"===typeof t)if(Array.isArray(t))t.forEach((t=>lv(t)));else{const e=Object.keys(t);for(const n of e){const e=t[n];null!=e&&"object"===typeof e&&(Array.isArray(e)||"ndarray"!==e["type"]||"number"!==typeof e["value"]?lv(e):t[n]=e["value"])}}}function uv(t,e={},n={},r="object",i=!1){if("string"===typeof t){const i=t;let o;if(i in n)o=n[i];else if(i in sv)o=sv[i];else if(o=e[i],null==o)throw new Xb(`Unknown ${r}: ${t}. This may be due to one of the following reasons:\n1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return o}{const o=t;if(null==o["className"]||null==o["config"])throw new Xb(`${r}: Improper config format: ${JSON.stringify(o)}.\n'className' and 'config' must set.`);const s=o["className"];let a,l;if(s in n?[a,l]=n[s]:s in sv?[a,l]=sv["className"]:s in e&&([a,l]=e[s]),null==a)throw new Xb(`Unknown ${r}: ${s}. This may be due to one of the following reasons:\n1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(null!=l){const t={};for(const n of Object.keys(sv))t[n]=sv[n];for(const i of Object.keys(n))t[i]=n[i];const e=o["config"];e["customObjects"]=t;const r=Object.assign({},sv);for(const i of Object.keys(n))sv[i]=n[i];lv(o["config"]);const s=l(a,o["config"],n,i);return sv=Object.assign({},r),s}{const t=Object.assign({},sv);for(const r of Object.keys(n))sv[r]=n[r];const e=new a(o["config"]);return sv=Object.assign({},t),e}}}function cv(t,e){return t<e?-1:t>e?1:0}function hv(t,e){return-1*cv(t,e)}function dv(t){if(null==t)return t;const e=[];for(const n of t)-1===e.indexOf(n)&&e.push(n);return e}function pv(t){if(null==t)throw new Xb(`Invalid value in obj: ${JSON.stringify(t)}`);for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function fv(t,e,n){if(null!=n&&t.indexOf(n)<0)throw new Xb(`${n} is not a valid ${e}.  Valid values are ${t} or null/undefined.`)}function gv(t,e,n=0,r=1/0){return tv(n>=0),tv(r>=n),Array.isArray(t)&&t.length>=n&&t.length<=r&&t.every((t=>typeof t===e))}function mv(t,e){Array.isArray(t)?(y(t.length>0,(()=>`${e} is unexpectedly an empty array.`)),t.forEach(((t,n)=>mv(t,`element ${n+1} of ${e}`)))):y(Number.isInteger(t)&&t>0,(()=>`Expected ${e} to be a positive integer, but got ${yv(t)}.`))}function yv(t){return null===t?"null":Array.isArray(t)?"["+t.map((t=>yv(t))).join(",")+"]":"string"===typeof t?`"${t}"`:`${t}`}function bv(t,e,n){let r,i=null!=n?n():ii();const o=(...o)=>{const s=null!=n?n():ii();return s-i<e||(i=s,r=t(...o)),r};return o}function vv(t){return"relu"===t?"relu":"linear"===t?"linear":"elu"===t?"elu":null}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
let wv=0;function xv(){return wv++}const kv={};function _v(t=""){return t in kv||(kv[t]=0),kv[t]+=1,t+kv[t].toString()}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
const Iv=["channelsFirst","channelsLast"],Cv=["nearest","bilinear"],Sv=["valid","same","causal"],Tv=["max","avg"],Ev=["sum","mul","concat","ave"],Nv=new Map;function Av(t){fv(Iv,"DataFormat",t)}function Rv(t){fv(Cv,"InterpolationFormat",t)}function $v(t){fv(Sv,"PaddingMode",t)}function Dv(t){fv(Tv,"PoolMode",t)}const Ov=[],Fv="/";function Mv(t,e){Ov.push(t);try{const t=e();return Ov.pop(),t}catch(n){throw Ov.pop(),n}}function Pv(){return 0===Ov.length?"":Ov.join(Fv)+Fv}function Lv(t){if(!Wv(t))throw new Error("Not a valid tensor name: '"+t+"'");return Pv()+t}function zv(t){if(!Wv(t))throw new Error("Not a valid tensor name: '"+t+"'");Nv.has(t)||Nv.set(t,0);const e=Nv.get(t);if(Nv.set(t,Nv.get(t)+1),e>0){const n=`${t}_${e}`;return Nv.set(n,1),n}return t}const Bv=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function Wv(t){return!!t.match(Bv)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function Uv(t){return t===parseInt(t.toString(),10)}function Vv(t,e,n){null==e&&(e=0),null==n&&(n=t.length);let r=1;for(let i=e;i<n;++i)r*=t[i];return r}function jv(t){if(0===t.length)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let n=0;n<t.length;n++){const r=t[n];r<e&&(e=r)}return e}function Hv(t){if(0===t.length)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let n=0;n<t.length;n++){const r=t[n];r>e&&(e=r)}return e}function Gv(t,e){if(e<t)throw new Xb(`end (${e}) < begin (${t}) is forbidden.`);const n=[];for(let r=t;r<e;++r)n.push(r);return n}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
let qv;function Kv(){return null==qv&&(qv=Eo().epsilon()),qv}function Xv(){return"channelsLast"}function Yv(t,e){return $s(t,e)}function Jv(t,e=-1){const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),Pl(t,n)}function Zv(t,e){return Io((()=>{if(2!==t.shape.length)throw new Xb(`repeat() expects a rank-2 tensor, but received a rank-${t.shape.length} tensor.`);const n=Jv(t,1);return sw(n,[1,e,1])}))}function Qv(t){const e=[Vv(t.shape)];return Pl(t,e)}function tw(t){if(t.rank<=1)throw new Xb(`batchFlatten requires a minimum rank of 2. Got rank: ${t.rank}.`);const e=[t.shape[0],Vv(t.shape,1)];return Pl(t,e)}function ew(t,e,n){return Io((()=>{switch(t.rank){case 1:return fh(t,e,n);case 2:return mh(t,[e,0],[n,t.shape[1]]);case 3:return bh(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return wh(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return dh(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return dh(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new Xb(`sliceAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}}))}function nw(t,e,n){return Io((()=>{switch(t.rank){case 1:return fh(t,e,n);case 2:return mh(t,[0,e],[t.shape[0],n]);case 3:return bh(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return wh(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new Xb(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}}))}function rw(t,e,n,r){return Io((()=>{switch(t.rank){case 1:return fh(t,e,n);case 2:switch(r){case 1:return ew(t,e,n);case 2:return nw(t,e,n);default:throw new Xb(`The axis is not within the rank of the tensor ${r}`)}case 3:switch(r){case 1:return ew(t,e,n);case 2:return bh(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return nw(t,e,n);default:throw new Xb(`The axis is not within the rank of the tensor ${r}`)}case 4:switch(r){case 1:return ew(t,e,n);case 2:return wh(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return wh(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return nw(t,e,n);default:throw new Xb(`The axis is not within the rank of the tensor ${r}`)}default:throw new Xb(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}}))}function iw(t,e=-1){let n;return e<0&&(n=t[0].rank,e=0!==n?n:0),e===t[0].rank&&(e=-1),nu(t,e)}function ow(t,e){switch(t.rank){case 1:return iu([t,e]);case 2:return su([t,e],0);case 3:return lu([t,e],0);case 4:return cu([t,e],0);default:throw new Xb(`concatAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}}function sw(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new Xb(`The length of input n (${e.length}) does not match the number of dimensions in input x (${t.rank})`);return Lu(t,e)}function aw(t,e=0,n=1,r,i){return Jc(t,e,n,r,i)}function lw(t,e,n,r){if(t.rank<2||e.rank<2)throw new Yb(`dot requires both inputs to be rank >= 2 but got x shape = ${t.shape} and y shape = ${e.shape}`);if(e.rank>=3){const n=t.shape.slice(-1)[0],r=e.shape.slice(-2)[0];if(n!==r)throw new Yb(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${t.shape} and  y shape = ${e.shape}`)}if(2===t.rank&&2===e.rank){const i=!1,o=!1;return kd({a:t,b:e,transposeA:i,transposeB:o,bias:r?hw(t.rank,r,Xv()):null,activation:n})}{const i=t.shape.slice(),o=i.pop();t=Pl(t,[-1,o]);const s=e.shape.slice(),a=s.pop(),l=s.pop(),u=[...s,a],c=Array.from({length:e.rank},((t,n)=>0===n?e.rank-2:n<=e.rank-2?n-1:n));e=Pl(qh(e,c),[l,-1]);const h=[...i,...u],d=!1,p=!1;return Pl(kd({a:t,b:e,transposeA:d,transposeB:p,bias:r?hw(t.rank,r,Xv()):null,activation:n}),h)}}function uw(t,e,n){return Io((()=>(e=Array.isArray(e)?Dh(e,"int32"):$s(e,"int32"),ju(t,e,n))))}function cw(t){return js(t,t)}function hw(t,e,n){const r=e.shape;if(1!==e.rank&&e.rank!==t)throw new Xb(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${t}`);if(5===t){if("channelsFirst"===n)return 1===r.length?Pl(e,[1,r[0],1,1,1]):Pl(e,[1,r[3],r[0],r[1],r[2]]);if("channelsLast"===n)return 1===r.length?Pl(e,[1,1,1,1,r[0]]):Pl(e,[1].concat(r))}else if(4===t){if("channelsFirst"===n)return 1===r.length?Pl(e,[1,r[0],1,1]):Pl(e,[1,r[2],r[0],r[1]]);if("channelsLast"===n)return 1===r.length?Pl(e,[1,1,1,r[0]]):Pl(e,[1].concat(r))}else if(3===t){if("channelsFirst"===n)return 1===r.length?Pl(e,[1,r[0],1]):Pl(e,[1,r[1],r[0]]);if("channelsLast"===n)return 1===r.length?Pl(e,[1,1,r[0]]):Pl(e,[1].concat(r))}else if(t<3)return e;throw new Xb(`Unsupported input rank by biasAdd: ${e.rank}`)}function dw(t,e,n){return Io((()=>(null==n&&(n=Xv()),Av(n),Ls(t,hw(t.rank,e,n)))))}function pw(t,e=1){if(1!==e)throw new Yb(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return Au(t)}function fw(t){return Io((()=>Us(t,Ls(ga(t),1))))}function gw(t,e,n,r){return Io((()=>Yh(t,e,n,r)))}function mw(t){return Io((()=>{const e=Ls(.5,js(.2,t));return tu(e,0,1)}))}function yw(t,e,n=!1){return n?t():e()}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
const bw=["fanIn","fanOut","fanAvg"],vw=["normal","uniform","truncatedNormal"];
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function ww(t){fv(bw,"FanMode",t)}function xw(t){fv(vw,"Distribution",t)}class kw extends na{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class _w extends kw{apply(t,e){return zc(t,e)}}_w.className="Zeros",ia(_w);class Iw extends kw{apply(t,e){return Bc(t,e)}}Iw.className="Ones",ia(Iw);class Cw extends kw{constructor(t){if(super(),"object"!==typeof t)throw new Xb(`Expected argument of type ConstantConfig but got ${t}`);if(void 0===t.value)throw new Xb(`config must have value set but got ${t}`);this.value=t.value}apply(t,e){return Io((()=>js(Qs(this.value),Bc(t,e))))}getConfig(){return{value:this.value}}}Cw.className="Constant",ia(Cw);class Sw extends kw{constructor(t){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=t.minval||this.DEFAULT_MINVAL,this.maxval=t.maxval||this.DEFAULT_MAXVAL,this.seed=t.seed}apply(t,e){return Qc(t,this.minval,this.maxval,e,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}Sw.className="RandomUniform",ia(Sw);class Tw extends kw{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,e){if(e=e||"float32","float32"!==e&&"int32"!==e)throw new Yb(`randomNormal does not support dType ${e}.`);return aw(t,this.mean,this.stddev,e,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}Tw.className="RandomNormal",ia(Tw);class Ew extends kw{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,e){if(e=e||"float32","float32"!==e&&"int32"!==e)throw new Yb(`truncatedNormal does not support dType ${e}.`);return Mh(t,this.mean,this.stddev,e,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}Ew.className="TruncatedNormal",ia(Ew);class Nw extends kw{constructor(t){super(),this.gain=null!=t.gain?t.gain:1}apply(t,e){return Io((()=>{if(2!==t.length||t[0]!==t[1])throw new Xb("Identity matrix initializer can only be used for 2D square matrices.");return js(this.gain,Bu(t[0]))}))}getConfig(){return{gain:this.gain}}}function Aw(t,e="channelsLast"){let n,r;if(Av(e),2===t.length)n=t[0],r=t[1];else if(-1!==[3,4,5].indexOf(t.length)){if("channelsFirst"===e){const e=Vv(t,2);n=t[1]*e,r=t[0]*e}else if("channelsLast"===e){const e=Vv(t,0,t.length-2);n=t[t.length-2]*e,r=t[t.length-1]*e}}else{const e=Vv(t);n=Math.sqrt(e),r=Math.sqrt(e)}return[n,r]}Nw.className="Identity",ia(Nw);class Rw extends kw{constructor(t){if(super(),t.scale<0)throw new Xb(`scale must be a positive float. Got: ${t.scale}`);this.scale=null==t.scale?1:t.scale,this.mode=null==t.mode?"fanIn":t.mode,ww(this.mode),this.distribution=null==t.distribution?"normal":t.distribution,xw(this.distribution),this.seed=t.seed}apply(t,e){const n=Aw(t),r=n[0],i=n[1];let o=this.scale;if("fanIn"===this.mode?o/=Math.max(1,r):"fanOut"===this.mode?o/=Math.max(1,i):o/=Math.max(1,(r+i)/2),"normal"===this.distribution){const n=Math.sqrt(o);if(e=e||"float32","float32"!==e&&"int32"!==e)throw new Yb(`${this.getClassName()} does not support dType ${e}.`);return Mh(t,0,n,e,this.seed)}{const n=Math.sqrt(3*o);return Qc(t,-n,n,e,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}Rw.className="VarianceScaling",ia(Rw);class $w extends Rw{constructor(t){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:null==t?null:t.seed})}getClassName(){return Rw.className}}$w.className="GlorotUniform",ia($w);class Dw extends Rw{constructor(t){super({scale:1,mode:"fanAvg",distribution:"normal",seed:null==t?null:t.seed})}getClassName(){return Rw.className}}Dw.className="GlorotNormal",ia(Dw);class Ow extends Rw{constructor(t){super({scale:2,mode:"fanIn",distribution:"normal",seed:null==t?null:t.seed})}getClassName(){return Rw.className}}Ow.className="HeNormal",ia(Ow);class Fw extends Rw{constructor(t){super({scale:2,mode:"fanIn",distribution:"uniform",seed:null==t?null:t.seed})}getClassName(){return Rw.className}}Fw.className="HeUniform",ia(Fw);class Mw extends Rw{constructor(t){super({scale:1,mode:"fanIn",distribution:"normal",seed:null==t?null:t.seed})}getClassName(){return Rw.className}}Mw.className="LeCunNormal",ia(Mw);class Pw extends Rw{constructor(t){super({scale:1,mode:"fanIn",distribution:"uniform",seed:null==t?null:t.seed})}getClassName(){return Rw.className}}Pw.className="LeCunUniform",ia(Pw);class Lw extends kw{constructor(t){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=null==t.gain?this.DEFAULT_GAIN:t.gain,this.seed=t.seed}apply(t,e){return Io((()=>{if(t.length<2)throw new Yb("Shape must be at least 2D.");if("int32"!==e&&"float32"!==e&&void 0!==e)throw new TypeError(`Unsupported data type ${e}.`);const n=w(t.slice(0,-1)),r=t[t.length-1],i=n*r;i>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${i}) elements: Slowness may result.`);const o=[Math.max(r,n),Math.min(r,n)],s=aw(o,0,1,e,this.seed),a=Pp.qr(s,!1);let l=a[0];const u=a[1],c=u.flatten().stridedSlice([0],[Math.min(r,n)*Math.min(r,n)],[Math.min(r,n)+1]);return l=js(l,c.sign()),n<r&&(l=l.transpose()),js(Qs(this.gain),l.reshape(t))}))}getConfig(){return{gain:this.gain,seed:this.seed}}}Lw.className="Orthogonal",ia(Lw);const zw={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function Bw(t,e={}){return uv(t,ra.getMap().classNameMap,e,"initializer")}function Ww(t){return av(t)}function Uw(t){if("string"===typeof t){const e=t in zw?zw[t]:t;if("GlorotNormal"===e)return new Dw;if("GlorotUniform"===e)return new $w;if("HeNormal"===e)return new Ow;if("HeUniform"===e)return new Fw;if("LeCunNormal"===e)return new Mw;if("LeCunUniform"===e)return new Pw;{const t={};return t["className"]=e,t["config"]={},Bw(t)}}return t instanceof kw?t:Bw(t)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function Vw(t){return Array.isArray(t)&&Array.isArray(t[0])}function jw(t){return 0===t.length?[]:Array.isArray(t[0])?t:[t]}function Hw(t){let e;if(Array.isArray(t)){if(1!==t.length)throw new Xb(`Expected Tensor length to be 1; got ${t.length}`);e=t[0]}else e=t;return e}function Gw(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(1===t.length)return t[0];throw new Xb(`Expected exactly 1 Shape; got ${t.length}`)}return t}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function qw(t){let e=0;for(const n of t)0===n.shape.length?e+=1:e+=n.shape.reduce(((t,e)=>t*e));return e}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
const Kw="Variable";class Xw{constructor(t,e="float32",n=Kw,r=!0,i=null){this.dtype=null==e?"float32":e,this.shape=t.shape,this.id=xv(),n=null==n?Kw:n,this.originalName=Lv(n),this.name=zv(this.originalName),this.trainable_=r,this.constraint=i,this.val=zh(t,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(t){return this.assertNotDisposed(),Yw(this.val,t),this.val.id!==t.id&&(this.val.assign(t),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(t){this.trainable_=t,this.val.trainable=t}}function Yw(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}function Jw(t){return t.map((t=>t.read()))}function Zw(t){t.forEach((t=>{const e=t[0];e.write(t[1])}))}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
class Qw{constructor(t){this.dtype=t.dtype,this.shape=t.shape,null!=t.shape?this.ndim=t.shape.length:this.ndim=t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}}}class tx{constructor(t,e,n,r,i,o,s){this.dtype=t,this.shape=e,this.sourceLayer=n,this.inputs=r,this.callArgs=i,this.outputTensorIndex=s,this.id=xv(),null!=o&&(this.originalName=Lv(o),this.name=zv(this.originalName)),this.rank=e.length}}let ex=0;class nx{constructor(t,e){this.callArgs=e,this.id=ex++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(const n of t.inboundLayers)null!=n&&n.outboundNodes.push(this);t.outboundLayer.inboundNodes.push(this)}getConfig(){const t=[];for(const e of this.inboundLayers)null!=e?t.push(e.name):t.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let rx=0;class ix extends na{constructor(t={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=rx++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let e=t.name;if(!e){const t=this.getClassName();e=iv(t)+"_"+_v(t)}if(this.name=e,this.trainable_=null==t.trainable||t.trainable,null!=t.inputShape||null!=t.batchInputShape){let e;if(null!=t.batchInputShape)e=t.batchInputShape;else if(null!=t.inputShape){let n=null;null!=t.batchSize&&(n=t.batchSize),e=[n].concat(t.inputShape)}this.batchInputShape=e;let n=t.dtype;null==n&&(n=t.inputDType),null==n&&(n="float32"),this.dtype=n}null!=t.weights?this.initialWeights=t.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(t,e){return t.name+"_ib-"+e.toString()}getNodeAtIndex(t,e){if(0===this.inboundNodes.length)throw new Kb(`The layer has never been called and thus has no defined ${e}.`);if(this.inboundNodes.length<=t)throw new Xb(`Asked to get ${e} at node ${t}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[t]}getInputAt(t){return nv(this.getNodeAtIndex(t,"input").inputTensors)}getOutputAt(t){return nv(this.getNodeAtIndex(t,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new qb(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(0===this.inboundNodes.length)throw new qb(`Layer ${this.name} is not connected, no input to return.`);return nv(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(0===this.inboundNodes.length)throw new qb(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new qb(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return nv(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map((t=>t()))}get updates(){return this._updates}get built(){return this._built}set built(t){this._built=t}get trainable(){return this.trainable_}set trainable(t){this._trainableWeights.forEach((e=>e.trainable=t)),this.trainable_=t}get trainableWeights(){return this.trainable_?this._trainableWeights.filter((t=>t.trainable)):[]}set trainableWeights(t){this._trainableWeights=t}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter((t=>!t.trainable)).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(t){this._nonTrainableWeights=t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(t){const e=rv(t);if(null==this.inputSpec||0===this.inputSpec.length)return;const n=rv(this.inputSpec);if(e.length!==n.length)throw new Xb(`Layer ${this.name} expects ${n.length} inputs, but it received ${e.length} input tensors. Input received: ${t}`);for(let r=0;r<e.length;r++){const t=e[r],i=n[r];if(null==i)continue;const o=t.rank;if(null!=i.ndim&&o!==i.ndim)throw new Xb(`Input ${r} is incompatible with layer ${this.name}: expected ndim=${i.ndim}, found ndim=${o}`);if(null!=i.maxNDim&&o>i.maxNDim)throw new Xb(`Input ${r} is incompatible with layer ${this.name}: expected max_ndim=${i.maxNDim}, found ndim=${o}`);if(null!=i.minNDim&&o<i.minNDim)throw new Xb(`Input ${r} is incompatible with layer ${this.name}: expected min_ndim=${i.minNDim}, found ndim=${o}.`);if(null!=i.dtype&&t.dtype!==i.dtype)throw new Xb(`Input ${r} is incompatible with layer ${this.name} : expected dtype=${i.dtype}, found dtype=${t.dtype}.`);if(i.axes){const e=t.shape;for(const t in i.axes){const n=Number(t),o=i.axes[t],s=n>=0?e[n]:e[e.length+n];if(null!=o&&-1===[o,null].indexOf(s))throw new Xb(`Input ${r} is incompatible with layer ${this.name}: expected axis ${n} of input shape to have value ${o} but got shape ${e}.`)}}if(null!=i.shape)for(let e=0;e<i.shape.length;++e){const n=i.shape[e],o=t.shape[e];if(null!=n&&null!=o&&n!==o)throw new Xb(`Input ${r} is incompatible with layer ${this.name}: expected shape=${i.shape}, found shape=${t.shape}.`)}}}call(t,e){return t}invokeCallHook(t,e){null!=this._callHook&&this._callHook(t,e)}setCallHook(t){this._callHook=t}clearCallHook(){this._callHook=null}apply(t,e){e=e||{},this.assertNotDisposed();const n=rv(t),r=lx(t),i=ux(t);if(r===i)throw new Xb("Arguments to apply() must be all SymbolicTensors or all Tensors");return Mv(this.name,(()=>{if(!this.built){this.assertInputCompatibility(t);const e=[];for(const n of rv(t))e.push(n.shape);this.build(nv(e)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),null===this._refCount&&i&&(this._refCount=1)}if(this.assertInputCompatibility(t),i){let r=this.call(t,e);this.supportsMasking&&this.setMaskMetadata(t,r);const i=rv(r),o=[];for(let t of i)-1!==n.indexOf(t)&&(t=t.clone()),o.push(t);if(r=nv(o),null!=this.activityRegularizer)throw new Yb("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return r}{const n=ox(t),r=this.computeOutputShape(n);let i;const o=sx(t);if(this.warnOnIncompatibleInputShape(Array.isArray(t)?n[0]:n),i=null!=r&&r.length>0&&Array.isArray(r[0])?r.map(((n,r)=>new tx(o,n,this,rv(t),e,this.name,r))):new tx(o,r,this,rv(t),e,this.name),this.addInboundNode(t,i,null,null,n,r,e),this._refCount++,null!=this.activityRegularizer)throw new Yb("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return i}}))}warnOnIncompatibleInputShape(t){if(null!=this.batchInputShape)if(t.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(t)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let e=!1;this.batchInputShape.forEach(((n,r)=>{null!=n&&null!=t[r]&&t[r]!==n&&(e=!0)})),e&&console.warn(`The shape of the input tensor (${JSON.stringify(t)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new qb(`The layer ${this.name} has never been called and thus has no defined output shape.`);const t=[];for(const e of this.inboundNodes){const n=JSON.stringify(e.outputShapes);-1===t.indexOf(n)&&t.push(n)}if(1===t.length){const t=this.inboundNodes[0].outputShapes;return Array.isArray(t)&&Array.isArray(t[0])&&1===t.length?t[0]:t}throw new qb(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new Kb(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return qw(this.weights)}build(t){this.built=!0}getWeights(t=!1){return Jw(t?this.trainableWeights:this.weights)}setWeights(t){Io((()=>{const e=this.weights;if(e.length!==t.length)throw new Xb(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${t.length}, but the layer was expecting ${e.length} weights. Provided weights: ${t}...`);if(0===e.length)return;const n=[],r=Jw(e);for(let i=0;i<r.length;++i){const o=r[i],s=e[i],a=t[i];if(!x(o.shape,a.shape))throw new Xb(`Layer weight shape ${o.shape} not compatible with provided weight shape ${a.shape}`);n.push([s,a])}Zw(n)}))}addWeight(t,e,n,r,i,o,s,a){if(-1!==this._addedWeightNames.indexOf(t))throw new Xb(`Duplicate weight name ${t} for layer ${this.name}`);this._addedWeightNames.push(t),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(r=null!=a?a():Uw("zeros"));const l=r.apply(e,n),u=new Xw(l,n,t,o,s);return l.dispose(),null!=i&&this.addLoss((()=>i.apply(u.read()))),null==o&&(o=!0),o?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}setFastWeightInitDuringBuild(t){this.fastWeightInitDuringBuild=t}addLoss(t){null==t||Array.isArray(t)&&0===t.length||(t=rv(t),void 0!==this._losses&&null!==this._losses&&this.losses.push(...t))}computeOutputShape(t){return t}computeMask(t,e){if(!this.supportsMasking){if(null!=e){if(!Array.isArray(e))throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);e.forEach((t=>{if(null!=t)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)}))}return null}return e}setMaskMetadata(t,e,n){if(!this.supportsMasking)return;const r=this.computeMask(t,n),i=rv(e),o=rv(r);if(i.length!==o.length)throw new Error(`${this.name} outputs ${i.length} tensors but ${i.length} masks for those tensors`);for(let s=0;s<i.length;s++)i[s].kerasMask=o[s]}addInboundNode(t,e,n,r,i,o,s=null){const a=rv(t);e=rv(e),n=rv(n),r=rv(r),i=jw(i),o=jw(o);const l=[],u=[],c=[];for(const h of a)l.push(h.sourceLayer),u.push(h.nodeIndex),c.push(h.tensorIndex);new nx({outboundLayer:this,inboundLayers:l,nodeIndices:u,tensorIndices:c,inputTensors:a,outputTensors:e,inputMasks:n,outputMasks:r,inputShapes:i,outputShapes:o},s);for(let h=0;h<e.length;h++)e[h].sourceLayer=this,e[h].nodeIndex=this.inboundNodes.length-1,e[h].tensorIndex=h}getConfig(){const t={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(t["batchInputShape"]=this.batchInputShape),null!=this.dtype&&(t["dtype"]=this.dtype),t}disposeWeights(){return this.weights.forEach((t=>t.dispose())),this.weights.length}assertNotDisposed(){if(0===this._refCount)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(null===this._refCount)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let t=0;return 0===--this._refCount&&(t=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:t}}}function ox(t){t=rv(t);const e=[];for(const n of t)e.push(n.shape);return nv(e)}function sx(t){return"float32"}function ax(t,e,n){if((null==e||null!=n&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),0===e.inboundNodes.length)return[t];{const t=e.inboundNodes[n];if(0===t.inboundLayers.length)return t.inputTensors;{const e=[];for(let n=0;n<t.inboundLayers.length;n++){const r=t.inputTensors[n],i=t.inboundLayers[n],o=t.nodeIndices[n],s=ax(r,i,o);for(const t of s)-1===e.indexOf(t)&&e.push(t)}return e}}}function lx(t){let e=!0;for(const n of rv(t))if(!(n instanceof tx)){e=!1;break}return e}function ux(t){let e=!0;for(const n of rv(t))if(n instanceof tx){e=!1;break}return e}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
class cx extends ix{constructor(t){if(super({dtype:t.dtype,name:null!=t.name?t.name:_v("input").toString()}),null==t.batchSize&&(t.batchSize=null),null==t.sparse&&(t.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=t.sparse,null!=t.inputShape&&null!=t.batchInputShape)throw new Xb("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let e=t.batchInputShape;if(null==e){if(null==t.inputShape)throw new Xb("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");e=[t.batchSize].concat(t.inputShape)}else if(null!=t.batchSize)throw new Xb("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const n=t.dtype||"float32";this.batchInputShape=e,this.dtype=n,this.inputSpec=[{shape:e}];const r=new tx(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new nx({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[e],outputShapes:[e]})}apply(t,e){throw new Xb(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}function hx(t){if(null==t.batchShape&&null==t.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=t.batchShape&&null!=t.shape)throw new Xb("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;null!=t.shape&&null==e&&(e=[null].concat(t.shape));let n=t.dtype;null==n&&(n="float32");const r=new cx({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}),i=r.inboundNodes[0].outputTensors;return i[0]}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function dx(t,e){if(null==t.dtype||t.dtype===e.dtype)return e;try{return $s(e,t.dtype)}catch(JX){throw new Xb(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${t.name}' (${t.dtype}).`)}}cx.className="InputLayer",ia(cx);class px{constructor(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof px)for(const e in t.id2Value)this.id2Value[e]=t.id2Value[e],e in t.id2Mask&&(this.id2Mask[e]=t.id2Mask[e]);else{if(null==t)return;for(const e of t)this.add(e.key,e.value)}}add(t,e,n){if(null!=this.id2Value[t.id])throw new Xb(`Duplicate key: name=${t.name}, id=${t.id}`);return this.id2Value[t.id]=dx(t,e),this.name2Id[t.name]=t.id,null!=n&&(this.id2Mask[t.id]=n),this}addFeed(t){this.add(t.key,t.value)}hasKey(t){return null!=this.id2Value[t.id]}names(){return Object.keys(this.name2Id)}getValue(t){if(t instanceof tx){if(null==this.id2Value[t.id])throw new Xb(`Nonexistent key: ${t.name}`);return this.id2Value[t.id]}{const e=this.name2Id[t];if(null==e)throw new Xb(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Value[e]}}getMask(t){if(t instanceof tx){if(null==this.id2Value[t.id])throw new Xb(`Nonexistent key: ${t.name}`);return this.id2Mask[t.id]}{const e=this.name2Id[t];if(null==e)throw new Xb(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Mask[e]}}disposeMasks(){null!=this.id2Mask&&Co(this.id2Mask)}}const fx=new Zb,gx=new Zb;function mx(t){null!=fx&&fx.setMaxEntries(t),null!=gx&&gx.setMaxEntries(t)}function yx(t,e,n,r){const i=null!=n&&n["training"],o=Array.isArray(t),s=o?t:[t],a=s.map((t=>t.name)),l=[],u=e.names();for(const f of a)-1!==u.indexOf(f)?l.push(e.getValue(f)):l.push(null);null!=r&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);const c=a.join(",")+"|"+e.names().sort().join(",");let h,d=fx.get(c);if(null==d){const t=bx(s,e);d=t.sorted,h=t.recipientCounts,fx.put(c,d),gx.put(c,h)}h={},i||Object.assign(h,gx.get(c));const p=new px(e);for(let f=0;f<d.length;++f){if(null!=r){const t=_o().numTensors;t>r.maxNumTensors&&(r.maxNumTensors=t),t<r.minNumTensors&&(r.minNumTensors=t)}const t=d[f],o=t.sourceLayer;if(o instanceof cx)continue;const s=[],u=[],c=[];let g=!1;for(const n of t.inputs){const t=p.getValue(n),r=p.getMask(n);s.push(t),u.push(r),null!=r&&(g=!0),i||(h[n.name]--,0!==h[n.name]||e.hasKey(n)||-1!==a.indexOf(n.name)||t.isDisposed||!0===n.sourceLayer.stateful||c.push(t))}g&&(n=n||{},n["mask"]=u[0]);const m=rv(o.apply(s,n));let y=null;o.supportsMasking&&(y=o.computeMask(s,u));const b=xx(t),v=Array.isArray(b)?b:[b];for(let e=0;e<v.length;++e){p.hasKey(v[e])||p.add(v[e],m[e],Array.isArray(y)?y[0]:y);const t=a.indexOf(v[e].name);-1!==t&&(l[t]=m[e])}i||Co(c)}return p.disposeMasks(),o?l:l[0]}function bx(t,e){y(null!=t&&t.length>0,(()=>"Expected at least one fetch, got none"));let n=[],r={};if(1===t.length){const i=wx(t[0],e);n=i.sorted,r=i.recipientMap}else{const i=new Set;for(const o of t){const{sorted:t,recipientMap:s}=wx(o,e);for(const e of t)i.has(e.name)||(n.push(e),i.add(e.name));for(const e in s)null==r[e]&&(r[e]=new Set),s[e].forEach((t=>r[e].add(t)))}}return{sorted:n,recipientCounts:vx(r)}}function vx(t){const e={};for(const n in t)e[n]=t[n].size;return e}function wx(t,e){const n=new Set,r=[],i={};for(const a of e.names())n.add(a);const o=[],s=[];o.push(t);while(o.length>0){const t=o[o.length-1];if(n.has(t.name)){o.pop();continue}const e=s[s.length-1]===o.length-1;if(0===t.inputs.length||e)o.pop(),r.push(t),n.add(t.name),e&&s.pop();else{s.push(o.length-1);for(const e of t.inputs)null==i[e.name]&&(i[e.name]=new Set),i[e.name].add(t.name),n.has(e.name)||o.push(e)}}return{sorted:r,recipientMap:i}}function xx(t){let e;if(1===t.sourceLayer.inboundNodes.length)e=t.sourceLayer.output;else{let n=null;for(let e=0;e<t.sourceLayer.inboundNodes.length;++e)for(const r of t.sourceLayer.inboundNodes[e].outputTensors)if(r.id===t.id){n=e;break}e=t.sourceLayer.getOutputAt(n)}return e}
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const kx=it();
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function _x(t,e){return Io((()=>Gs(ic(js(t,t),e,!0))))}kx.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",(()=>100),mx);class Ix extends na{getConfig(){return{}}}class Cx extends Ix{constructor(t){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=null!=t.maxValue?t.maxValue:this.defaultMaxValue,this.axis=null!=t.axis?t.axis:this.defaultAxis}apply(t){return Io((()=>{const e=_x(t,this.axis),n=tu(e,0,this.maxValue);return js(t,Us(n,Ls(Kv(),e)))}))}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}Cx.className="MaxNorm",ia(Cx);class Sx extends Ix{constructor(t){super(),this.defaultAxis=0,this.axis=null!=t.axis?t.axis:this.defaultAxis}apply(t){return Io((()=>Us(t,Ls(Kv(),_x(t,this.axis)))))}getConfig(){return{axis:this.axis}}}Sx.className="UnitNorm",ia(Sx);class Tx extends Ix{apply(t){return nh(t)}}Tx.className="NonNeg",ia(Tx);class Ex extends Ix{constructor(t){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=null!=t.minValue?t.minValue:this.defaultMinValue,this.maxValue=null!=t.maxValue?t.maxValue:this.defaultMaxValue,this.rate=null!=t.rate?t.rate:this.defaultRate,this.axis=null!=t.axis?t.axis:this.defaultAxis}apply(t){return Io((()=>{const e=_x(t,this.axis),n=Ls(js(this.rate,tu(e,this.minValue,this.maxValue)),js(1-this.rate,e));return js(t,Us(n,Ls(Kv(),e)))}))}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}Ex.className="MinMaxNorm",ia(Ex);const Nx={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Ax(t){return av(t)}function Rx(t,e={}){return uv(t,ra.getMap().classNameMap,e,"constraint")}function $x(t){if(null==t)return null;if("string"===typeof t){const e=t in Nx?Nx[t]:t,n={className:e,config:{}};return Rx(n)}return t instanceof Ix?t:Rx(t)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
async function Dx(t){if(null==t)return;const e=[],n=[],r=[];for(const i in t){const o=t[i];if("number"!==typeof o){const t=o;e.push(t.data()),n.push(i),r.push(t)}}if(e.length>0){const i=await Promise.all(e);for(let e=0;e<i.length;++e)t[n[e]]=i[e][0];Co(r)}}function Ox(t){if(null!=t)for(const e in t){const n=t[e];"number"!==typeof n&&n.dispose()}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
var Fx;(function(t){t[t["SILENT"]=0]="SILENT",t[t["VERBOSE"]=1]="VERBOSE"})(Fx||(Fx={}));const Mx=125;class Px{constructor(){this.validationData=null}setParams(t){this.params=t}async onEpochBegin(t,e){}async onEpochEnd(t,e){}async onBatchBegin(t,e){}async onBatchEnd(t,e){}async onTrainBegin(t){}async onTrainEnd(t){}setModel(t){}}class Lx{constructor(t,e=10){null==t&&(t=[]),this.callbacks=t,this.queueLength=e}append(t){this.callbacks.push(t)}setParams(t){for(const e of this.callbacks)e.setParams(t)}setModel(t){for(const e of this.callbacks)e.setModel(t)}async onEpochBegin(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onEpochBegin(t,e)}async onEpochEnd(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onEpochEnd(t,e)}async onBatchBegin(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onBatchBegin(t,e)}async onBatchEnd(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onBatchEnd(t,e)}async onTrainBegin(t){null==t&&(t={});for(const e of this.callbacks)await e.onTrainBegin(t)}async onTrainEnd(t){null==t&&(t={});for(const e of this.callbacks)await e.onTrainEnd(t)}}class zx extends Px{constructor(){super()}async onEpochBegin(t){this.seen=0,this.totals={}}async onBatchEnd(t,e){null==e&&(e={});const n=null==e["size"]?0:e["size"];this.seen+=n;for(const r in e){const t=e[r];if("number"===typeof t)this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+t*n;else{let e;r in this.totals?e=this.totals[r]:this.totals[r]=0;const i=Io((()=>Ls(this.totals[r],js(t,n))));this.totals[r]=i,null!=e&&e.dispose()}}}async onEpochEnd(t,e){if(null!=e)for(const n of this.params["metrics"])null!=this.totals[n]&&("number"===typeof this.totals[n]?e[n]=this.totals[n]/this.seen:Io((()=>{const t=js(Us(1,this.seen),this.totals[n]);e[n]=t,this.totals[n].dispose(),So(e[n])})))}}class Bx extends Px{async onTrainBegin(t){this.epoch=[],this.history={}}async onEpochEnd(t,e){null==e&&(e={}),this.epoch.push(t);for(const n in e)null==this.history[n]&&(this.history[n]=[]),this.history[n].push(e[n])}async syncData(){const t=[],e=[],n=[];for(const i in this.history){const r=this.history[i];for(let o=0;o<r.length;++o)if("number"!==typeof r[o]){const s=r[o];t.push(s.data()),e.push(i),n.push(o)}}const r=await Promise.all(t);for(let i=0;i<r.length;++i){const t=this.history[e[i]][n[i]];t.dispose(),this.history[e[i]][n[i]]=r[i][0]}}}class Wx extends Px{constructor(t,e){if(super(),this.currentEpoch=0,this.nowFunc=t.nowFunc,this.nextFrameFunc=t.nextFrameFunc||Wp,this.yieldEvery=e||"auto","auto"===this.yieldEvery&&(this.yieldEvery=Mx),"never"===this.yieldEvery&&null!=t.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");L(this.yieldEvery)&&(this.maybeWait=bv(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=t.onTrainBegin,this.trainEnd=t.onTrainEnd,this.epochBegin=t.onEpochBegin,this.epochEnd=t.onEpochEnd,this.batchBegin=t.onBatchBegin,this.batchEnd=t.onBatchEnd,this.yield=t.onYield}async maybeWait(t,e,n){const r=[];null!=this.yield&&(await Dx(n),r.push(this.yield(t,e,n))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(t,e){this.currentEpoch=t,null!=this.epochBegin&&(await Dx(e),await this.epochBegin(t,e))}async onEpochEnd(t,e){const n=[];null!=this.epochEnd&&(await Dx(e),n.push(this.epochEnd(t,e))),"epoch"===this.yieldEvery&&n.push(this.nextFrameFunc()),await Promise.all(n)}async onBatchBegin(t,e){null!=this.batchBegin&&(await Dx(e),await this.batchBegin(t,e))}async onBatchEnd(t,e){const n=[];null!=this.batchEnd&&(await Dx(e),n.push(this.batchEnd(t,e))),"batch"===this.yieldEvery?n.push(this.nextFrameFunc()):L(this.yieldEvery)&&n.push(this.maybeWait(this.currentEpoch,t,e)),await Promise.all(n)}async onTrainBegin(t){null!=this.trainBegin&&(await Dx(t),await this.trainBegin(t))}async onTrainEnd(t){null!=this.trainEnd&&(await Dx(t),await this.trainEnd(t))}}function Ux(t,e){if(null==t&&(t={}),t instanceof Px)return[t];if(Array.isArray(t)&&t[0]instanceof Px)return t;const n=rv(t);return n.map((t=>new Wx(t,e)))}class Vx{constructor(){}static registerCallbackConstructor(t,e){y(t>=0&&Number.isInteger(t),(()=>`Verbosity level is expected to be an integer >= 0, but got ${t}`)),Vx.checkForDuplicate(e),null==Vx.constructors[t]&&(Vx.constructors[t]=[]),Vx.constructors[t].push(e)}static checkForDuplicate(t){for(const e in Vx.constructors){const n=Vx.constructors[+e];n.forEach((e=>{if(e===t)throw new Xb("Duplicate callback constructor.")}))}}static clear(){Vx.constructors={}}static createCallbacks(t){const e=[];for(const n in Vx.constructors){const r=+n;t>=r&&e.push(...Vx.constructors[r])}return e.map((t=>new t))}}function jx(t,e,n,r,i,o,s,a,l){const u=new Bx,c=[new zx,...Vx.createCallbacks(e)];null!=t&&c.push(...t),c.push(u);const h=new Lx(c);return h.setParams({epochs:n,initialEpoch:r,samples:i,steps:o,batchSize:s,verbose:e,doValidation:a,metrics:l}),{callbackList:h,history:u}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function Hx(t,e={},n=!1){return uv(t,ra.getMap().classNameMap,e,"layer",n)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function Gx(t,e){return Io((()=>{"float32"!==t.dtype&&(t=$s(t,"float32"));const n=ic(cw(t),e,!0),r=aa(n.shape,Kv()),i=Gs(wa(n,r));return Us(t,i)}))}function qx(t,e){return Io((()=>Sc(cw(da(e,t)),-1)))}function Kx(t,e){return Io((()=>Sc(ga(da(e,t)),-1)))}function Xx(t,e){return Io((()=>{const n=da(t,e),r=tu(ga(t),Kv(),Number.MAX_VALUE),i=ga(Us(n,r));return js(100,Sc(i,-1))}))}function Yx(t,e){return Io((()=>{const n=tu(e,Kv(),Number.MAX_VALUE),r=Zu(Ls(1,n)),i=tu(t,Kv(),Number.MAX_VALUE),o=Zu(Ls(1,i));return Sc(cw(da(r,o)),-1)}))}function Jx(t,e){return Io((()=>{const n=wa(0,da(1,js(t,e)));return Sc(cw(n),-1)}))}function Zx(t,e){return Io((()=>{const n=wa(0,da(1,js(t,e)));return Sc(n,-1)}))}function Qx(t,e){return Io((()=>{const n=ic(js(t,e),-1),r=nc(js(da(1,t),e),-1);return wa(0,Ls(1,da(r,n)))}))}function tk(t,e){return Io((()=>{const n=Math.log(2),r=da(e,t),i=da(Ls(r,Ih(js(-2,r))),n);return Sc(i,-1)}))}function ek(t,e,n=!1){return Io((()=>{if(n)e=kh(e);else{const t=ic(e,e.shape.length-1,!0);e=Us(e,t)}return e=tu(e,Kv(),1-Kv()),Oc(ic(js($s(t,"float32"),Zu(e)),e.shape.length-1))}))}function nk(t,e,n=!1){return Io((()=>{const r=$s(Uu(Qv(t)),"int32");e=tu(e,Kv(),1-Kv());const i=e.shape,o=Pl(Lc(r,i[i.length-1]),i);return ek(o,e,n)}))}function rk(t,e){if(!x(t.shape,e.shape))throw new Xb(`logits and labels must have the same shape, but got shapes ${JSON.stringify(t.shape)} and ${JSON.stringify(e.shape)}`);return Io((()=>{const n=nh(e),r=Oc(ga(e));return Ls(da(n,js(e,t)),tc(Ou(r)))}))}function ik(t,e){return Io((()=>{let n;return n=tu(e,Kv(),1-Kv()),n=Zu(Us(n,da(1,n))),Sc(rk(t,n),-1)}))}function ok(t,e){return Io((()=>{const n=tu(t,Kv(),1),r=tu(e,Kv(),1);return ic(js(t,Zu(Us(n,r))),-1)}))}function sk(t,e){return Io((()=>{const n=Zu(Ls(Kv(),e));return Sc(da(e,js(t,n)),-1)}))}function ak(t,e){return Io((()=>{const n=Gx(t,-1),r=Gx(e,-1),i=js(n,r);return Oc(ic(i,-1))}))}Vx.constructors={};const lk={meanSquaredError:qx,meanAbsoluteError:Kx,meanAbsolutePercentageError:Xx,meanSquaredLogarithmicError:Yx,squaredHinge:Jx,hinge:Zx,categoricalHinge:Qx,logcosh:tk,categoricalCrossentropy:ek,sparseCategoricalCrossentropy:nk,binaryCrossentropy:ik,kullbackLeiblerDivergence:ok,poisson:sk,cosineProximity:ak};function uk(t){if("string"===typeof t){if(t in lk)return lk[t];let e=`Unknown loss ${t}`;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${t}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new Xb(e)}return t}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function ck(t,e){return Io((()=>{const n=js(.5,Uc(e)),r=Yv(Gu(e,n),t.dtype);return Sc($u(t,r),-1)}))}function hk(t,e){return Io((()=>Yv($u(ml(t,-1),ml(e,-1)),"float32")))}function dk(t,e){return Io((()=>$s(ic(bc($u(t,1),$u(e,1))),"float32")))}function pk(t,e){return Io((()=>$s(ic(bc($u(t,0),$u(e,1))),"float32")))}function fk(t,e){return Io((()=>{const n=dk(t,e),r=pk(t,e),i=Ls(n,r);return $s(Wh(Gu(i,0),Us(n,i),0),"float32")}))}function gk(t,e){return ik(t,e)}function mk(t,e){return t.rank===e.rank&&(t=Eh(t,[t.rank-1])),e=ml(e,-1),e.dtype!==t.dtype&&(e=$s(e,t.dtype)),$s($u(t,e),"float32")}const yk=qx,bk=qx,vk=Kx,wk=Kx,xk=Xx,kk=Xx,_k=ek,Ik=ak,Ck=nk,Sk={binaryAccuracy:ck,categoricalAccuracy:hk,precision:fk,categoricalCrossentropy:_k,sparseCategoricalCrossentropy:Ck,mse:yk,MSE:bk,mae:vk,MAE:wk,mape:xk,MAPE:kk,cosine:Ik};function Tk(t){if("string"===typeof t&&t in Sk)return Sk[t];if("string"!==typeof t&&null!=t)return t;throw new Xb(`Unknown metric ${t}`)}function Ek(t){if(tv(null!==t,`Unknown LossOrMetricFn ${t}`),"string"===typeof t)return t;{let e;for(const n of Object.keys(lk))if(lk[n]===t){e=n;break}if(void 0!==e)return e;for(const n of Object.keys(Sk))if(Sk[n]===t){e=n;break}return void 0!==e?e:t.name}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function Nk(t){const e={Adagrad:()=>zp.adagrad(.01),Adadelta:()=>zp.adadelta(1,.95,Kv()),Adam:()=>zp.adam(.001,.9,.999,Kv()),Adamax:()=>zp.adamax(.002,.9,.999,Kv(),0),RMSProp:()=>zp.rmsprop(.001,.9,0,Kv()),SGD:()=>zp.sgd(.01)};if(e["adagrad"]=e["Adagrad"],e["adadelta"]=e["Adadelta"],e["adam"]=e["Adam"],e["adamax"]=e["Adamax"],e["rmsprop"]=e["RMSProp"],e["sgd"]=e["SGD"],t in e)return e[t]();throw new Xb(`Unknown Optimizer ${t}`)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
const Ak=1048576;function Rk(t,e,n=!1){if(null==t||"object"!==typeof t||Object.getPrototypeOf(t)!==Object.prototype||!$k(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const n=JSON.stringify(t);n.length>Ak&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${n.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${Ak}.`)}}function $k(t){if(null===t)return!0;if("object"===typeof t){if(Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);for(const n of e){if("string"!==typeof n)return!1;if(!$k(t[n]))return!1}return!0}if(Array.isArray(t)){for(const e of t)if(!$k(e))return!1;return!0}return!1}{const e=typeof t;return"string"===e||"number"===e||"boolean"===e}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function Dk(t,e,n,r=console.log){const i=Fk(t),o=["Layer (type)","Input Shape","Output shape","Param #"];let s;if(i?(e=e||90,n=n||[.32,.61,.89,1]):(e=e||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map((t=>Math.floor(e*t)))),!i){o.push("Receives inputs"),s=[];for(const e in t.nodesByDepth)s.push(...t.nodesByDepth[e])}r("_".repeat(e)),Mk(o,n,r),r("=".repeat(e));const a=t.layers;for(let c=0;c<a.length;++c)i?Pk(a[c],n,r):Lk(a[c],n,s,r),r((c===a.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const l=Ok(t),u=qw(t.nonTrainableWeights);r(`Total params: ${l+u}`),r(`Trainable params: ${l}`),r(`Non-trainable params: ${u}`),r("_".repeat(e))}function Ok(t){let e;return e=null!=t.collectedTrainableWeights?qw(t.collectedTrainableWeights):qw(t.trainableWeights),e}function Fk(t){let e=!0;const n=[],r=[];for(const i in t.nodesByDepth)n.push(t.nodesByDepth[i]);for(const i of n){if(i.length>1||1===i.length&&i[0].inboundLayers.length>1){e=!1;break}r.push(...i)}if(e)for(const i of t.layers){let t=!1;for(const n of i.inboundNodes)if(-1!==r.indexOf(n)){if(t){e=!1;break}t=!0}if(!e)break}return e}function Mk(t,e,n=console.log){let r="";for(let i=0;i<t.length;++i)i>0&&(r=r.slice(0,r.length-1)+" "),r+=t[i],r=r.slice(0,e[i]),r+=" ".repeat(e[i]-r.length);n(r)}function Pk(t,e,n){let r,i;try{i=t.inboundNodes.map((t=>JSON.stringify(t.inputShapes))).join(",")}catch(JX){i="multiple"}try{r=JSON.stringify(t.outputShape)}catch(JX){r="multiple"}const o=t.name,s=t.getClassName(),a=[`${o} (${s})`,i,r,t.countParams().toString()];Mk(a,e,n)}function Lk(t,e,n,r){let i,o;try{o=t.inboundNodes.map((t=>JSON.stringify(t.inputShapes))).join(",")}catch(JX){o="multiple"}try{i=JSON.stringify(t.outputShape)}catch(JX){i="multiple"}const s=[];for(const h of t.inboundNodes)if(!(null!=n&&n.length>0&&-1===n.indexOf(h)))for(let t=0;t<h.inboundLayers.length;++t){const e=h.inboundLayers[t].name,n=h.nodeIndices[t],r=h.tensorIndices[t];s.push(`${e}[${n}][${r}]`)}const a=t.name,l=t.getClassName(),u=0===s.length?"":s[0],c=[`${a} (${l})`,o,i,t.countParams().toString(),u];Mk(c,e,r);for(let h=1;h<s.length;++h)Mk(["","","","",s[h]],e,r)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function zk(t,e,n){return("inboundNodes"===t||"outputLayers"===t||"inputLayers"===t)&&0===e&&"string"===typeof n}function Bk(t,e){if(null===t)return null;if("string"===typeof t)return ov(t);if("number"===typeof t||"boolean"===typeof t)return t;if(t instanceof Array){const n=[],r=t.length;for(let i=0;i<r;++i){const r=t[i];zk(e,i,r)?n.push(r):n.push(Bk(r,e))}return n}{const e={};for(const n of Object.keys(t)){const r=t[n];if("name"===n&&"string"===typeof r)e[n]=r;else{const t=ov(n);e[t]=Bk(r,t)}}return e}}function Wk(t,e){if(null===t||void 0===t)return null;if("string"===typeof t)return iv(t);if("number"===typeof t||"boolean"===typeof t)return t;if(t instanceof Array){const n=[],r=t.length;for(let i=0;i<r;++i){const r=t[i];zk(e,i,r)?n.push(r):n.push(Wk(r,e))}return n}{const e={};for(const n of Object.keys(t)){const r=t[n],i=iv(n);e[i]="name"!==n&&"className"!==n||"string"!==typeof r?Wk(r,n):r}return e}}
/** @license See the LICENSE file. */
const Uk="4.16.0",Vk=t=>{const e=Object.keys(t);if(0===e.length)return!1;const n=e[0].split("/");return!isNaN(parseInt(n[n.length-1],10))};class jk extends ix{constructor(t){if(super({}),this.containerNodes=new Set,this.name=t.name,null==this.name){const t=this.getClassName().toLowerCase();this.name=_v(t)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(t.inputs)?this.inputs=t.inputs.slice():this.inputs=[t.inputs],Array.isArray(t.outputs)?this.outputs=t.outputs.slice():this.outputs=[t.outputs],dv(this.inputs).length!==this.inputs.length)throw new Xb(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map((t=>t.name))}`);dv(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map((t=>t.name))}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const y of this.outputs){const t=y.sourceLayer,e=y.nodeIndex,n=y.tensorIndex;this.outputLayers.push(t),this.outputLayersNodeIndices.push(e),this.outputLayersTensorIndices.push(n)}for(const y of this.inputs){const t=y.sourceLayer,e=y.nodeIndex,n=y.tensorIndex;tv(0===e,"input layer has >1 nodes"),tv(0===n,"input layer has >1 tensors"),this.inputLayers.push(t),this.inputLayersNodeIndices.push(e),this.inputLayersTensorIndices.push(n)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let y=0;y<this.inputLayers.length;y++){const e=this.inputLayers[y];if(!(e instanceof cx))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${t.inputs}. Input ${y} (0-based) originates from layer type ${e.getClassName()}.`);this.inputNames.push(e.name),this.feedInputShapes.push(e.batchInputShape),this.feedInputNames.push(e.name)}for(const y of this.outputLayers)this.outputNames.push(y.name);this.internalInputShapes=this.inputs.map((t=>t.shape)),this.internalOutputShapes=this.outputs.map((t=>t.shape));const e={},n={},r={},i={},o={},s=[],a=(t,e,n,r,i,l)=>{null!=r&&null!=i&&null!=l||(r=t.sourceLayer,i=t.nodeIndex,l=t.tensorIndex);const u=r.inboundNodes[i];if(-1!==n.indexOf(u))throw new Kb(`The tensor ${t.name} at layer "${r.name}" is part of a cycle.`);if(-1!==e.indexOf(u))return;this.containerNodes.add(jk.nodeKey(r,i)),r.id in o||(o[r.id]=Object.keys(o).length),-1===n.indexOf(u)&&n.push(u);const c=u.inboundLayers.length;for(let o=0;o<c;o++){const t=u.inputTensors[o],r=u.inboundLayers[o],i=u.nodeIndices[o],s=u.tensorIndices[o];a(t,e,n,r,i,s)}e.push(u);while(n.indexOf(u)>=0)n.splice(n.indexOf(u),1);s.push(u)},l=[],u=[];for(const y of this.outputs)a(y,l,u);const c=s.slice().reverse();for(const y of c){n[y.id]=y,y.id in e||(e[y.id]=0);let t=e[y.id];const o=null==r[y.outboundLayer.id]?0:r[y.outboundLayer.id];t=Math.max(t,o),r[y.outboundLayer.id]=t,i[y.outboundLayer.id]=y.outboundLayer,e[y.id]=t;for(let r=0;r<y.inboundLayers.length;r++){const i=y.inboundLayers[r],o=y.nodeIndices[r],s=i.inboundNodes[o],a=null==e[s.id]?0:e[s.id];e[s.id]=Math.max(t+1,a),n[s.id]=s}}const h={};for(const y in e){const t=e[y];t in h||(h[t]=[]),h[t].push(n[y])}const d={};for(const y in r){const t=r[y];t in d||(d[t]=[]),d[t].push(i[y])}let p=Object.keys(d).map((t=>parseInt(t,10))).sort(hv);this.layers=[];for(const y of p){const t=d[y];t.sort(((t,e)=>{const n=o[t.id],r=o[e.id];return n<r?-1:n>r?1:0}));for(const e of t)e instanceof jk&&this.internalContainerRefs.push(e),this.layers.push(e)}this.layersByDepth=d,p=Object.keys(h).map((t=>parseInt(t,10))).sort(hv);const f=this.inputs.slice(),g=[];for(const y of p)for(const t of h[y]){const e=t.outboundLayer;if(null!=e){for(const n of t.inputTensors)if(-1===f.indexOf(n))throw new Kb(`Graph disconnected: cannot obtain value for tensor ${n} at layer "${e.name}". The following previous layers were accessed without issue: ${g}`);for(const e of t.outputTensors)f.push(e);g.push(e.name)}}this.nodesByDepth=h;const m=this.layers.map((t=>t.name));for(const y of m){const t=m.filter((t=>t===y)).length;if(1!==t)throw new Kb(`The name "${y}" is used ${t} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(m))}this.outboundNodes=[],this.inboundNodes=[],new nx({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map((t=>null)),outputMasks:this.outputs.map((t=>null)),inputShapes:this.inputs.map((t=>t.shape)),outputShapes:this.outputs.map((t=>t.shape))}),this.built=!0,this._refCount=1}assertNotDisposed(){if(0===this._refCount)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const t={refCountAfterDispose:null,numDisposedVariables:0};if(0===--this._refCount){for(const e of this.layers)t.numDisposedVariables+=e.dispose().numDisposedVariables;for(const e of this.internalContainerRefs)t.numDisposedVariables+=e.dispose().numDisposedVariables}return t.refCountAfterDispose=this._refCount,t}get trainable(){return this.trainable_}set trainable(t){this.layers.forEach((e=>{e._trainableWeights.forEach((e=>e.trainable=t))})),this.trainable_=t}get trainableWeights(){if(this._trainableWeights.length>0)throw new Xb("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let t=[];for(const e of this.layers)t=t.concat(e.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const e of this.layers)t.push(...e.nonTrainableWeights);if(!this.trainable){const e=[];for(const t of this.layers)e.push(...t.trainableWeights);return e.concat(t)}return t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(t,e=!0){const n={};let r=0;const i=Vk(t);i&&this.parseWeights(t);for(const s of this.layers)for(const[t,e]of s.weights.entries()){const o=i?`${e.name.split("/").slice(0,-1).join("/")+"/"}${t}`:e.originalName;if(null!=n[o])throw new Xb(`Duplicate weight name: ${o}`);n[o]=e,r++}const o=[];for(const s in t){let r=s;if(null==n[s]){const t=s.split("/"),e=t.slice(0,-2).concat([t[t.length-1]]);r=e.join("/")}if(null!=n[r])o.push([n[r],t[s]]);else if(e)throw new Xb(`Provided weight data has no target variable: ${s}`);delete n[r]}if(e){const t=[];for(const e in n)t.push(e);if(t.length>0)throw new Xb(`${t.length} of ${r} weights are not set: ${t}`)}Zw(o)}parseWeights(t){for(const e in Object.keys(t)){const n=e.split("/"),r=["vars","layer_checkpoint_dependencies"],i=n.map((t=>t.startsWith("_")?t.slice(1):t)).filter((t=>!r.includes(t))).join("/");i!==e&&(t[i]=t[e],delete t[e])}}updatedConfig(){const t=this.getConfig(),e={};return e["className"]=this.getClassName(),e["config"]=t,e["kerasVersion"]=`tfjs-layers ${Uk}`,e["backend"]="TensorFlow.js",e}toJSON(t,e=!0){const n=Wk(this.updatedConfig());return e?JSON.stringify(n):n}call(t,e){return Io((()=>{t=rv(t);const n=new px;for(let e=0;e<this.inputs.length;++e)n.add(this.inputs[e],t[e]);return yx(this.outputs,n,e)}))}computeMask(t,e){return Io((()=>{let n;return t=rv(t),n=null==e?Qb(null,t.length):rv(e),this.runInternalGraph(t,n)[1]}))}computeOutputShape(t){const e=jw(t);if(e.length!==this.inputLayers.length)throw new Xb(`Invalid inputShape argument ${t}: model has ${this.inputLayers.length} tensor inputs.`);const n={};for(let s=0;s<e.length;s++){const t=this.inputLayers[s],r=e[s],i=t.name+"_0_0";n[i]=r}const r=Object.keys(this.nodesByDepth).map((t=>parseInt(t,10))).sort(hv);if(r.length>1)for(const s of r){const t=this.nodesByDepth[s];for(const e of t){const t=e.outboundLayer;if(-1!==this.inputLayers.map((t=>t.id)).indexOf(t.id))continue;const r=[];for(let a=0;a<e.inboundLayers.length;a++){const t=e.inboundLayers[a],i=e.nodeIndices[a],o=e.tensorIndices[a],s=`${t.name}_${i}_${o}`,l=n[s];r.push(l)}const i=t.computeOutputShape(nv(r)),o=jw(i),s=t.inboundNodes.indexOf(e);for(let e=0;e<o.length;e++){const r=`${t.name}_${s}_${e}`;n[r]=o[e]}}}const i=[],o=[];for(let s=0;s<this.outputLayers.length;s++){const t=this.outputLayers[s],e=this.outputLayersNodeIndices[s],n=this.outputLayersTensorIndices[s],r=`${t.name}_${e}_${n}`;o.push(r)}for(let s=0;s<o.length;s++){const t=o[s];tv(t in n),i.push(n[t])}return nv(i)}runInternalGraph(t,e){null==e&&(e=Qb(null,t.length));const n={};for(let a=0;a<this.inputs.length;++a){const r=this.inputs[a],i=t[a],o=e[a];n[r.id]=[i,o]}const r=Object.keys(this.nodesByDepth).map((t=>parseInt(t,10))).sort(hv);for(const a of r){const t=this.nodesByDepth[a];for(const e of t){const t=e.outboundLayer,r=e.inputTensors,i=e.outputTensors,o=new Array;for(const e of r)e.id in n&&o.push(n[e.id]);if(o.length===r.length){let r,s,a,l,u={};if(null!=e.callArgs&&(u=e.callArgs),1===o.length){const[e,n]=o[0];null==u["mask"]&&(u["mask"]=n),a=rv(t.call(e,u)),l=rv(t.computeMask(e,n)),r=[e],s=[n]}else r=o.map((t=>t[0])),s=o.map((t=>t[1])),null==u["mask"]&&(u["mask"]=s),a=rv(t.call(r,u)),l=rv(t.computeMask(r,s));if(t.activityRegularizer)throw new Yb("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let t=0;t<i.length;++t){const e=i[t],r=a[t],o=l[t];n[e.id]=[r,o]}}}}const i=[],o=[],s=[];for(const a of this.outputs){tv(a.id in n,`Could not compute output ${a.name} : ${a.id}`);const[t,e]=n[a.id];s.push(t.shape),i.push(t),o.push(e)}return[i,o,s]}buildNodeConversionMap(t){const e={};let n;for(const r of this.layers){n=r instanceof jk?1:0;for(let t=0;t<r.inboundNodes.length;t++){const i=jk.nodeKey(r,t);this.containerNodes.has(i)&&(e[i]=n,n+=1)}}return e}getLayer(t,e){if(null!=e)return this.findLayer(e);if(null==t)throw new Xb("Provide either a layer name or layer index");if("number"===typeof t)return this.findLayer(t);for(const n of this.layers)if(n.name===t)return n;throw new Xb(`No such layer: ${t}`)}findLayer(t){if(this.layers.length<=t)throw new Xb(`Was asked to retrieve layer at index ${t}, but model only has ${this.layers.length} layer(s).`);return this.layers[t]}calculateLosses(){return Io((()=>{const t=[];for(const e of this.layers)for(let n=0;n<e.inboundNodes.length;++n){const r=jk.nodeKey(e,n);this.containerNodes.has(r)&&t.push(...e.calculateLosses())}return t}))}getConfig(){const t={name:this.name},e=this.buildNodeConversionMap(this.layers),n=[];for(const o of this.layers){const t=o.getClassName(),r=o.getConfig(),i=[];for(let n=0;n<o.inboundNodes.length;n++){const t=o.inboundNodes[n],r=jk.nodeKey(o,n);let s={};if(this.containerNodes.has(r)){if(t.callArgs)try{JSON.stringify(t.callArgs),s=t.callArgs}catch(JX){console.warn(`Layer ${o.name} was passed non-serializable keyword arguments: ${t.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),s={}}if(t.inboundLayers.length>0){const n=[];for(let r=0;r<t.inboundLayers.length;r++){const i=t.inboundLayers[r],o=t.nodeIndices[r],a=t.tensorIndices[r],l=jk.nodeKey(i,o);let u=e[l];null==u&&(u=0),n.push([i.name,u,a,s])}i.push(n)}}}const s={};s["name"]=o.name,s["className"]=t,s["config"]=r,s["inboundNodes"]=i,n.push(s)}t["layers"]=n;const r=[];for(let o=0;o<this.inputLayers.length;o++){const t=this.inputLayers[o],n=this.inputLayersNodeIndices[o],i=jk.nodeKey(t,n);if(!this.containerNodes.has(i))continue;let s=e[i];null!==s&&void 0!==s||(s=0);const a=this.inputLayersTensorIndices[o];r.push([t.name,s,a])}t["inputLayers"]=r;const i=[];for(let o=0;o<this.outputLayers.length;o++){const t=this.outputLayers[o],n=this.outputLayersNodeIndices[o],r=jk.nodeKey(t,n);if(!this.containerNodes.has(r))continue;let s=e[r];null!==s&&void 0!==s||(s=0);const a=this.outputLayersTensorIndices[o];i.push([t.name,s,a])}return t["outputLayers"]=i,t}static fromConfig(t,e,n={},r=!1){const i={},o={};function s(t,e){t.name in o?o[t.name].push(e):o[t.name]=[e]}function a(t,e){const n=[];let r;for(const o of e){const a=o[0],l=o[1],u=o[2];if(r=null==o[3]?{}:o[3],!(a in i))return void s(t,e);const c=i[a];if(c.inboundNodes.length<=l)return void s(t,e);const h=c.inboundNodes[l];n.push(h.outputTensors[u])}n.length>0&&t.apply(nv(n),r)}function l(t){const n=t["name"],o=Hx(t,null!=e["customObjects"]?e["customObjects"]:{});o.setFastWeightInitDuringBuild(r),i[n]=o;const a=t["inboundNodes"];a.forEach((t=>{if(!(t instanceof Array))throw new Xb(`Corrupted configuration, expected array for nodeData: ${t}`);s(o,t)}))}const u=e["name"],c=e["layers"];for(const g of c)l(g);while(!pv(o))for(const t of c){const e=i[t["name"]];if(e.name in o){const t=o[e.name];delete o[e.name];for(const n of t)a(e,n)}}const h=[],d=[],p=e["inputLayers"];for(const g of p){const t=g[0],e=g[1],n=g[2];tv(t in i);const r=i[t],o=r.inboundNodes[e].outputTensors;h.push(o[n])}const f=e["outputLayers"];for(const g of f){const t=g[0],e=g[1],n=g[2];tv(t in i);const r=i[t],o=r.inboundNodes[e].outputTensors;d.push(o[n])}return new t({inputs:h,outputs:d,name:u})}get stateful(){if(this._stateful)throw new Xb("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const t of this.layers)if(t.stateful)return!0;return!1}resetStates(){Io((()=>{this.layers.forEach((t=>{t.stateful&&t.resetStates()}))}))}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function Hk(t,e,n){const r=e.length;if(null==t||Array.isArray(t)&&0===t.length)return e.map((t=>null));if(1===r)return Array.isArray(t)&&1===t.length?t:"object"===typeof t&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==r)throw new Error(`Provided ${n} is an array of ${t.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return t}if("object"===typeof t&&Object.keys(t).length>0&&"object"===typeof t[Object.keys(t)[0]]){const n=[];return e.forEach((e=>{e in t?n.push(t[e]):n.push(null)})),n}throw new Error(`The model has multiple (${r}) outputs, so ${n} must be either an array with ${r} elements or an object with ${e} keys. Provided ${n} not understood: ${JSON.stringify(t)}`)}function Gk(t,e){return Hk(t,e,"classWeight")}async function qk(t,e,n,r){if(null!=e||null!=r)throw new Error("Support sampleWeight is not implemented yet");if(null!=n){const e=Io((()=>{if(1===t.shape.length)return Os(t);if(2===t.shape.length){if(t.shape[1]>1){const e=1;return ml(t,e)}if(1===t.shape[1])return Pl(t,[t.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${t.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}throw new Error(`Unexpected rank of target (y) tensor (${t.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)})),r=Array.from(await e.data());Co(e);const i=[];return r.forEach((t=>{if(null==n[t])throw new Error(`classWeight must contain all classes in the training data. The class ${t} exists in the data but not in classWeight`);i.push(n[t])})),Dh(i,"float32")}return null}function Kk(t,e){return js(t,e)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
const Xk=32;function Yk(t,e){let n,r;const i=e;n=i["xs"],r=i["ys"],y(null!=n&&null!=r,(()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`));const o=Jk("input",t.inputNames,n),s=Jk("output",t.outputNames,r),a=o[0].shape[0];y(o.length===t.inputs.length,(()=>`LayersModel has ${t.inputs.length} inputs, but the dataset provides ${o.length} inputs.  (Expected input keys: ${JSON.stringify(t.inputNames)})`)),y(s.length===t.outputs.length,(()=>`LayersModel has ${t.outputs.length} outputs, but the dataset provides ${s.length} outputs.  (Expected output keys: ${JSON.stringify(t.outputNames)})`));for(let l=0;l<o.length;l++)y(o[l].shape[0]===a,(()=>`Batch size mismatch: input ${t.inputNames[l]} has ${o[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`));for(let l=0;l<s.length;l++)y(s[l].shape[0]===a,(()=>`Batch size mismatch: output ${t.outputNames[l]} has ${s[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`));return{xs:o,ys:s}}function Jk(t,e,n){if(n instanceof Ai)return[n];if(Array.isArray(n))return y(n.length===e.length,(()=>`Received an array of ${n.length} Tensors, but expected ${e.length} to match the ${t} keys ${e}.`)),n;{const r=[];for(const i of e){if(null==n[i])throw new Xb(`The feature data generated by the dataset lacks the required ${t} key '${i}'.`);r.push(n[i])}return r}}function Zk(t){if(3===t.length)throw new Yb("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}async function Qk(t,e,n){const r=null!=n.batchesPerEpoch;if(y(null!=t.optimizer,(()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig).")),y(null!=n,(()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call.")),y(null!=n.epochs&&n.epochs>0&&Number.isInteger(n.epochs),(()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`)),y(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),(()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`)),y(null==n["validationSplit"],(()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead.")),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const i=null!=n.validationData;let o,s;if(i)if(e_(n.validationData))y(null==n.validationBatches||n.validationBatches>0&&Number.isInteger(n.validationBatches),(()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`));else{const t=Zk(n.validationData);o=t.xs,s=t.ys}const a=t.makeTrainFunction(),l=t.getDedupedMetricsNames();let u;u=i?l.slice().concat(l.map((t=>"val_"+t))):l.slice();const c=Ux(n.callbacks,n.yieldEvery),h=null==n.verbose?1:n.verbose,{callbackList:d,history:p}=jx(c,h,n.epochs,null,null,t_(e,n),null,i,u);d.setModel(t),t.history=p,await d.onTrainBegin(),t.stopTraining_=!1;let f=null==n.initialEpoch?0:n.initialEpoch,g=await e.iterator();while(f<n.epochs){const u={};await d.onEpochBegin(f);let c=0,h=0;r||(g=await e.iterator());while(!r||c<n.batchesPerEpoch){const e=await g.next();if(r&&e.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${c} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, `+n.batchesPerEpoch*n.epochs+" batches). You may need to use the repeat() function when building your dataset.");break}if(null!=e.value){const{xs:r,ys:i}=Yk(t,e.value),o={};o["batch"]=h,o["size"]=r[0].shape[0],await d.onBatchBegin(h,o);const s=[];if(null!=n.classWeight){const e=Gk(n.classWeight,t.outputNames);for(let t=0;t<e.length;++t)s.push(await qk(i[t],null,e[t]))}const u=r.concat(i).concat(s),p=a(u);Co(u);for(let t=0;t<l.length;++t){const e=l[t],n=p[t];o[e]=n,So(n)}await d.onBatchEnd(h,o),Ox(o),h++,c++}if(r?c>=n.batchesPerEpoch:e.done){if(i){let e;e=e_(n.validationData)?rv(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):rv(t.evaluate(o,s,{batchSize:null==n.validationBatchSize?Xk:n.validationBatchSize,verbose:0}));for(let n=0;n<t.metricsNames.length;++n)u[`val_${t.metricsNames[n]}`]=e[n]}break}if(t.stopTraining_)break}if(await d.onEpochEnd(f,u),f++,t.stopTraining_)break}return await d.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}function t_(t,e){let n=null;return null!=e.batchesPerEpoch?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}function e_(t){return"function"===typeof t.iterator}function n_(t){return"function"===typeof t.next}async function r_(t,e,n){n=n||{};const r=null!=n.batches,i=t.testFunction;let o=[];if(n.verbose>0)throw new Yb("Verbose mode is not implemented yet.");y(!r||n.batches>0&&Number.isInteger(n.batches),(()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`));const s=n_(e)?e:await e.iterator();let a=0,l=0;while(!r||l<n.batches){const e=await s.next();if(o=Io((()=>{if(e.value){const{xs:n,ys:r}=Yk(t,e.value),s=n.concat(r),u=Io((()=>i(s)));if(Co(s),0===l)for(let t=0;t<u.length;++t)o.push(Qs(0));const c=s[0].shape[0];for(let t=0;t<u.length;++t){const e=u[t],n=o[t];o[t]=Io((()=>Ls(o[t],js(c,e)))),l>0&&Co(n)}Co(u),a+=c,++l}return o})),e.done){r&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let u=0;u<o.length;++u){const t=o[u];o[u]=Us(o[u],a),Co(t)}return nv(o)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function i_(t){y(t>0&&Number.isInteger(t),(()=>`batchSize is required to be a positive integer, but got ${t}`))}function o_(t,e,n){return null==t?[null]:Array.isArray(t)?t.map((t=>ew(t,e,n-e))):ew(t,e,n-e)}function s_(t,e){return Io((()=>null==t?null:Array.isArray(t)?t.map((t=>s_(t,e))):uw(t,"int32"===e.dtype?e:$s(e,"int32"))))}function a_(t,e){const n=[];let r=0,i=null;while(r<t)i=r+e,i>=t&&(i=t),n.push([r,i]),r=i;return n}function l_(t){const e=[];t instanceof Ai&&(t=[t]);for(let n=0;n<t.length;++n){const r=t[n];if(1===r.rank)e.push(Jv(r,1));else{if(0===r.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(r)}}return e}function u_(t,e){if(null==t)return;const n=[];if(e instanceof Ai)n.push(e.id);else if(Array.isArray(e))e.forEach((t=>n.push(t.id)));else if(null!=e)for(const i in e){const t=e[i];n.push(t.id)}const r=[];if(t instanceof Ai)-1===n.indexOf(t.id)&&r.push(t);else if(Array.isArray(t))t.forEach((t=>{-1===n.indexOf(t.id)&&r.push(t)}));else if(null!=t)for(const i in t){const e=t[i];-1===n.indexOf(e.id)&&r.push(e)}r.forEach((t=>{t.isDisposed||t.dispose()}))}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function c_(t){return t instanceof Ai}function h_(t){return Array.isArray(t)}function d_(t){return!c_(t)&&!h_(t)}function p_(t,e,n,r=!0,i=""){if(null==e||0===e.length){if(null!=t){let e=!1;if(h_(t)&&t.length>0)e=!0;else if(d_(t)){for(const n in t)if(t.hasOwnProperty(n)){e=!0;break}}else e=!0;if(e)throw new Xb(`Error when checking model ${i} expected no data, but got ${t}`)}return[]}if(null==t)return e.map((t=>null));let o;if(d_(t)){o=[];for(const n of e){if(null==t[n])throw new Xb(`No data provided for "${n}". Need data for each key in: ${e}`);o.push(t[n])}}else if(h_(t)){if(t.length!==e.length)throw new Xb(`Error when checking model ${i}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${t}`);o=t}else{if(e.length>1)throw new Xb(`The model ${i} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${t.shape}`);o=[t]}if(o=l_(o),null!=n)for(let s=0;s<e.length;++s){if(null==n[s])continue;const t=o[s];if(t.shape.length!==n[s].length)throw new Xb(`Error when checking ${i}: expected ${e[s]} to have ${n[s].length} dimension(s). but got array with shape ${t.shape}`);for(let e=0;e<n[s].length;++e){if(0===e&&!r)continue;const o=t.shape[e],a=n[s][e];if(null!=a&&a>=0&&o!==a)throw new Xb(`${i} expected a batch of elements where each example has shape [${n[s].slice(1,n[s].length)}] (i.e.,tensor shape [*,${n[s].slice(1,n[s].length)}]) but the ${i} received an input with ${t.shape[0]} examples, each with shape [${t.shape.slice(1,t.shape.length)}] (tensor shape [${t.shape}])`)}}return o}function f_(t,e,n){const r=dv(t.map((t=>t.shape[0])));r.sort();const i=dv(e.map((t=>t.shape[0])));if(i.sort(),r.length>1)throw new Xb(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map((t=>t.shape)))}`);if(i.length>1)throw new Xb(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map((t=>t.shape)))}`);if(r.length>0&&i.length>0&&!x(r,i))throw new Xb(`Input Tensors should have the same number of samples as target Tensors. Found ${r[0]} input sample(s) and ${i[0]} target sample(s).`)}function g_(t,e,n){const r=[qx,ik,ek];for(let i=0;i<t.length;++i){const o=t[i],s=e[i],a=n[i];if(null!=s){if(s===ek&&1===o.shape[o.shape.length-1])throw new Xb(`You are passing a target array of shape ${o.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(-1!==r.indexOf(s)){const t=o.shape.slice(1),e=a.slice(1);for(let n=0;n<t.length;++n){const r=t[n],i=e[n];if(null!=i&&r!==i)throw new Xb(`A target Tensor with shape ${o.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function m_(t,e,n,r=!0,i=""){let o;if(Array.isArray(t)){if(t.length!==e.length)throw new Xb(`Error when checking model ${i}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${t.length} Tensors(s).`);o=t}else{if(e.length>1)throw new Xb(`The model expects ${e.length} ${i} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(t.shape)}.`);o=[t]}if(null!=n)for(let s=0;s<e.length;++s){if(null==n[s])continue;const t=o[s];if(t.shape.length!==n[s].length)throw new Xb(`Error when checking ${i}: expected ${e[s]} to have ${n[s].length} dimension(s), but got array with shape ${JSON.stringify(t.shape)}`);for(let o=0;o<n[s].length;++o){if(0===o&&!r)continue;const a=t.shape[o],l=n[s][o];if(null!=l&&l!==a)throw new Xb(`Error when checking ${i}: expected ${e[s]} to have shape ${JSON.stringify(n[s])} but got array with shape ${JSON.stringify(t.shape)}.`)}}}function y_(t,e){if(null==t||Array.isArray(t)&&0===t.length)return e.map((t=>[]));let n;if("string"===typeof t||"function"===typeof t)n=[t];else{if(!Array.isArray(t)&&"object"!==typeof t)throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${t}`);n=t}if(Array.isArray(n))return e.map((t=>n));{const t=[];for(const r of e){let e=n.hasOwnProperty(r)?n[r]:[];Array.isArray(e)||(e=[e]),t.push(e)}return t}}const b_="layers-model";class v_ extends jk{constructor(t){super(t),this.isTraining=!1}summary(t,e,n=console.log){if(!this.built)throw new Xb("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");Dk(this,t,e,n)}compile(t){if(null==t.loss&&(t.loss=[]),this.loss=t.loss,"string"===typeof t.optimizer)this.optimizer_=Nk(t.optimizer),this.isOptimizerOwned=!0;else{if(!(t.optimizer instanceof oa))throw new Xb("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=t.optimizer,this.isOptimizerOwned=!1}let e=[];if(Array.isArray(t.loss)||"string"===typeof t.loss||"function"===typeof t.loss)if(Array.isArray(t.loss)){if(t.loss.length!==this.outputs.length)throw new Xb(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${t.loss}.`);const n=t.loss;e=n.map((t=>uk(t)))}else{const n=uk(t.loss);this.outputs.forEach((t=>{e.push(n)}))}else{t.loss=t.loss;for(const e in t.loss)if(-1===this.outputNames.indexOf(e))throw new Xb(`Unknown entry in loss dictionary: "${e}". Only expected the following keys: ${this.outputNames}`);for(const n of this.outputNames)null==t.loss[n]&&console.warn(`Output "${n}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${n} during training`),e.push(uk(t.loss[n]))}this.lossFunctions=e,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let o=0;o<this.outputs.length;++o){const t=this.internalOutputShapes[o],e=this.outputNames[o];this.feedOutputNames.push(e),this.feedOutputShapes.push(t),this.feedLossFns.push(this.lossFunctions[o])}const n=[];this.metrics=t.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Mv("loss",(()=>{for(let t=0;t<this.outputs.length;++t){if(-1!==n.indexOf(t))continue;const e=this.lossFunctions[t];this.outputs.length>1&&(this.metricsTensors.push([e,t]),this.metricsNames.push(this.outputNames[t]+"_loss"))}}));const r=y_(t.metrics,this.outputNames),i=(t,e,n)=>{this.outputNames.length>1&&(e=this.outputNames[t]+"_"+e),this.metricsNames.push(e),this.metricsTensors.push([n,t])};Mv("metric",(()=>{for(let t=0;t<this.outputs.length;++t){if(-1!==n.indexOf(t))continue;const e=r[t],o=e=>{const n="";let r,o,s;for(const a of e){if("string"===typeof a&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(a)){const e=this.internalOutputShapes[t];let i;1===e[e.length-1]||this.lossFunctions[t]===ik?-1!==["accuracy","acc"].indexOf(a)?o=ck:-1!==["crossentropy","ce"].indexOf(a)&&(o=gk):this.lossFunctions[t]===nk?-1!==["accuracy","acc"].indexOf(a)?o=mk:-1!==["crossentropy","ce"].indexOf(a)&&(o=Ck):-1!==["accuracy","acc"].indexOf(a)?o=hk:-1!==["crossentropy","ce"].indexOf(a)&&(o=_k),-1!==["accuracy","acc"].indexOf(a)?i="acc":-1!==["crossentropy","ce"].indexOf(a)&&(i="ce"),s=o,r=n+i}else{const t=Tk(a);s=t,r=n+Ek(a)}let e;Mv(r,(()=>{e=s})),i(t,r,e)}};o(e)}})),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(t,e,n={}){const r=null==n.batchSize?32:n.batchSize;i_(r);const i=!0,o=this.standardizeUserDataXY(t,e,i,r);try{const t=o[0].concat(o[1]);this.makeTestFunction();const e=this.testFunction,i=this.testLoop(e,t,r,n.verbose,n.steps);return nv(i)}finally{u_(o[0],t),u_(o[1],e)}}async evaluateDataset(t,e){return this.makeTestFunction(),r_(this,t,e)}checkNumSamples(t,e,n,r="steps"){let i;if(null!=n){if(i=null,null!=e)throw new Xb(`If ${r} is set, batchSize must be null or undefined.Got batchSize = ${e}`)}else{if(null==t)throw new Xb(`Either the input data should have a defined shape, or ${r} shoud be specified.`);i=Array.isArray(t)?t[0].shape[0]:t.shape[0]}return i}execute(t,e){if(Array.isArray(e)&&0===e.length)throw new Xb("`outputs` is an empty Array, which is not allowed.");const n=Array.isArray(e),r=n?e:[e],i=this.retrieveSymbolicTensors(r),o=new px;if(t instanceof Ai&&(t=[t]),Array.isArray(t)){if(t.length!==this.inputs.length)throw new Xb(`The number of inputs provided (${t.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let e=0;e<this.inputs.length;++e)o.add(this.inputs[e],t[e])}else for(const a of this.inputs){const e=t[a.name];if(null==e)throw new Xb(`No value is provided for the model's input ${a.name}`);o.add(a,e)}const s=yx(i,o);return n?s:s[0]}retrieveSymbolicTensors(t){const e=Qb(null,t.length);let n=t.length;for(const r of this.layers){const i=Array.isArray(r.output)?r.output:[r.output],o=i.map((t=>t.name));for(let r=0;r<t.length;++r){const s=o.indexOf(t[r]);if(-1!==s&&(e[r]=i[s],n--),0===n)break}if(0===n)break}if(n>0){const n=[];throw e.forEach(((e,r)=>{null==e&&n.push(t[r])})),new Xb(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(n)}`)}return e}predictLoop(t,e=32,n=!1){return Io((()=>{const r=this.checkNumSamples(t);if(n)throw new Yb("Verbose predictLoop() is not implemented yet.");const i=a_(r,e),o=this.outputs.map((t=>[]));for(let e=0;e<i.length;++e){const n=Io((()=>{const n=i[e][0],r=i[e][1],o=o_(t,n,r),s=[];if(Array.isArray(o))for(let t=0;t<o.length;++t)s.push({key:this.inputs[t],value:o[t]});else s.push({key:this.inputs[0],value:o});const a=new px(s);return yx(this.outputs,a)}));n.forEach(((t,e)=>o[e].push(t)))}return nv(o.map((t=>nu(t,0))))}))}predict(t,e={}){const n=l_(t);m_(n,this.inputNames,this.feedInputShapes,!1);try{const t=null==e.batchSize?32:e.batchSize;return i_(t),this.predictLoop(n,t)}finally{u_(n,t)}}predictOnBatch(t){m_(t,this.inputNames,this.feedInputShapes,!0);const e=(Array.isArray(t)?t[0]:t).shape[0];return this.predictLoop(t,e)}standardizeUserDataXY(t,e,n=!0,r){if(null==this.optimizer_)throw new Kb("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const i=[];for(let o=0;o<this.feedOutputShapes.length;++o){const t=this.feedOutputShapes[o],e=this.feedLossFns[o];e===nk?i.push(t.slice(0,t.length-1).concat([1])):i.push(t)}if(t=p_(t,this.feedInputNames,this.feedInputShapes,!1,"input"),e=p_(e,this.feedOutputNames,i,!1,"target"),f_(t,e,null),g_(e,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=r&&r>0&&t[0].shape[0]%r!==0)throw new Xb(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${r}. Found: ${t[0].shape[0]} sample(s).`);return[t,e]}async standardizeUserData(t,e,n,r,i=!0,o){const[s,a]=this.standardizeUserDataXY(t,e,i,o);if(null!=n)throw new Error("sample weight is not supported yet.");let l=null;if(null!=r){const t=Gk(r,this.outputNames);l=[];for(let e=0;e<t.length;++e)l.push(await qk(a[e],null,t[e]))}return[s,a,l]}testLoop(t,e,n,r=0,i){return Io((()=>{const o=this.checkNumSamples(e,n,i,"steps"),s=[];if(r>0)throw new Yb("Verbose mode is not implemented yet.");if(null!=i)throw new Yb("steps mode in testLoop() is not implemented yet");{const r=a_(o,n),i=Dh(Gv(0,o));for(let n=0;n<r.length;++n){const o=r[n][0],a=r[n][1],l=ew(i,o,a-o),u=s_(e,l),c=t(u);if(0===n)for(let t=0;t<c.length;++t)s.push(Qs(0));for(let t=0;t<c.length;++t){const e=c[t];s[t]=Ls(s[t],js(a-o,e))}}for(let t=0;t<s.length;++t)s[t]=Us(s[t],o)}return s}))}getDedupedMetricsNames(){const t=this.metricsNames,e=[];for(let n=0;n<t.length;++n){const r=t[n];let i=r;if(ev(t,r)>1){const e=ev(t.slice(0,n),r);i+=`_${e}`}e.push(i)}return e}makeTrainFunction(){return t=>{const e=[],n=t.slice(0,this.inputs.length),r=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=t.slice(this.inputs.length+this.outputs.length,this.inputs.length+2*this.outputs.length),o=[],s=()=>{const t=[];for(let e=0;e<this.inputs.length;++e)t.push({key:this.inputs[e],value:n[e]});const s=new px(t),a=yx(this.outputs,s,{training:!0});let l;for(let n=0;n<this.lossFunctions.length;++n){const t=this.lossFunctions[n];let o=t(r[n],a[n]);null!=i[n]&&(o=Kk(o,i[n]));const s=Sc(o);e.push(s),l=0===n?o:Ls(l,o)}for(let n=0;n<this.metricsTensors.length;++n){let t;if(this.outputs.length>1&&n<this.outputs.length)t=e[n];else{const e=this.metricsTensors[n][0],i=this.metricsTensors[n][1];t=Sc(e(r[i],a[i]))}So(t),o.push(t)}return l=Sc(l),this.calculateLosses().forEach((t=>{l=Ls(l,t)})),l},a=this.collectedTrainableWeights.map((t=>t.read())),l=!0,u=this.optimizer_.minimize(s,l,a);return[u].concat(o)}}makeTestFunction(){this.testFunction=t=>Io((()=>{const e=[];let n;const r=t.slice(0,this.inputs.length),i=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=[];for(let t=0;t<this.inputs.length;++t)o.push({key:this.inputs[t],value:r[t]});const s=new px(o),a=yx(this.outputs,s);for(let t=0;t<this.lossFunctions.length;++t){const r=this.lossFunctions[t],o=Sc(r(i[t],a[t]));n=0===t?o:Ls(n,o),e.push(n)}for(let t=0;t<this.metricsTensors.length;++t){const n=this.metricsTensors[t][0],r=this.metricsTensors[t][1],o=Sc(n(i[r],a[r]));e.push(o)}return e}))}async fit(t,e,n={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");let r,i,o,s,a,l,u,c,h;this.isTraining=!0;try{const d=null==n.batchSize?32:n.batchSize;i_(d);const p=!1,f=await this.standardizeUserData(t,e,n.sampleWeight,n.classWeight,p,d);r=f[0],i=f[1],h=f[2];let g,m=!1;if(null!=n.validationData&&n.validationData.length>0){if(m=!0,2!==n.validationData.length)throw 3===n.validationData.length?new Yb("validationData including sample weights is not supported yet."):new Xb(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${n.validationData} is invalid.`);a=n.validationData[0],l=n.validationData[1];const t=!0,e=await this.standardizeUserData(a,l,null,null,t,d);u=e[0],c=e[1],g=u.concat(c)}else if(null!=n.validationSplit&&n.validationSplit>0&&n.validationSplit<1){m=!0;const t=Math.floor(r[0].shape[0]*(1-n.validationSplit)),e=r[0].shape[0];u=o_(r,t,e),o=r,r=o_(r,0,t),c=o_(i,t,e),s=i,i=o_(i,0,t),g=u.concat(c)}else null!=n.validationSteps&&(m=!0);const y=r.concat(i).concat(h);this.checkTrainableWeightsConsistency();const b=this.makeTrainFunction(),v=this.getDedupedMetricsNames();let w,x;m?(this.makeTestFunction(),w=this.testFunction,x=v.slice().concat(v.map((t=>"val_"+t)))):(w=null,g=[],x=v.slice());const k=Ux(n.callbacks,n.yieldEvery),_=await this.fitLoop(b,y,v,d,n.epochs,n.verbose,k,w,g,n.shuffle,x,n.initialEpoch,null,null);return _}finally{this.isTraining=!1,u_(r,t),u_(i,e),u_(o,t),u_(s,e),u_(u,a),u_(c,l),null!=h&&Co(h)}}async fitLoop(t,e,n,r,i,o,s,a,l,u,c,h,p,f){null==r&&(r=32),null==i&&(i=1),null==u&&(u=!0),null==h&&(h=0);let g=!1;if(null!=a&&null!=l&&(g=!0),null!=f&&(g=!0,null==p))throw new Xb("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const m=this.checkNumSamples(e,r,p,"steps_per_epoch");let y;null!=m&&(y=Gv(0,m)),null==o&&(o=1);const{callbackList:b,history:v}=jx(s,o,i,h,m,p,r,g,c);b.setModel(this),this.history=v,await b.onTrainBegin(),this.stopTraining_=!1;for(let w=h;w<i;++w){await b.onEpochBegin(w);const i={};if(null!=p)throw new Yb("stepsPerEpoch mode is not implemented yet.");{if("batch"===u)throw new Yb("batch shuffling is not implemneted yet");u&&d(y);const o=Dh(y),s=a_(m,r);for(let u=0;u<s.length;++u){const c={};if(await b.onBatchBegin(u,c),Io((()=>{const h=s[u][0],d=s[u][1],p=ew(o,h,d-h);c["batch"]=u,c["size"]=d-h;const f=s_(e,p),m=t(f);for(let t=0;t<n.length;++t){const e=n[t],r=m[t];c[e]=r,So(r)}if(u===s.length-1&&g){const t=this.testLoop(a,l,r);for(let e=0;e<n.length;++e){const r=n[e],o=t[e];So(o),i["val_"+r]=o}}})),await b.onBatchEnd(u,c),Ox(c),this.stopTraining_)break}o.dispose()}if(await b.onEpochEnd(w,i),this.stopTraining_)break}return await b.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(t,e){return Qk(this,t,e)}async trainOnBatch(t,e){const n=await this.standardizeUserData(t,e),r=n[0],i=n[1],o=this.makeTrainFunction(),s=o(r.concat(i)),a=[];for(const l of s){const t=await l.data();a.push(t[0])}return Co(s),u_(n[0],t),u_(n[1],e),nv(a)}getNamedWeights(t){const e=[],n=null!=t&&t.trainableOnly,r=n?this.trainableWeights:this.weights,i=this.getWeights(n);for(let o=0;o<r.length;++o)n&&!r[o].trainable||e.push({name:r[o].originalName,tensor:i[o]});return e}set stopTraining(t){this.stopTraining_=t}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(t){this.optimizer_!==t&&(this.optimizer_=t,this.isOptimizerOwned=!1)}dispose(){const t=super.dispose();if(0===t.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){const e=_o().numTensors;this.optimizer_.dispose(),t.numDisposedVariables+=e-_o().numTensors}return t}getLossIdentifiers(){let t;if("string"===typeof this.loss)t=iv(this.loss);else if(Array.isArray(this.loss)){for(const t of this.loss)if("string"!==typeof t)throw new Error("Serialization of non-string loss is not supported.");t=this.loss.map((t=>iv(t)))}else{const e=Object.keys(this.loss);t={};const n=this.loss;for(const r of e){if("string"!==typeof n[r])throw new Error("Serialization of non-string loss is not supported.");t[r]=iv(n[r])}}return t}getMetricIdentifiers(){if("string"===typeof this.metrics||"function"===typeof this.metrics)return[iv(Ek(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map((t=>iv(Ek(t))));{const t={};for(const e in this.metrics)t[e]=iv(Ek(this.metrics[e]));return t}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(t){if(null!=t.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=t.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=t.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");const e=Bk(t.optimizer_config),n=Hx(e);let r,i;if("string"===typeof t.loss)r=ov(t.loss);else if(Array.isArray(t.loss))r=t.loss.map((t=>ov(t)));else if(null!=t.loss){r={};for(const e in t.loss)r[e]=ov(t.loss[e])}if(Array.isArray(t.metrics))i=t.metrics.map((t=>ov(t)));else if(null!=t.metrics){i={};for(const e in t.metrics)i[e]=ov(t.metrics[e])}this.compile({loss:r,metrics:i,optimizer:n})}async save(t,e){if("string"===typeof t){const e=Yo(t);if(0===e.length)throw new Xb(`Cannot find any save handlers for URL '${t}'`);if(e.length>1)throw new Xb(`Found more than one (${e.length}) save handlers for URL '${t}'`);t=e[0]}if(null==t.save)throw new Xb("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const n=await Ao(this.getNamedWeights(e)),r=!1,i=null,o=this.toJSON(i,r),s={modelTopology:o,format:b_,generatedBy:`TensorFlow.js tfjs-layers v${Uk}`,convertedBy:null},a=null!=e&&e.includeOptimizer;if(a&&null!=this.optimizer){s.trainingConfig=this.getTrainingConfig();const t="optimizer",{data:e,specs:r}=await Ao(await this.optimizer.getWeights(),t);n.specs.push(...r),n.data=zo([n.data,e])}if(null!=this.userDefinedMetadata){const t=!0;Rk(this.userDefinedMetadata,this.name,t),s.userDefinedMetadata=this.userDefinedMetadata}return s.weightData=n.data,s.weightSpecs=n.specs,t.save(s)}setUserDefinedMetadata(t){Rk(t,this.name),this.userDefinedMetadata=t}getUserDefinedMetadata(){return this.userDefinedMetadata}}v_.className="Model",ia(v_);class w_ extends v_{}async function x_(t,e){if(null==e&&(e={}),"string"===typeof t){const n=Jo(t,e);if(0===n.length)n.push(ja(t,e));else if(n.length>1)throw new Xb(`Found more than one (${n.length}) load handlers for URL '${t}'`);t=n[0]}return k_(t,void 0,e)}async function k_(t,e,n){if(null==n&&(n={}),null==t.load)throw new Xb("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const r=await t.load();let i=r.modelTopology;null!=i["model_config"]&&(i=i["model_config"]);const o=null==n.strict||n.strict,s=null!=r.weightData&&null!=r.weightSpecs&&o,a=Hx(Bk(i),e,s),l=r.trainingConfig;if(null!=l&&a.loadTrainingConfig(l),null!=r.userDefinedMetadata&&a.setUserDefinedMetadata(r.userDefinedMetadata),null!=r.weightData){if(null==r.weightSpecs)throw new Xb("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");const{modelWeights:t,optimizerWeights:e}=__(r.weightData,r.weightSpecs);a.loadWeights(t,o),null!=a.optimizer&&e.length>0&&await a.optimizer.setWeights(e),Co(t),Co(e.map((t=>t.tensor)))}return a}function __(t,e){const n=Ro(t,e),r={},i=[];return e.forEach((t=>{"optimizer"===t.group?i.push({name:t.name,tensor:n[t.name]}):r[t.name]=n[t.name]})),{modelWeights:r,optimizerWeights:i}}w_.className="Functional",ia(w_);class I_ extends v_{constructor(t){if(super({inputs:[],outputs:[]}),t=t||{},this.trainable=!0,this.built=!1,this.name=null!=t.name?t.name:_v("sequential_"),null!=t.layers)for(const e of t.layers)this.add(e)}checkShape(t){const e=t.inboundNodes[0].outputTensors[0].shape;if(e.some((t=>t<0)))throw new Xb(`Negative dimension size caused by adding layer ${t.name} with input shape [${t.inboundNodes[0].inputTensors[0].shape}]`)}add(t){const e=t instanceof I_||t instanceof v_;let n;if(e){if(n=t,1!==n.outputs.length)throw new Xb("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==n.inputs.length)throw new Xb("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===t.inboundNodes.length){if(null==t.batchInputShape)throw new Xb("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const e=hx({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+"_input"});t.apply(e)}if(e)this.outputs=n.outputs,this.inputs=n.inputs;else{if(1!==t.inboundNodes.length)throw new Xb(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${t.name} which has ${t.inboundNodes.length} pre-existing inbound connections.`);if(1!==t.inboundNodes[0].outputTensors.length)throw new Xb("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=ax(this.outputs[0])}this.inboundNodes=[],new nx({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Qb(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map((t=>t.shape)),outputShapes:this.outputs[0].shape})}else{const e=t.apply(this.outputs[0]);if(Array.isArray(e))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[e],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1}pop(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const t=this.layers.length-1;this.layers[t].outboundNodes=[],this.outputs=[this.layers[t].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(t,e){return null==this.model&&this.build(),this.model.call(t,e)}build(t){if(Gw(t),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new v_({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(t,e,n=console.log){this.built||this.build(),super.summary(t,e,n)}setWeights(t){null==this.model&&this.build(),this.model.setWeights(t)}evaluate(t,e,n={}){if(!this.built)throw new Kb("The model needs to be compiled before being used.");return this.model.evaluate(t,e,n)}async evaluateDataset(t,e){if(!this.built)throw new Kb("The model needs to be compiled before being used.");return this.model.evaluateDataset(t,e)}predict(t,e={}){return null==this.model&&this.build(),this.model.predict(t,e)}predictOnBatch(t){return null==this.model&&this.build(),this.model.predictOnBatch(t)}compile(t){this.build(),this.model.compile(t),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return null==this.model?void 0:this.model.optimizer}set optimizer(t){this.model.optimizer=t}async fit(t,e,n={}){if(!this.built)throw new Kb("The model needs to be compiled before being used.");return this.model.fit(t,e,n)}async fitDataset(t,e){if(!this.built)throw new Kb("The model needs to be compiled before being used.");return this.model.fitDataset(t,e)}async trainOnBatch(t,e){return this.model.trainOnBatch(t,e)}static fromConfig(t,e,n={},r=!1){let i,o={};if(e instanceof Array){if(null==e[0].className||"Merge"===e[0]["className"])throw new Xb("Legacy serialization format not supported yet.");i=e}else y(null!=e["layers"],(()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field.")),i=e["layers"],delete e["layers"],o=e;const s=new t(o);if(!(s instanceof I_))throw new Yb(`Sequential.fromConfig called on non-Sequential input: ${s}`);for(const a of i){const t=void 0,e=Hx(a,t,r);r&&e.setFastWeightInitDuringBuild(!0),s.add(e)}return s}set stopTraining(t){if(null==this.model)throw new Xb("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=t}get stopTraining(){if(null==this.model)throw new Xb("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const t=[];for(const e of this.layers){const n={};n["className"]=e.getClassName(),n["config"]=e.getConfig(),t.push(n)}return{name:this.name,layers:t}}}I_.className="Sequential",ia(I_);
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
class C_ extends na{getConfig(){return{}}}class S_ extends C_{apply(t,e=1){return pw(t,e)}}S_.className="elu",ia(S_);class T_ extends C_{apply(t){return sh(t)}}T_.className="selu",ia(T_);class E_ extends C_{apply(t){return nh(t)}}E_.className="relu",ia(E_);class N_ extends C_{apply(t){return Io((()=>Ac(6,nh(t))))}}N_.className="relu6",ia(N_);class A_ extends C_{apply(t){return t}}A_.className="linear",ia(A_);class R_ extends C_{apply(t){return ch(t)}}R_.className="sigmoid",ia(R_);class $_ extends C_{apply(t){return mw(t)}}$_.className="hardSigmoid",ia($_);class D_ extends C_{apply(t){return Ih(t)}}D_.className="softplus",ia(D_);class O_ extends C_{apply(t){return fw(t)}}O_.className="softsign",ia(O_);class F_ extends C_{apply(t){return $h(t)}}F_.className="tanh",ia(F_);class M_ extends C_{apply(t,e=-1){return kh(t,e)}}M_.className="softmax",ia(M_);class P_ extends C_{apply(t,e=-1){return sc(t,e)}}P_.className="logSoftmax",ia(P_);class L_ extends C_{apply(t,e=1){return Io((()=>js(ch(js(t,e)),t)))}}L_.className="swish",ia(L_);class z_ extends C_{apply(t){return Io((()=>js(t,$h(Ih(t)))))}}function B_(t){return t.getClassName()}function W_(t,e={}){return uv(t,ra.getMap().classNameMap,e,"activation")}function U_(t){if(null==t){const t={className:"linear",config:{}};return W_(t)}if("string"===typeof t){const e={};return e["className"]=t,e["config"]={},W_(e)}return t instanceof C_?t:W_(t)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function V_(t){if(null!=t&&"object"!==typeof t)throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${t}`)}z_.className="mish",ia(z_);class j_ extends na{}class H_ extends j_{constructor(t){super(),V_(t),this.l1=null==t||null==t.l1?.01:t.l1,this.l2=null==t||null==t.l2?.01:t.l2,this.hasL1=0!==this.l1,this.hasL2=0!==this.l2}apply(t){return Io((()=>{let e=zc([1]);return this.hasL1&&(e=Ls(e,ic(js(this.l1,ga(t))))),this.hasL2&&(e=Ls(e,ic(js(this.l2,cw(t))))),Pl(e,[])}))}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(t,e){return new t({l1:e["l1"],l2:e["l2"]})}}H_.className="L1L2",ia(H_);const G_={l1l2:"L1L2"};function q_(t){return av(t)}function K_(t,e={}){return uv(t,ra.getMap().classNameMap,e,"regularizer")}function X_(t){if(null==t)return null;if("string"===typeof t){const e=t in G_?G_[t]:t,n={className:e,config:{}};return K_(n)}return t instanceof j_?t:K_(t)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
class Y_ extends ix{constructor(t){super(null==t?{}:t),this.supportsMasking=!0,null!=t&&(this.maxValue=t.maxValue)}call(t,e){t=Hw(t);let n=nh(t);return null!=this.maxValue&&(n=tu(n,0,this.maxValue)),n}computeOutputShape(t){return t}getConfig(){const t={maxValue:this.maxValue},e=super.getConfig();return Object.assign(t,e),t}}Y_.className="ReLU",ia(Y_);class J_ extends ix{constructor(t){super(null==t?{}:t),this.DEFAULT_ALPHA=.3,null==t&&(t={}),this.alpha=null==t.alpha?this.DEFAULT_ALPHA:t.alpha}call(t,e){const n=Hw(t);return Yu(n,this.alpha)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},e=super.getConfig();return Object.assign(t,e),t}}J_.className="LeakyReLU",ia(J_);class Z_ extends ix{constructor(t){if(super(null==t?{}:t),this.DEFAULT_ALPHA_INITIALIZER="zeros",null==t&&(t={}),this.supportsMasking=!0,this.alphaInitializer=Uw(t.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=X_(t.alphaRegularizer),this.alphaConstraint=$x(t.alphaConstraint),null==t.sharedAxes)this.sharedAxes=null;else if(Array.isArray(t.sharedAxes))this.sharedAxes=t.sharedAxes;else{if("number"!==typeof t.sharedAxes)throw new Xb(`Expected sharedAxes to be a number or an array of numbers, but got ${t.sharedAxes}`);this.sharedAxes=[t.sharedAxes]}}build(t){t=Gw(t);const e=t.slice(1);if(null!=this.sharedAxes)for(const r of this.sharedAxes)e[r-1]=1;this.alpha=this.addWeight("alpha",e,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const n={};if(null!=this.sharedAxes)for(let r=1;r<t.length;++r)n[r]=t[r];this.inputSpec=[new Qw({ndim:t.length,axes:n})],this.built=!0}call(t,e){return t=Hw(t),Gc(t,this.alpha.read())}getConfig(){const t={alphaInitializer:Ww(this.alphaInitializer),alphaRegularizer:q_(this.alphaRegularizer),alphaConstraint:Ax(this.alphaConstraint),sharedAxes:this.sharedAxes},e=super.getConfig();return Object.assign(t,e),t}}Z_.className="PReLU",ia(Z_);class Q_ extends ix{constructor(t){if(super(null==t?{}:t),this.DEFAULT_ALPHA=1,null==t&&(t={}),null!=t.alpha&&t.alpha!==this.DEFAULT_ALPHA)throw new Yb(`Non-default alpha value (${t.alpha}) is not supported by the ELU layer yet.`);this.alpha=null==t.alpha?this.DEFAULT_ALPHA:t.alpha}call(t,e){const n=Hw(t);return Au(n)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},e=super.getConfig();return Object.assign(t,e),t}}Q_.className="ELU",ia(Q_);class tI extends ix{constructor(t){super(null==t?{}:t),this.DEFAULT_THETA=1,null==t&&(t={}),this.theta=null==t.theta?this.DEFAULT_THETA:t.theta}call(t,e){const n=Hw(t);return js(n,$s(Gu(n,this.theta),"float32"))}computeOutputShape(t){return t}getConfig(){const t={theta:this.theta},e=super.getConfig();return Object.assign(t,e),t}}tI.className="ThresholdedReLU",ia(tI);class eI extends ix{constructor(t){super(null==t?{}:t),this.DEFAULT_AXIS=1,null==t&&(t={}),this.softmax=(new M_).apply,this.axis=null==t.axis?this.DEFAULT_AXIS:t.axis}call(t,e){return Io((()=>{let n=Hw(t);const r=e["mask"];if(null!=r){const t=js(da(Bc(n.shape),$s(r,n.dtype)),Qs(-1e9));n=Ls(n,t)}return this.axis instanceof Array?this.axis.length>1?Ou(da(n,mc(n,this.axis,!0))):this.softmax(n,this.axis[0]):this.softmax(n,this.axis)}))}computeOutputShape(t){return t}getConfig(){const t={axis:this.axis},e=super.getConfig();return Object.assign(t,e),t}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function nI(t,e,n){if("number"===typeof t)return Qb(t,e);if(t.length!==e)throw new Xb(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${t.length} elements.`);for(let r=0;r<e;++r){const i=t[r];if(!Uv(i))throw new Xb(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(t)} including a non-integer number ${i}`)}return t}function rI(t,e,n,r,i=1){if(null==t)return t;const o=e+(e-1)*(i-1);let s;return s="same"===n?t:t-o+1,Math.floor((s+r-1)/r)}function iI(t,e,n,r){if(null==t)return null;if("valid"===r)t=t*e+Hv([n-e,0]);else{if("same"!==r)throw new Xb(`Unsupport padding mode: ${r}.`);t*=e}return t}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function oI(t,e){return Io((()=>(Av(e),"channelsFirst"===e?qh(t,[0,2,3,1]):t)))}function sI(t,e){return Io((()=>(Av(e),"channelsFirst"===e?qh(t,[0,2,3,4,1]):t)))}function aI(t,e,n,r=1,i="valid",o,s=1){return Io((()=>{if(null==o&&(o=Xv()),Av(o),3!==t.shape.length)throw new Xb(`The input of a conv1dWithBias operation should be 3, but is ${t.shape.length} instead.`);if(3!==e.shape.length)throw new Xb(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(null!=n&&1!==n.shape.length)throw new Xb(`The bias for a conv1dWithBias operation should be 1, but is ${e.shape.length} instead`);if("channelsFirst"===o&&(t=qh(t,[0,2,1])),"causal"===i)throw new Yb("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=fu(t,e,r,"same"===i?"same":"valid","NWC",s);return null!=n&&(a=dw(a,n)),a}))}function lI(t,e,n,r=[1,1],i="valid",o,s,a=null){return Io((()=>{if(null==o&&(o=Xv()),Av(o),3!==t.rank&&4!==t.rank)throw new Xb(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${t.rank}.`);if(3!==e.rank&&4!==e.rank)throw new Xb(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${t.rank}.`);let l=oI(t,o);if("causal"===i)throw new Yb("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=md({x:l,filter:e,strides:r,pad:"same"===i?"same":"valid",dilations:s,dataFormat:"NHWC",bias:n,activation:a}),"channelsFirst"===o&&(l=qh(l,[0,3,1,2])),l}))}function uI(t,e,n,r=[1,1,1],i="valid",o,s){return Io((()=>{if(null==o&&(o=Xv()),Av(o),4!==t.rank&&5!==t.rank)throw new Xb(`conv3dWithBias expects input to be of rank 4 or 5, but received ${t.rank}.`);if(4!==e.rank&&5!==e.rank)throw new Xb(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${t.rank}.`);let a=sI(t,o);if("causal"===i)throw new Yb("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=wu(a,e,r,"same"===i?"same":"valid","NDHWC",s),null!=n&&(a=dw(a,n)),"channelsFirst"===o&&(a=qh(a,[0,4,1,2,3])),a}))}eI.className="Softmax",ia(eI);class cI extends ix{constructor(t,e){if(super(e),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",cI.verifyArgs(e),this.rank=t,mv(this.rank,"rank"),1!==this.rank&&2!==this.rank&&3!==this.rank)throw new Yb(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=nI(e.kernelSize,t,"kernelSize"),this.strides=nI(null==e.strides?1:e.strides,t,"strides"),this.padding=null==e.padding?"valid":e.padding,$v(this.padding),this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,Av(this.dataFormat),this.activation=U_(e.activation),this.useBias=null==e.useBias||e.useBias,this.biasInitializer=Uw(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=$x(e.biasConstraint),this.biasRegularizer=X_(e.biasRegularizer),this.activityRegularizer=X_(e.activityRegularizer),this.dilationRate=nI(null==e.dilationRate?1:e.dilationRate,t,"dilationRate"),1===this.rank&&Array.isArray(this.dilationRate)&&1!==this.dilationRate.length)throw new Xb(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(2===this.rank){if("number"===typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate];else if(2!==this.dilationRate.length)throw new Xb(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(3===this.rank)if("number"===typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(3!==this.dilationRate.length)throw new Xb(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}static verifyArgs(t){if(tv("kernelSize"in t,"required key 'kernelSize' not in config"),"number"!==typeof t.kernelSize&&!gv(t.kernelSize,"number",1,3))throw new Xb(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(t.kernelSize)}.`)}getConfig(){const t={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:B_(this.activation),useBias:this.useBias,biasInitializer:Ww(this.biasInitializer),biasRegularizer:q_(this.biasRegularizer),activityRegularizer:q_(this.activityRegularizer),biasConstraint:Ax(this.biasConstraint)},e=super.getConfig();return Object.assign(t,e),t}}class hI extends cI{constructor(t,e){super(t,e),this.kernel=null,hI.verifyArgs(e),this.filters=e.filters,mv(this.filters,"filters"),this.kernelInitializer=Uw(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=$x(e.kernelConstraint),this.kernelRegularizer=X_(e.kernelRegularizer)}build(t){t=Gw(t);const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e])throw new Xb(`The channel dimension of the input should be defined. Found ${t[e]}`);const n=t[e],r=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[e]:n}}],this.built=!0}call(t,e){return Io((()=>{let e;t=Hw(t);const n=null==this.bias?null:this.bias.read(),r=vv(this.activation.getClassName());if(null!=r&&2===this.rank)e=lI(t,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate,r);else{if(1===this.rank)e=aI(t,this.kernel.read(),n,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(2===this.rank)e=lI(t,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate);else{if(3!==this.rank)throw new Yb("convolutions greater than 3D are not implemented yet.");e=uI(t,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate)}null!=this.activation&&(e=this.activation.apply(e))}return e}))}computeOutputShape(t){t=Gw(t);const e=[],n="channelsLast"===this.dataFormat?t.slice(1,t.length-1):t.slice(2);for(let i=0;i<n.length;++i){const t=rI(n[i],this.kernelSize[i],this.padding,this.strides[i],"number"===typeof this.dilationRate?this.dilationRate:this.dilationRate[i]);e.push(t)}let r=[t[0]];return"channelsLast"===this.dataFormat?(r=r.concat(e),r.push(this.filters)):(r.push(this.filters),r=r.concat(e)),r}getConfig(){const t={filters:this.filters,kernelInitializer:Ww(this.kernelInitializer),kernelRegularizer:q_(this.kernelRegularizer),kernelConstraint:Ax(this.kernelConstraint)},e=super.getConfig();return Object.assign(t,e),t}static verifyArgs(t){if(!("filters"in t)||"number"!==typeof t.filters||t.filters<1)throw new Xb(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(t.filters)}`)}}class dI extends hI{constructor(t){super(2,t),dI.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t["rank"],t}static verifyArgs(t){if("number"!==typeof t.kernelSize&&!gv(t.kernelSize,"number",1,2))throw new Xb(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(t.kernelSize)}.`)}}dI.className="Conv2D",ia(dI);class pI extends hI{constructor(t){super(3,t),pI.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t["rank"],t}static verifyArgs(t){if("number"!==typeof t.kernelSize&&(!Array.isArray(t.kernelSize)||1!==t.kernelSize.length&&3!==t.kernelSize.length))throw new Xb(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(t.kernelSize)}.`)}}pI.className="Conv3D",ia(pI);class fI extends dI{constructor(t){if(super(t),this.inputSpec=[new Qw({ndim:4})],"same"!==this.padding&&"valid"!==this.padding)throw new Xb(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(t){if(t=Gw(t),4!==t.length)throw new Xb("Input should have rank 4; Received input shape: "+JSON.stringify(t));const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e])throw new Xb("The channel dimension of the inputs should be defined. Found `None`.");const n=t[e],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Qw({ndim:4,axes:{[e]:n}})],this.built=!0}call(t,e){return Io((()=>{let e=Hw(t);if(4!==e.shape.length)throw new Xb(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${e.shape.length}`);const n=e.shape,r=n[0];let i,o;"channelsFirst"===this.dataFormat?(i=2,o=3):(i=1,o=2);const s=n[i],a=n[o],l=this.kernelSize[0],u=this.kernelSize[1],c=this.strides[0],h=this.strides[1],d=iI(s,c,l,this.padding),p=iI(a,h,u,this.padding),f=[r,d,p,this.filters];"channelsLast"!==this.dataFormat&&(e=qh(e,[0,2,3,1]));let g=bu(e,this.kernel.read(),f,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(g=qh(g,[0,3,1,2])),null!=this.bias&&(g=dw(g,this.bias.read(),this.dataFormat)),null!=this.activation&&(g=this.activation.apply(g)),g}))}computeOutputShape(t){t=Gw(t);const e=t.slice();let n,r,i;"channelsFirst"===this.dataFormat?(n=1,r=2,i=3):(n=3,r=1,i=2);const o=this.kernelSize[0],s=this.kernelSize[1],a=this.strides[0],l=this.strides[1];return e[n]=this.filters,e[r]=iI(e[r],a,o,this.padding),e[i]=iI(e[i],l,s,this.padding),e}getConfig(){const t=super.getConfig();return delete t["dilationRate"],t}}fI.className="Conv2DTranspose",ia(fI);class gI extends pI{constructor(t){if(super(t),this.inputSpec=[new Qw({ndim:5})],"same"!==this.padding&&"valid"!==this.padding)throw new Xb(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(t){if(t=Gw(t),5!==t.length)throw new Xb("Input should have rank 5; Received input shape: "+JSON.stringify(t));const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e])throw new Xb("The channel dimension of the inputs should be defined. Found `None`.");const n=t[e],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Qw({ndim:5,axes:{[e]:n}})],this.built=!0}call(t,e){return Io((()=>{let e=Hw(t);if(5!==e.shape.length)throw new Xb(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${e.shape.length}`);const n=e.shape,r=n[0];let i,o,s;"channelsFirst"===this.dataFormat?(s=2,i=3,o=4):(s=1,i=2,o=3);const a=n[s],l=n[i],u=n[o],c=this.kernelSize[0],h=this.kernelSize[1],d=this.kernelSize[2],p=this.strides[0],f=this.strides[1],g=this.strides[2],m=iI(a,p,c,this.padding),y=iI(l,f,h,this.padding),b=iI(u,g,d,this.padding),v=[r,m,y,b,this.filters];"channelsLast"!==this.dataFormat&&(e=qh(e,[0,2,3,4,1]));let w=Iu(e,this.kernel.read(),v,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(w=qh(w,[0,4,1,2,3])),null!==this.bias&&(w=dw(w,this.bias.read(),this.dataFormat)),null!==this.activation&&(w=this.activation.apply(w)),w}))}computeOutputShape(t){t=Gw(t);const e=t.slice();let n,r,i,o;"channelsFirst"===this.dataFormat?(n=1,r=2,i=3,o=4):(n=4,r=1,i=2,o=3);const s=this.kernelSize[0],a=this.kernelSize[1],l=this.kernelSize[2],u=this.strides[0],c=this.strides[1],h=this.strides[2];return e[n]=this.filters,e[r]=iI(e[r],u,s,this.padding),e[i]=iI(e[i],c,a,this.padding),e[o]=iI(e[o],h,l,this.padding),e}getConfig(){const t=super.getConfig();return delete t["dilationRate"],t}}gI.className="Conv3DTranspose",ia(gI);class mI extends hI{constructor(t,e){if(super(t,e),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,null==e.filters)throw new Xb("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=e.kernelInitializer||null!=e.kernelRegularizer||null!=e.kernelConstraint)throw new Xb("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=e.padding&&"same"!==e.padding&&"valid"!==e.padding)throw new Xb(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(e.padding)}`);this.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,this.depthwiseInitializer=Uw(e.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=X_(e.depthwiseRegularizer),this.depthwiseConstraint=$x(e.depthwiseConstraint),this.pointwiseInitializer=Uw(e.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=X_(e.pointwiseRegularizer),this.pointwiseConstraint=$x(e.pointwiseConstraint)}build(t){if(t=Gw(t),t.length<this.rank+2)throw new Xb(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(t)}`);const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e]||t[e]<0)throw new Xb(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(t[e])}`);const n=t[e],r=this.kernelSize.concat([n,this.depthMultiplier]),i=[];for(let s=0;s<this.rank;++s)i.push(1);i.push(n*this.depthMultiplier,this.filters);const o=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,o,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",i,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,o,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,o,this.biasConstraint):this.bias=null,this.inputSpec=[new Qw({ndim:this.rank+2,axes:{[e]:n}})],this.built=!0}call(t,e){return Io((()=>{let e;if(t=Hw(t),1===this.rank)throw new Yb("1D separable convolution is not implemented yet.");return 2===this.rank&&("channelsFirst"===this.dataFormat&&(t=qh(t,[0,2,3,1])),e=lh(t,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(e=dw(e,this.bias.read(),this.dataFormat)),null!=this.activation&&(e=this.activation.apply(e)),"channelsFirst"===this.dataFormat&&(e=qh(e,[0,3,1,2])),e}))}getConfig(){const t=super.getConfig();return delete t["rank"],delete t["kernelInitializer"],delete t["kernelRegularizer"],delete t["kernelConstraint"],t["depthwiseInitializer"]=Ww(this.depthwiseInitializer),t["pointwiseInitializer"]=Ww(this.pointwiseInitializer),t["depthwiseRegularizer"]=q_(this.depthwiseRegularizer),t["pointwiseRegularizer"]=q_(this.pointwiseRegularizer),t["depthwiseConstraint"]=Ax(this.depthwiseConstraint),t["pointwiseConstraint"]=Ax(this.pointwiseConstraint),t}}mI.className="SeparableConv";class yI extends mI{constructor(t){super(2,t)}}yI.className="SeparableConv2D",ia(yI);class bI extends hI{constructor(t){super(1,t),bI.verifyArgs(t),this.inputSpec=[{ndim:3}]}getConfig(){const t=super.getConfig();return delete t["rank"],delete t["dataFormat"],t}static verifyArgs(t){if("number"!==typeof t.kernelSize&&!gv(t.kernelSize,"number",1,1))throw new Xb(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(t.kernelSize)}.`)}}bI.className="Conv1D",ia(bI);class vI extends ix{constructor(t){super(t),"number"===typeof t.cropping?this.cropping=[[t.cropping,t.cropping],[t.cropping,t.cropping]]:"number"===typeof t.cropping[0]?this.cropping=[[t.cropping[0],t.cropping[0]],[t.cropping[1],t.cropping[1]]]:this.cropping=t.cropping,this.dataFormat=void 0===t.dataFormat?"channelsLast":t.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(t){return"channelsFirst"===this.dataFormat?[t[0],t[1],t[2]-this.cropping[0][0]-this.cropping[0][1],t[3]-this.cropping[1][0]-this.cropping[1][1]]:[t[0],t[1]-this.cropping[0][0]-this.cropping[0][1],t[2]-this.cropping[1][0]-this.cropping[1][1],t[3]]}call(t,e){return Io((()=>{if(t=Hw(t),"channelsLast"===this.dataFormat){const e=rw(t,this.cropping[0][0],t.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return rw(e,this.cropping[1][0],t.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}{const e=rw(t,this.cropping[0][0],t.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return rw(e,this.cropping[1][0],t.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}}))}getConfig(){const t={cropping:this.cropping,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}vI.className="Cropping2D",ia(vI);class wI extends ix{constructor(t){super(t),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=null==t.size?this.DEFAULT_SIZE:t.size,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,Av(this.dataFormat),this.interpolation=null==t.interpolation?"nearest":t.interpolation,Rv(this.interpolation)}computeOutputShape(t){if("channelsFirst"===this.dataFormat){const e=null==t[2]?null:this.size[0]*t[2],n=null==t[3]?null:this.size[1]*t[3];return[t[0],t[1],e,n]}{const e=null==t[1]?null:this.size[0]*t[1],n=null==t[2]?null:this.size[1]*t[2];return[t[0],e,n,t[3]]}}call(t,e){return Io((()=>{let e=Hw(t);const n=e.shape;if("channelsFirst"===this.dataFormat){e=qh(e,[0,2,3,1]);const t=this.size[0]*n[2],r=this.size[1]*n[3],i="nearest"===this.interpolation?Mp.resizeNearestNeighbor(e,[t,r]):Mp.resizeBilinear(e,[t,r]);return qh(i,[0,3,1,2])}{const t=this.size[0]*n[1],r=this.size[1]*n[2];return"nearest"===this.interpolation?Mp.resizeNearestNeighbor(e,[t,r]):Mp.resizeBilinear(e,[t,r])}}))}getConfig(){const t={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},e=super.getConfig();return Object.assign(t,e),t}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function xI(t,e,n=[1,1],r="valid",i,o){return Io((()=>{null==i&&(i=Xv()),Av(i);let s=oI(t,i);if(4!==t.rank)throw new Xb(`Input for depthwiseConv2d is required to be 4-D, but is instead ${t.rank}-D`);if(4!==e.rank)throw new Xb(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return s=Eu(s,e,n,"same"===r?"same":"valid","NHWC",o),"channelsFirst"===i&&(s=qh(s,[0,3,1,2])),s}))}wI.className="UpSampling2D",ia(wI);class kI extends cI{constructor(t){super(2,t),this.depthwiseKernel=null,this.depthMultiplier=null==t.depthMultiplier?1:t.depthMultiplier,this.depthwiseInitializer=Uw(t.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=$x(t.depthwiseConstraint),this.depthwiseRegularizer=X_(t.depthwiseRegularizer)}build(t){if(t=Gw(t),t.length<4)throw new Xb(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(t)}.`);const e="channelsFirst"===this.dataFormat?1:3;if(null==t[e]||t[e]<0)throw new Xb(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${t[e]}).`);const n=t[e],r=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,e){return Io((()=>{t=Hw(t);let e=xI(t,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(e=dw(e,this.bias.read(),this.dataFormat)),null!=this.activation&&(e=this.activation.apply(e)),e}))}computeOutputShape(t){t=Gw(t);const e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2],r="channelsFirst"===this.dataFormat?t[1]*this.depthMultiplier:t[3]*this.depthMultiplier,i=rI(e,this.kernelSize[0],this.padding,this.strides[0]),o=rI(n,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[t[0],r,i,o]:[t[0],i,o,r]}getConfig(){const t=super.getConfig();return t["depthMultiplier"]=this.depthMultiplier,t["depthwiseInitializer"]=Ww(this.depthwiseInitializer),t["depthwiseRegularizer"]=q_(this.depthwiseRegularizer),t["depthwiseConstraint"]=Ax(this.depthwiseRegularizer),t}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function _I(t,e,n,r){if(Array.isArray(t)){if(null!=e||null!=n)throw new Xb("When inputs is an array, neither initialState or constants should be provided");null!=r&&(n=t.slice(t.length-r,t.length),t=t.slice(0,t.length-r)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function i(t){return null==t||Array.isArray(t)?t:[t]}return e=i(e),n=i(n),{inputs:t,initialState:e,constants:n}}function II(t,e,n,r=!1,i,o,s=!1,a=!1){return Io((()=>{const l=e.shape.length;if(l<3)throw new Xb(`Input should be at least 3D, but is ${l}D.`);const u=[1,0].concat(Gv(2,l));if(e=qh(e,u),null!=o)throw new Yb("The rnn() functoin of the deeplearn.js backend does not support constants yet.");s&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=i&&(i=$s($s(i,"bool"),"float32"),i.rank===l-1&&(i=Mu(i,-1)),i=qh(i,u)),r&&(e=ih(e,0),null!=i&&(i=ih(i,0)));const c=[];let h,d=n;const p=e.shape[0],f=Lh(e);let g,m;null!=i&&(g=Lh(i));for(let e=0;e<p;++e){const n=f[e],r=Io((()=>t(n,d)));if(null==i)h=r[0],d=r[1];else{const t=Io((()=>{const t=g[e],n=da(Uc(t),t),i=Ls(js(r[0],t),js(d[0],n)),o=d.map(((e,i)=>Ls(js(r[1][i],t),js(e,n))));return{output:i,newStates:o}}));h=t.output,d=t.newStates}a&&c.push(h)}if(a){const t=1;m=Ah(c,t)}return[h,m,d]}))}kI.className="DepthwiseConv2D",ia(kI);class CI extends ix{constructor(t){let e;if(super(t),null==t.cell)throw new Xb("cell property is missing for the constructor of RNN.");if(e=Array.isArray(t.cell)?new DI({cells:t.cell}):t.cell,null==e.stateSize)throw new Xb("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=e,this.returnSequences=null!=t.returnSequences&&t.returnSequences,this.returnState=null!=t.returnState&&t.returnState,this.goBackwards=null!=t.goBackwards&&t.goBackwards,this._stateful=null!=t.stateful&&t.stateful,this.unroll=null!=t.unroll&&t.unroll,this.supportsMasking=!0,this.inputSpec=[new Qw({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(null==this.states_){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return Gv(0,t).map((t=>null))}return this.states_}setStates(t){this.states_=t}computeOutputShape(t){Vw(t)&&(t=t[0]);let e=this.cell.stateSize;Array.isArray(e)||(e=[e]);const n=e[0];let r;if(r=this.returnSequences?[t[0],t[1],n]:[t[0],n],this.returnState){const n=[];for(const r of e)n.push([t[0],r]);return[r].concat(n)}return r}computeMask(t,e){return Io((()=>{Array.isArray(e)&&(e=e[0]);const t=this.returnSequences?e:null;if(this.returnState){const e=this.states.map((t=>null));return[t].concat(e)}return t}))}get states(){if(null==this.states_){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,e=[];for(let n=0;n<t;++n)e.push(null);return e}return this.states_}set states(t){this.states_=t}build(t){const e=null;if(null!=this.numConstants)throw new Yb("Constants support is not implemented in RNN yet.");Vw(t)&&(t=t[0]);const n=this.stateful?t[0]:null,r=t.slice(2);this.inputSpec[0]=new Qw({shape:[n,null,...r]});const i=[t[0]].concat(t.slice(2));if(null!=e)throw new Yb("Constants support is not implemented in RNN yet.");let o;if(this.cell.build(i),o=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!x(this.stateSpec.map((t=>t.shape[t.shape.length-1])),o))throw new Xb(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=o.map((t=>new Qw({shape:[null,t]})));this.stateful&&this.resetStates()}resetStates(t,e=!1){Io((()=>{if(!this.stateful)throw new qb("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape[0];if(null==n)throw new Xb("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.states_)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((t=>zc([n,t]))):this.states_=[zc([n,this.cell.stateSize])];else if(null==t)Co(this.states_),null!=this.keptStates&&(Co(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((t=>zc([n,t]))):this.states_[0]=zc([n,this.cell.stateSize]);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new Xb(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${t.length} state value(s). Input received: ${t}`);!0===e?this.keptStates.push(this.states_.slice()):Co(this.states_);for(let e=0;e<this.states_.length;++e){const r=t[e],i=Array.isArray(this.cell.stateSize)?this.cell.stateSize[e]:this.cell.stateSize,o=[n,i];if(!x(r.shape,o))throw new Xb(`State ${e} is incompatible with layer ${this.name}: expected shape=${o}, received shape=${r.shape}`);this.states_[e]=r}}this.states_=this.states_.map((t=>So(t.clone())))}))}apply(t,e){let n=null==e?null:e["initialState"],r=null==e?null:e["constants"];null==e&&(e={});const i=_I(t,n,r,this.numConstants);t=i.inputs,n=i.initialState,r=i.constants;let o=[],s=[];if(null!=n){e["initialState"]=n,o=o.concat(n),this.stateSpec=[];for(const t of n)this.stateSpec.push(new Qw({shape:t.shape}));s=s.concat(this.stateSpec)}null!=r&&(e["constants"]=r,o=o.concat(r),this.numConstants=r.length);const a=o[0]instanceof tx;if(a){const n=[t].concat(o),r=this.inputSpec.concat(s),i=this.inputSpec;this.inputSpec=r;const a=super.apply(n,e);return this.inputSpec=i,a}return super.apply(t,e)}call(t,e){return Io((()=>{const n=null==e?null:e["mask"],r=null==e?null:e["training"];let i=null==e?null:e["initialState"];t=Hw(t),null==i&&(i=this.stateful?this.states_:this.getInitialState(t));const o=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(i.length!==o)throw new Xb(`RNN Layer has ${o} state(s) but was passed ${i.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const s={training:r},a=(t,e)=>{const n=this.cell.call([t].concat(e),s);return[n[0],n.slice(1)]},l=II(a,t,i,this.goBackwards,n,null,this.unroll,this.returnSequences),u=l[0],c=l[1],h=l[2];this.stateful&&this.resetStates(h,r);const d=this.returnSequences?c:u;return this.returnState?[d].concat(h):d}))}getInitialState(t){return Io((()=>{let e=zc(t.shape);return e=ic(e,[1,2]),e=Jv(e),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map((t=>t>1?sw(e,[1,t]):e)):this.cell.stateSize>1?[sw(e,[1,this.cell.stateSize])]:[e]}))}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(t)}getConfig(){const t=super.getConfig(),e={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(e["numConstants"]=this.numConstants);const n=this.cell.getConfig();return this.getClassName()===CI.className&&(e["cell"]={className:this.cell.getClassName(),config:n}),Object.assign(Object.assign(Object.assign({},n),t),e)}static fromConfig(t,e,n={}){const r=e["cell"],i=Hx(r,n);return new t(Object.assign(e,{cell:i}))}}CI.className="RNN",ia(CI);class SI extends ix{}class TI extends SI{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,mv(this.units,"units"),this.activation=U_(null==t.activation?this.DEFAULT_ACTIVATION:t.activation),this.useBias=null==t.useBias||t.useBias,this.kernelInitializer=Uw(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Uw(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Uw(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=X_(t.kernelRegularizer),this.recurrentRegularizer=X_(t.recurrentRegularizer),this.biasRegularizer=X_(t.biasRegularizer),this.kernelConstraint=$x(t.kernelConstraint),this.recurrentConstraint=$x(t.recurrentConstraint),this.biasConstraint=$x(t.biasConstraint),this.dropout=jv([1,Hv([0,null==t.dropout?0:t.dropout])]),this.recurrentDropout=jv([1,Hv([0,null==t.recurrentDropout?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=Gw(t),this.kernel=this.addWeight("kernel",[t[t.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,e){return Io((()=>{if(2!==t.length)throw new Xb(`SimpleRNNCell expects 2 input Tensors, got ${t.length}.`);let n=t[1];t=t[0];const r=null!=e["training"]&&e["training"];let i;0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=OI({ones:()=>Uc(t),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=OI({ones:()=>Uc(n),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,s=this.recurrentDropoutMask;i=lw(null!=o?js(t,o):t,this.kernel.read()),null!=this.bias&&(i=dw(i,this.bias.read())),null!=s&&(n=js(n,s));let a=Ls(i,lw(n,this.recurrentKernel.read()));return null!=this.activation&&(a=this.activation.apply(a)),[a,a]}))}getConfig(){const t=super.getConfig(),e={units:this.units,activation:B_(this.activation),useBias:this.useBias,kernelInitializer:Ww(this.kernelInitializer),recurrentInitializer:Ww(this.recurrentInitializer),biasInitializer:Ww(this.biasInitializer),kernelRegularizer:q_(this.kernelRegularizer),recurrentRegularizer:q_(this.recurrentRegularizer),biasRegularizer:q_(this.biasRegularizer),activityRegularizer:q_(this.activityRegularizer),kernelConstraint:Ax(this.kernelConstraint),recurrentConstraint:Ax(this.recurrentConstraint),biasConstraint:Ax(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},t),e)}}TI.className="SimpleRNNCell",ia(TI);class EI extends CI{constructor(t){t.cell=new TI(t),super(t)}call(t,e){return Io((()=>{null!=this.cell.dropoutMask&&(Co(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(Co(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==e?null:e["mask"],r=null==e?null:e["training"],i=null==e?null:e["initialState"];return super.call(t,{mask:n,training:r,initialState:i})}))}static fromConfig(t,e){return new t(e)}}EI.className="SimpleRNN",ia(EI);class NI extends SI{constructor(t){if(super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",t.resetAfter)throw new Xb("GRUCell does not support reset_after parameter set to true.");this.units=t.units,mv(this.units,"units"),this.activation=U_(void 0===t.activation?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=U_(void 0===t.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=null==t.useBias||t.useBias,this.kernelInitializer=Uw(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Uw(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Uw(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=X_(t.kernelRegularizer),this.recurrentRegularizer=X_(t.recurrentRegularizer),this.biasRegularizer=X_(t.biasRegularizer),this.kernelConstraint=$x(t.kernelConstraint),this.recurrentConstraint=$x(t.recurrentConstraint),this.biasConstraint=$x(t.biasConstraint),this.dropout=jv([1,Hv([0,null==t.dropout?0:t.dropout])]),this.recurrentDropout=jv([1,Hv([0,null==t.recurrentDropout?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.implementation=t.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=Gw(t);const e=t[t.length-1];this.kernel=this.addWeight("kernel",[e,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,e){return Io((()=>{if(2!==t.length)throw new Xb(`GRUCell expects 2 input Tensors (inputs, h, c), got ${t.length}.`);const n=null!=e["training"]&&e["training"];let r=t[1];t=t[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=OI({ones:()=>Uc(t),rate:this.dropout,training:n,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=OI({ones:()=>Uc(r),rate:this.recurrentDropout,training:n,count:3,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,o=this.recurrentDropoutMask;let s,a,l;0<this.dropout&&this.dropout<1&&(t=js(t,i[0]));let u=lw(t,this.kernel.read());this.useBias&&(u=dw(u,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=js(r,o[0]));const c=this.recurrentKernel.read(),[h,d]=Sh(c,[2*this.units,this.units],c.rank-1),p=lw(r,h),[f,g,m]=Sh(u,3,u.rank-1),[y,b]=Sh(p,2,p.rank-1);s=this.recurrentActivation.apply(Ls(f,y)),a=this.recurrentActivation.apply(Ls(g,b));const v=lw(js(a,r),d);l=this.activation.apply(Ls(m,v));const w=Ls(js(s,r),js(Ls(1,Oc(s)),l));return[w,w]}))}getConfig(){const t=super.getConfig(),e={units:this.units,activation:B_(this.activation),recurrentActivation:B_(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Ww(this.kernelInitializer),recurrentInitializer:Ww(this.recurrentInitializer),biasInitializer:Ww(this.biasInitializer),kernelRegularizer:q_(this.kernelRegularizer),recurrentRegularizer:q_(this.recurrentRegularizer),biasRegularizer:q_(this.biasRegularizer),activityRegularizer:q_(this.activityRegularizer),kernelConstraint:Ax(this.kernelConstraint),recurrentConstraint:Ax(this.recurrentConstraint),biasConstraint:Ax(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},t),e)}}NI.className="GRUCell",ia(NI);class AI extends CI{constructor(t){0===t.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new NI(t),super(t)}call(t,e){return Io((()=>{null!=this.cell.dropoutMask&&(Co(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(Co(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==e?null:e["mask"],r=null==e?null:e["training"],i=null==e?null:e["initialState"];return super.call(t,{mask:n,training:r,initialState:i})}))}static fromConfig(t,e){return 0===e["implmentation"]&&(e["implementation"]=1),new t(e)}}AI.className="GRU",ia(AI);class RI extends SI{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,mv(this.units,"units"),this.activation=U_(void 0===t.activation?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=U_(void 0===t.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=null==t.useBias||t.useBias,this.kernelInitializer=Uw(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Uw(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Uw(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=t.unitForgetBias,this.kernelRegularizer=X_(t.kernelRegularizer),this.recurrentRegularizer=X_(t.recurrentRegularizer),this.biasRegularizer=X_(t.biasRegularizer),this.kernelConstraint=$x(t.kernelConstraint),this.recurrentConstraint=$x(t.recurrentConstraint),this.biasConstraint=$x(t.biasConstraint),this.dropout=jv([1,Hv([0,null==t.dropout?0:t.dropout])]),this.recurrentDropout=jv([1,Hv([0,null==t.recurrentDropout?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.implementation=t.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){var e;t=Gw(t);const n=t[t.length-1];let r;if(this.kernel=this.addWeight("kernel",[n,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){const t=this.biasInitializer,n=this.units;r=new(e=class extends kw{apply(e,r){const i=t.apply([n]),o=(new Iw).apply([n]),s=t.apply([2*n]);return ow(ow(i,o),s)}},e.className="CustomInit",e)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(t,e){return Io((()=>{const n=null!=e["training"]&&e["training"];if(3!==t.length)throw new Xb(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${t.length}.`);let r=t[1];const i=t[2];t=t[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=OI({ones:()=>Uc(t),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=OI({ones:()=>Uc(r),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,s=this.recurrentDropoutMask;let a,l,u,c;0<this.dropout&&this.dropout<1&&(t=js(t,o[0]));let h=lw(t,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=js(r,s[0])),h=Ls(h,lw(r,this.recurrentKernel.read())),this.useBias&&(h=dw(h,this.bias.read()));const[d,p,f,g]=Sh(h,4,h.rank-1);a=this.recurrentActivation.apply(d),l=this.recurrentActivation.apply(p),u=Ls(js(l,i),js(a,this.activation.apply(f))),c=this.recurrentActivation.apply(g);const m=js(c,this.activation.apply(u));return[m,m,u]}))}getConfig(){const t=super.getConfig(),e={units:this.units,activation:B_(this.activation),recurrentActivation:B_(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Ww(this.kernelInitializer),recurrentInitializer:Ww(this.recurrentInitializer),biasInitializer:Ww(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:q_(this.kernelRegularizer),recurrentRegularizer:q_(this.recurrentRegularizer),biasRegularizer:q_(this.biasRegularizer),activityRegularizer:q_(this.activityRegularizer),kernelConstraint:Ax(this.kernelConstraint),recurrentConstraint:Ax(this.recurrentConstraint),biasConstraint:Ax(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},t),e)}}RI.className="LSTMCell",ia(RI);class $I extends CI{constructor(t){0===t.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new RI(t),super(t)}call(t,e){return Io((()=>{null!=this.cell.dropoutMask&&(Co(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(Co(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==e?null:e["mask"],r=null==e?null:e["training"],i=null==e?null:e["initialState"];return super.call(t,{mask:n,training:r,initialState:i})}))}static fromConfig(t,e){return 0===e["implmentation"]&&(e["implementation"]=1),new t(e)}}$I.className="LSTM",ia($I);class DI extends SI{constructor(t){super(t),this.cells=t.cells}get stateSize(){const t=[];for(const e of this.cells.slice().reverse())Array.isArray(e.stateSize)?t.push(...e.stateSize):t.push(e.stateSize);return t}call(t,e){return Io((()=>{let n=t.slice(1);const r=[];for(const t of this.cells.slice().reverse())Array.isArray(t.stateSize)?r.push(n.splice(0,t.stateSize.length)):r.push(n.splice(0,1));r.reverse();const i=[];let o;for(let s=0;s<this.cells.length;++s){const a=this.cells[s];n=r[s],o=0===s?[t[0]].concat(n):[o[0]].concat(n),o=a.call(o,e),i.push(o.slice(1))}n=[];for(const t of i.slice().reverse())n.push(...t);return[o[0]].concat(n)}))}build(t){let e;Vw(t)&&(t=t[0]),this.cells.forEach(((n,r)=>{Mv(`RNNCell_${r}`,(()=>{n.build(t),e=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,t=[t[0],e]}))})),this.built=!0}getConfig(){const t=super.getConfig(),e=t=>({className:t.getClassName(),config:t.getConfig()}),n=this.cells.map(e),r={cells:n};return Object.assign(Object.assign({},t),r)}static fromConfig(t,e,n={}){const r=[];for(const i of e["cells"])r.push(Hx(i,n));return new t({cells:r})}get trainableWeights(){if(!this.trainable)return[];const t=[];for(const e of this.cells)t.push(...e.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const e of this.cells)t.push(...e.nonTrainableWeights);if(!this.trainable){const e=[];for(const t of this.cells)e.push(...t.trainableWeights);return e.concat(t)}return t}getWeights(){const t=[];for(const e of this.cells)t.push(...e.weights);return Jw(t)}setWeights(t){const e=[];for(const n of this.cells){const r=n.weights.length,i=t.splice(r);for(let t=0;t<n.weights.length;++t)e.push([n.weights[t],i[t]])}Zw(e)}}function OI(t){const{ones:e,rate:n,training:r=!1,count:i=1,dropoutFunc:o}=t,s=()=>null!=o?o(e(),n):gw(e(),n),a=()=>yw(s,e,r);if(!i||i<=1)return So(a().clone());const l=Array(i).fill(void 0).map(a);return l.map((t=>So(t.clone())))}DI.className="StackedRNNCells",ia(DI);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
var FI=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};class MI extends CI{constructor(t){if(t.unroll)throw new Yb("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(t.cell))throw new Yb("It is not possible at the moment to stack convolutional cells.");super(t),this.inputSpec=[new Qw({ndim:5})]}call(t,e){return Io((()=>{if(null!=this.cell.dropoutMask&&(Co(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(Co(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),e&&e["constants"])throw new Xb("ConvRNN2D cell does not support constants");const n=null==e?null:e["mask"],r=null==e?null:e["training"],i=null==e?null:e["initialState"];return super.call(t,{mask:n,training:r,initialState:i})}))}computeOutputShape(t){let e=this.computeSingleOutputShape(t);return this.returnSequences||(e=[e[0],...e.slice(2)]),this.returnState&&(e=[e,...Array(2).fill([t[0],...e.slice(-3)])]),e}getInitialState(t){return Io((()=>{const{stateSize:e}=this.cell,n=t.shape,r=this.computeSingleOutputShape(n),i=[r[0],...r.slice(2)],o=zc(i);return Array.isArray(e)?Array(e.length).fill(o):[o]}))}resetStates(t,e=!1){Io((()=>{if(!this.stateful)throw new qb("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape,r=this.computeSingleOutputShape(n),i=[r[0],...r.slice(2)],o=n[0];if(null==o)throw new Xb("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.getStates())Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((()=>zc(i))):this.states_=[zc(i)];else if(null==t)Co(this.states_),null!=this.keptStates&&(Co(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((()=>zc(i))):this.states_[0]=zc(i);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new Xb(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${t.length} state value(s). Input received: ${t}`);e?this.keptStates.push(this.states_.slice()):Co(this.states_);for(let e=0;e<this.states_.length;++e){const n=t[e],r=i;if(!x(n.shape,r))throw new Xb(`State ${e} is incompatible with layer ${this.name}: expected shape=${r}, received shape=${n.shape}`);this.states_[e]=n}}this.states_=this.states_.map((t=>So(t.clone())))}))}computeSingleOutputShape(t){const{dataFormat:e,filters:n,kernelSize:r,padding:i,strides:o,dilationRate:s}=this.cell,a="channelsFirst"===e,l=t[a?3:2],u=t[a?4:3],c=rI(l,r[0],i,o[0],s[0]),h=rI(u,r[1],i,o[1],s[1]),d=[...t.slice(0,2),...a?[n,c,h]:[c,h,n]];return d}}MI.className="ConvRNN2D";class PI extends RI{constructor(t){const{filters:e,kernelSize:n,strides:r,padding:i,dataFormat:o,dilationRate:s}=t;super(Object.assign(Object.assign({},t),{units:e})),this.filters=e,mv(this.filters,"filters"),this.kernelSize=nI(n,2,"kernelSize"),this.kernelSize.forEach((t=>mv(t,"kernelSize"))),this.strides=nI(r||1,2,"strides"),this.strides.forEach((t=>mv(t,"strides"))),this.padding=i||"valid",$v(this.padding),this.dataFormat=o||"channelsLast",Av(this.dataFormat),this.dilationRate=nI(s||1,2,"dilationRate"),this.dilationRate.forEach((t=>mv(t,"dilationRate")))}build(t){var e;t=Gw(t);const n="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[n])throw new Xb(`The channel dimension of the input should be defined. Found ${t[n]}`);const r=t[n],i=4,o=this.kernelSize.concat([r,this.filters*i]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const s=this.kernelSize.concat([this.filters,this.filters*i]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",s,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let t;if(this.unitForgetBias){const n=this.biasInitializer,r=this.filters;t=new(e=class extends kw{apply(t,e){const i=n.apply([r]),o=Bc([r]),s=n.apply([2*r]);return iw([i,o,s])}},e.className="CustomInit",e)}else t=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*i],null,t,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(t,e){return Io((()=>{if(3!==t.length)throw new Xb(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${t.length}.`);const n=e["training"]||!1,r=t[0],i=t[1],o=t[2],s=4;0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=OI({ones:()=>Uc(r),rate:this.dropout,training:n,count:s,dropoutFunc:this.dropoutFunc}));const a=this.dropoutMask,l=(t,e,n)=>e&&e[n]?js(e[n],t):t;let u=l(r,a,0),c=l(r,a,1),h=l(r,a,2),d=l(r,a,3);0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=OI({ones:()=>Uc(i),rate:this.recurrentDropout,training:n,count:s,dropoutFunc:this.dropoutFunc}));const p=this.recurrentDropoutMask;let f=l(i,p,0),g=l(i,p,1),m=l(i,p,2),y=l(i,p,3);const b=3,[v,w,x,k]=Sh(this.kernel.read(),s,b),[_,I,C,S]=this.useBias?Sh(this.bias.read(),s):[null,null,null,null];u=this.inputConv(u,v,_,this.padding),c=this.inputConv(c,w,I,this.padding),h=this.inputConv(h,x,C,this.padding),d=this.inputConv(d,k,S,this.padding);const[T,E,N,A]=Sh(this.recurrentKernel.read(),s,b);f=this.recurrentConv(f,T),g=this.recurrentConv(g,E),m=this.recurrentConv(m,N),y=this.recurrentConv(y,A);const R=this.recurrentActivation.apply(Ls(u,f)),$=this.recurrentActivation.apply(Ls(c,g)),D=Ls(js($,o),js(R,this.activation.apply(Ls(h,m)))),O=js(this.recurrentActivation.apply(Ls(d,y)),this.activation.apply(D));return[O,O,D]}))}getConfig(){const t=super.getConfig(),{units:e}=t,n=FI(t,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),r)}inputConv(t,e,n,r){const i=du(t,e,this.strides,r||"valid","channelsFirst"===this.dataFormat?"NCHW":"NHWC",this.dilationRate);return n?dw(i,n,this.dataFormat):i}recurrentConv(t,e){const n=1;return du(t,e,n,"same","channelsFirst"===this.dataFormat?"NCHW":"NHWC")}}PI.className="ConvLSTM2DCell",ia(PI);class LI extends MI{constructor(t){const e=new PI(t);super(Object.assign(Object.assign({},t),{cell:e}))}static fromConfig(t,e){return new t(e)}}LI.className="ConvLSTM2D",ia(LI);
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
class zI extends ix{constructor(t){super(t),this.rate=Math.max(Math.min(t.rate,1),0),this.noiseShape=t.noiseShape,this.seed=t.seed,this.supportsMasking=!0}getNoiseShape(t){if(null==this.noiseShape)return this.noiseShape;const e=t.shape,n=[];for(let r=0;r<this.noiseShape.length;++r)n.push(null==this.noiseShape[r]?e[r]:this.noiseShape[r]);return n}call(t,e){return Io((()=>{this.invokeCallHook(t,e);const n=Hw(t);if(0<this.rate&&this.rate<1){const t=null!=e["training"]&&e["training"],r=this.getNoiseShape(n),i=yw((()=>gw(n,this.rate,r,this.seed)),(()=>n),t);return i}return t}))}getConfig(){const t={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},e=super.getConfig();return Object.assign(t,e),t}dispose(){return super.dispose()}}zI.className="Dropout",ia(zI);class BI extends zI{constructor(t){super(t),this.inputSpec=[{ndim:3}]}getNoiseShape(t){const e=t.shape;return[e[0],1,e[2]]}}BI.className="SpatialDropout1D",ia(BI);class WI extends ix{constructor(t){if(super(t),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",null==t.batchInputShape&&null==t.inputShape&&null!=t.inputDim){let e=null;null!=t.batchSize&&(e=t.batchSize),this.batchInputShape=[e,t.inputDim]}this.units=t.units,mv(this.units,"units"),this.activation=U_(t.activation),null!=t.useBias&&(this.useBias=t.useBias),this.kernelInitializer=Uw(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=Uw(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=$x(t.kernelConstraint),this.biasConstraint=$x(t.biasConstraint),this.kernelRegularizer=X_(t.kernelRegularizer),this.biasRegularizer=X_(t.biasRegularizer),this.activityRegularizer=X_(t.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(t){t=Gw(t);const e=t[t.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[e,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:e}}],this.built=!0}computeOutputShape(t){t=Gw(t);const e=t.slice();return e[e.length-1]=this.units,e}call(t,e){return Io((()=>{this.invokeCallHook(t,e);const n=Hw(t),r=vv(this.activation.getClassName());let i;return null!=r?i=lw(n,this.kernel.read(),r,this.bias?this.bias.read():null):(i=lw(n,this.kernel.read()),null!=this.bias&&(i=dw(i,this.bias.read())),null!=this.activation&&(i=this.activation.apply(i))),i}))}getConfig(){const t={units:this.units,activation:B_(this.activation),useBias:this.useBias,kernelInitializer:Ww(this.kernelInitializer),biasInitializer:Ww(this.biasInitializer),kernelRegularizer:q_(this.kernelRegularizer),biasRegularizer:q_(this.biasRegularizer),activityRegularizer:q_(this.activityRegularizer),kernelConstraint:Ax(this.kernelConstraint),biasConstraint:Ax(this.biasConstraint)},e=super.getConfig();return Object.assign(t,e),t}}WI.className="Dense",ia(WI);class UI extends ix{constructor(t){t=t||{},super(t),this.inputSpec=[{minNDim:3}],this.dataFormat=t.dataFormat}computeOutputShape(t){t=Gw(t);for(const e of t.slice(1))if(null==e)throw new Xb(`The shape of the input to "Flatten" is not fully defined (got ${t.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[t[0],Vv(t,1)]}call(t,e){return Io((()=>{this.invokeCallHook(t,e);let n=Hw(t);if("channelsFirst"===this.dataFormat&&n.rank>1){const t=[0];for(let e=2;e<n.rank;++e)t.push(e);t.push(1),n=qh(n,t)}return tw(n)}))}getConfig(){const t={};null!=this.dataFormat&&(t["dataFormat"]=this.dataFormat);const e=super.getConfig();return Object.assign(t,e),t}}UI.className="Flatten",ia(UI);class VI extends ix{constructor(t){super(t),this.supportsMasking=!0,this.activation=U_(t.activation)}call(t,e){return Io((()=>{this.invokeCallHook(t,e);const n=Hw(t);return this.activation.apply(n)}))}getConfig(){const t={activation:B_(this.activation)},e=super.getConfig();return Object.assign(t,e),t}}VI.className="Activation",ia(VI);class jI extends ix{constructor(t){super(t),this.n=t.n,this.inputSpec=[{ndim:2}]}computeOutputShape(t){return[t[0],this.n,t[1]]}call(t,e){return Io((()=>(t=Hw(t),Zv(t,this.n))))}getConfig(){const t={n:this.n},e=super.getConfig();return Object.assign(t,e),t}}jI.className="RepeatVector",ia(jI);class HI extends ix{constructor(t){super(t),this.targetShape=t.targetShape;for(let e=0;e<this.targetShape.length;++e)this.isUnknown(this.targetShape[e])&&(this.targetShape[e]=null)}isUnknown(t){return t<0||null==t}fixUnknownDimension(t,e){const n="Total size of new array must be unchanged.",r=e.slice();let i=1,o=null;for(let a=0;a<r.length;++a){const t=r[a];if(this.isUnknown(t)){if(null!==o)throw new Xb("Can only specifiy one unknown dimension.");o=a}else i*=t}const s=Vv(t);if(null!==o){if(0===i||s%i!==0)throw new Xb(n);r[o]=s/i}else if(s!==i)throw new Xb(n);return r}computeOutputShape(t){let e=!1;for(let n=0;n<t.length;++n)if(this.isUnknown(t[n])){e=!0;break}return e?t.slice(0,1).concat(this.targetShape):t.slice(0,1).concat(this.fixUnknownDimension(t.slice(1),this.targetShape))}call(t,e){return Io((()=>{this.invokeCallHook(t,e);const n=Hw(t),r=n.shape,i=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return Pl(n,i)}))}getConfig(){const t={targetShape:this.targetShape},e=super.getConfig();return Object.assign(t,e),t}}HI.className="Reshape",ia(HI);class GI extends ix{constructor(t){if(super(t),null==t.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(t.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${t.dims} instead.`);const e=Gv(1,t.dims.length+1);if(!x(t.dims.slice().sort(),e))throw new Error("Invalid permutation `dims`: "+JSON.stringify(t.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=t.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new Qw({ndim:this.dims.length+1})]}computeOutputShape(t){t=Gw(t);const e=t.slice();return this.dims.forEach(((n,r)=>{e[r+1]=t[n]})),e}call(t,e){return qh(Hw(t),this.dimsIncludingBatch)}getConfig(){const t={dims:this.dims},e=super.getConfig();return Object.assign(t,e),t}}GI.className="Permute",ia(GI);class qI extends ix{constructor(t){super(null==t?{}:t),this.supportsMasking=!0,this.maskValue=null!=t?null==t.maskValue?0:t.maskValue:0}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={maskValue:this.maskValue};return Object.assign(e,t),e}computeMask(t,e){const n=Hw(t),r=-1;return fl(Mc(n,this.maskValue),r)}call(t,e){return Io((()=>{this.invokeCallHook(t,e);const n=Hw(t),r=-1,i=!0,o=fl(Mc(n,this.maskValue),r,i),s=js(n,$s(o,n.dtype));return s}))}}qI.className="Masking",ia(qI);
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
class KI extends ix{constructor(t){if(super(t),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==t.batchInputShape&&null==t.inputShape){let e=null;null!=t.batchSize&&(e=t.batchSize),null==t.inputLength?this.batchInputShape=[e,null]:this.batchInputShape=[e].concat(rv(t.inputLength))}this.inputDim=t.inputDim,mv(this.inputDim,"inputDim"),this.outputDim=t.outputDim,mv(this.outputDim,"outputDim"),this.embeddingsInitializer=Uw(t.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=X_(t.embeddingsRegularizer),this.activityRegularizer=X_(t.activityRegularizer),this.embeddingsConstraint=$x(t.embeddingsConstraint),this.maskZero=t.maskZero,this.supportsMasking=t.maskZero,this.inputLength=t.inputLength}build(t){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(t){}computeMask(t,e){return Io((()=>this.maskZero?(t=Hw(t),Mc(t,Ys(t))):null))}computeOutputShape(t){if(t=Gw(t),null==this.inputLength)return[...t,this.outputDim];const e=rv(this.inputLength);if(e.length!==t.length-1)throw new Xb(`"inputLength" is ${this.inputLength}, but received input shape has shape ${t}`);{let n=0;for(let r=0;r<e.length;++r){const i=e[r],o=t[r+1];if(null!=i&&null!=o&&i!==o)throw new Xb(`"inputLength" is ${this.inputLength}, but received input shape has shape ${t}`);null==i&&(e[n]=o),n++}}return[t[0],...e,this.outputDim]}call(t,e){return Io((()=>{this.invokeCallHook(t,e);let n=Hw(t);"int32"!==n.dtype&&(n=Yv(n,"int32"));const r=uw(this.embeddings.read(),Pl(n,[n.size]));return Pl(r,Gw(this.computeOutputShape(n.shape)))}))}getConfig(){const t={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Ww(this.embeddingsInitializer),embeddingsRegularizer:q_(this.embeddingsRegularizer),activityRegularizer:q_(this.activityRegularizer),embeddingsConstraint:Ax(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},e=super.getConfig();return Object.assign(t,e),t}}KI.className="Embedding",ia(KI);
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
class XI extends ix{constructor(t){super(t||{}),this.supportsMasking=!0}mergeFunction(t){throw new Yb}computeElementwiseOpOutputShape(t,e){if(null==t||null==e)return null;if(t.length<e.length)return this.computeElementwiseOpOutputShape(e,t);if(0===e.length)return t;const n=t.slice(0,t.length-e.length);for(let r=0;r<e.length;++r){const i=t[t.length-e.length+r],o=e[r];if(null==i||null==o||i<0||o<0)n.push(null);else if(1===i)n.push(o);else if(1===o)n.push(i);else{if(i!==o)throw new Xb("Operands could not be broadcast together with shapes "+JSON.stringify(t)+" "+JSON.stringify(e));n.push(i)}}return n}build(t){if(Array.isArray(t)&&!Array.isArray(t[0])&&(t=[Gw(t)]),t.length<2)throw new Xb(`A merge layer should be called on an Array of at least 2 inputs. Got ${t.length} input(s).`);let e=[];for(const i of t)null!=i&&null!==i[0]&&e.push(i[0]);if(e=dv(e),e.length>1)throw new Xb(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(t)}.`);let n=null==t[0]?null:t[0].slice(1);for(let i=1;i<t.length;++i){const e=null==t[i]?null:t[i].slice(1);n=this.computeElementwiseOpOutputShape(n,e)}const r=t.map((t=>t.length));-1===t.indexOf(null)&&1===dv(r).length?this.reshapeRequired=!1:this.reshapeRequired=!0}call(t,e){return Io((()=>{if(this.reshapeRequired){const e=[],n=t.map((t=>t.rank));if(-1===n.indexOf(null)){const r=Hv(n);for(let n of t){const t=n.rank;for(let e=0;e<r-t;++e)n=Jv(n,1);e.push(n)}return this.mergeFunction(e)}{let n=!1;for(const o of t){const t=o.rank;if(null==t){const t=o.shape,r=t[0],i=t.slice(1).concat([r]);let s=Pl(o,[r].concat(Vv(t.slice(1))));s=qh(s,[1,0]),s=Pl(s,i),e.push(s),n=!0}else if(t>1){const r=Gv(1,t).concat([0]);e.push(qh(o,r)),n=!0}else e.push(o)}let r=this.mergeFunction(e);const i=r.rank;if(n)if(null==i){const t=r.shape,e=t.length,n=t[e-1],i=[n].concat(t.slice(0,t.length-1));r=Pl(qh(Pl(r,[-1,n]),[1,0]),i)}else if(i>1){const t=[i-1].concat(Gv(0,i-1));r=qh(r,t)}return r}}return this.mergeFunction(t)}))}computeOutputShape(t){let e;e=null==t[0]?null:t[0].slice(1);for(let r=1;r<t.length;++r){const n=null==t[r]?null:t[r].slice(1);e=this.computeElementwiseOpOutputShape(e,n)}let n=[];for(const r of t)null!=r&&null!==r[0]&&n.push(r[0]);return n=dv(n),e=1===n.length?n.concat(e):[null].concat(e),e}computeMask(t,e){return Io((()=>{if(null==e)return null;if(!Array.isArray(e))throw new Xb("`mask` should be an Array");if(!Array.isArray(t))throw new Xb("`inputs` should be an Array");if(e.length!==t.length)throw new Xb(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${t.length} vs ${e.length})`);if(e.every((t=>null==t)))return null;e=e.map((t=>null==t?t:Mu(t,0)));let n=e[0];for(let t=1;t<e.length-1;++t)n=bc(n,e[t]);return n}))}}class YI extends XI{constructor(t){super(t)}mergeFunction(t){return Io((()=>{let e=t[0].clone();for(let n=1;n<t.length;++n)e=Ls(e,t[n]);return e}))}}YI.className="Add",ia(YI);class JI extends XI{constructor(t){super(t)}mergeFunction(t){return Io((()=>{let e=t[0].clone();for(let n=1;n<t.length;++n)e=js(e,t[n]);return e}))}}JI.className="Multiply",ia(JI);class ZI extends XI{constructor(t){super(t)}mergeFunction(t){return Io((()=>{let e=t[0].clone();for(let n=1;n<t.length;++n)e=Ls(e,t[n]);return js(1/t.length,e)}))}}ZI.className="Average",ia(ZI);class QI extends XI{constructor(t){super(t)}mergeFunction(t){return Io((()=>{let e=t[0];for(let n=1;n<t.length;++n)e=wa(e,t[n]);return e}))}}QI.className="Maximum",ia(QI);class tC extends XI{constructor(t){super(t)}mergeFunction(t){return Io((()=>{let e=t[0];for(let n=1;n<t.length;++n)e=Ac(e,t[n]);return e}))}}tC.className="Minimum",ia(tC);class eC extends XI{constructor(t){super(t),this.DEFAULT_AXIS=-1,null==t&&(t={}),this.axis=null==t.axis?this.DEFAULT_AXIS:t.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){if(!Array.isArray(t)||!Array.isArray(t[0])||1===t.length)throw new Xb("A `Concatenate` layer should be called on a list of at least 2 inputs");let e=!0;for(const r of t)if(null!=r){e=!1;break}if(e)return;const n=[];for(let r=0;r<t.length;++r){const e=t[r].slice();e.splice(this.axis,1);let i=!1;for(const t of n)if(x(t,e)){i=!0;break}i||n.push(e)}if(n.length>1)throw new Xb("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(t))}mergeFunction(t){return Io((()=>iw(t,this.axis)))}computeOutputShape(t){if(!Array.isArray(t)||!Array.isArray(t[0]))throw new Xb("A `Concatenate` layer should be called on a list of inputs.");const e=t,n=e[0].slice(),r=this.axis<0?n.length+this.axis:this.axis;for(const i of e.slice(1)){if(null==n[r]||null==i[r]){n[r]=null;break}n[r]+=i[r]}return n}computeMask(t,e){if(null==e)return null;if(!Array.isArray(e))throw new Xb("`mask` should be an array for Concatenate");if(!Array.isArray(t))throw new Xb("`inputs` should be an array for Concatenate");if(e.length!==t.length)throw new Xb(`Mismatch in the length of mask (${e.length}) and the legnth of inputs (${t.length})`);return Io((()=>{let n=!0;if(e.forEach((t=>{null==t||(n=!1)})),n)return null;const r=[];for(let o=0;o<t.length;++o)null==e[o]?r.push($s(Uc(t[o]),"bool")):e[o].rank<t[o].rank?r.push(Mu(e[o],-1)):r.push(e[o]);const i=nu(r,this.axis);return dl(i,-1,!1)}))}getConfig(){const t={axis:this.axis},e=super.getConfig();return Object.assign(t,e),t}}function nC(t,e){while(t<0)t+=e;return t}function rC(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new Yb("batchDot is not implemented for tensors of 4D or higher rank yet");if(y(t.shape.length>=2,(()=>`batchDot requires the rank of x to be >= 2, but got ${t.shape.length}`)),y(t.shape.length>=2,(()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`)),"number"===typeof n&&(n=[n,n]),"complex64"===t.dtype||"complex64"===e.dtype)throw new Yb("batchDot is not implemented for complex64-type Tensors yet.");const r=t.shape.length,i=e.shape.length;null==n&&(n=[r-1,i-2]);const o=n;return Io((()=>{let n,s;if(r>i){n=r-i;const t=[];for(let e=0;e<n;++e)t.push(1);e=Pl(e,e.shape.concat(t))}else if(i>r){n=i-r;const e=[];for(let t=0;t<n;++t)e.push(1);t=Pl(t,t.shape.concat(e))}else n=0;if(2===t.shape.length&&2===e.shape.length)s=o[0]===o[1]?ic(js(t,e),o[0]):ic(js(qh(t,[1,0]),e),o[1]);else{const n=o[0]!==t.shape.length-1,r=o[1]===e.shape.length-1;s=wc(t,e,n,r)}if(n>0){let t;t=r>i?r+i-3:r-1;const e=[];for(let r=t;r<t+n;++r)e.push(r);s=Eh(s,e)}return 1===s.shape.length&&(s=Mu(s,1)),s}))}eC.className="Concatenate",ia(eC);class iC extends XI{constructor(t){super(t),this.axes=t.axes,this.normalize=null!=t.normalize&&t.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){y(Array.isArray(t)&&2===t.length&&Array.isArray(t[0])&&Array.isArray(t[1]),(()=>"A `Dot` layer should be called on a list of exactly 2 inputs."));const e=t[0],n=t[1];if(e.length>3||n.length>3)throw new Yb("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(e,n);if(e[r[0]]!==n[r[1]])throw new Xb(`Dimension incompatibility: ${e[r[0]]} !== ${n[r[1]]}`)}mergeFunction(t){if(2!==t.length)throw new Xb(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${t.length} input(s).`);let e,n=t[0],r=t[1];return e=Array.isArray(this.axes)?this.axes.map(((e,n)=>nC(e,t[n].shape.length))):[nC(this.axes,n.shape.length),nC(this.axes,r.shape.length)],this.normalize&&(n=Gx(n,e[0]),r=Gx(r,e[1])),rC(n,r,e)}interpretAxes(t,e){let n;return n=Array.isArray(this.axes)?this.axes:[nC(this.axes,t.length),nC(this.axes,e.length)],n}computeOutputShape(t){y(Array.isArray(t)&&2===t.length&&Array.isArray(t[0])&&Array.isArray(t[1]),(()=>"A `Dot` layer should be called on a list of exactly 2 inputs."));const e=t[0].slice(),n=t[1].slice();if(e.length>3||n.length>3)throw new Yb("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(e,n);e.splice(r[0],1),n.splice(r[1],1),n.splice(0,1);const i=e.concat(n);return 1===i.length&&i.push(1),i}computeMask(t,e){return null}getConfig(){const t={axes:this.axes,normalize:this.normalize},e=super.getConfig();return Object.assign(t,e),t}}iC.className="Dot",ia(iC);
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
class oC extends ix{constructor(t){super(t),this.supportsMasking=!0,this.stddev=t.stddev}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={stddev:this.stddev};return Object.assign(e,t),e}call(t,e){return Io((()=>{this.invokeCallHook(t,e);const n=Hw(t),r=()=>Ls(aw(n.shape,0,this.stddev),n),i=yw(r,(()=>n),e["training"]||!1);return i}))}}oC.className="GaussianNoise",ia(oC);class sC extends ix{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={rate:this.rate};return Object.assign(e,t),e}call(t,e){return Io((()=>{this.invokeCallHook(t,e);const n=Hw(t);if(this.rate>0&&this.rate<1){const t=()=>{const t=Math.sqrt(this.rate/(1-this.rate));return js(n,aw(n.shape,1,t))};return yw(t,(()=>n),e["training"]||!1)}return n}))}}sC.className="GaussianDropout",ia(sC);class aC extends ix{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate,this.noiseShape=t.noiseShape}_getNoiseShape(t){return this.noiseShape||Hw(t).shape}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={rate:this.rate};return Object.assign(e,t),e}call(t,e){return Io((()=>{if(this.rate<1&&this.rate>0){const n=this._getNoiseShape(t),r=()=>{const e=Hw(t),r=1.6732632423543772,i=1.0507009873554805,o=-r*i;let s=Ku(Qc(n),this.rate);s=Yv(s,"float32");const a=((1-this.rate)*(1+this.rate*o**2))**-.5,l=-a*o*this.rate,u=Ls(js(e,s),js(Ls(s,-1),o));return Ls(js(u,a),l)};return yw(r,(()=>Hw(t)),e["training"]||!1)}return t}))}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function lC(t,e,n,r,i,o=.001){let s;if(2===t.rank)s=Gl(t,e,n,r,i,o);else if(3===t.rank)s=Kl(t,e,n,r,i,o);else{if(4!==t.rank)throw new Yb(`batchNormalization is not implemented for array of rank ${t.rank} yet`);s=Yl(t,e,n,r,i,o)}return s}function uC(t,e,n,r,i=.001){return Io((()=>{const o=$c(t,r),s=o.mean,a=o.variance,l=lC(t,s,a,n,e,i);return[l,s,a]}))}function cC(t,e,n,r,i=.001){return Io((()=>{const o=$c(t,r),s=o.mean,a=o.variance,l=[];for(const e of Gv(0,t.rank))-1!==r.indexOf(e)?l.push(1):l.push(t.shape[e]);const u=Pl(s,l),c=Pl(a,l),h=null==e?null:Pl(e,l),d=null==n?null:Pl(n,l),p=lC(t,u,c,d,h,i);return[p,s,a]}))}function hC(t,e,n,r,i=.001){return x(r.slice().sort(),Gv(0,t.rank-1))?uC(t,e,n,r,i):cC(t,e,n,r,i)}aC.className="AlphaDropout",ia(aC);class dC extends ix{constructor(t){null==t&&(t={}),super(t),this.supportsMasking=!0,this.axis=null==t.axis?-1:t.axis,this.momentum=null==t.momentum?.99:t.momentum,this.epsilon=null==t.epsilon?.001:t.epsilon,this.center=null==t.center||t.center,this.scale=null==t.scale||t.scale,this.betaInitializer=Uw(t.betaInitializer||"zeros"),this.gammaInitializer=Uw(t.gammaInitializer||"ones"),this.movingMeanInitializer=Uw(t.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=Uw(t.movingVarianceInitializer||"ones"),this.betaConstraint=$x(t.betaConstraint),this.gammaConstraint=$x(t.gammaConstraint),this.betaRegularizer=X_(t.betaRegularizer),this.gammaRegularizer=X_(t.gammaRegularizer)}build(t){t=Gw(t);const e=this.axis>=0?this.axis:this.axis+t.length,n=t[e];if(null==n)throw new Xb(`Axis ${e} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(t)}.`);this.inputSpec=[new Qw({ndim:t.length,axes:{[e]:n}})];const r=[n];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(t,e){return Io((()=>{const n=null!=e["training"]&&e["training"],r=Hw(t),i=r.shape,o=i.length,s=Gv(0,o),a=this.axis>=0?this.axis:this.axis+o;s.splice(a,1);const l=Qb(1,o);l[a]=i[a];const u=s.slice();u.sort();const c=!x(u,Gv(0,o).slice(0,o-1)),h=()=>{if(c){const t=Pl(this.movingMean.read(),l),e=Pl(this.movingVariance.read(),l),n=this.center?Pl(this.beta.read(),l):null,i=this.scale?Pl(this.gamma.read(),l):null;return lC(r,t,e,n,i,this.epsilon)}return lC(r,this.movingMean.read(),this.movingVariance.read(),null==this.beta?null:this.beta.read(),null==this.gamma?null:this.gamma.read(),this.epsilon)};if(!n)return h();const[d,p,f]=hC(r,this.gamma.read(),this.beta.read(),s,this.epsilon),g=(t,e,n)=>{Io((()=>{const r=1-n,i=t.read(),o=js(da(i,e),r);t.write(da(i,o))}))},m=()=>{g(this.movingMean,p,this.momentum),g(this.movingVariance,f,this.momentum)};return m(),d}))}getConfig(){const t={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Ww(this.betaInitializer),gammaInitializer:Ww(this.gammaInitializer),movingMeanInitializer:Ww(this.movingMeanInitializer),movingVarianceInitializer:Ww(this.movingVarianceInitializer),betaRegularizer:q_(this.betaRegularizer),gammaRegularizer:q_(this.gammaRegularizer),betaConstraint:Ax(this.betaConstraint),gammaConstraint:Ax(this.gammaConstraint)},e=super.getConfig();return Object.assign(t,e),t}}dC.className="BatchNormalization",ia(dC);class pC extends ix{constructor(t){if(null==t&&(t={}),super(t),this.axis=null==t.axis?-1:t.axis,"number"===typeof this.axis){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else{if(!Array.isArray(this.axis))throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);for(const t of this.axis)if(!Number.isInteger(t))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}this.epsilon=null==t.epsilon?.001:t.epsilon,this.center=null==t.center||t.center,this.scale=null==t.scale||t.scale,this.betaInitializer=Uw(t.betaInitializer||"zeros"),this.gammaInitializer=Uw(t.gammaInitializer||"ones"),this.betaRegularizer=X_(t.betaRegularizer),this.gammaRegularizer=X_(t.gammaRegularizer),this.supportsMasking=!0}build(t){t=Gw(t);const e=t.length;"number"===typeof this.axis&&(this.axis=[this.axis]);for(let i=0;i<this.axis.length;++i)this.axis[i]<0&&(this.axis[i]+=e);for(const i of this.axis)if(i<0||i>=e)throw new Error(`Invalid axis: ${i}`);if(this.axis.length!==dv(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const n=this.axis.map((e=>t[e])),r=!0;this.scale?this.gamma=this.addWeight("gamma",n,"float32",this.gammaInitializer,this.gammaRegularizer,r):this.gamma=null,this.center?this.beta=this.addWeight("beta",n,"float32",this.betaInitializer,this.betaRegularizer,r):this.beta=null,this.built=!0}call(t,e){const n=Hw(t),r=n.shape,i=r.length;return Io((()=>{const t=!0;let{mean:e,variance:o}=$c(n,this.axis,t);const s=Qb(1,i);for(const n of this.axis)s[n]=r[n];const a=t=>null!=t&&t.shape.length!==i?Pl(t,s):t;let l=this.scale?a(this.gamma.read()):null,u=this.center?a(this.beta.read()):null;const c=[],h=[];for(let n=0;n<i;++n)-1!==this.axis.indexOf(n)?(c.push(r[n]),h.push(1)):(c.push(1),h.push(r[n]));return e=Lu(e,c),o=Lu(o,c),null!=l&&(l=Lu(l,h)),null!=u&&(u=Lu(u,h)),lC(n,e,o,u,l,this.epsilon)}))}getConfig(){const t={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Ww(this.betaInitializer),gammaInitializer:Ww(this.gammaInitializer),betaRegularizer:q_(this.betaRegularizer),gammaRegularizer:q_(this.gammaRegularizer)},e=super.getConfig();return Object.assign(t,e),t}}function fC(t,e,n){return Io((()=>{if(4!==t.rank)throw new Xb(`temporalPadding expects input tensor to be 4-D, but received a ${t.rank}-D tensor.`);if(null==e&&(e=[[1,1],[1,1]]),2!==e.length||2!==e[0].length||2!==e[1].length)throw new Xb("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==n&&(n=Xv()),"channelsLast"!==n&&"channelsFirst"!==n)throw new Xb(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let r;return r="channelsFirst"===n?[[0,0],[0,0],e[0],e[1]]:[[0,0],e[0],e[1],[0,0]],jc(t,r)}))}pC.className="LayerNormalization",ia(pC);class gC extends ix{constructor(t){if(null==t&&(t={}),super(t),this.dataFormat=null==t.dataFormat?Xv():t.dataFormat,null==t.padding)this.padding=[[1,1],[1,1]];else if("number"===typeof t.padding)this.padding=[[t.padding,t.padding],[t.padding,t.padding]];else{if(t.padding=t.padding,2!==t.padding.length)throw new Xb(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${t.padding.length} array.`);let e,n;if("number"===typeof t.padding[0])e=[t.padding[0],t.padding[0]],n=[t.padding[1],t.padding[1]];else{if(t.padding=t.padding,2!==t.padding[0].length)throw new Xb(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${t.padding[0].length} array.`);if(e=t.padding[0],2!==t.padding[1].length)throw new Xb(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${t.padding[1].length} array.`);n=t.padding[1]}this.padding=[e,n]}this.inputSpec=[new Qw({ndim:4})]}computeOutputShape(t){let e,n;return t=Gw(t),"channelsFirst"===this.dataFormat?(e=null!=t[2]&&t[2]>=0?t[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=t[3]&&t[3]>=0?t[3]+this.padding[1][0]+this.padding[1][1]:null,[t[0],t[1],e,n]):(e=null!=t[1]&&t[1]>=0?t[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=t[2]&&t[2]>=0?t[2]+this.padding[1][0]+this.padding[1][1]:null,[t[0],e,n,t[3]])}call(t,e){return Io((()=>fC(Hw(t),this.padding,this.dataFormat)))}getConfig(){const t={padding:this.padding,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function mC(t,e,n,r,i,o){return Io((()=>{let s;Av(i),Dv(o),$v(r),null==n&&(n=[1,1]),null==r&&(r="valid"),null==i&&(i=Xv()),null==o&&(o="max"),t=oI(t,i);const a="same"===r?"same":"valid";return s="max"===o?kc(t,e,n,a):zl(t,e,n,a),"channelsFirst"===i&&(s=qh(s,[0,3,1,2])),s}))}function yC(t,e,n,r,i,o){return Io((()=>{let s;Av(i),Dv(o),$v(r),null==n&&(n=[1,1,1]),null==r&&(r="valid"),null==i&&(i=Xv()),null==o&&(o="max"),t=sI(t,i);const a="same"===r?"same":"valid";return s="max"===o?Ic(t,e,n,a):Wl(t,e,n,a),"channelsFirst"===i&&(s=qh(s,[0,4,1,2,3])),s}))}gC.className="ZeroPadding2D",ia(gC);class bC extends ix{constructor(t){if(null==t.poolSize&&(t.poolSize=2),super(t),"number"===typeof t.poolSize)this.poolSize=[t.poolSize];else{if(!Array.isArray(t.poolSize)||1!==t.poolSize.length||"number"!==typeof t.poolSize[0])throw new Xb(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(t.poolSize)}`);this.poolSize=t.poolSize}if(mv(this.poolSize,"poolSize"),null==t.strides)this.strides=this.poolSize;else if("number"===typeof t.strides)this.strides=[t.strides];else{if(!Array.isArray(t.strides)||1!==t.strides.length||"number"!==typeof t.strides[0])throw new Xb(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(t.strides)}`);this.strides=t.strides}mv(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,$v(this.padding),this.inputSpec=[new Qw({ndim:3})]}computeOutputShape(t){t=Gw(t);const e=rI(t[1],this.poolSize[0],this.padding,this.strides[0]);return[t[0],e,t[2]]}call(t,e){return Io((()=>{this.invokeCallHook(t,e),t=Jv(Hw(t),2);const n=this.poolingFunction(Hw(t),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return Eh(n,[2])}))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides},e=super.getConfig();return Object.assign(t,e),t}}class vC extends bC{constructor(t){super(t)}poolingFunction(t,e,n,r,i){return Av(i),$v(r),mC(t,e,n,r,i,"max")}}vC.className="MaxPooling1D",ia(vC);class wC extends bC{constructor(t){super(t)}poolingFunction(t,e,n,r,i){return Av(i),$v(r),mC(t,e,n,r,i,"avg")}}wC.className="AveragePooling1D",ia(wC);class xC extends ix{constructor(t){if(null==t.poolSize&&(t.poolSize=[2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize],null==t.strides)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(2!==t.strides.length)throw new Xb(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides];mv(this.poolSize,"poolSize"),mv(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,Av(this.dataFormat),$v(this.padding),this.inputSpec=[new Qw({ndim:4})]}computeOutputShape(t){t=Gw(t);let e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2];return e=rI(e,this.poolSize[0],this.padding,this.strides[0]),n=rI(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,n]:[t[0],e,n,t[3]]}call(t,e){return Io((()=>(this.invokeCallHook(t,e),this.poolingFunction(Hw(t),this.poolSize,this.strides,this.padding,this.dataFormat))))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class kC extends xC{constructor(t){super(t)}poolingFunction(t,e,n,r,i){return Av(i),$v(r),mC(t,e,n,r,i,"max")}}kC.className="MaxPooling2D",ia(kC);class _C extends xC{constructor(t){super(t)}poolingFunction(t,e,n,r,i){return Av(i),$v(r),mC(t,e,n,r,i,"avg")}}_C.className="AveragePooling2D",ia(_C);class IC extends ix{constructor(t){if(null==t.poolSize&&(t.poolSize=[2,2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize,t.poolSize],null==t.strides)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(3!==t.strides.length)throw new Xb(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides,t.strides];mv(this.poolSize,"poolSize"),mv(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,Av(this.dataFormat),$v(this.padding),this.inputSpec=[new Qw({ndim:5})]}computeOutputShape(t){t=Gw(t);let e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2],r="channelsFirst"===this.dataFormat?t[4]:t[3];return e=rI(e,this.poolSize[0],this.padding,this.strides[0]),n=rI(n,this.poolSize[1],this.padding,this.strides[1]),r=rI(r,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,n,r]:[t[0],e,n,r,t[4]]}call(t,e){return Io((()=>(this.invokeCallHook(t,e),this.poolingFunction(Hw(t),this.poolSize,this.strides,this.padding,this.dataFormat))))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class CC extends IC{constructor(t){super(t)}poolingFunction(t,e,n,r,i){return Av(i),$v(r),yC(t,e,n,r,i,"max")}}CC.className="MaxPooling3D",ia(CC);class SC extends IC{constructor(t){super(t)}poolingFunction(t,e,n,r,i){return Av(i),$v(r),yC(t,e,n,r,i,"avg")}}SC.className="AveragePooling3D",ia(SC);class TC extends ix{constructor(t){super(t),this.inputSpec=[new Qw({ndim:3})]}computeOutputShape(t){return[t[0],t[2]]}call(t,e){throw new Yb}}class EC extends TC{constructor(t){super(t||{})}call(t,e){return Io((()=>{const e=Hw(t);return Sc(e,1)}))}}EC.className="GlobalAveragePooling1D",ia(EC);class NC extends TC{constructor(t){super(t||{})}call(t,e){return Io((()=>{const e=Hw(t);return nc(e,1)}))}}NC.className="GlobalMaxPooling1D",ia(NC);class AC extends ix{constructor(t){super(t),this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,Av(this.dataFormat),this.inputSpec=[new Qw({ndim:4})]}computeOutputShape(t){return"channelsLast"===this.dataFormat?[t[0],t[3]]:[t[0],t[1]]}call(t,e){throw new Yb}getConfig(){const t={dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class RC extends AC{call(t,e){return Io((()=>{const e=Hw(t);return"channelsLast"===this.dataFormat?Sc(e,[1,2]):Sc(e,[2,3])}))}}RC.className="GlobalAveragePooling2D",ia(RC);class $C extends AC{call(t,e){return Io((()=>{const e=Hw(t);return"channelsLast"===this.dataFormat?nc(e,[1,2]):nc(e,[2,3])}))}}$C.className="GlobalMaxPooling2D",ia($C);
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
class DC extends ix{constructor(t){super(t),this.layer=t.layer}build(t){this.built=!0}get trainable(){return null!=this.layer&&this.layer.trainable}set trainable(t){null!=this.layer&&(this.layer.trainable=t)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(t){this.layer.setWeights(t)}getConfig(){const t={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},e=super.getConfig();return Object.assign(t,e),t}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(t)}static fromConfig(t,e,n={}){const r=e["layer"],i=Hx(r,n);delete e["layer"];const o={layer:i};return Object.assign(o,e),new t(o)}}class OC extends DC{constructor(t){super(t),this.supportsMasking=!0}build(t){if(t=Gw(t),t.length<3)throw new Xb(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(t)}`);this.inputSpec=[{shape:t}];const e=[t[0]].concat(t.slice(2));this.layer.built||(this.layer.build(e),this.layer.built=!0),super.build(t)}computeOutputShape(t){t=Gw(t);const e=[t[0]].concat(t.slice(2)),n=this.layer.computeOutputShape(e),r=t[1];return[n[0],r].concat(n.slice(1))}call(t,e){return Io((()=>{t=Hw(t);const n=(t,n)=>{const r=Hw(this.layer.call(t,e));return[r,[]]},r=II(n,t,[],!1,null,null,!1,!0),i=r[1];return i}))}}function FC(t){fv(Ev,"BidirectionalMergeMode",t)}OC.className="TimeDistributed",ia(OC);const MC="concat";class PC extends DC{constructor(t){super(t);const e=t.layer.getConfig(),n={};n["className"]=t.layer.getClassName(),n["config"]=e,this.forwardLayer=Hx(n),e["goBackwards"]=!0!==e["goBackwards"];const r={};if(r["className"]=t.layer.getClassName(),r["config"]=e,this.backwardLayer=Hx(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=void 0===t.mergeMode?MC:t.mergeMode,FC(this.mergeMode),t.weights)throw new Yb("weights support is not implemented for Bidirectional layer yet.");this._stateful=t.layer.stateful,this.returnSequences=t.layer.returnSequences,this.returnState=t.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=t.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(t){this._trainable=t,null!=this.forwardLayer&&(this.forwardLayer.trainable=t),null!=this.backwardLayer&&(this.backwardLayer.trainable=t)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(t){const e=t.length,n=Math.floor(e/2);this.forwardLayer.setWeights(t.slice(0,n)),this.backwardLayer.setWeights(t.slice(n))}computeOutputShape(t){let e,n,r,i=this.forwardLayer.computeOutputShape(t);return Array.isArray(i)&&Array.isArray(i[0])||(i=[i]),this.returnState?(r=i.slice(1),e=i[0]):e=i[0],"concat"===this.mergeMode?(e[e.length-1]*=2,n=[e]):n=null==this.mergeMode?[e,e.slice()]:[e],this.returnState?null==this.mergeMode?n.concat(r).concat(r.slice()):[e].concat(r).concat(r.slice()):nv(n)}apply(t,e){let n=null==e?null:e["initialState"],r=null==e?null:e["constants"];null==e&&(e={});const i=_I(t,n,r,this.numConstants);if(t=i.inputs,n=i.initialState,r=i.constants,Array.isArray(t)&&(n=t.slice(1),t=t[0]),(null==n||0===n.length)&&null==r)return super.apply(t,e);const o=[],s=[];if(null!=n){const t=n.length;if(t%2>0)throw new Xb("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");e["initialState"]=n,o.push(...n);const r=n.map((t=>new Qw({shape:t.shape})));this.forwardLayer.stateSpec=r.slice(0,t/2),this.backwardLayer.stateSpec=r.slice(t/2),s.push(...r)}if(null!=r)throw new Yb("Support for constants in Bidirectional layers is not implemented yet.");const a=o[0]instanceof tx;for(const l of o)if(l instanceof tx!==a)throw new Xb("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(a){const n=[t].concat(o),r=this.inputSpec.concat(s),i=this.inputSpec;this.inputSpec=r;const a=super.apply(n,e);return this.inputSpec=i,a}return super.apply(t,e)}call(t,e){return Io((()=>{const n=e["initialState"];let r,i,o,s;if(null==n)r=this.forwardLayer.call(t,e),i=this.backwardLayer.call(t,e);else{const o=n.slice(0,n.length/2),s=n.slice(n.length/2);r=this.forwardLayer.call(t,Object.assign(e,{initialState:o})),i=this.backwardLayer.call(t,Object.assign(e,{initialState:s}))}return this.returnState&&(Array.isArray(r)&&(o=r.slice(1).concat(i.slice(1))),r=r[0],i=i[0]),this.returnSequences&&(i=ih(i,1)),"concat"===this.mergeMode?s=iw([r,i]):"sum"===this.mergeMode?s=Ls(r,i):"ave"===this.mergeMode?s=js(.5,Ls(r,i)):"mul"===this.mergeMode?s=js(r,i):null==this.mergeMode&&(s=[r,i]),this.returnState?null==this.mergeMode?s.concat(o):[s].concat(o):s}))}resetStates(t){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(t){Mv(this.forwardLayer.name,(()=>{this.forwardLayer.build(t)})),Mv(this.backwardLayer.name,(()=>{this.backwardLayer.build(t)})),this.built=!0}computeMask(t,e){let n;if(Array.isArray(e)&&(e=e[0]),n=this.returnSequences?null==this.mergeMode?[e,e]:e:null==this.mergeMode?[null,null]:null,this.returnState){const t=this.forwardLayer.states,e=t.map((t=>null));return Array.isArray(n)?n.concat(e).concat(e):[n].concat(e).concat(e)}return n}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(t),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(t)}getConfig(){const t={mergeMode:this.mergeMode},e=super.getConfig();return Object.assign(t,e),t}static fromConfig(t,e){const n=Hx(e["layer"]);if(delete e["layer"],null!=e["numConstants"])throw new Yb("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=e;return r["layer"]=n,new t(r)}}PC.className="Bidirectional",ia(PC);
/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
class LC extends ix{constructor(t){super(t),this.scale=t.scale,t.offset?this.offset=t.offset:this.offset=0}getConfig(){const t={scale:this.scale,offset:this.offset},e=super.getConfig();return Object.assign(t,e),t}call(t,e){return Io((()=>(t=Hw(t),"float32"!==t.dtype&&(t=Yv(t,"float32")),Ls(js(t,this.scale),this.offset))))}}LC.className="Rescaling",ia(LC);
/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
const{resizeBilinear:zC,cropAndResize:BC}=Mp;class WC extends ix{constructor(t){super(t),this.height=t.height,this.width=t.width}centerCrop(t,e,n,r,i,o,s,a){return Io((()=>{let l,u=!1;const c=e/o,h=n/s,d=(r+e)/o,p=(i+n)/s,f=[c,h,d,p],g=[];3===t.rank?(u=!0,l=Ah([t])):l=t;for(let t=0;t<l.shape[0];t++)g.push(f);const m=yo(g,[g.length,4]),y=th(0,g.length,1,"int32"),b=[r,i],v=BC(l,m,y,b,"nearest");return Yv(u?Hw(Lh(v)):v,a)}))}upsize(t,e,n,r){return Io((()=>{const i=zC(t,[e,n]);return Yv(i,r)}))}call(t,e){return Io((()=>{const e=Hw(t),n=e.dtype,r=e.shape,i=r[r.length-3],o=r[r.length-2];let s=0;i!==this.height&&(s=Math.floor((i-this.height)/2));let a=0;return o!==this.width&&(a=Math.floor((o-this.width)/2),0===a&&(a=1)),s>=0&&a>=0?this.centerCrop(e,s,a,this.height,this.width,i,o,n):this.upsize(t,this.height,this.width,n)}))}getConfig(){const t={height:this.height,width:this.width},e=super.getConfig();return Object.assign(t,e),t}computeOutputShape(t){t=Gw(t);const e=t.length-3,n=t.length-2;return t[e]=this.height,t[n]=this.width,t}}
/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function UC(t,e,n,r){let i=Hw(t);if("int32"!==i.dtype&&(i=Yv(i,"int32")),"int"===e)return i;const o=i.shape;if(0===i.rank&&(i=Mu(i,-1)),"oneHot"===e&&1!==i.shape[i.shape.length-1]&&(i=Mu(i,-1)),i.rank>2)throw new Xb(`When outputMode is not int, maximum output rank is 2 Received outputMode ${e} and input shape ${o} which would result in output rank ${i.rank}.`);const s=["multiHot","oneHot"].includes(e),a=i;let l;if(l=Su(a,"undefined"!==typeof r&&"count"===e?r:[],n,s),"tfIdf"!==e)return l;if(r)return js(l,r);throw new Xb("When outputMode is 'tfIdf', weights must be provided.")}WC.className="CenterCrop",ia(WC);
/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
class VC extends ix{constructor(t){super(t),this.numTokens=t.numTokens,t.outputMode?this.outputMode=t.outputMode:this.outputMode="multiHot"}getConfig(){const t={numTokens:this.numTokens,outputMode:this.outputMode},e=super.getConfig();return Object.assign(t,e),t}computeOutputShape(t){return t=Gw(t),null==t?[this.numTokens]:"oneHot"===this.outputMode&&1!==t[t.length-1]?(t.push(this.numTokens),t):(t[t.length-1]=this.numTokens,t)}call(t,e){return Io((()=>{let n;if(t=Hw(t),"int32"!==t.dtype&&(t=Yv(t,"int32")),"undefined"!==typeof e["countWeights"]){if("count"!==this.outputMode)throw new Xb(`countWeights is not used when outputMode !== count.\n              Received countWeights=${e["countWeights"]}`);n=Hw(e["countWeights"])}const r=nc(t),i=Ec(t),o=Gu(this.numTokens,r).bufferSync().get(0),s=Ku(i,0).bufferSync().get(0);if(!o||!s)throw new Xb(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return UC(t,this.outputMode,this.numTokens,n)}))}}VC.className="CategoryEncoding",ia(VC);
/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
const jC=["bilinear","nearest"],HC=new Set(jC);class GC extends ix{constructor(t){if(super(t),this.height=t.height,this.width=t.width,t.interpolation){if(!HC.has(t.interpolation))throw new Xb(`Invalid interpolation parameter: ${t.interpolation} is not implemented`);this.interpolation=t.interpolation}else this.interpolation="bilinear";this.cropToAspectRatio=Boolean(t.cropToAspectRatio)}computeOutputShape(t){t=Gw(t);const e=t[2];return[this.height,this.width,e]}getConfig(){const t={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},e=super.getConfig();return Object.assign(t,e),t}call(t,e){return Io((()=>{const e=[this.height,this.width];if("bilinear"===this.interpolation)return Mp.resizeBilinear(t,e,!this.cropToAspectRatio);if("nearest"===this.interpolation)return Mp.resizeNearestNeighbor(t,e,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...HC]} are supported`)}))}}GC.className="Resizing",ia(GC);
/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
class qC{constructor(t){this.seed=t}next(){if(void 0!==this.seed)return this.seed++}}qC.className="RandomSeed";
/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
class KC extends ix{constructor(t){super(t),this.randomGenerator=new qC(t.seed)}getConfig(){const t={seed:this.randomGenerator.seed},e=super.getConfig();return Object.assign(t,e),t}}KC.className="BaseRandomLayer";
/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
const XC=["bilinear","nearest"],YC=new Set(XC);class JC extends KC{constructor(t){super(t);const{factor:e,interpolation:n="bilinear"}=t;if(this.factor=e,Array.isArray(this.factor)&&2===this.factor.length)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else{if(Array.isArray(this.factor)||!(this.factor>0))throw new Xb(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);this.widthLower=-this.factor,this.widthUpper=this.factor}if(this.widthLower<-1||this.widthUpper<-1)throw new Xb(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new Xb(`factor cannot have upper bound less than lower bound.\n        Got upper bound: ${this.widthUpper}.\n        Got lower bound: ${this.widthLower}\n      `);if(n){if(!YC.has(n))throw new Xb(`Invalid interpolation parameter: ${n} is not implemented`);this.interpolation=n}}getConfig(){const t={factor:this.factor,interpolation:this.interpolation},e=super.getConfig();return Object.assign(t,e),t}computeOutputShape(t){t=Gw(t);const e=t[2];return[this.imgHeight,-1,e]}call(t,e){return Io((()=>{const e=Hw(t);this.imgHeight=e.shape[e.shape.length-3];const n=e.shape[e.shape.length-2];this.widthFactor=Qc([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let r=this.widthFactor.dataSync()[0]*n;r=Math.round(r);const i=[this.imgHeight,r];switch(this.interpolation){case"bilinear":return Mp.resizeBilinear(t,i);case"nearest":return Mp.resizeNearestNeighbor(t,i);default:throw new Error(`Interpolation is ${this.interpolation}\n          but only ${[...YC]} are supported`)}}))}}JC.className="RandomWidth",ia(JC);const ZC=it();
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */
var QC,tS;ZC.registerFlag("KEEP_INTERMEDIATE_TENSORS",(()=>!1),(t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")})),function(t){t[t["DT_INVALID"]=0]="DT_INVALID",t[t["DT_FLOAT"]=1]="DT_FLOAT",t[t["DT_DOUBLE"]=2]="DT_DOUBLE",t[t["DT_INT32"]=3]="DT_INT32",t[t["DT_UINT8"]=4]="DT_UINT8",t[t["DT_INT16"]=5]="DT_INT16",t[t["DT_INT8"]=6]="DT_INT8",t[t["DT_STRING"]=7]="DT_STRING",t[t["DT_COMPLEX64"]=8]="DT_COMPLEX64",t[t["DT_INT64"]=9]="DT_INT64",t[t["DT_BOOL"]=10]="DT_BOOL",t[t["DT_QINT8"]=11]="DT_QINT8",t[t["DT_QUINT8"]=12]="DT_QUINT8",t[t["DT_QINT32"]=13]="DT_QINT32",t[t["DT_BFLOAT16"]=14]="DT_BFLOAT16",t[t["DT_QINT16"]=15]="DT_QINT16",t[t["DT_QUINT16"]=16]="DT_QUINT16",t[t["DT_UINT16"]=17]="DT_UINT16",t[t["DT_COMPLEX128"]=18]="DT_COMPLEX128",t[t["DT_HALF"]=19]="DT_HALF",t[t["DT_RESOURCE"]=20]="DT_RESOURCE",t[t["DT_VARIANT"]=21]="DT_VARIANT",t[t["DT_UINT32"]=22]="DT_UINT32",t[t["DT_UINT64"]=23]="DT_UINT64",t[t["DT_FLOAT_REF"]=101]="DT_FLOAT_REF",t[t["DT_DOUBLE_REF"]=102]="DT_DOUBLE_REF",t[t["DT_INT32_REF"]=103]="DT_INT32_REF",t[t["DT_UINT8_REF"]=104]="DT_UINT8_REF",t[t["DT_INT16_REF"]=105]="DT_INT16_REF",t[t["DT_INT8_REF"]=106]="DT_INT8_REF",t[t["DT_STRING_REF"]=107]="DT_STRING_REF",t[t["DT_COMPLEX64_REF"]=108]="DT_COMPLEX64_REF",t[t["DT_INT64_REF"]=109]="DT_INT64_REF",t[t["DT_BOOL_REF"]=110]="DT_BOOL_REF",t[t["DT_QINT8_REF"]=111]="DT_QINT8_REF",t[t["DT_QUINT8_REF"]=112]="DT_QUINT8_REF",t[t["DT_QINT32_REF"]=113]="DT_QINT32_REF",t[t["DT_BFLOAT16_REF"]=114]="DT_BFLOAT16_REF",t[t["DT_QINT16_REF"]=115]="DT_QINT16_REF",t[t["DT_QUINT16_REF"]=116]="DT_QUINT16_REF",t[t["DT_UINT16_REF"]=117]="DT_UINT16_REF",t[t["DT_COMPLEX128_REF"]=118]="DT_COMPLEX128_REF",t[t["DT_HALF_REF"]=119]="DT_HALF_REF",t[t["DT_RESOURCE_REF"]=120]="DT_RESOURCE_REF",t[t["DT_VARIANT_REF"]=121]="DT_VARIANT_REF",t[t["DT_UINT32_REF"]=122]="DT_UINT32_REF",t[t["DT_UINT64_REF"]=123]="DT_UINT64_REF"}(QC||(QC={})),function(t){let e;(function(t){t[t["LEGACY"]=0]="LEGACY",t[t["V1"]=1]="V1",t[t["V2"]=2]="V2"})(e=t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))}(tS||(tS={}));new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */
function eS(t,e){return nS(t,e)}function nS(t,e,n=new Map,r=new Set){if(null==t)return null;if("function"===typeof Blob&&t instanceof Blob)return t.slice();if(r.has(t))throw new Error("Circular references are not supported.");if(n.has(t))return n.get(t);const i=e(t);if(i.recurse&&null!==i.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(i.recurse){if(sS(t)){const i=Array.isArray(t)?[]:{};r.add(t);for(const o in t){const s=t[o],a=nS(s,e,n,r);i[o]=a}return r.delete(t),t.__proto__&&(i.__proto__=t.__proto__),i}throw new Error(`Can't recurse into non-iterable type: ${t}`)}return n.set(t,i.value),i.value}function rS(t,e=oS){return iS(t,e)}function iS(t,e,n=new Set){const r=t[0];if(n.has(r))throw new Error("Circular references are not supported.");const i=e(t);if(i.recurse&&null!==i.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(i.recurse){if(sS(r)){const i=Array.isArray(r)?[]:{};n.add(r);for(const o in r){const r=t.map((t=>t[o])),s=iS(r,e,n);i[o]=s}return n.delete(r),i}throw new Error(`Can't recurse into non-iterable type: ${r}`)}return i.value}function oS(t){return null===t?null:sS(t[0])?{value:null,recurse:!0}:{value:t,recurse:!1}}function sS(t){let e=!1;if(it().get("IS_BROWSER"))e=t instanceof TextDecoder;else{const{StringDecoder:r}=n(4977);e=t instanceof r}return null!=t&&!ArrayBuffer.isView(t)&&(Array.isArray(t)||"object"===typeof t&&!(t instanceof Ai)&&!(t instanceof Promise)&&!e)}function aS(t){return null==t||lS(t)||Array.isArray(t)||"object"===typeof t&&t instanceof Ai||ai(t)}function lS(t){return null===t||"object"!==typeof t&&"function"!==typeof t}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */
function uS(t){return eS(t,cS)}function cS(t){return t instanceof Ai?{value:t.clone(),recurse:!1}:sS(t)?{value:null,recurse:!0}:{value:t,recurse:!1}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */
class hS{constructor(t){if(this.capacity=t,this.begin=0,this.end=0,null==t)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}wrap(t){while(t<0)t+=this.doubledCapacity;return t%this.doubledCapacity}get(t){if(t<0)throw new RangeError("Can't get item at a negative index.");return this.data[t%this.capacity]}set(t,e){if(t<0)throw new RangeError("Can't set item at a negative index.");this.data[t%this.capacity]=e}length(){let t=this.end-this.begin;return t<0&&(t=this.doubledCapacity+t),t}isFull(){return this.length()===this.capacity}isEmpty(){return 0===this.length()}push(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,t),this.end=this.wrap(this.end+1)}pushAll(t){for(const e of t)this.push(e)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);const t=this.get(this.end);return this.set(this.end,void 0),t}unshift(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,t)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const t=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),t}shuffleExcise(t){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const e=this.wrap(this.begin+t),n=this.get(e);return this.set(e,this.pop()),n}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */
class dS extends hS{constructor(){super(dS.INITIAL_CAPACITY)}isFull(){return!1}push(t){super.isFull()&&this.expand(),super.push(t)}unshift(t){super.isFull()&&this.expand(),super.unshift(t)}expand(){const t=2*this.capacity,e=new Array(t),n=this.length();for(let r=0;r<n;r++)e[r]=this.get(this.wrap(this.begin+r));this.data=e,this.capacity=t,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */
function pS(t){return new yS(t)}function fS(t){return new bS(t)}function gS(t,e){return new NS(t,e)}dS.INITIAL_CAPACITY=32;class mS{async toArray(){const t=[];let e=await this.next();while(!e.done)t.push(e.value),e=await this.next();return t}async toArrayForTest(){const t=this.prefetch(100),e=[];let n=await t.next();while(!n.done)e.push(n.value),n=await t.next();return e}async resolveFully(){let t=await this.next();while(!t.done)t=await this.next()}async resolveWhile(t){let e=await this.next(),n=t(e.value);while(!e.done&&n)e=await this.next(),n=t(e.value)}handleErrors(t){return new CS(this,t)}filter(t){return new _S(this,t)}map(t){return new IS(this,t)}mapAsync(t){return new SS(this,t)}serialMapAsync(t){return new SS(this,t).serial()}flatmap(t){return new ES(this,t)}async forEachAsync(t){return this.map(t).resolveFully()}async serialForEach(t){return this.serialMapAsync(t).resolveWhile((t=>!0===t))}rowMajorBatch(t,e=!0){return new kS(this,t,e)}columnMajorBatch(t,e=!0,n=oS){const r=this.rowMajorBatch(t,e);return r.map((t=>rS(t,n)))}concatenate(t,e){return new NS(pS([this,t]),e)}take(t){return t<0||null==t?this:new xS(this,t)}skip(t){return t<0||null==t?this:new wS(this,t)}prefetch(t){return new RS(this,t)}shuffle(t,e){return new $S(this,t,e)}serial(){return new vS(this)}}class yS extends mS{constructor(t){super(),this.items=t,this.trav=0}summary(){return`Array of ${this.items.length} items`}async next(){if(this.trav>=this.items.length)return{value:null,done:!0};const t=this.items[this.trav];return this.trav++,{value:uS(t),done:!1}}}class bS extends mS{constructor(t){super(),this.nextFn=t}summary(){return"Function call"}async next(){try{return this.nextFn()}catch(t){throw t.message=`Error thrown while iterating through a dataset: ${t.message}`,t}}}class vS extends mS{constructor(t){super(),this.upstream=t,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Serial`}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){return this.upstream.next()}}class wS extends mS{constructor(t,e){super(),this.upstream=t,this.maxCount=e,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Skip`}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){while(this.count++<this.maxCount){const t=await this.upstream.next();if(t.done)return t;Co(t.value)}return this.upstream.next()}}class xS extends mS{constructor(t,e){super(),this.upstream=t,this.maxCount=e,this.count=0}summary(){return`${this.upstream.summary()} -> Take`}async next(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()}}class kS extends mS{constructor(t,e,n=!0){super(),this.upstream=t,this.batchSize=e,this.enableSmallLastBatch=n,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> RowMajorBatch`}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){const t=[];while(t.length<this.batchSize){const e=await this.upstream.next();if(e.done)return this.enableSmallLastBatch&&t.length>0?{value:t,done:!1}:{value:null,done:!0};t.push(e.value)}return{value:t,done:!1}}}class _S extends mS{constructor(t,e){super(),this.upstream=t,this.predicate=e,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Filter`}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){while(1){const t=await this.upstream.next();if(t.done||this.predicate(t.value))return t;Co(t.value)}}}class IS extends mS{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return`${this.upstream.summary()} -> Map`}async next(){const t=await this.upstream.next();if(t.done)return{value:null,done:!0};const e=Hi(t.value),n=this.transform(t.value),r=Hi(n);for(const i of e)ji(i,r)||i.dispose();return{value:n,done:!1}}}class CS extends mS{constructor(t,e){super(),this.upstream=t,this.handler=e,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> handleErrors`}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){while(1)try{return await this.upstream.next()}catch(t){if(!this.handler(t))return{value:null,done:!0}}}}class SS extends mS{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return`${this.upstream.summary()} -> AsyncMap`}async next(){const t=await this.upstream.next();if(t.done)return{value:null,done:!0};const e=Hi(t.value),n=await this.transform(t.value),r=Hi(n);for(const i of e)ji(i,r)||i.dispose();return{value:n,done:!1}}}class TS extends mS{constructor(){super(),this.outputQueue=new dS,this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){while(0===this.outputQueue.length())if(!await this.pump())return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}}}class ES extends TS{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return`${this.upstream.summary()} -> Flatmap`}async pump(){const t=await this.upstream.next();if(t.done)return!1;const e=Hi(t.value),n=this.transform(t.value),r=Hi(n);this.outputQueue.pushAll(n);for(const i of e)ji(i,r)||i.dispose();return!0}}class NS extends mS{constructor(t,e){super(),this.baseErrorHandler=e,this.lastRead=null,this.iterator=null,this.moreIterators=t}summary(){const t="TODO: fill in upstream of chained summaries";return`${t} -> Chained`}async next(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead}async readFromChain(t){if(await t,null==this.iterator){const t=await this.moreIterators.next();if(t.done)return{value:null,done:!0};this.iterator=t.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}const e=await this.iterator.next();return e.done?(this.iterator=null,this.readFromChain(t)):e}}var AS;(function(t){t[t["FAIL"]=0]="FAIL",t[t["SHORTEST"]=1]="SHORTEST",t[t["LONGEST"]=2]="LONGEST"})(AS||(AS={}));class RS extends mS{constructor(t,e){super(),this.upstream=t,this.bufferSize=e,this.buffer=new hS(e)}summary(){return`${this.upstream.summary()} -> Prefetch`}refill(){while(!this.buffer.isFull()){const t=this.upstream.next();this.buffer.push(t)}}next(){return this.refill(),this.buffer.shift()}}class $S extends RS{constructor(t,e,n){super(t,e),this.upstream=t,this.windowSize=e,this.upstreamExhausted=!1,this.random=qc.alea(n||ii().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}randomInt(t){return Math.floor(this.random()*t)}chooseIndex(){return this.randomInt(this.buffer.length())}async serialNext(){this.upstreamExhausted||this.refill();while(!this.buffer.isEmpty()){const t=this.chooseIndex(),e=await this.buffer.shuffleExcise(t);if(!e.done)return this.refill(),e;this.upstreamExhausted=!0}return{value:null,done:!0}}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */
class DS{constructor(){this.size=null}batch(t,e=!0){const n=this;let r;return y(t>0,(()=>`batchSize needs to be positive, but it is\n      ${t}`)),r=this.size===1/0||null==this.size?this.size:e?Math.ceil(this.size/t):Math.floor(this.size/t),OS((async()=>(await n.iterator()).columnMajorBatch(t,e,FS)),r)}concatenate(t){const e=this;let n;return n=this.size===1/0||t.size===1/0?1/0:null!=this.size&&null!=t.size?this.size+t.size:null,OS((async()=>(await e.iterator()).concatenate(await t.iterator())),n)}filter(t){const e=this;let n;return n=this.size===1/0?1/0:null,OS((async()=>(await e.iterator()).filter((e=>Io((()=>t(e)))))),n)}async forEachAsync(t){return(await this.iterator()).forEachAsync(t)}map(t){const e=this;return OS((async()=>(await e.iterator()).map((e=>Io((()=>t(e)))))),this.size)}mapAsync(t){const e=this;return OS((async()=>(await e.iterator()).mapAsync(t)),this.size)}prefetch(t){if(null==t)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");const e=this;return OS((async()=>(await e.iterator()).prefetch(t)),this.size)}repeat(t){const e=this;let n;return n=null!=this.size&&t>0?this.size*t:0===t?0:null!=this.size&&(void 0===t||t<0)?1/0:null,OS((async()=>{const n=fS((async()=>({value:await e.iterator(),done:!1})));return gS(n.take(t))}),n)}skip(t){const e=this;let n;return n=null!=this.size&&t>=0&&this.size>=t?this.size-t:null!=this.size&&(this.size<t||void 0===t||t<0)?0:null,OS((async()=>(await e.iterator()).skip(t)),n)}shuffle(t,e,n=!0){if(null==t||t<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError(`\`Dataset.shuffle()\` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for \`tf.Tensor\`s), consider setting bufferSize to the dataset size (${this.size} elements)`);const r=this,i=qc.alea(e||ii().toString());return OS((async()=>{let e=i.int32();return n&&(e+=i.int32()),(await r.iterator()).shuffle(t,e.toString())}),this.size)}take(t){const e=this;let n;return n=null!=this.size&&this.size>t?t:null!=this.size&&this.size<=t?this.size:null,OS((async()=>(await e.iterator()).take(t)),n)}async toArray(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArray()}async toArrayForTest(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArrayForTest()}}function OS(t,e=null){return new class extends DS{constructor(){super(...arguments),this.size=e}async iterator(){return t()}}}function FS(t){if(null===t)return null;const e=t[0];if(aS(e)){const e=MS(t);return{value:e,recurse:!1}}return{value:null,recurse:!0}}function MS(t){if(0===t.length)throw new Error("Can't make a batch of zero elements.");return t[0]instanceof Ai?Ah(t):yo(t)}DS.MAX_BUFFER_SIZE=1e4;
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */
Symbol("out"),Symbol("field"),Symbol("quote"),Symbol("quoteafterquote"),Symbol("quoteinquote");
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function PS(t,e){Array.isArray(t)||(t=[t]),t.forEach((t=>{null!=t&&y("complex64"!==t.dtype,(()=>`${e} does not support complex64 tensors in the CPU backend.`))}))}
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const LS=Zf;class zS extends c{nextDataId(){return zS.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new u(this,ko())}write(t,e,n){this.firstUse&&(this.firstUse=!1,it().get("IS_NODE")&&Cr("\n============================\nHi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. \n============================"));const r={id:this.nextDataId()};return this.data.set(r,{values:t,dtype:n,refCount:1}),r}makeTensorInfo(t,e,n){let r;if("string"===e&&null!=n&&n.length>0&&M(n[0])){const i=n.map((t=>oi(t)));r=this.write(i,t,e)}else r=this.write(n,t,e);return{dataId:r,shape:t,dtype:e}}refCount(t){if(this.data.has(t)){const e=this.data.get(t);return e.refCount}return 0}incRef(t){const e=this.data.get(t);e.refCount++}decRef(t){if(this.data.has(t)){const e=this.data.get(t);e.refCount--}}move(t,e,n,r,i){this.data.set(t,{values:e,dtype:r,refCount:i})}numDataIds(){return this.data.numDataIds()}async read(t){return this.readSync(t)}readSync(t){const{dtype:e,complexTensorInfos:n}=this.data.get(t);if("complex64"===e){const t=this.readSync(n.real.dataId),e=this.readSync(n.imag.dataId);return mf(t,e)}return H(this.data.get(t).values,e)}bufferSync(t){const e=this.readSync(t.dataId);if("string"===t.dtype)try{const n=e.map((t=>si(t)));return As(t.shape,t.dtype,n)}catch(n){throw new Error("Failed to decode encoded string bytes into utf-8")}return As(t.shape,t.dtype,e)}makeOutput(t,e,n){return ko().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,t),this)}disposeData(t,e=!1){if(this.data.has(t)){if(this.data.get(t).refCount--,!e&&this.data.get(t).refCount>0)return!1;const{complexTensorInfos:n}=this.data.get(t);null!=n&&(this.disposeData(n.real.dataId,!0),this.disposeData(n.imag.dataId,!0)),this.data.delete(t)}return!0}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}async time(t){const e=ii();t();const n=ii()-e;return{kernelMs:n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(t){PS([t],"where");const e=this.readSync(t.dataId);return LS(t.shape,e)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}zS.nextDataId=0;
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function BS(t){return(e,n,r)=>{const i=A(n,e.length);for(let o=0;o<e.length;++o)i[o]=t(e[o],r);return i}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function WS(t,e,n){const r=BS(e);return US(t,r,n)}function US(t,e,n){return({inputs:r,attrs:i,backend:o})=>{const{x:s}=r;PS(s,t);const a=o,l=a.data.get(s.dataId).values;let u;if("string"===s.dtype){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");u=Yf(l)}else u=l;const c=n||s.dtype,h=e(u,c,i);return a.makeTensorInfo(s.shape,c,h)}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
To("cpu",(()=>new zS),1);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const VS=WS(ce,(t=>t>=0?t:Math.exp(t)-1)),jS={kernelName:ce,backendName:"cpu",kernelFunc:VS};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function HS(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const GS={kernelName:Te,backendName:"cpu",kernelFunc:HS};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function qS(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{alpha:o}=r;PS([i],"leakyRelu");const s=w(i.shape),a=n.data.get(i.dataId).values,l=N("float32",s);for(let u=0;u<a.length;u++)l[u]=a[u]<0?o*a[u]:a[u];return n.makeTensorInfo(i.shape,"float32",l)}const KS={kernelName:De,backendName:"cpu",kernelFunc:qS};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function XS(t){return(e,n,r,i,o)=>{const s=ba(e,n),a=s.length,l=U(s),u=w(s),c=N(o,u),h=e.length,d=n.length,p=U(e),f=U(n),g=ma(e,s),m=ma(n,s);if(g.length+m.length===0)for(let y=0;y<c.length;++y)c[y]=t(r[y%r.length],i[y%i.length]);else for(let y=0;y<c.length;++y){const e=J(y,a,l),n=e.slice(-h);g.forEach((t=>n[t]=0));const o=Y(n,h,p),s=e.slice(-d);m.forEach((t=>s[t]=0));const u=Y(s,d,f);c[y]=t(r[o],i[u])}return[c,s]}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const YS=XS(((t,e)=>t<0?e*t:t));function JS(t){const{inputs:e,backend:n}=t,{x:r,alpha:i}=e;PS([r,i],"prelu");const o=n.data.get(r.dataId).values,s=n.data.get(i.dataId).values,[a,l]=YS(r.shape,i.shape,o,s,"float32");return n.makeTensorInfo(l,"float32",a)}const ZS={kernelName:mn,backendName:"cpu",kernelFunc:JS},QS=WS(In,(t=>Math.max(0,t))),tT={kernelName:In,backendName:"cpu",kernelFunc:QS},eT=WS(An,(t=>Math.min(Math.max(0,t),6))),nT={kernelName:An,backendName:"cpu",kernelFunc:eT},rT=BS((t=>1/(1+Math.exp(-t)))),iT=WS(Vn,(t=>1/(1+Math.exp(-t)))),oT={kernelName:Vn,backendName:"cpu",kernelFunc:iT};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function sT(t,e,n,r,i){if("linear"===n)return HS({inputs:{x:e},backend:t});if("relu"===n)return QS({inputs:{x:e},backend:t});if("elu"===n)return VS({inputs:{x:e},backend:t});if("relu6"===n)return eT({inputs:{x:e},backend:t});if("prelu"===n)return JS({inputs:{x:e,alpha:r},backend:t});if("leakyrelu"===n)return qS({inputs:{x:e},backend:t,attrs:{alpha:i}});if("sigmoid"===n)return iT({inputs:{x:e},backend:t});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function aT(t){const{inputs:e,backend:n}=t,{real:r,imag:i}=e,o=n.data.get(r.dataId).values,s=n.data.get(i.dataId).values,a=n.makeTensorInfo(r.shape,"complex64"),l=n.data.get(a.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",o),imag:n.makeTensorInfo(i.shape,"float32",s)},a}const lT={kernelName:Lt,backendName:"cpu",kernelFunc:aT};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function uT(t,e,n="float32"){if("complex64"===n){const n=uT(t,e,"float32"),r=uT(t,e,"float32");return aT({inputs:{real:n,imag:r},backend:t})}const r=q(w(e),n);return t.makeTensorInfo(e,n,r)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function cT(t){const{inputs:e,backend:n}=t,{input:r}=e,i=n.data.get(r.dataId).complexTensorInfos.real,o=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,o)}const hT={kernelName:kn,backendName:"cpu",kernelFunc:cT};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function dT(t,e,n,r){if("int32"===r){const n=Int32Array.from(t);return[e,"int32",n]}if("bool"===r){const r=ri([0],n),[i,o]=XS(((t,e)=>t!==e?1:0))(e,[],t,r,"bool");return[o,"bool",i]}throw new Error(`Error in Cast: failed to cast ${n} to ${r}`)}function pT(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{dtype:o}=r;if("complex64"===o){if("complex64"===i.dtype)return HS({inputs:{x:i},backend:n});const t=uT(n,i.shape,i.dtype),e=pT({inputs:{x:i},backend:n,attrs:{dtype:"float32"}}),r=aT({inputs:{real:e,imag:t},backend:n});return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),r}if("complex64"===i.dtype){const t=cT({inputs:{input:i},backend:n}),e=pT({inputs:{x:t},backend:n,attrs:{dtype:o}});return n.disposeIntermediateTensorInfo(t),e}if(!D(i.dtype,o)){const t=HS({inputs:{x:i},backend:n});return{dataId:t.dataId,shape:t.shape,dtype:o}}const s=n.data.get(i.dataId).values,[a,l,u]=dT(s,i.shape,i.dtype,o);return n.makeTensorInfo(a,l,u)}const fT={kernelName:Ft,backendName:"cpu",kernelFunc:pT};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function gT(t,e,n,r){return null==n?({inputs:n,backend:i})=>{const{a:o,b:s}=n,a=i;PS([o,s],t);const l=a.data.get(o.dataId).values,u=a.data.get(s.dataId).values,c="string"===o.dtype?Yf(l):l,h="string"===o.dtype?Yf(u):u,d=r||o.dtype,[p,f]=e(o.shape,s.shape,c,h,d);return a.makeTensorInfo(f,d,p)}:({inputs:t,backend:i})=>{const{a:o,b:s}=t,a=i;if("complex64"===o.dtype||"complex64"===s.dtype){const t=pT({inputs:{x:o},backend:a,attrs:{dtype:"complex64"}}),e=a.data.get(t.dataId),r=e.complexTensorInfos.real,i=e.complexTensorInfos.imag,l=a.data.get(r.dataId).values,u=a.data.get(i.dataId).values,c=pT({inputs:{x:s},backend:a,attrs:{dtype:"complex64"}}),h=a.data.get(c.dataId),d=h.complexTensorInfos.real,p=h.complexTensorInfos.imag,f=a.data.get(d.dataId).values,g=a.data.get(p.dataId).values,[m,y,b]=n(o.shape,s.shape,l,u,f,g),v=a.makeTensorInfo(b,"float32",m),w=a.makeTensorInfo(b,"float32",y),x=aT({inputs:{real:v,imag:w},backend:a});return a.disposeIntermediateTensorInfo(t),a.disposeIntermediateTensorInfo(c),a.disposeIntermediateTensorInfo(v),a.disposeIntermediateTensorInfo(w),x}{const t=a.data.get(o.dataId).values,n=a.data.get(s.dataId).values,i=r||o.dtype,[l,u]=e(o.shape,s.shape,t,n,i);return a.makeTensorInfo(u,i,l)}}}function mT(t){return(e,n,r,i,o,s)=>{const a=ba(e,n),l=w(a),u=a.length,c=U(a),h=N("float32",l),d=N("float32",l),p=ma(e,a),f=ma(n,a),g=mf(r,i),m=mf(o,s),y=e.length,b=U(e),v=n.length,x=U(n);if(p.length+f.length===0)for(let w=0;w<h.length;w++){const e=w%g.length,n=w%m.length,r=t(g[2*e],g[2*e+1],m[2*n],m[2*n+1]);h[w]=r.real,d[w]=r.imag}else for(let w=0;w<h.length;w++){const e=J(w,u,c),n=e.slice(-y);p.forEach((t=>n[t]=0));const r=Y(n,y,b),i=e.slice(-v);f.forEach((t=>i[t]=0));const o=Y(i,v,x),s=t(g[2*r],g[2*r+1],m[2*o],m[2*o+1]);h[w]=s.real,d[w]=s.imag}return[h,d,a]}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const yT=XS(((t,e)=>t+e)),bT=mT(((t,e,n,r)=>({real:t+n,imag:e+r}))),vT=gT(ft,yT,bT),wT={kernelName:ft,backendName:"cpu",kernelFunc:vT};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function xT(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{shape:o}=r,s=w(i.shape),a=S(o,s),l=w(a);y(s===l,(()=>`The new shape (${a}) has ${l} elements and the old shape (${i.shape}) has ${s} elements. The new shape and old shape must have the same number of elements.`)),n.incRef(i.dataId);const u=n.data.get(i.dataId);if(null!=u.complexTensorInfos){const t=u.complexTensorInfos.real,e=u.complexTensorInfos.imag;t.shape=a,e.shape=a}return{dataId:i.dataId,shape:a,dtype:i.dtype}}const kT={kernelName:Cn,backendName:"cpu",kernelFunc:xT};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function _T(t){const{inputs:e,backend:n,attrs:r}=t,{a:i,b:o}=e,{transposeA:s,transposeB:a}=r;PS([i,o],"matMul");const l=i.shape.length,u=o.shape.length,c=s?i.shape[l-2]:i.shape[l-1],h=a?o.shape[u-1]:o.shape[u-2],d=s?i.shape[l-1]:i.shape[l-2],p=a?o.shape[u-2]:o.shape[u-1],f=i.shape.slice(0,-2),g=o.shape.slice(0,-2),m=w(f),b=w(g),v=ba(i.shape.slice(0,-2),o.shape.slice(0,-2)),x=v.concat([d,p]);y(c===h,(()=>`Error in matMul: inner shapes (${c}) and (${h}) of Tensors with shapes ${i.shape} and ${o.shape} and transposeA=${s} and transposeB=${a} must match.`));const k=s?[m,c,d]:[m,d,c],_=a?[b,p,h]:[b,h,p],I=xT({inputs:{x:i},backend:n,attrs:{shape:k}}),C=xT({inputs:{x:o},backend:n,attrs:{shape:_}}),S=s?I.shape[1]:I.shape[2],T=s?I.shape[2]:I.shape[1],E=a?C.shape[1]:C.shape[2],N=Math.max(m,b),A=n.data.get(I.dataId).values,R=n.data.get(C.dataId).values,$=U(I.shape),D=U(C.shape),[O,F,M]=s?[$[0],1,$[1]]:[$[0],$[1],1],[P,L,z]=a?[1,D[1],D[0]]:[D[1],1,D[0]],B=T*E,W=As([N,T,E],I.dtype),V=W.values,j=n.blockSize;for(let y=0;y<N;y++){const t=y%m,e=y%b;for(let n=0;n<T;n+=j){const r=Math.min(n+j,T);for(let i=0;i<E;i+=j){const o=Math.min(i+j,E);for(let s=0;s<S;s+=j){const a=Math.min(s+j,S);for(let l=n;l<r;l++)for(let n=i;n<o;n++){let r=0;for(let i=s;i<a;i++){const o=A[t*O+l*F+i*M],s=R[i*P+n*L+e*z];r+=o*s}V[y*B+(l*E+n)]+=r}}}}}return n.disposeIntermediateTensorInfo(I),n.disposeIntermediateTensorInfo(C),n.makeTensorInfo(x,W.dtype,W.values)}const IT={kernelName:Nt,backendName:"cpu",kernelFunc:_T};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function CT(t){const{inputs:e,backend:n,attrs:r}=t,{a:i,b:o,bias:s,preluActivationWeights:a}=e,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:h}=r;let d,p,f;const g=[],m=_T({inputs:{a:i,b:o},attrs:{transposeA:l,transposeB:u},backend:n});d=m,s&&(p=vT({inputs:{a:d,b:s},backend:n}),g.push(d),d=p),c&&(f=sT(n,d,c,a,h),g.push(d),d=f);for(const y of g)n.disposeIntermediateTensorInfo(y);return d}const ST={kernelName:kr,backendName:"cpu",kernelFunc:CT};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function TT(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}const ET=t=>{const{x:e}=t.inputs,n=t.backend;PS(e,"abs");let r=new Float32Array(w(e.shape));const i=n.data.get(e.dataId).values;return r=TT(i),n.makeOutput(r,e.shape,e.dtype)},NT={kernelName:ht,backendName:"cpu",kernelFunc:ET},AT=WS(dt,(t=>Math.acos(t))),RT={kernelName:dt,backendName:"cpu",kernelFunc:AT},$T=WS(pt,(t=>Math.acosh(t))),DT={kernelName:pt,backendName:"cpu",kernelFunc:$T};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function OT(t){const{inputs:e,backend:n}=t,r=e;PS(e,"addN");const i=r.map((t=>n.data.get(t.dataId).values)),o=As(r[0].shape,r[0].dtype),s=o.values;for(let a=0;a<r.length;a++){const t=i[a];for(let e=0;e<s.length;e++)s[e]+=t[e]}return n.makeTensorInfo(o.shape,o.dtype,o.values)}const FT={kernelName:gt,backendName:"cpu",kernelFunc:OT};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function MT(t,e,n,r,i){const o=e.length,s=w(e),a=U(e),l=U(i),u=N(n,w(i));for(let c=0;c<s;++c){const e=J(c,o,a),n=new Array(e.length);for(let t=0;t<n.length;t++)n[t]=e[r[t]];const i=Y(n,o,l);u[i]=t[c]}return u}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function PT(t){const{inputs:e,attrs:n,backend:r}=t,{x:i}=e,{perm:o}=n;PS(i,"transpose");const s=i.shape.length,a=new Array(s);for(let h=0;h<a.length;h++)a[h]=i.shape[o[h]];const l=r.data.get(i.dataId).values,u=MT(l,i.shape,i.dtype,o,a),c=r.write(u,a,i.dtype);return{dataId:c,shape:a,dtype:i.dtype}}const LT={kernelName:fr,backendName:"cpu",kernelFunc:PT};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function zT(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:o,keepDims:s}=r;PS(i,"all");const a=T(o,i.shape);let l=a;const u=dc(l,i.shape.length);let c=i;null!=u&&(c=PT({inputs:{x:i},backend:n,attrs:{perm:u}}),l=fc(l.length,i.shape.length)),hc("all",l,c.shape.length);const[h,d]=uc(c.shape,l),p=w(d),f=q(w(h),c.dtype),g=n.data.get(c.dataId).values;for(let y=0;y<f.length;++y){const t=y*p;let e=g[t];for(let n=0;n<p;++n){const r=g[t+n];e=e&&r}f[y]=e}null!=u&&n.disposeIntermediateTensorInfo(c);const m=n.makeTensorInfo(h,c.dtype,f);if(s){const t=cc(h,a),e=xT({inputs:{x:m},backend:n,attrs:{shape:t}});return n.disposeIntermediateTensorInfo(m),e}return m}const BT={kernelName:mt,backendName:"cpu",kernelFunc:zT};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function WT(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:o,keepDims:s}=r;PS(i,"any");const a=T(o,i.shape);let l=a;const u=dc(l,i.shape.length);let c=i;null!=u&&(c=PT({inputs:{x:i},backend:n,attrs:{perm:u}}),l=fc(l.length,i.shape.length)),hc("any",l,c.shape.length);const[h,d]=uc(c.shape,l),p=w(d),f=q(w(h),c.dtype),g=n.data.get(c.dataId).values;for(let y=0;y<f.length;++y){const t=y*p;let e=g[t];for(let n=0;n<p;++n){const r=g[t+n];e=e||r}f[y]=e}null!=u&&n.disposeIntermediateTensorInfo(c);const m=n.makeTensorInfo(h,c.dtype,f);if(s){const t=cc(h,a),e=xT({inputs:{x:m},backend:n,attrs:{shape:t}});return n.disposeIntermediateTensorInfo(m),e}return m}const UT={kernelName:yt,backendName:"cpu",kernelFunc:WT};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function VT(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:o}=r;PS(i,"argMax");let s=T(o,i.shape);const a=dc(s,i.shape.length);let l=i;const u=[];null!=a&&(l=PT({inputs:{x:i},backend:n,attrs:{perm:a}}),u.push(l),s=fc(s.length,l.shape.length)),s=[s[0]],hc("argMax",s,l.shape.length);const[c,h]=uc(l.shape,s),d=w(c),p=q(d,"int32"),f=w(h),g=n.data.get(l.dataId).values;for(let m=0;m<p.length;++m){const t=m*f;let e=g[t],n=0;for(let r=0;r<f;++r){const i=g[t+r];i>e&&(e=i,n=r)}p[m]=n}return u.forEach((t=>n.disposeIntermediateTensorInfo(t))),n.makeTensorInfo(c,"int32",p)}const jT={kernelName:bt,backendName:"cpu",kernelFunc:VT};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function HT(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:o}=r;PS(i,"argMin");let s=T(o,i.shape);const a=dc(s,i.shape.length);let l=i;const u=[];null!=a&&(l=PT({inputs:{x:i},backend:n,attrs:{perm:a}}),u.push(l),s=fc(s.length,l.shape.length)),s=[s[0]],hc("argMin",s,l.shape.length);const[c,h]=uc(l.shape,s),d=w(c),p=q(d,"int32"),f=w(h),g=n.data.get(l.dataId).values;for(let m=0;m<p.length;++m){const t=m*f;let e=g[t],n=0;for(let r=0;r<f;++r){const i=g[t+r];i<e&&(e=i,n=r)}p[m]=n}return u.forEach((t=>n.disposeIntermediateTensorInfo(t))),n.makeTensorInfo(c,"int32",p)}const GT={kernelName:vt,backendName:"cpu",kernelFunc:HT},qT=WS(wt,(t=>Math.asin(t))),KT={kernelName:wt,backendName:"cpu",kernelFunc:qT},XT=WS(xt,(t=>Math.asinh(t))),YT={kernelName:xt,backendName:"cpu",kernelFunc:XT},JT=WS(kt,(t=>Math.atan(t))),ZT={kernelName:kt,backendName:"cpu",kernelFunc:JT},QT=XS(((t,e)=>Math.atan2(t,e))),tE=gT(It,QT),eE={kernelName:It,backendName:"cpu",kernelFunc:tE},nE=WS(_t,(t=>Math.atanh(t))),rE={kernelName:_t,backendName:"cpu",kernelFunc:nE};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function iE(t,e,n,r,i,o){const s=i.strideHeight,a=i.strideWidth,l=i.dilationHeight,u=i.dilationWidth,c=i.effectiveFilterHeight,h=i.effectiveFilterWidth,d=i.padInfo.top,p=i.padInfo.left,f="max"===o?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=As(i.outShape,n),m=g.values,y=i.outShape[1]*i.outShape[2]*i.outShape[3],b=i.outShape[2]*i.outShape[3],v=i.outShape[3];for(let w=0;w<i.batchSize;++w){const e=w*y,n=w*r[0];for(let g=0;g<i.inChannels;++g)for(let y=0;y<i.outHeight;++y){const w=y*s-d,x=Math.max(0,w),k=Math.min(i.inHeight,c+w),_=e+y*b;for(let e=0;e<i.outWidth;++e){const s=e*a-p,c=Math.max(0,s),d=Math.min(i.inWidth,h+s);let y=f,b=0,w=0;for(let e=x;e<k;e+=l){const i=n+e*r[1];for(let e=c;e<d;e+=u){const n=i+e*r[2],s=t[n+g];"max"===o&&s>y?y=s:"avg"===o&&(b+=s,w++)}if(isNaN(y))break}const I=_+e*v+g;m[I]="avg"===o?b/w:y}}}return g}function oE(t,e,n,r,i=!1,o=!1){const s=As(r.outShape,"int32"),a=r.strideHeight,l=r.strideWidth,u=r.dilationHeight,c=r.dilationWidth,h=r.effectiveFilterHeight,d=r.effectiveFilterWidth,p=r.padInfo.top,f=r.padInfo.left,g=As(e,n,t);for(let m=0;m<r.batchSize;++m)for(let t=0;t<r.inChannels;++t)for(let e=0;e<r.outHeight;++e){const n=e*a-p;let y=n;while(y<0)y+=u;const b=Math.min(r.inHeight,h+n);for(let a=0;a<r.outWidth;++a){const h=a*l-f;let p=h;while(p<0)p+=c;const v=Math.min(r.inWidth,d+h);let w=Number.NEGATIVE_INFINITY,x=-1;for(let e=y;e<b;e+=u){const s=e-n;for(let n=p;n<v;n+=c){const a=n-h,l=g.get(m,e,n,t);l>w&&(w=l,x=i?o?((m*r.inHeight+e)*r.inWidth+n)*r.inChannels+t:(e*r.inWidth+n)*r.inChannels+t:s*d+a)}}s.set(x,m,e,a,t)}}return s}function sE(t,e,n,r,i,o){const s=i.strideDepth,a=i.strideHeight,l=i.strideWidth,u=i.dilationDepth,c=i.dilationHeight,h=i.dilationWidth,d=i.effectiveFilterDepth,p=i.effectiveFilterHeight,f=i.effectiveFilterWidth,g=i.padInfo.front,m=i.padInfo.top,y=i.padInfo.left,b="max"===o?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=As(i.outShape,n),w=v.values,x=i.outShape[1]*i.outShape[2]*i.outShape[3]*i.outShape[4],k=i.outShape[2]*i.outShape[3]*i.outShape[4],_=i.outShape[3]*i.outShape[4],I=i.outShape[4];for(let C=0;C<i.batchSize;++C){const e=C*x,n=C*r[0];for(let v=0;v<i.inChannels;++v)for(let x=0;x<i.outDepth;++x){const C=x*s-g;let S=C;while(S<0)S+=u;const T=Math.min(i.inDepth,d+C),E=e+x*k;for(let e=0;e<i.outHeight;++e){const s=e*a-m;let d=s;while(d<0)d+=c;const g=Math.min(i.inHeight,p+s),x=E+e*_;for(let e=0;e<i.outWidth;++e){const s=e*l-y;let a=s;while(a<0)a+=h;const p=Math.min(i.inWidth,f+s),m=x+e*I;let k=b,_=0,C=0;for(let e=S;e<T;e+=u){const i=n+e*r[1];for(let e=d;e<g;e+=c){const n=i+e*r[2];for(let e=a;e<p;e+=h){const i=n+e*r[3],s=t[i+v];if("max"===o&&s>k?k=s:"avg"===o&&(_+=s,C++),isNaN(k))break}if(isNaN(k))break}if(isNaN(k))break}const E=m+v;w[E]="avg"===o?_/Math.max(C,1):k}}}}return v}function aE(t,e){const n=As(e.outShape,"int32"),r=e.strideDepth,i=e.strideHeight,o=e.strideWidth,s=e.dilationDepth,a=e.dilationHeight,l=e.dilationWidth,u=e.effectiveFilterDepth,c=e.effectiveFilterHeight,h=e.effectiveFilterWidth,d=e.padInfo.front,p=e.padInfo.top,f=e.padInfo.left;for(let g=0;g<e.batchSize;++g)for(let m=0;m<e.inChannels;++m)for(let y=0;y<e.outDepth;++y){const b=y*r-d;let v=b;while(v<0)v+=s;const w=Math.min(e.inDepth,u+b);for(let r=0;r<e.outHeight;++r){const u=r*i-p;let d=u;while(d<0)d+=a;const x=Math.min(e.inHeight,c+u);for(let i=0;i<e.outWidth;++i){const p=i*o-f;let k=p;while(k<0)k+=l;const _=Math.min(e.inWidth,h+p);let I=Number.NEGATIVE_INFINITY,C=-1;for(let e=v;e<w;e+=s){const n=e-b;for(let r=d;r<x;r+=a){const i=r-u;for(let o=k;o<_;o+=l){const s=o-p,a=t.get(g,e,r,o,m);a>=I&&(I=a,C=n*c*h+i*c+s)}}}n.set(C,g,y,r,i,m)}}}return n}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function lE(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e;PS(i,"avgPool");const{filterSize:o,strides:s,pad:a,dimRoundingMode:l}=r,u=1;y($l(s,u),(()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${u}'`));const c=bl(i.shape,o,s,u,a,l);let h;if(1===c.filterWidth&&1===c.filterHeight&&x(c.inShape,c.outShape))h=HS({inputs:{x:i},backend:n});else{const t=n.data.get(i.dataId).values,e=U(i.shape),r=iE(t,i.shape,i.dtype,e,c,"avg");h=n.makeTensorInfo(c.outShape,i.dtype,r.values)}return h}const uE={kernelName:Ct,backendName:"cpu",kernelFunc:lE};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function cE(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{filterSize:o,strides:s,pad:a,dimRoundingMode:l,dataFormat:u}=r;PS(i,"avgPool3d");const c=vl(i.shape,o,s,1,a,l,u),h=n.data.get(i.dataId).values,d=sE(h,i.shape,i.dtype,U(i.shape),c,"avg");return n.makeTensorInfo(d.shape,"float32",d.values)}const hE={kernelName:Tt,backendName:"cpu",kernelFunc:cE};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function dE(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,input:o}=e,{filterSize:s,strides:a,pad:l,dimRoundingMode:u}=r;PS([i,o],"avgPool3DGrad");const c=vl(o.shape,s,a,1,l,u),h=c.strideDepth,d=c.strideHeight,p=c.strideWidth,f=c.filterDepth,g=c.filterHeight,m=c.filterWidth,y=c.dilationDepth,b=c.dilationHeight,v=c.dilationWidth,w=c.effectiveFilterDepth,x=c.effectiveFilterHeight,k=c.effectiveFilterWidth,_=w-1-c.padInfo.front,I=k-1-c.padInfo.left,C=x-1-c.padInfo.top,S=As(o.shape,"float32"),T=1/(f*g*m),E=n.bufferSync(i);for(let N=0;N<c.batchSize;++N)for(let t=0;t<c.inChannels;++t)for(let e=0;e<c.inDepth;++e)for(let n=0;n<c.inHeight;++n)for(let r=0;r<c.inWidth;++r){const i=e-_,o=n-C,s=r-I;let a=0;for(let e=0;e<w;e+=y){const n=(i+e)/h;if(!(n<0||n>=c.outDepth||Math.floor(n)!==n))for(let e=0;e<x;e+=b){const r=(o+e)/d;if(!(r<0||r>=c.outHeight||Math.floor(r)!==r))for(let e=0;e<k;e+=v){const i=(s+e)/p;if(i<0||i>=c.outWidth||Math.floor(i)!==i)continue;const o=E.get(N,n,r,i,t);a+=o}}}S.set(a*T,N,e,n,r,t)}return n.makeTensorInfo(S.shape,S.dtype,S.values)}const pE={kernelName:Et,backendName:"cpu",kernelFunc:dE};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function fE(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,input:o}=e,s=o;PS([i,o],"avgPoolGrad");const{filterSize:a,strides:l,pad:u}=r,c=bl(s.shape,a,l,1,u),h=c.strideHeight,d=c.strideWidth,p=c.filterHeight,f=c.filterWidth,g=c.dilationHeight,m=c.dilationWidth,y=c.effectiveFilterHeight,b=c.effectiveFilterWidth,v=b-1-c.padInfo.left,w=y-1-c.padInfo.top,x=As(s.shape,"float32"),k=1/(p*f),_=n.data.get(i.dataId).values,I=As(i.shape,"float32",_);for(let C=0;C<c.batchSize;++C)for(let t=0;t<c.inChannels;++t)for(let e=0;e<c.inHeight;++e)for(let n=0;n<c.inWidth;++n){const r=e-w,i=n-v;let o=0;for(let e=0;e<y;e+=g){const n=(r+e)/h;if(!(n<0||n>=c.outHeight||Math.floor(n)!==n))for(let e=0;e<b;e+=m){const r=(i+e)/d;if(r<0||r>=c.outWidth||Math.floor(r)!==r)continue;const s=I.get(C,n,r,t);o+=s}}x.set(o*k,C,e,n,t)}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const gE={kernelName:St,backendName:"cpu",kernelFunc:fE};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function mE(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,scale:o,offset:s,mean:a,variance:l}=e;y(a.shape.length===l.shape.length,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),y(null==s||a.shape.length===s.shape.length,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),y(null==o||a.shape.length===o.shape.length,(()=>"Batch normalization gradient requires mean and scale to have equal ranks.")),PS([i,a,l,o,s],"batchNorm");let{varianceEpsilon:u}=r;null==u&&(u=.001);const c=n.data.get(i.dataId).values,h=n.data.get(a.dataId).values,d=n.data.get(l.dataId).values,p=o?n.data.get(o.dataId).values:new Float32Array([1]),f=s?n.data.get(s.dataId).values:new Float32Array([0]),g=new Float32Array(c.length),m=f.length,b=p.length,v=d.length,w=h.length;let x=0,k=0,_=0,I=0;for(let y=0;y<c.length;++y)g[y]=f[x++]+(c[y]-h[k++])*p[_++]/Math.sqrt(d[I++]+u),x>=m&&(x=0),k>=w&&(k=0),_>=b&&(_=0),I>=v&&(I=0);return n.makeTensorInfo(i.shape,i.dtype,g)}const yE={kernelName:ke,backendName:"cpu",kernelFunc:mE};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function bE(t,e,n,r,i){const o=ol(r,e,n),s=w(n),a=U(r);if(o){const n=sl(e,a);return"string"===i?t.slice(n,n+s):t.subarray(n,n+s)}const l="string"===i?Yf(t):t,u=As(r,i,l),c=As(n,i);for(let h=0;h<c.size;++h){const t=c.indexToLoc(h),n=t.map(((t,n)=>t+e[n]));c.set(u.get(...n),...t)}return"string"===i?Jf(c.values):c.values}function vE(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{begin:o,size:s}=r;PS(i,"slice");const[a,l]=al(i,o,s);qa(i,a,l);const u=n.data.get(i.dataId).values,c=bE(u,a,l,i.shape,i.dtype);return n.makeTensorInfo(l,i.dtype,c)}const wE={kernelName:zn,backendName:"cpu",kernelFunc:vE};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function xE(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{blockShape:o,crops:s}=r;PS([i],"batchToSpaceND");const a=o.reduce(((t,e)=>t*e)),l=Zp(i.shape,o,a),u=Qp(l.length,o.length),c=tf(i.shape,o,a),h=ef(s,o.length),d=nf(c,s,o.length),p=xT({inputs:{x:i},backend:n,attrs:{shape:l}}),f=PT({inputs:{x:p},backend:n,attrs:{perm:u}}),g=xT({inputs:{x:f},backend:n,attrs:{shape:c}}),m=vE({inputs:{x:g},backend:n,attrs:{begin:h,size:d}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),m}const kE={kernelName:At,backendName:"cpu",kernelFunc:xE};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function _E(t,e,n,r,i){const o=w(r),s=q(i,n);for(let a=0;a<t.length;a++){const n=t[a];if(n<0)throw new Error("Input x must be non-negative!");n>=i||(s[n]+=o>0?e[a]:1)}return s}function IE(t,e,n,r=!1){const i=t.shape[0],o=t.shape[1],s=As([i,n],e.dtype);for(let a=0;a<i;a++)for(let i=0;i<o;i++){const o=t.get(a,i);if(o<0)throw new Error("Input x must be non-negative!");o>=n||(r?s.set(1,a,o):e.size>0?s.set(s.get(a,o)+e.get(a,i),a,o):s.set(s.get(a,o)+1,a,o))}return s}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function CE(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,weights:o}=e,{size:s}=r,a=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values,u=_E(a,l,o.dtype,o.shape,s);return n.makeTensorInfo([s],o.dtype,u)}const SE={kernelName:Rt,backendName:"cpu",kernelFunc:CE},TE=XS(((t,e)=>t&e)),EE=gT($t,TE),NE={kernelName:$t,backendName:"cpu",kernelFunc:EE};
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function AE(t){const{inputs:e,backend:n}=t,{s0:r,s1:i}=e,o=n.data.get(r.dataId).values,s=n.data.get(i.dataId).values,a=ba(Array.from(o),Array.from(s));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const RE={kernelName:Ot,backendName:"cpu",kernelFunc:AE},$E=BS((t=>Math.ceil(t))),DE=US(Mt,$E),OE={kernelName:Mt,backendName:"cpu",kernelFunc:DE},FE=WS(Pt,((t,e)=>{const n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t})),ME={kernelName:Pt,backendName:"cpu",kernelFunc:FE},PE=t=>{const{x:e}=t.inputs,n=t.backend,r=new Float32Array(w(e.shape)),i=n.data.get(e.dataId),o=i.complexTensorInfos.real,s=i.complexTensorInfos.imag,a=n.data.get(o.dataId).values,l=n.data.get(s.dataId).values;for(let u=0;u<a.length;u++){const t=a[u],e=l[u];r[u]=Math.hypot(t,e)}return n.makeOutput(r,e.shape,"float32")},LE={kernelName:zt,backendName:"cpu",kernelFunc:PE};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function zE(t,e,n,r){const i=A(n,w(e));if(r&&"string"!==n){let e=0;t.forEach((t=>{const n=w(t.shape);i.set(t.vals,e),e+=n}))}else{let r=0;t.forEach((t=>{const o="string"===n?Yf(t.vals):t.vals;let s=0;for(let n=0;n<t.shape[0];++n){const a=n*e[1]+r;for(let e=0;e<t.shape[1];++e)i[a+e]=o[s++]}r+=t.shape[1]}))}return i}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function BE(t){const{inputs:e,backend:n}=t,{input:r}=e,i=n.data.get(r.dataId).complexTensorInfos.imag,o=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,o)}const WE={kernelName:Ne,backendName:"cpu",kernelFunc:BE};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function UE(t){const{inputs:e,backend:n,attrs:r}=t,{axis:i}=r,o=T(i,e[0].shape)[0],s=e.map((t=>t.shape));Up(s,o);let a=Vp(e.map((t=>t.shape)),o);if(0===w(a))return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter((t=>w(t.shape)>0));if(1===l.length)return HS({inputs:{x:l[0]},backend:n});if("complex64"===l[0].dtype){const t=l.map((t=>cT({inputs:{input:t},backend:n}))),e=l.map((t=>BE({inputs:{input:t},backend:n}))),r=UE({inputs:t,backend:n,attrs:{axis:o}}),i=UE({inputs:e,backend:n,attrs:{axis:o}}),s=aT({inputs:{real:r,imag:i},backend:n});return t.forEach((t=>n.disposeIntermediateTensorInfo(t))),e.forEach((t=>n.disposeIntermediateTensorInfo(t))),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),s}const u=l.map((t=>{const e=w(t.shape.slice(o)),r=[-1,e];return xT({inputs:{x:t},backend:n,attrs:{shape:r}})})),c=u.map((t=>({vals:n.data.get(t.dataId).values,shape:t.shape})));a=Vp(u.map((t=>t.shape)),1);const h=1===u[0].shape[0],d=zE(c,a,e[0].dtype,h),p=Vp(l.map((t=>t.shape)),o),f=n.makeTensorInfo(p,e[0].dtype,d);return u.forEach((t=>n.disposeIntermediateTensorInfo(t))),f}const VE={kernelName:Bt,backendName:"cpu",kernelFunc:UE};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function jE(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:o}=e,{strides:s,pad:a,dataFormat:l,dilations:u,dimRoundingMode:c}=r;PS([i,o],"conv2d");const h=Ol(l),d=wl(i.shape,o.shape,s,u,a,c,!1,h),p=d.filterHeight,f=d.filterWidth,g=d.dilationHeight,m=d.dilationWidth,y=d.padInfo.left,b=d.padInfo.top,v="channelsLast"===d.dataFormat,w=new _i(d.outShape,i.dtype),x=U(i.shape),k=U(o.shape),_=x[0],I=v?x[1]:x[2],C=v?x[2]:1,S=v?1:x[1],T=w.strides[0],E=v?w.strides[1]:w.strides[2],N=v?w.strides[2]:1,A=v?1:w.strides[1],R=n.data.get(i.dataId).values,$=n.data.get(o.dataId).values,D=w.values;for(let O=0;O<d.batchSize;++O){const t=O*_,e=O*T;for(let n=0;n<d.outHeight;++n){const r=e+n*E,i=n*d.strideHeight-b;for(let e=0;e<p;++e){const n=i+e*g;if(n<0||n>=d.inHeight)continue;const o=e*k[0],s=t+n*I;for(let t=0;t<d.outWidth;++t){const e=r+t*N,n=t*d.strideWidth-y;for(let t=0;t<f;++t){const r=n+t*m;if(r<0||r>=d.inWidth)continue;const i=o+t*k[1],a=s+r*C;let l=i;for(let t=0;t<d.inChannels;++t){const n=R[a+t*S];for(let t=0;t<d.outChannels;++t)D[e+t*A]+=n*$[l+t];l+=d.outChannels}}}}}}return n.makeTensorInfo(w.shape,w.dtype,D)}const HE={kernelName:Wt,backendName:"cpu",kernelFunc:jE};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function GE(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,dy:o}=e,{strides:s,pad:a,dataFormat:l,dimRoundingMode:u,filterShape:c}=r;PS([i,o],"conv2dBackpropFilter");const h=Ol(l),d=wl(i.shape,c,s,1,a,u,!1,h),{strideHeight:p,strideWidth:f,filterHeight:g,filterWidth:m}=d,y="channelsLast"===d.dataFormat,b=new _i(d.filterShape,"float32"),v=d.padInfo.left,w=d.padInfo.top,x=n.data.get(i.dataId).values,k=n.data.get(o.dataId).values,_=new _i(i.shape,i.dtype,x),I=new _i(o.shape,o.dtype,k);for(let C=0;C<g;++C){const t=Math.max(0,Math.ceil((w-C)/p)),e=Math.min(d.outHeight,(d.inHeight+w-C)/p);for(let n=0;n<m;++n){const r=Math.max(0,Math.ceil((v-n)/f)),i=Math.min(d.outWidth,(d.inWidth+v-n)/f);for(let o=0;o<d.inChannels;++o)for(let s=0;s<d.outChannels;++s){let a=0;for(let l=0;l<d.batchSize;++l)for(let u=t;u<e;++u){const t=C+u*p-w;for(let e=r;e<i;++e){const r=n+e*f-v;a+=y?_.get(l,t,r,o)*I.get(l,u,e,s):_.get(l,o,t,r)*I.get(l,s,u,e)}}b.set(a,C,n,o,s)}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}const qE={kernelName:Ut,backendName:"cpu",kernelFunc:GE};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function KE(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,filter:o}=e,{inputShape:s,strides:a,pad:l,dataFormat:u,dimRoundingMode:c}=r;PS([i,o],"conv2dBackpropInput");const h=U(o.shape),d=U(i.shape);let p=Ol(u);const f=wl(s,o.shape,a,1,l,c,!1,p),g=new _i(f.inShape,"float32"),m=g.values,y=n.data.get(i.dataId).values,b=n.data.get(o.dataId).values,[v,w,x]=h,{batchSize:k,filterHeight:_,filterWidth:I,inChannels:C,inHeight:S,inWidth:T,outChannels:E,outHeight:N,outWidth:A,strideHeight:R,strideWidth:$}=f;p=f.dataFormat;const D=_-1-f.padInfo.top,O=I-1-f.padInfo.left,F="channelsLast"===p,M=g.strides[0],P=F?g.strides[1]:g.strides[2],L=F?g.strides[2]:1,z=F?1:g.strides[1],B=d[0],W=F?d[1]:d[2],V=F?d[2]:1,j=F?1:d[1];for(let U=0;U<k;++U)for(let t=0;t<C;++t)for(let e=0;e<S;++e){const n=e-D,r=Math.max(0,Math.ceil(n/R)),i=Math.min(N,(_+n)/R);for(let o=0;o<T;++o){const s=o-O,a=Math.max(0,Math.ceil(s/$)),l=Math.min(A,(I+s)/$);let u=0;for(let e=r;e<i;++e){const r=e*R-n;for(let n=a;n<l;++n){const i=n*$-s,o=B*U+W*e+V*n,a=v*(_-1-r)+w*(I-1-i)+x*t;for(let t=0;t<E;++t){const e=y[o+j*t],n=b[a+t];u+=e*n}}}const c=M*U+P*e+L*o+z*t;m[c]=u}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}const XE={kernelName:Vt,backendName:"cpu",kernelFunc:KE};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function YE(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:o}=e,{strides:s,pad:a,dilations:l}=r;PS([i,o],"conv3d");const u=xl(i.shape,o.shape,s,l,a),{filterDepth:c,filterHeight:h,filterWidth:d,dilationDepth:p,dilationHeight:f,dilationWidth:g,padInfo:m}=u,y=m.front,b=m.left,v=m.top,w=new _i(u.outShape,i.dtype),x=n.data.get(i.dataId).values,k=n.data.get(o.dataId).values,_=w.values,I=U(i.shape),C=U(o.shape);for(let S=0;S<u.batchSize;++S){const t=S*I[0],e=S*w.strides[0];for(let n=0;n<u.outDepth;++n){const r=e+n*w.strides[1],i=n*u.strideDepth-y;for(let e=0;e<c;++e){const n=i+e*p;if(n<0||n>=u.inDepth)continue;const o=e*C[0],s=t+n*I[1];for(let t=0;t<u.outHeight;++t){const e=r+t*w.strides[2],n=t*u.strideHeight-v;for(let t=0;t<h;++t){const r=n+t*f;if(r<0||r>=u.inHeight)continue;const i=o+t*C[1],a=s+r*I[2];for(let t=0;t<u.outWidth;++t){const n=e+t*u.outChannels,r=t*u.strideWidth-b;for(let t=0;t<d;++t){const e=r+t*g;if(e<0||e>=u.inWidth)continue;const o=i+t*C[2],s=a+e*u.inChannels;let l=o;for(let t=0;t<u.inChannels;++t){const e=x[s+t];for(let t=0;t<u.outChannels;++t)_[n+t]+=e*k[l+t];l+=u.outChannels}}}}}}}}return n.makeTensorInfo(w.shape,w.dtype,w.values)}const JE={kernelName:jt,backendName:"cpu",kernelFunc:YE};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function ZE(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,dy:o}=e,{strides:s,pad:a,filterShape:l}=r;PS([i,o],"conv3dBackpropFilterV2");const u=U(i.shape),c=U(o.shape),h=xl(i.shape,l,s,1,a),d=h.strideDepth,p=h.strideHeight,f=h.strideWidth,g=h.filterDepth,m=h.filterHeight,y=h.filterWidth,b=new _i(h.filterShape,"float32"),v=b.values,[w,x,k,_]=b.strides,I=n.data.get(o.dataId).values,[C,S,T,E]=c,N=n.data.get(i.dataId).values,[A,R,$,D]=u,O=h.padInfo.front,F=h.padInfo.left,M=h.padInfo.top;for(let P=0;P<g;++P){const t=Math.max(0,Math.ceil((O-P)/d)),e=Math.min(h.outDepth,(h.inDepth+O-P)/d),n=P*w;for(let r=0;r<m;++r){const i=Math.max(0,Math.ceil((M-r)/p)),o=Math.min(h.outHeight,(h.inHeight+M-r)/p),s=r*x+n;for(let n=0;n<y;++n){const a=Math.max(0,Math.ceil((F-n)/f)),l=Math.min(h.outWidth,(h.inWidth+F-n)/f),u=n*k+s;for(let s=0;s<h.inChannels;++s){const c=s*_+u;for(let u=0;u<h.outChannels;++u){let g=0;for(let c=0;c<h.batchSize;++c){const h=c*A,m=c*C;for(let c=t;c<e;++c){const t=P+c*d-O,e=t*R+h,y=c*S+m;for(let c=i;c<o;++c){const t=r+c*p-M,i=t*$+e,o=c*T+y;for(let e=a;e<l;++e){const t=n+e*f-F,r=t*D+i,a=e*E+o;g+=N[r+s]*I[a+u]}}}}v[c+u]=g}}}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}const QE={kernelName:Ht,backendName:"cpu",kernelFunc:ZE};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function tN(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,filter:o}=e,{pad:s,strides:a,inputShape:l}=r;PS([i],"conv3dBackpropInputV2");const u=U(i.shape),c=U(o.shape),h=xl(l,o.shape,a,1,s),d=new _i(h.inShape,"float32"),p=d.values,[f,g,m,y]=d.strides,b=n.data.get(i.dataId).values,[v,w,x,k]=u,_=n.data.get(o.dataId).values,[I,C,S,T]=c,{batchSize:E,filterDepth:N,filterHeight:A,filterWidth:R,inChannels:$,inDepth:D,inHeight:O,inWidth:F,outChannels:M,outDepth:P,outHeight:L,outWidth:z,strideDepth:B,strideHeight:W,strideWidth:V}=h,j=N-1-h.padInfo.front,H=A-1-h.padInfo.top,G=R-1-h.padInfo.left;for(let U=0;U<E;++U)for(let t=0;t<$;++t)for(let e=0;e<D;++e){const n=e-j,r=Math.max(0,Math.ceil(n/B)),i=Math.min(P,(N+n)/B);for(let o=0;o<O;++o){const s=o-H,a=Math.max(0,Math.ceil(s/W)),l=Math.min(L,(A+s)/W);for(let u=0;u<F;++u){const c=u-G,h=Math.max(0,Math.ceil(c/V)),d=Math.min(z,(R+c)/V);let E=0;for(let e=r;e<i;++e){const r=e*B-n;for(let n=a;n<l;++n){const i=n*W-s;for(let o=h;o<d;++o){const s=o*V-c,a=v*U+w*e+x*n+k*o,l=I*(N-1-r)+C*(A-1-i)+S*(R-1-s)+T*t;for(let t=0;t<M;++t){const e=b[a+t],n=_[l+t];E+=e*n}}}}p[f*U+g*e+m*o+y*u+t]=E}}}return n.makeTensorInfo(d.shape,d.dtype,d.values)}const eN={kernelName:Gt,backendName:"cpu",kernelFunc:tN},nN=WS(qt,(t=>Math.cos(t))),rN={kernelName:qt,backendName:"cpu",kernelFunc:nN},iN=WS(Kt,(t=>Math.cosh(t))),oN={kernelName:Kt,backendName:"cpu",kernelFunc:iN};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function sN(t){const{inputs:e,backend:n,attrs:r}=t,{image:i,boxes:o,boxInd:s}=e,{cropSize:a,method:l,extrapolationValue:u}=r,[c,h,d,p]=i.shape,f=o.shape[0],[g,m]=a,y=As([f,g,m,p],"float32"),b=n.data.get(o.dataId).values,v=n.data.get(s.dataId).values,w=n.data.get(i.dataId).values,x=U(i.shape),k=U(y.shape);for(let _=0;_<f;_++){const t=4*_,e=b[t],n=b[t+1],r=b[t+2],i=b[t+3],o=v[_];if(o>=c)continue;const s=g>1?(r-e)*(h-1)/(g-1):0,a=m>1?(i-n)*(d-1)/(m-1):0;for(let c=0;c<g;c++){const t=g>1?e*(h-1)+c*s:.5*(e+r)*(h-1);if(t<0||t>h-1)for(let e=0;e<m;e++)for(let t=0;t<p;t++){const n=t+e*k[2]+c*k[1]+_*k[0];y.values[n]=u}else if("bilinear"===l){const e=Math.floor(t),r=Math.ceil(t),s=t-e;for(let t=0;t<m;t++){const l=m>1?n*(d-1)+t*a:.5*(n+i)*(d-1);if(l<0||l>d-1){for(let e=0;e<p;e++){const n=e+t*k[2]+c*k[1]+_*k[0];y.values[n]=u}continue}const h=Math.floor(l),f=Math.ceil(l),g=l-h;for(let n=0;n<p;n++){let i=n+h*x[2]+e*x[1]+o*x[0];const a=w[i];i=n+f*x[2]+e*x[1]+o*x[0];const l=w[i];i=n+h*x[2]+r*x[1]+o*x[0];const u=w[i];i=n+f*x[2]+r*x[1]+o*x[0];const d=w[i],p=a+(l-a)*g,m=u+(d-u)*g;i=n+t*k[2]+c*k[1]+_*k[0],y.values[i]=p+(m-p)*s}}}else for(let e=0;e<m;++e){const r=m>1?n*(d-1)+e*a:.5*(n+i)*(d-1);if(r<0||r>d-1){for(let t=0;t<p;t++){const n=t+e*k[2]+c*k[1]+_*k[0];y.values[n]=u}continue}const s=Math.round(r),l=Math.round(t);for(let t=0;t<p;t++){const n=t+s*x[2]+l*x[1]+o*x[0],r=t+e*k[2]+c*k[1]+_*k[0];y.values[r]=w[n]}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const aN={kernelName:Jt,backendName:"cpu",kernelFunc:sN};
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function lN(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:o,exclusive:s,reverse:a}=r;PS(i,"cumprod");const l=dc([o],i.shape.length);let u=i;null!=l&&(u=PT({inputs:{x:i},backend:n,attrs:{perm:l}}));const c=fc(1,i.shape.length)[0];if(c!==u.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${c}`);const h=zi(u.dtype,"int32"),d=G(w(u.shape),h),p=n.data.get(u.dataId).values,f=u.shape[u.shape.length-1],g=a?(t,e)=>t+f-e-1:(t,e)=>t+e;for(let y=0;y<p.length;y+=f)for(let t=0;t<f;t++){const e=g(y,t);if(0===t)d[e]=s?1:p[e];else{const n=g(y,t-1);d[e]=s?p[n]*d[n]:p[e]*d[n]}}const m=n.makeTensorInfo(u.shape,h,d);if(null!=l){const t=pc(l),e=PT({inputs:{x:m},backend:n,attrs:{perm:t}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(u),e}return m}const uN={kernelName:Xt,backendName:"cpu",kernelFunc:lN};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function cN(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:o,exclusive:s,reverse:a}=r;PS(i,"cumsum");const l=dc([o],i.shape.length);let u=i;null!=l&&(u=PT({inputs:{x:i},backend:n,attrs:{perm:l}}));const c=fc(1,i.shape.length)[0];if(c!==u.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${c}`);const h=zi(u.dtype,"int32"),d=q(w(u.shape),h),p=n.data.get(u.dataId).values,f=u.shape[u.shape.length-1],g=a?(t,e)=>t+f-e-1:(t,e)=>t+e;for(let y=0;y<p.length;y+=f)for(let t=0;t<f;t++){const e=g(y,t);if(0===t)d[e]=s?0:p[e];else{const n=g(y,t-1);d[e]=s?p[n]+d[n]:p[e]+d[n]}}const m=n.makeTensorInfo(u.shape,h,d);if(null!=l){const t=pc(l),e=PT({inputs:{x:m},backend:n,attrs:{perm:t}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(u),e}return m}const hN={kernelName:Yt,backendName:"cpu",kernelFunc:cN};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function dN(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,weights:o}=e,{size:s,binaryOutput:a}=r;if(1===i.shape.length){const t=n.data.get(i.dataId).values,e=n.data.get(o.dataId).values,r=_E(t,e,o.dtype,o.shape,s);return n.makeTensorInfo([s],o.dtype,r)}if(2===i.shape.length){const t=n.bufferSync(i),e=n.bufferSync(o),r=IE(t,e,s,a);return n.makeTensorInfo(r.shape,o.dtype,r.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${i.shape.length}.`)}const pN={kernelName:Zt,backendName:"cpu",kernelFunc:dN};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function fN(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{blockSize:o,dataFormat:s}=r;y("NHWC"===s,(()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${s}`));const a=i.shape[0],l=i.shape[1],u=i.shape[2],c=i.shape[3],h=l*o,d=u*o,p=c/(o*o),f=n.data.get(i.dataId).values,g=new Float32Array(a*h*d*p);let m=0;for(let y=0;y<a;++y)for(let t=0;t<h;++t){const e=Math.floor(t/o),n=t%o;for(let t=0;t<d;++t){const r=Math.floor(t/o),i=t%o,s=(n*o+i)*p;for(let t=0;t<p;++t){const n=t+s,i=n+c*(r+u*(e+l*y));g[m++]=f[i]}}}return n.makeTensorInfo([a,h,d,p],i.dtype,g)}const gN={kernelName:Qt,backendName:"cpu",kernelFunc:fN};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function mN(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:o}=e,{strides:s,pad:a,dilations:l,dimRoundingMode:u}=r;PS([i,o],"depthwiseConv2DNative");const c=U(i.shape),h=U(o.shape);let d=l;null==d&&(d=[1,1]),y($l(s,d),(()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${s} and dilations '${d}'`));const p=wl(i.shape,o.shape,s,d,a,u,!0),{filterHeight:f,filterWidth:g,dilationHeight:m,dilationWidth:b,padInfo:v}=p,w=v.left,x=v.top,k=p.outChannels/p.inChannels,_=new _i(p.outShape,i.dtype),I=n.data.get(i.dataId).values,C=n.data.get(o.dataId).values,S=_.values;for(let y=0;y<p.batchSize;++y){const t=y*c[0],e=y*_.strides[0];for(let n=0;n<p.outHeight;++n){const r=e+n*_.strides[1],i=n*p.strideHeight-x;for(let e=0;e<f;++e){const n=i+e*m;if(n<0||n>=p.inHeight)continue;const o=e*h[0],s=t+n*c[1];for(let t=0;t<p.outWidth;++t){const e=r+t*_.strides[2],n=t*p.strideWidth-w;for(let t=0;t<g;++t){const r=n+t*b;if(r<0||r>=p.inWidth)continue;const i=o+t*h[1],a=s+r*p.inChannels;let l=e,u=i;for(let t=0;t<p.inChannels;++t){const e=I[a+t];for(let t=0;t<k;++t)S[l+t]+=e*C[u+t];l+=k,u+=k}}}}}}return n.makeTensorInfo(_.shape,_.dtype,_.values)}const yN={kernelName:te,backendName:"cpu",kernelFunc:mN};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function bN(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,dy:o}=e,{strides:s,dilations:a,pad:l,dimRoundingMode:u,filterShape:c}=r;PS([i,o],"depthwiseConv2dNativeBackpropFilter");const h=wl(i.shape,c,s,a,l,u,!0),{strideHeight:d,strideWidth:p,filterHeight:f,filterWidth:g}=h,m=new _i(h.filterShape,"float32"),y=h.padInfo.left,b=h.padInfo.top,v=h.outChannels/h.inChannels,w=n.data.get(i.dataId).values,x=new _i(i.shape,i.dtype,w),k=n.data.get(o.dataId).values,_=new _i(o.shape,o.dtype,k);for(let I=0;I<f;++I){const t=Math.max(0,Math.ceil((b-I)/d)),e=Math.min(h.outHeight,(h.inHeight+b-I)/d);for(let n=0;n<g;++n){const r=Math.max(0,Math.ceil((y-n)/p)),i=Math.min(h.outWidth,(h.inWidth+y-n)/p);for(let o=0;o<h.outChannels;++o){const s=Math.trunc(o/v),a=o%v;let l=0;for(let u=0;u<h.batchSize;++u)for(let a=t;a<e;++a){const t=I+a*d-b;for(let e=r;e<i;++e){const r=n+e*p-y;l+=x.get(u,t,r,s)*_.get(u,a,e,o)}}m.set(l,I,n,s,a)}}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}const vN={kernelName:ee,backendName:"cpu",kernelFunc:bN};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function wN(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,filter:o}=e,{strides:s,dilations:a,pad:l,dimRoundingMode:u,inputShape:c}=r;PS([i,o],"depthwiseConv2DNativeBackpropInput");const h=U(i.shape),d=U(o.shape),p=wl(c,o.shape,s,a,l,u,!0),f=new _i(p.inShape,"float32"),g=f.values,[m,y,b]=f.strides,v=n.data.get(i.dataId).values,[w,x,k]=h,_=n.data.get(o.dataId).values,[I,C,S]=d,{batchSize:T,filterHeight:E,filterWidth:N,inChannels:A,inHeight:R,inWidth:$,outChannels:D,outHeight:O,outWidth:F,strideHeight:M,strideWidth:P}=p,L=E-1-p.padInfo.top,z=N-1-p.padInfo.left,B=D/A;for(let W=0;W<T;++W)for(let t=0;t<A;++t)for(let e=0;e<R;++e){const n=e-L,r=Math.max(0,Math.ceil(n/M)),i=Math.min(O,(E+n)/M);for(let o=0;o<$;++o){const s=o-z,a=Math.max(0,Math.ceil(s/P)),l=Math.min(F,(N+s)/P);let u=0;for(let e=r;e<i;++e){const r=e*M-n;for(let n=a;n<l;++n){const i=n*P-s,o=w*W+x*e+k*n,a=I*(E-1-r)+C*(N-1-i)+S*t;for(let e=0;e<B;++e){const n=t*B+e,r=v[o+n],i=_[a+e];u+=r*i}}}g[m*W+y*e+b*o+t]=u}}return n.makeTensorInfo(f.shape,f.dtype,f.values)}const xN={kernelName:ne,backendName:"cpu",kernelFunc:wN};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function kN(t){const{inputs:e,backend:n}=t,{x:r}=e,i=w(r.shape),o=n.data.get(r.dataId).values,s=As([i,i],r.dtype),a=s.values;for(let u=0;u<o.length;u++)a[u*i+u]=o[u];const l=[...r.shape,...r.shape];return n.makeTensorInfo(l,s.dtype,s.values)}const _N={kernelName:re,backendName:"cpu",kernelFunc:kN},IN={kernelName:ie,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:i}=t,{strides:o,pad:s,dilations:a}=n,l=e,u=l.data.get(r.dataId).values,c=r.shape.length,h=l.data.get(i.dataId).values,d=i.shape.length,{batchSize:p,inHeight:f,inWidth:g,inChannels:m,outHeight:y,outWidth:b,padInfo:v,strideHeight:x,strideWidth:k,filterHeight:_,filterWidth:I,dilationHeight:C,dilationWidth:S,outShape:T}=yl(r.shape,i.shape,o,s,"NHWC",a),E=w(T),N=T.length,R=A(r.dtype,E);for(let w=0;w<p;++w)for(let t=0;t<y;++t){const e=t*x-v.top;for(let n=0;n<b;++n){const o=n*k-v.left;for(let s=0;s<m;++s){let a=Number.MIN_SAFE_INTEGER;for(let t=0;t<_;++t){const n=e+t*C;if(n>=0&&n<f)for(let e=0;e<I;++e){const l=o+e*S;if(l>=0&&l<g){const o=Y([w,n,l,s],c,U(r.shape)),p=Y([t,e,s],d,U(i.shape)),f=u[o]+h[p];f>a&&(a=f)}}}const l=Y([w,t,n,s],N,U(T));R[l]=a}}}const $=l.write(ri(R,r.dtype),T,r.dtype);return{dataId:$,shape:T,dtype:r.dtype}}},CN={kernelName:se,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:i,dy:o}=t,{strides:s,pad:a,dilations:l}=n,u=e,c=j(r.shape,u.data.get(r.dataId).values),h=j(i.shape,u.data.get(i.dataId).values),{batchSize:d,inHeight:p,inWidth:f,inChannels:g,outHeight:m,outWidth:b,padInfo:v,strideHeight:w,strideWidth:x,filterHeight:k,filterWidth:_,dilationHeight:I,dilationWidth:C,outShape:S}=yl(r.shape,i.shape,s,a,"NHWC",l);y(o.rank===S.length,(()=>`Error in ${se}, dy must have the same rank as output ${S.length}, but got ${o.rank}`));const T=j(S,u.data.get(o.dataId).values),E=K(i.shape,i.dtype);for(let y=0;y<d;++y)for(let t=0;t<m;++t){const e=t*w-v.top;for(let n=0;n<b;++n){const r=n*x-v.left;for(let i=0;i<g;++i){let o=Number.MIN_SAFE_INTEGER,s=0,a=0;for(let t=0;t<k;++t){const n=e+t*I;if(n>=0&&n<p)for(let e=0;e<_;++e){const l=r+e*C;if(l>=0&&l<f){const r=c[y][n][l][i]+h[t][e][i];r>o&&(o=r,s=t,a=e)}}}E[s][a][i]+=T[y][t][n][i]}}}const N=u.write(ri(E,r.dtype),i.shape,i.dtype);return{dataId:N,shape:i.shape,dtype:i.dtype}}},SN={kernelName:oe,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:i,dy:o}=t,{strides:s,pad:a,dilations:l}=n,u=e,c=j(r.shape,u.data.get(r.dataId).values),h=j(i.shape,u.data.get(i.dataId).values),{batchSize:d,inHeight:p,inWidth:f,inChannels:g,outHeight:m,outWidth:b,padInfo:v,strideHeight:w,strideWidth:x,filterHeight:k,filterWidth:_,dilationHeight:I,dilationWidth:C,outShape:S}=yl(r.shape,i.shape,s,a,"NHWC",l);y(o.rank===S.length,(()=>`Error in ${oe}, dy must have the same rank as output ${S.length}, but got ${o.rank}`));const T=j(S,u.data.get(o.dataId).values),E=K(r.shape,r.dtype);for(let y=0;y<d;++y)for(let t=0;t<m;++t){const e=t*w-v.top;for(let n=0;n<b;++n){const r=n*x-v.left;for(let i=0;i<g;++i){let o=Number.MIN_SAFE_INTEGER,s=e<0?0:e,a=r<0?0:r;for(let t=0;t<k;++t){const n=e+t*I;if(n>=0&&n<p)for(let e=0;e<_;++e){const l=r+e*C;if(l>=0&&l<f){const r=c[y][n][l][i]+h[t][e][i];r>o&&(o=r,s=n,a=l)}}}E[y][s][a][i]+=T[y][t][n][i]}}}const N=u.write(ri(E,r.dtype),r.shape,r.dtype);return{dataId:N,shape:r.shape,dtype:r.dtype}}};
/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function TN(t){const{inputs:e,backend:n,attrs:r}=t,{image:i}=e,{canvas:o,options:s}=r,{contextOptions:a,imageOptions:l}=s||{},u=(null===l||void 0===l?void 0:l.alpha)||1,c=(null===a||void 0===a?void 0:a.contextType)||"2d";if("2d"!==c)throw new Error(`Context type ${a.contextType} is not supported by the CPU backend.`);const h=o.getContext(c,(null===a||void 0===a?void 0:a.contextAttributes)||{});if(null==h)throw new Error(`Could not get the context with ${c} type.`);const[d,p]=i.shape.slice(0,2),f=2===i.shape.length?1:i.shape[2],g=n.data.get(i.dataId).values,m="float32"===i.dtype?255:1,y=new Uint8ClampedArray(p*d*4);for(let v=0;v<d*p;++v){const t=[0,0,0,255*u];for(let n=0;n<f;n++){const e=g[v*f+n];if("float32"===i.dtype){if(e<0||e>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${e}.`)}else if("int32"===i.dtype&&(e<0||e>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${e}.`);1===f?(t[0]=e*m,t[1]=e*m,t[2]=e*m):t[n]=e*m}const e=4*v;y[e+0]=Math.round(t[0]),y[e+1]=Math.round(t[1]),y[e+2]=Math.round(t[2]),y[e+3]=Math.round(t[3])}o.width=p,o.height=d;const b=new ImageData(y,p,d);return h.putImageData(b,0,0),i}const EN={kernelName:ae,backendName:"cpu",kernelFunc:TN},NN=XS(((t,e)=>t*e)),AN=mT(((t,e,n,r)=>({real:t*n-e*r,imag:t*r+e*n}))),RN=gT(on,NN,AN),$N={kernelName:on,backendName:"cpu",kernelFunc:RN};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function DN(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:o,keepDims:s}=r;let a;PS(i,"sum"),a="bool"===i.dtype?pT({inputs:{x:i},backend:n,attrs:{dtype:"int32"}}):HS({inputs:{x:i},backend:n});const l=a.shape.length,u=T(o,a.shape),c=dc(u,l);let h=u,d=a;null!=c&&(d=PT({inputs:{x:a},backend:n,attrs:{perm:c}}),h=fc(h.length,l)),hc("sum",h,d.shape.length);const[p,f]=uc(d.shape,h),g=zi(d.dtype,"int32");let m=uT(n,p,g);const y=w(f),b=n.data.get(m.dataId).values,v=n.data.get(d.dataId).values;for(let w=0;w<b.length;++w){const t=w*y;let e=0;for(let n=0;n<y;++n)e+=v[t+n];b[w]=e}if(s){const t=cc(m.shape,u),e=m;m=xT({inputs:{x:m},backend:n,attrs:{shape:t}}),n.disposeIntermediateTensorInfo(e)}return n.disposeIntermediateTensorInfo(a),null!=c&&n.disposeIntermediateTensorInfo(d),m}const ON={kernelName:Gn,backendName:"cpu",kernelFunc:DN};
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function FN(t){const{inputs:e,backend:n,attrs:r}=t,{equation:i}=r,o=e,{allDims:s,summedDims:a,idDims:l}=Ef(i,o.length);Af(s.length,l,o);const{path:u,steps:c}=Rf(a,l),h=c.length;let d=null,p=s.length;const f=[];for(let g=0;g<h;++g){for(const t of c[g]){const{permutationIndices:e,expandDims:r}=Nf(p,l[t]);let i;$f(e)?i=o[t]:(i=PT({inputs:{x:o[t]},backend:n,attrs:{perm:e}}),f.push(i));const s=i.shape.slice();for(let t=0;t<r.length;++t)s.splice(r[t],0,1);x(i.shape,s)||(i=xT({inputs:{x:i},backend:n,attrs:{shape:s}}),f.push(i)),null===d?d=i:(d=RN({inputs:{a:i,b:d},backend:n}),f.push(d))}g<h-1&&(u[g]>=0&&(d=DN({inputs:{x:d},backend:n,attrs:{axis:u[g]-(s.length-p),keepDims:!1}}),f.push(d)),p--)}for(const g of f)g!==d&&n.disposeIntermediateTensorInfo(g);return d}const MN={kernelName:ue,backendName:"cpu",kernelFunc:FN};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function PN(t){const{inputs:e,backend:n}=t,{dy:r,y:i}=e;PS([r,i],"eluGrad");const o=new Float32Array(w(i.shape)),s=n.data.get(i.dataId).values,a=n.data.get(r.dataId).values;for(let l=0;l<s.length;++l){const t=s[l];o[l]=t>=0?a[l]:a[l]*(t+1)}return n.makeTensorInfo(i.shape,"float32",o)}const LN={kernelName:he,backendName:"cpu",kernelFunc:PN},zN=XS(((t,e)=>t===e?1:0)),BN=gT(pe,zN,null,"bool"),WN={kernelName:pe,backendName:"cpu",kernelFunc:BN},UN=cf,VN=hf,jN=df,HN=pf,GN=ff,qN=gf,KN=WS(de,(t=>{const e=Math.sign(t),n=Math.abs(t),r=1/(1+UN*n);return e*(1-((((qN*r+GN)*r+HN)*r+jN)*r+VN)*r*Math.exp(-n*n))})),XN={kernelName:de,backendName:"cpu",kernelFunc:KN},YN=BS((t=>Math.exp(t))),JN=US(fe,YN,"float32"),ZN={kernelName:fe,backendName:"cpu",kernelFunc:JN};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function QN(t){const{inputs:e,backend:n,attrs:r}=t,{input:i}=e,{dim:o}=r,s=i.shape.length,a=i.shape.slice();let l=o;return o<0&&(y(-(s+1)<=o,(()=>`Axis must be in the interval [${-(s+1)}, ${s}]`)),l=s+o+1),a.splice(l,0,1),xT({inputs:{x:i},backend:n,attrs:{shape:a}})}const tA={kernelName:ge,backendName:"cpu",kernelFunc:QN},eA=BS((t=>Math.expm1(t))),nA=US(me,eA),rA={kernelName:me,backendName:"cpu",kernelFunc:nA},iA=XS(((t,e)=>t/e)),oA=gT(le,iA),sA={kernelName:le,backendName:"cpu",kernelFunc:oA},aA=XS(((t,e)=>t-e)),lA=mT(((t,e,n,r)=>({real:t-n,imag:e-r}))),uA=gT(lr,aA,lA),cA={kernelName:lr,backendName:"cpu",kernelFunc:uA};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function hA(t,e,n){const r=t.shape,i=r[0],o=r[1],s=n.data.get(t.dataId),a=s.complexTensorInfos.real,l=s.complexTensorInfos.imag,u=[i,o],c=w(u),h=N("float32",c),d=N("float32",c);for(let m=0;m<i;m++){const t=vE({inputs:{x:a},backend:n,attrs:{begin:[m,0],size:[1,o]}}),r=vE({inputs:{x:l},backend:n,attrs:{begin:[m,0],size:[1,o]}}),i=aT({inputs:{real:t,imag:r},backend:n}),{real:s,imag:u}=dA(i,e,n),c=mf(s,u);for(let e=0;e<o;e++){const t=wf(c,e);h[m*o+e]=t.real,d[m*o+e]=t.imag}n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i)}const p=n.makeTensorInfo(u,"float32",h),f=n.makeTensorInfo(u,"float32",d),g=aT({inputs:{real:p,imag:f},backend:n});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),g}function dA(t,e,n){const r=w(t.shape),i=n.data.get(t.dataId),o=n.data.get(i.complexTensorInfos.real.dataId).values,s=n.data.get(i.complexTensorInfos.imag.dataId).values;if(pA(r)){const i=fA(o,s,r,e,n),a=[t.shape[0],t.shape[1]];if(e){const t=n.makeTensorInfo(a,"float32",i.real),e=n.makeTensorInfo(a,"float32",i.imag),o=n.makeTensorInfo([],"float32",ei(r,"float32")),s=HS({inputs:{x:o},backend:n}),l=sA.kernelFunc({inputs:{a:t,b:o},backend:n}),u=sA.kernelFunc({inputs:{a:e,b:s},backend:n}),c=n.data.get(l.dataId).values,h=n.data.get(u.dataId).values;return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(u),{real:c,imag:h}}return i}{const t=mf(o,s),n=gA(t,r,e);return yf(n)}}function pA(t){return 0===(t&t-1)}function fA(t,e,n,r,i){if(1===n)return{real:t,imag:e};const o=mf(t,e),s=n/2,a=bf(o),l=a.real,u=a.imag,c=[l.length],h=i.makeTensorInfo(c,"float32",l),d=i.makeTensorInfo(c,"float32",u),p=aT({inputs:{real:h,imag:d},backend:i}),f=vf(o),g=f.real,m=f.imag,y=[g.length],b=i.makeTensorInfo(y,"float32",g),v=i.makeTensorInfo(y,"float32",m),w=aT({inputs:{real:b,imag:v},backend:i}),x=fA(l,u,s,r,i),k=x.real,_=x.imag,I=[k.length],C=i.makeTensorInfo(I,"float32",k),S=i.makeTensorInfo(I,"float32",_),T=aT({inputs:{real:C,imag:S},backend:i}),E=fA(g,m,s,r,i),N=E.real,A=E.imag,R=[N.length],$=i.makeTensorInfo(R,"float32",N),D=i.makeTensorInfo(R,"float32",A),O=aT({inputs:{real:$,imag:D},backend:i}),F=kf(n,r),M=[F.real.length],P=i.makeTensorInfo(M,"float32",F.real),L=i.makeTensorInfo(M,"float32",F.imag),z=aT({inputs:{real:P,imag:L},backend:i}),B=RN({inputs:{a:z,b:O},backend:i}),W=vT({inputs:{a:T,b:B},backend:i}),U=uA({inputs:{a:T,b:B},backend:i}),V=cT({inputs:{input:W},backend:i}),j=cT({inputs:{input:U},backend:i}),H=BE({inputs:{input:W},backend:i}),G=BE({inputs:{input:U},backend:i}),q=UE({inputs:[V,j],backend:i,attrs:{axis:0}}),K=UE({inputs:[H,G],backend:i,attrs:{axis:0}}),X=i.data.get(q.dataId).values,Y=i.data.get(K.dataId).values;return i.disposeIntermediateTensorInfo(h),i.disposeIntermediateTensorInfo(d),i.disposeIntermediateTensorInfo(p),i.disposeIntermediateTensorInfo(b),i.disposeIntermediateTensorInfo(v),i.disposeIntermediateTensorInfo(w),i.disposeIntermediateTensorInfo(C),i.disposeIntermediateTensorInfo(S),i.disposeIntermediateTensorInfo(T),i.disposeIntermediateTensorInfo($),i.disposeIntermediateTensorInfo(D),i.disposeIntermediateTensorInfo(O),i.disposeIntermediateTensorInfo(P),i.disposeIntermediateTensorInfo(L),i.disposeIntermediateTensorInfo(z),i.disposeIntermediateTensorInfo(B),i.disposeIntermediateTensorInfo(W),i.disposeIntermediateTensorInfo(U),i.disposeIntermediateTensorInfo(V),i.disposeIntermediateTensorInfo(H),i.disposeIntermediateTensorInfo(j),i.disposeIntermediateTensorInfo(G),i.disposeIntermediateTensorInfo(q),i.disposeIntermediateTensorInfo(K),{real:X,imag:Y}}function gA(t,e,n){const r=new Float32Array(2*e);for(let i=0;i<e;i++){let o=0,s=0;for(let r=0;r<e;r++){const a=_f(i*r,e,n),l=wf(t,r);o+=l.real*a.real-l.imag*a.imag,s+=l.real*a.imag+l.imag*a.real}n&&(o/=e,s/=e),xf(r,o,s,i)}return r}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function mA(t){const{inputs:e,backend:n}=t,{input:r}=e,i=w(r.shape),o=r.shape[r.shape.length-1],s=i/o,a=xT({inputs:{x:r},backend:n,attrs:{shape:[s,o]}}),l=hA(a,!1,n),u=xT({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),u}const yA={kernelName:ye,backendName:"cpu",kernelFunc:mA};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function bA(t){const{backend:e,attrs:n}=t,{shape:r,value:i,dtype:o}=n,s=o||z(i),a=A(s,w(r));return wA(a,i,s),e.makeTensorInfo(r,s,a)}const vA={kernelName:be,backendName:"cpu",kernelFunc:bA};function wA(t,e,n){t.fill(e)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const xA={kernelName:ve,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,i=n,o=N(r.dtype,w(r.shape)),[s,a,l,u]=r.shape,c=i.data.get(r.dataId).values;for(let d=0;d<s;d++){const t=d*l*a*u;for(let e=0;e<a;e++){const n=e*(l*u);for(let e=0;e<l;e++){const r=e*u;for(let i=0;i<u;i++){const s=Math.round(l-e-1),a=t+n+r+i;let h=c[a];if(s>=0&&s<l){const e=s*u,r=t+n+e+i;h=c[r]}o[a]=h}}}}const h=i.write(o,r.shape,r.dtype);return{dataId:h,shape:r.shape,dtype:r.dtype}}},kA=BS((t=>Math.floor(t))),_A=US(we,kA),IA={kernelName:we,backendName:"cpu",kernelFunc:_A},CA=XS(((t,e)=>Math.floor(t/e))),SA=gT(xe,CA,null,"int32"),TA={kernelName:xe,backendName:"cpu",kernelFunc:SA};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function EA(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:o,bias:s,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:c,dilations:h,dimRoundingMode:d,activation:p,leakyreluAlpha:f}=r;let g=jE({inputs:{x:i,filter:o},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:h,dimRoundingMode:d}});if(s){const t=g;if("NCHW"===c&&1===s.shape.length&&1!==s.shape[0]){const t=xT({inputs:{x:s},backend:n,attrs:{shape:[s.shape[0],1,1]}});g=vT({inputs:{a:g,b:t},backend:n}),n.disposeIntermediateTensorInfo(t)}else g=vT({inputs:{a:g,b:s},backend:n});n.disposeIntermediateTensorInfo(t)}if(p){const t=g;if("NCHW"===c&&"prelu"===p&&1===a.shape.length&&1!==a.shape[0]){const t=xT({inputs:{x:a},backend:n,attrs:{shape:[a.shape[0],1,1]}});g=sT(n,g,p,t,f),n.disposeIntermediateTensorInfo(t)}else g=sT(n,g,p,a,f);n.disposeIntermediateTensorInfo(t)}return g}const NA={kernelName:_r,backendName:"cpu",kernelFunc:EA};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function AA(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:o,bias:s,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:c,dilations:h,dimRoundingMode:d,activation:p,leakyreluAlpha:f}=r;let g=mN({inputs:{x:i,filter:o},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:h,dimRoundingMode:d}});if(s){const t=g;g=vT({inputs:{a:g,b:s},backend:n}),n.disposeIntermediateTensorInfo(t)}if(p){const t=g;g=sT(n,g,p,a,f),n.disposeIntermediateTensorInfo(t)}return g}const RA={kernelName:Ir,backendName:"cpu",kernelFunc:AA};
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function $A(t,e,n,r,i,o,s,a,l){const u=As([r,o],n);for(let c=0;c<r;c++){const n=[];let r=0;for(let e=0;e<i;e++){const o=t[c*i+e];r+=o*s[e],n.push(o)}if(r<0||r>=l/o)throw new Error(`Invalid indices: ${n} does not index into ${a}`);for(let t=0;t<o;t++)u.values[c*o+t]=e.get(...e.indexToLoc(r*o+t))}return u}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function DA(t){const{inputs:e,backend:n}=t,{params:r,indices:i}=e,o=w(r.shape),s=i.shape,a=s[s.length-1],[l,u,c,h]=rf(r,i);if(0===u)return n.makeTensorInfo(l,r.dtype,[]);const d=n.data.get(i.dataId).values,p=n.bufferSync(r),f=$A(d,p,r.dtype,u,a,c,h,r.shape,o);return n.makeTensorInfo(l,r.dtype,f.values)}const OA={kernelName:Ie,backendName:"cpu",kernelFunc:DA};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function FA(t,e,n){const r=As(n,t.dtype);for(let i=0;i<r.size;++i){const n=r.indexToLoc(i),o=n.slice(),s=o[0],a=o[2],l=e.locToIndex([s,a]);o[2]=e.values[l];const u=t.locToIndex(o);0<=u&&u<t.values.length&&(r.values[i]=t.values[u])}return r}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function MA(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,indices:o}=e,{axis:s,batchDims:a}=r;PS([i,o],"gatherV2");const l=T(s,i.shape)[0],u=n.data.get(o.dataId).values,c=i.shape[l];for(let w=0;w<u.length;++w){const t=u[w];y(t<=c-1&&t>=0,(()=>`GatherV2: the index value ${t} is not in [0, ${c-1}]`))}let h=a;null==a&&(h=0);const d=w(o.shape),p=Xf(i,o,l,h),f=xT({inputs:{x:i},backend:n,attrs:{shape:[p.batchSize,p.outerSize,p.dimSize,p.sliceSize]}}),g=xT({inputs:{x:o},backend:n,attrs:{shape:[p.batchSize,d/p.batchSize]}}),m=[p.batchSize,p.outerSize,d/p.batchSize,p.sliceSize],b=n.bufferSync(g),v=n.bufferSync(f),x=FA(v,b,m);return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),n.makeTensorInfo(p.outputShape,x.dtype,x.values)}const PA={kernelName:_e,backendName:"cpu",kernelFunc:MA},LA=XS(((t,e)=>t>e?1:0)),zA=gT(Ce,LA,null,"bool"),BA={kernelName:Ce,backendName:"cpu",kernelFunc:zA},WA=XS(((t,e)=>t>=e?1:0)),UA=gT(Se,WA,null,"bool"),VA={kernelName:Se,backendName:"cpu",kernelFunc:UA};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function jA(t){const{inputs:e,backend:n}=t,{input:r}=e,i=w(r.shape),o=r.shape[r.shape.length-1],s=i/o,a=xT({inputs:{x:r},backend:n,attrs:{shape:[s,o]}}),l=hA(a,!0,n),u=xT({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),u}const HA={kernelName:Ee,backendName:"cpu",kernelFunc:jA},GA=WS(Ae,(t=>Number.isFinite(t)?1:0),"bool"),qA={kernelName:Ae,backendName:"cpu",kernelFunc:GA},KA=WS(Re,(t=>Math.abs(t)===1/0?1:0),"bool"),XA={kernelName:Re,backendName:"cpu",kernelFunc:KA},YA=WS($e,(t=>Number.isNaN(t)?1:0),"bool"),JA={kernelName:$e,backendName:"cpu",kernelFunc:YA},ZA=XS(((t,e)=>t<e?1:0)),QA=gT(Oe,ZA,null,"bool"),tR={kernelName:Oe,backendName:"cpu",kernelFunc:QA},eR=XS(((t,e)=>t<=e?1:0)),nR=gT(Fe,eR,null,"bool"),rR={kernelName:Fe,backendName:"cpu",kernelFunc:nR};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function iR(t,e,n){const r=(e-t)/(n-1),i=q(n,"float32");i[0]=t;for(let o=1;o<i.length;o++)i[o]=i[o-1]+r;return i}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function oR(t){const{backend:e,attrs:n}=t,{start:r,stop:i,num:o}=n,s=iR(r,i,o);return e.makeTensorInfo([s.length],"float32",s)}const sR={kernelName:Me,backendName:"cpu",kernelFunc:oR},aR=BS((t=>Math.log(t))),lR=US(Pe,aR),uR={kernelName:Pe,backendName:"cpu",kernelFunc:lR},cR=WS(Le,(t=>Math.log1p(t))),hR={kernelName:Le,backendName:"cpu",kernelFunc:cR},dR=XS(((t,e)=>t&&e)),pR=gT(ze,dR,null,"bool"),fR={kernelName:ze,backendName:"cpu",kernelFunc:pR},gR=WS(Be,(t=>t?0:1),"bool"),mR={kernelName:Be,backendName:"cpu",kernelFunc:gR},yR=XS(((t,e)=>t||e)),bR=gT(We,yR,null,"bool"),vR={kernelName:We,backendName:"cpu",kernelFunc:bR};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function wR(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{depthRadius:o,bias:s,alpha:a,beta:l}=r;PS(i,"LRN");const u=i.shape[3],c=u-1,h=n.data.get(i.dataId).values,d=w(i.shape),p=new Float32Array(d);function f(t){const e=t%u;let n=t-e+Math.max(0,e-o);const r=t-e+Math.min(e+o,c);let i=0;for(;n<=r;n++){const t=h[n];i+=t*t}return i}for(let g=0;g<d;g++){const t=f(g),e=h[g]*Math.pow(s+a*t,-l);p[g]=e}return n.makeTensorInfo(i.shape,i.dtype,p)}const xR={kernelName:Ve,backendName:"cpu",kernelFunc:wR};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function kR(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,y:o,dy:s}=e,{depthRadius:a,bias:l,alpha:u,beta:c}=r;PS(s,"LRNGrad");const h=w(s.shape),d=s.shape[3],p=n.data.get(s.dataId).values,f=n.data.get(i.dataId).values,g=n.data.get(o.dataId).values,m=new Float32Array(h),y=h;for(let b=0;b<y;b++){const t=b%d,e=b-t+Math.max(0,t-a),n=b-t+Math.min(d,t+a+1);let r=0;for(let i=e;i<n;i++)r+=Math.pow(f[i],2);r=u*r+l;for(let i=e;i<n;i++){let t=-2*u*c*f[i]*g[b]/r;b===i&&(t+=Math.pow(r,-c)),t*=p[b],m[i]+=t}}return n.makeTensorInfo(s.shape,i.dtype,m)}const _R={kernelName:je,backendName:"cpu",kernelFunc:kR};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function IR(t,e,n,r){const i=N(r,w(n));for(let o=0;o<i.length;++o){const n=o*e;let r=t[n];for(let i=0;i<e;++i){const e=t[n+i];(Number.isNaN(e)||e>r)&&(r=e)}i[o]=r}return i}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function CR(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{reductionIndices:o,keepDims:s}=r,a=n;let l=i.shape;const u=l.length,c=T(o,l);let h=c;const d=dc(h,u);let p=a.data.get(i.dataId).values;if(null!=d){const t=new Array(u);for(let e=0;e<t.length;e++)t[e]=l[d[e]];p=MT(p,l,i.dtype,d,t),h=fc(h.length,u),l=t}PS(i,"max"),hc("max",h,u);const[f,g]=uc(l,h),m=w(g),y=IR(p,m,f,i.dtype),b=a.write(y,f,i.dtype);let v=f;if(s){const t=cc(f,c);v=t}return{dataId:b,shape:v,dtype:i.dtype}}const SR={kernelName:He,backendName:"cpu",kernelFunc:CR},TR=XS(((t,e)=>Math.max(t,e))),ER=gT(Ge,TR),NR={kernelName:Ge,backendName:"cpu",kernelFunc:ER};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function AR(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e;PS(i,"maxPool");const{filterSize:o,strides:s,pad:a,dimRoundingMode:l}=r,u=1;y($l(s,u),(()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${u}'`));const c=bl(i.shape,o,s,u,a,l);let h;if(1===c.filterWidth&&1===c.filterHeight&&x(c.inShape,c.outShape))h=HS({inputs:{x:i},backend:n});else{const t=n.data.get(i.dataId).values,e=U(i.shape),r=iE(t,i.shape,i.dtype,e,c,"max");h=n.makeTensorInfo(c.outShape,i.dtype,r.values)}return h}const RR={kernelName:qe,backendName:"cpu",kernelFunc:AR};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function $R(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{filterSize:o,strides:s,pad:a,dimRoundingMode:l,dataFormat:u}=r;PS(i,"maxPool3d");const c=vl(i.shape,o,s,1,a,l,u),h=n.data.get(i.dataId).values,d=sE(h,i.shape,i.dtype,U(i.shape),c,"max");return n.makeTensorInfo(d.shape,"float32",d.values)}const DR={kernelName:Xe,backendName:"cpu",kernelFunc:$R};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function OR(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,input:o}=e,{filterSize:s,strides:a,pad:l,dimRoundingMode:u}=r;PS([i,o],"maxPool3DGrad");const c=vl(o.shape,s,a,1,l,u),h=n.bufferSync(o),d=aE(h,c),p=c.strideDepth,f=c.strideHeight,g=c.strideWidth,m=c.dilationDepth,y=c.dilationHeight,b=c.dilationWidth,v=c.effectiveFilterDepth,w=c.effectiveFilterHeight,x=c.effectiveFilterWidth,k=v-1-c.padInfo.front,_=x-1-c.padInfo.left,I=w-1-c.padInfo.top,C=As(o.shape,"float32"),S=n.bufferSync(i);for(let T=0;T<c.batchSize;++T)for(let t=0;t<c.inChannels;++t)for(let e=0;e<c.inDepth;++e)for(let n=0;n<c.inHeight;++n)for(let r=0;r<c.inWidth;++r){const i=e-k,o=n-I,s=r-_;let a=0;for(let e=0;e<v;e+=m){const n=(i+e)/p;if(!(n<0||n>=c.outDepth||Math.floor(n)!==n))for(let r=0;r<w;r+=y){const i=(o+r)/f;if(!(i<0||i>=c.outHeight||Math.floor(i)!==i))for(let o=0;o<x;o+=b){const l=(s+o)/g;if(l<0||l>=c.outWidth||Math.floor(l)!==l)continue;const u=v*w*x-1-d.get(T,n,i,l,t),h=e*w*x+r*x+o,p=u===h?1:0;if(0===p)continue;const f=S.get(T,n,i,l,t);a+=f*p}}}C.set(a,T,e,n,r,t)}return n.makeTensorInfo(C.shape,C.dtype,C.values)}const FR={kernelName:Ye,backendName:"cpu",kernelFunc:OR};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function MR(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,input:o,output:s}=e,a=o;PS([o,s],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:h}=r,d=bl(a.shape,l,u,1,c,h),p=n.data.get(a.dataId).values,f=As(d.outShape,a.dtype,oE(p,a.shape,a.dtype,d).values),g=d.strideHeight,m=d.strideWidth,y=d.dilationHeight,b=d.dilationWidth,v=d.effectiveFilterHeight,w=d.effectiveFilterWidth,x=w-1-d.padInfo.left,k=v-1-d.padInfo.top,_=As(a.shape,"float32"),I=n.data.get(i.dataId).values,C=As(i.shape,"float32",I);for(let S=0;S<d.batchSize;++S)for(let t=0;t<d.inChannels;++t)for(let e=0;e<d.inHeight;++e)for(let n=0;n<d.inWidth;++n){const r=e-k,i=n-x;let o=0;for(let e=0;e<v;e+=y){const n=(r+e)/g;if(!(n<0||n>=d.outHeight||Math.floor(n)!==n))for(let r=0;r<w;r+=b){const s=(i+r)/m;if(s<0||s>=d.outWidth||Math.floor(s)!==s)continue;const a=v*w-1-f.get(S,n,s,t),l=e*w+r,u=a===l?1:0;if(0===u)continue;const c=C.get(S,n,s,t);o+=c*u}}_.set(o,S,e,n,t)}return n.makeTensorInfo(_.shape,_.dtype,_.values)}const PR={kernelName:Ke,backendName:"cpu",kernelFunc:MR};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function LR(t,e,n,r,i){const o=U(e),s=iE(t,e,n,o,i,"max"),a=oE(t,e,n,i,!0,r);return[s.values,a.values]}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const zR={kernelName:Je,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{filterSize:i,strides:o,pad:s,includeBatchInIndex:a}=e,l=n;PS(r,"MaxPoolWithArgmax");const u=l.data.get(r.dataId).values,c=bl(r.shape,i,o,[1,1],s),[h,d]=LR(u,r.shape,r.dtype,a,c),p=l.write(h,c.outShape,r.dtype),f=l.write(d,c.outShape,r.dtype);return[{dataId:p,shape:c.outShape,dtype:r.dtype},{dataId:f,shape:c.outShape,dtype:"int32"}]}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function BR(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:o,keepDims:s}=r,a=T(o,i.shape),l=uc(i.shape,a),u=l[1],c=w(u),h=[],d=n.makeTensorInfo([],"float32",new Float32Array([c]));h.push(d);const p=pT({inputs:{x:i},backend:n,attrs:{dtype:"float32"}});h.push(p);const f=oA({inputs:{a:p,b:d},backend:n});h.push(f);const g=DN({inputs:{x:f},backend:n,attrs:{axis:o,keepDims:s}});return h.forEach((t=>n.disposeIntermediateTensorInfo(t))),g}const WR={kernelName:Ze,backendName:"cpu",kernelFunc:BR};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function UR(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:o,keepDims:s}=r;PS(i,"min");const a=T(o,i.shape);let l=a;const u=dc(l,i.shape.length);let c=i;null!=u&&(c=PT({inputs:{x:i},backend:n,attrs:{perm:u}}),l=fc(l.length,i.shape.length)),hc("min",l,c.shape.length);const[h,d]=uc(c.shape,l),p=w(d),f=q(w(h),c.dtype),g=n.data.get(c.dataId).values;for(let y=0;y<f.length;++y){const t=y*p;let e=g[t];for(let n=0;n<p;++n){const r=g[t+n];(Number.isNaN(r)||r<e)&&(e=r)}f[y]=e}null!=u&&n.disposeIntermediateTensorInfo(c);const m=n.makeTensorInfo(h,c.dtype,f);if(s){const t=cc(h,a),e=xT({inputs:{x:m},backend:n,attrs:{shape:t}});return n.disposeIntermediateTensorInfo(m),e}return m}const VR={kernelName:Qe,backendName:"cpu",kernelFunc:UR},jR=XS(((t,e)=>Math.min(t,e))),HR=gT(tn,jR),GR={kernelName:tn,backendName:"cpu",kernelFunc:HR};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function qR(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{paddings:o,mode:s}=r;PS(i,"mirrorPad");const a=o.map(((t,e)=>t[0]+i.shape[e]+t[1])),l=o.map((t=>t[0])),u=o.map(((t,e)=>t[0]+i.shape[e])),c="reflect"===s?0:1,h=n.data.get(i.dataId).values,d=i.shape.length,p=U(i.shape),f=w(a),g=a.length,m=U(a),y=N(i.dtype,f);for(let v=0;v<f;v++){let t=J(v,g,m);for(let n=0;n<g;n++)t[n]<l[n]?t[n]=2*l[n]-t[n]-c:t[n]>=u[n]&&(t[n]=2*(u[n]-1)-t[n]+c);t=t.map(((t,e)=>t-l[e]));const e=Y(t,d,p);y[v]=h[e]}const b=n.write(y,a,i.dtype);return{dataId:b,shape:a,dtype:i.dtype}}const KR={kernelName:en,backendName:"cpu",kernelFunc:qR},XR=XS(((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e})),YR=gT(nn,XR),JR={kernelName:nn,backendName:"cpu",kernelFunc:YR};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function ZR(t){const{inputs:e,backend:n,attrs:r}=t,{logits:i}=e,{dim:o}=r,s=i.shape.length;let a=o;if(-1===a&&(a=s-1),a!==s-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${s} and dim was ${a}`);const l=T([a],i.shape),u=CR({inputs:{x:i},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),c=cc(u.shape,l),h=xT({inputs:{x:u},backend:n,attrs:{shape:c}}),d=uA({inputs:{a:i,b:h},backend:n}),p=JN({inputs:{x:d},backend:n}),f=DN({inputs:{x:p},backend:n,attrs:{axis:l,keepDims:!1}}),g=xT({inputs:{x:f},backend:n,attrs:{shape:c}}),m=oA({inputs:{a:p,b:g},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),m}const QR={kernelName:Xn,backendName:"cpu",kernelFunc:ZR};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function t$(t){const{inputs:e,backend:n,attrs:r}=t,{logits:i}=e,{numSamples:o,seed:s,normalized:a}=r;PS(i,"multinomial");const l=a?i:ZR({inputs:{logits:i},backend:n,attrs:{dim:-1}}),u=l.shape[0],c=l.shape[1],h=n.data.get(l.dataId).values,d=[u,o],p=q(w(d),"int32");for(let f=0;f<u;++f){const t=f*c,e=new Float32Array(c-1);e[0]=h[t];for(let i=1;i<e.length;++i)e[i]=e[i-1]+h[t+i];const n=qc.alea(s.toString()),r=f*o;for(let i=0;i<o;++i){const t=n();p[r+i]=e.length;for(let n=0;n<e.length;n++)if(t<e[n]){p[r+i]=n;break}}}return a||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(d,"int32",p)}const e$={kernelName:rn,backendName:"cpu",kernelFunc:t$};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function n$(t,e,n){const r=ei(-1,n);return NN([],e,r,t,n)}function r$(t){const{inputs:e,backend:n}=t,{x:r}=e;PS(r,"neg");const i=n.data.get(r.dataId).values,[o,s]=n$(i,r.shape,r.dtype);return n.makeTensorInfo(s,r.dtype,o)}const i$={kernelName:sn,backendName:"cpu",kernelFunc:r$},o$=Vd;function s$(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:i,scores:o}=e,{maxOutputSize:s,iouThreshold:a,scoreThreshold:l}=r;PS(i,"NonMaxSuppression");const u=n.data.get(i.dataId).values,c=n.data.get(o.dataId).values,{selectedIndices:h}=o$(u,c,s,a,l);return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}const a$={kernelName:ln,backendName:"cpu",kernelFunc:s$},l$=jd;function u$(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:i,scores:o}=e,{maxOutputSize:s,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:u}=r;PS(i,"NonMaxSuppressionPadded");const c=n.data.get(i.dataId).values,h=n.data.get(o.dataId).values,{selectedIndices:d,validOutputs:p}=l$(c,h,s,a,l,u);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}const c$={kernelName:un,backendName:"cpu",kernelFunc:u$},h$=Hd;function d$(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:i,scores:o}=e,{maxOutputSize:s,iouThreshold:a,scoreThreshold:l,softNmsSigma:u}=r;PS(i,"NonMaxSuppressionWithScore");const c=n.data.get(i.dataId).values,h=n.data.get(o.dataId).values,d=s,p=a,f=l,g=u,{selectedIndices:m,selectedScores:y}=h$(c,h,d,p,f,g);return[n.makeTensorInfo([m.length],"int32",new Int32Array(m)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}const p$={kernelName:cn,backendName:"cpu",kernelFunc:d$},f$=XS(((t,e)=>t!==e?1:0)),g$=gT(an,f$,null,"bool"),m$={kernelName:an,backendName:"cpu",kernelFunc:g$};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function y$(t){const{inputs:e,backend:n,attrs:r}=t,{indices:i}=e,{dtype:o,depth:s,onValue:a,offValue:l}=r;PS(i,"oneHot");const u=w(i.shape),c=new Float32Array(u*s);c.fill(l);const h=n.data.get(i.dataId).values;for(let d=0;d<u;++d)h[d]>=0&&h[d]<s&&(c[d*s+h[d]]=a);return n.makeTensorInfo([...i.shape,s],o,c)}const b$={kernelName:dn,backendName:"cpu",kernelFunc:y$};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function v$(t){const{inputs:e,backend:n}=t,{x:r}=e;if("string"===r.dtype)throw new Error("zerosLike is not supported for string tensors");if("complex64"===r.dtype){const t=cT({inputs:{input:r},backend:n}),e=v$({inputs:{x:t},backend:n}),i=BE({inputs:{input:r},backend:n}),o=v$({inputs:{x:i},backend:n}),s=aT({inputs:{real:e,imag:o},backend:n});return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),s}return bA({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}const w$={kernelName:br,backendName:"cpu",kernelFunc:v$};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function x$(t){const{inputs:e,backend:n}=t,{x:r}=e;if("string"===r.dtype)throw new Error("onesLike is not supported for string tensors");if("complex64"===r.dtype){const t=cT({inputs:{input:r},backend:n}),e=x$({inputs:{x:t},backend:n}),i=BE({inputs:{input:r},backend:n}),o=v$({inputs:{x:i},backend:n}),s=aT({inputs:{real:e,imag:o},backend:n});return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),s}return bA({backend:n,attrs:{shape:r.shape,value:1,dtype:r.dtype}})}const k$={kernelName:hn,backendName:"cpu",kernelFunc:x$};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function _$(t){const{inputs:e,backend:n,attrs:r}=t,{axis:i}=r;if(1===e.length)return QN({inputs:{input:e[0]},backend:n,attrs:{dim:i}});const o=e[0].shape,s=e[0].dtype;e.forEach((t=>{b(o,t.shape,"All tensors passed to stack must have matching shapes"),y(s===t.dtype,(()=>"All tensors passed to stack must have matching dtypes"))}));const a=[],l=e.map((t=>{const e=QN({inputs:{input:t},backend:n,attrs:{dim:i}});return a.push(e),e})),u=UE({inputs:l,backend:n,attrs:{axis:i}});return a.forEach((t=>n.disposeIntermediateTensorInfo(t))),u}const I$={kernelName:pn,backendName:"cpu",kernelFunc:_$};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function C$(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{paddings:o,constantValue:s}=r;PS(i,"pad");const a=o.map(((t,e)=>t[0]+i.shape[e]+t[1])),l=o.map((t=>t[0])),u=n.data.get(i.dataId).values,c=w(i.shape),h=i.shape.length,d=U(i.shape),p=w(a),f=a.length,g=U(a),m=N(i.dtype,p);0!==s&&m.fill(s);for(let b=0;b<c;b++){const t=J(b,h,d),e=t.map(((t,e)=>t+l[e])),n=Y(e,f,g);m[n]=u[b]}const y=n.write(m,a,i.dtype);return{dataId:y,shape:a,dtype:i.dtype}}const S$={kernelName:fn,backendName:"cpu",kernelFunc:C$},T$=XS(((t,e)=>Math.pow(t,e))),E$=gT(gn,T$),N$={kernelName:gn,backendName:"cpu",kernelFunc:E$};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function A$(t,e,n,r){const[i,o]=uc(t,r),s=zi(e,"int32"),a=q(w(i),s),l=w(o);for(let u=0;u<a.length;++u){const t=u*l;let e=1;for(let r=0;r<l;++r)e*=n[t+r];a[u]=e}return{outVals:a,outShape:i,outDtype:s}}function R$(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:o,keepDims:s}=r;PS(i,"prod");const a=i.shape.length,l=T(o,i.shape),u=dc(l,a);let c=l,h=i;const d=[];null!=u&&(h=PT({inputs:{x:i},backend:n,attrs:{perm:u}}),d.push(h),c=fc(c.length,a));const p=n.data.get(h.dataId).values,{outVals:f,outShape:g,outDtype:m}=A$(h.shape,h.dtype,p,c);let y=g;return s&&(y=cc(g,l)),d.forEach((t=>n.disposeIntermediateTensorInfo(t))),n.makeTensorInfo(y,m,f)}const $$={kernelName:yn,backendName:"cpu",kernelFunc:R$};
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function D$(t,e,n){t.forEach(((t,r)=>{if(t<0||t>=n){const i=J(r,e.length,U(e)).join(",");throw new Error(`indices[${i}] = ${t} is not in [0, ${n})`)}}))}function O$(t,e){for(let n=0;n<t.length;++n){const r=t[n],i=n===t.length-1?e:t[n+1].length;if(0===r.length)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>i)throw new Error("Ragged splits must not point past values");for(let t=1;t<r.length;++t)if(r[t-1]>r[t])throw new Error("Ragged splits must be sorted in ascending order")}}function F$(t,e,n,r){const i=[];let o=0;const s=e.length-1+n.length,a=new Array(s).fill(null).map((()=>[0]));O$(n,r);let l=1;for(let u=0;u<e.length-1;++u){l*=e[u];const t=e[u+1];for(let e=1;e<l+1;++e)a[u].push(e*t)}for(let u=0;u<t.length;++u){let r=t[u],s=t[u]+1;for(let t=0;t<n.length;++t){const i=n[t],o=t+e.length-1;if(o>=0){const t=a[o],e=t[t.length-1]-i[r];for(let n=r;n<s;++n)a[o].push(i[n+1]+e)}r=i[r],s=i[s]}s!==r&&(i.push([r,s]),o+=s-r)}return{outSplits:a,valueSlices:i,numValues:o}}function M$(t){const e=[];for(let n=0;n<t.length;++n){const r=t[n].length,i=A("int32",r);e.push(i),t[n].forEach(((t,e)=>i[e]=t))}return e}function P$(t,e){const n=t.slice(0,e);while(n.length<e)n.push(1);for(let r=e;r<t.length;r++)n[e-1]*=t[r];return n}function L$(t,e,n,r,i,o){const s=P$(e,2)[1],a=P$(o,2)[1];let l=0;for(const u of n)for(let e=u[0];e<u[1];++e){for(let n=0;n<r;++n)i[l*a+n]=t[e*s+n];++l}}function z$(t,e,n,r,i){const o=e.slice();o[0]=i;const s=A(n,w(o)),a=t.length,l=0===a?0:a/e[0];return L$(t,e,r,l,s,o),[s,o]}function B$(t,e,n,r,i,o,s,a){if(0===t.length)throw new Error("paramsNestedSplits must be non empty");if(0===e[0].length)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(D$(o,s,l),0===r.length)throw new Error("params.rank must be nonzero");const u=r[0],{outSplits:c,valueSlices:h,numValues:d}=F$(o,s,t,u),p=M$(c),f=z$(n,r,i,h,d);return[p,f[0],f[1]]}
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function W$(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:i,paramsDenseValues:o,indices:s}=e,{outputRaggedRank:a}=r,l=i.map((t=>n.data.get(t.dataId).values)),u=i.map((t=>t.shape)),c=n.data.get(o.dataId).values,h=n.data.get(s.dataId).values,[d,p,f]=B$(l,u,c,o.shape,o.dtype,h,s.shape,a),g=d.map((t=>n.makeTensorInfo([t.length],"int32",t))),m=n.makeTensorInfo(f,o.dtype,p);return g.concat([m])}const U$={kernelName:bn,backendName:"cpu",kernelFunc:W$},V$=2147483647;function j$(t,e,n,r,i,o,s){if(e.length>1)throw new Error("starts must be a scalar or vector");if(i.length>1)throw new Error("limits must be a scalar or vector");if(s.length>1)throw new Error("deltas must be a scalar or vector");const a=0===e.length,l=0===i.length,u=0===s.length,c=[];a||c.push(e[0]),l||c.push(i[0]),u||c.push(s[0]);for(let m=1;m<c.length;++m)if(c[m]!==c[m-1])throw new Error("starts, limits, and deltas must have the same shape");const h=0===c.length?1:c[0],d=A("int32",h+1);d[0]=0;for(let m=0;m<h;++m){const e=a?t[0]:t[m],n=l?r[0]:r[m],i=u?o[0]:o[m];if(0===i)throw new Error("Requires delta != 0");let s;if(i>0&&n<e||i<0&&n>e)s=0;else if(s=Math.ceil(Math.abs((n-e)/i)),s>V$)throw new Error(`Requires ((limit - start) / delta) <= ${V$}`);d[m+1]=d[m]+s}const p=d[h],f=A(n,p);let g=0;for(let m=0;m<h;++m){const e=d[m+1]-d[m];let n=a?t[0]:t[m];const r=u?o[0]:o[m];for(let t=0;t<e;++t)f[g++]=n,n+=r}return[d,f]}
/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function H$(t){const{inputs:e,backend:n}=t,{starts:r,limits:i,deltas:o}=e,s=n.data.get(r.dataId).values,a=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values,[u,c]=j$(s,r.shape,r.dtype,a,i.shape,l,o.shape),h=n.makeTensorInfo([u.length],"int32",u),d=n.makeTensorInfo([c.length],r.dtype,c);return[h,d]}const G$={kernelName:vn,backendName:"cpu",kernelFunc:H$};
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
var q$=jp;class K${constructor(t,e,n,r,i,o,s,a,l,u){this.shape=t,this.shapeShape=e,this.values=n,this.valuesShape=r,this.valuesDType=i,this.defaultValue=o,this.defaultValueShape=s,this.rowPartitionValues=a,this.rowPartitionValuesShapes=l,this.rowPartitionTypes=Gp(u),this.raggedRank=qp(this.rowPartitionTypes)}getRowPartitionTypeByDimension(t){return this.rowPartitionTypes[0]===q$.FIRST_DIM_SIZE?this.rowPartitionTypes[t+1]:this.rowPartitionTypes[t]}getRowPartitionTensor(t){return this.rowPartitionTypes[0]===q$.FIRST_DIM_SIZE?this.rowPartitionValues[t+1]:this.rowPartitionValues[t]}getMaxWidth(t){const e=this.getRowPartitionTensor(t-1);switch(this.getRowPartitionTypeByDimension(t-1)){case q$.VALUE_ROWIDS:return K$.getMaxWidthValueRowID(e);case q$.ROW_SPLITS:return K$.getMaxWidthRowSplit(e);default:throw new Error(`Cannot handle partition type ${q$[this.getRowPartitionTypeByDimension(t-1)]}`)}}static getMaxWidthRowSplit(t){const e=t.length;if(0===e||1===e)return 0;let n=0;for(let r=0;r<e-1;++r){const e=t[r+1]-t[r];e>n&&(n=e)}return n}static getMaxWidthValueRowID(t){const e=t.length;if(0===e)return 0;let n=0,r=t[0],i=0;for(let o=1;o<e;++o){const e=t[o];e!==r&&(r=e,i=Math.max(o-n,i),n=o)}return Math.max(e-n,i)}tensorShapeFromTensor(t,e,n=!0){if(0===e.length){if(-1===t[0])return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return Y$(t,n)}calculateOutputSize(t){const e=this.valuesShape,n=this.defaultValueShape;Kp(n,e);const r=this.tensorShapeFromTensor(this.shape,this.shapeShape),i=Hp(this.raggedRank,r,e),o=i;o[0]<0&&(o[0]=t);for(let s=1;s<=this.raggedRank;++s)o[s]<0&&(o[s]=this.getMaxWidth(s));return o}calculateFirstParentOutputIndex(t,e,n){const r=Math.min(t,n),i=[];let o=0;for(let s=0;s<r;++s,o+=e)i.push(o);for(let s=r;s<t;++s)i.push(-1);return y(i.length===t,(()=>"Final length of result must be equal to firstDimension.")),i}calculateOutputIndexRowSplit(t,e,n,r){const i=t.length,o=[];for(let s=0;s<i-1;++s){const i=t[s+1]-t[s];let a=Math.min(r,i),l=e[s];-1===l&&(a=0);for(let t=0;t<a;++t)o.push(l),l+=n;for(let t=0;t<i-a;++t)o.push(-1)}if(i>0&&o.length!==t[i-1])throw new Error("Invalid row split size.");return o}calculateOutputIndexValueRowID(t,e,n,r){const i=t.length,o=[];if(0===i)return[];let s=0,a=t[0];if(a>=e.length)throw new Error(`Got currentValueRowId=${a}, which is not less than ${e.length}`);let l=e[a];o.push(l);for(let u=1;u<i;++u){const i=t[u];if(i===a)l>=0&&(++s,s<r?l+=n:l=-1);else{if(s=0,a=i,i>=e.length)throw new Error(`Got nextValueRowId=${i} which is not less than ${e.length}`);l=e[i]}o.push(l)}if(o.length!==t.length)throw new Error("Invalid row ids.");return o}calculateOutputIndex(t,e,n,r){const i=this.getRowPartitionTensor(t),o=this.getRowPartitionTypeByDimension(t);switch(o){case q$.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(i,e,n,r);case q$.ROW_SPLITS:if(i.length-1>e.length)throw new Error(`Row partition size is greater than output size: ${i.length-1} > ${e.length}`);return this.calculateOutputIndexRowSplit(i,e,n,r);default:throw new Error(`Unsupported partition type: ${q$[o]}`)}}getFirstDimensionSize(){const t=this.rowPartitionValues[0];if(0===this.rowPartitionTypes.length)throw new Error("No row_partition_types given.");const e=this.rowPartitionTypes[0];switch(e){case q$.FIRST_DIM_SIZE:return t[0];case q$.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case q$.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${q$[e]}`)}}compute(){const t=this.rowPartitionValues[0];if(t.length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const e=this.getFirstDimensionSize(),n=this.calculateOutputSize(e),r=new Array(this.raggedRank+1);r[r.length-1]=1;for(let a=r.length-2;a>=0;--a)r[a]=r[a+1]*n[a+1];const i=Y$(n,!1),o=A(this.valuesDType,w(i)),s=r[0]*n[0];if(s>0){let t=this.calculateFirstParentOutputIndex(e,r[0],n[0]);for(let e=1;e<=this.raggedRank;++e){const i=this.calculateOutputIndex(e-1,t,r[e],n[e]);t=i}this.setOutput(this.raggedRank,t,o,i)}return[i,o]}setOutput(t,e,n,r){if(0===n.length)return;const i=this.values,o=n;let s=r.slice();s=s.slice(t+1);const a=w(s),l=e.length;let u=this.defaultValue;if(u.length!==a&&1!==u.length){const t=this.defaultValueShape;Io((()=>{const e=Pl(u,t),n=Zl(e,s);u=n.dataSync()}))}let c=0,h=0,d=0;for(let p=0;p<=l;++p){let t=p<l?e[p]:-1;if(t!==d){if(h<d){const t=i.subarray(c*a),e=o.subarray(h*a),n=(d-h)*a;X$(e,t,n)}if(p>=l){const e=n.length;t=Math.floor(e/a)}if(t>d)if(1===this.defaultValue.length)o.subarray(d*a,t*a).fill(this.defaultValue[0]),d=t;else while(t>d){const t=o.slice(d*a);X$(t,u,a),++d}t<0?(c=p+1,h=d):(c=p,h=d,d=h+1)}else++d}}}function X$(t,e,n){for(let r=0;r<n;r++)t[r]=e[r]}function Y$(t,e){const n=[];for(let r of t){if(r<0){if(!e)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}n.push(r)}return n}function J$(t,e,n,r,i,o,s,a,l,u){return new K$(t,e,n,r,i,o,s,a,l,u).compute()}
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Z$(t){const{inputs:e,backend:n,attrs:r}=t,{shape:i,values:o,defaultValue:s,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=r,u=n.data.get(i.dataId).values,c=n.data.get(o.dataId).values,h=n.data.get(s.dataId).values,d=a.map((t=>n.data.get(t.dataId).values)),p=a.map((t=>t.shape)),[f,g]=J$(u,i.shape,c,o.shape,o.dtype,h,s.shape,d,p,l);return n.makeTensorInfo(f,o.dtype,g)}const Q$={kernelName:wn,backendName:"cpu",kernelFunc:Z$};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function tD(t,e,n,r){const i=t===e,o=t<e&&n<0,s=e<t&&n>1;if(i||o||s)return q(0,r);const a=Math.abs(Math.ceil((e-t)/n)),l=q(a,r);e<t&&1===n&&(n=-1),l[0]=t;for(let u=1;u<l.length;u++)l[u]=l[u-1]+n;return l}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function eD(t){const{backend:e,attrs:n}=t,{start:r,stop:i,dtype:o,step:s}=n,a=tD(r,i,s,o);return e.makeTensorInfo([a.length],o,a)}const nD={kernelName:xn,backendName:"cpu",kernelFunc:eD},rD=WS(_n,(t=>1/t)),iD={kernelName:_n,backendName:"cpu",kernelFunc:rD};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function oD(t){const{inputs:e,backend:n,attrs:r}=t,{images:i}=e,{alignCorners:o,halfPixelCenters:s,size:a}=r;PS(i,"resizeBilinear");const l=U(i.shape),[u,c]=a,[h,d,p,f]=i.shape,g=n.data.get(i.dataId).values,m=new Float32Array(w([h,u,c,f])),y=[o&&u>1?d-1:d,o&&c>1?p-1:p],b=[o&&u>1?u-1:u,o&&c>1?c-1:c];let v=0;const x=y[0]/b[0],k=y[1]/b[1];for(let w=0;w<h;w++)for(let t=0;t<u;t++){let e;e=s?x*(t+.5)-.5:x*t;const n=Math.max(0,Math.floor(e)),r=e-n,i=Math.min(d-1,Math.ceil(e)),o=w*l[0]+n*l[1],a=w*l[0]+i*l[1];for(let t=0;t<c;t++){let e;e=s?k*(t+.5)-.5:k*t;const n=Math.max(0,Math.floor(e)),i=e-n,u=Math.min(p-1,Math.ceil(e)),c=o+n*l[2],h=a+n*l[2],d=o+u*l[2],y=a+u*l[2];for(let t=0;t<f;t++){const e=g[c+t],n=g[h+t],o=g[d+t],s=g[y+t],a=e+(o-e)*i,l=n+(s-n)*i,u=a+(l-a)*r;m[v++]=u}}}return n.makeTensorInfo([h,u,c,f],"float32",m)}const sD={kernelName:En,backendName:"cpu",kernelFunc:oD};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function aD(t){const{inputs:e,backend:n,attrs:r}=t,{images:i,dy:o}=e,{alignCorners:s}=r;PS([o,i],"resizeBilinearGrad");const a=U(i.shape),[l,u,c,h]=i.shape,[,d,p]=o.shape,f=new Float32Array(l*u*c*h),g=[s&&d>1?u-1:u,s&&p>1?c-1:c],m=[s&&d>1?d-1:d,s&&p>1?p-1:p],y=g[0]/m[0],b=g[1]/m[1],v=n.data.get(o.dataId).values;let w=0;for(let x=0;x<l;x++){const t=x*a[0];for(let e=0;e<d;e++){const n=e*y,r=Math.floor(n),i=Math.min(Math.ceil(n),u-1),o=t+r*a[1],s=t+i*a[1],l=n-r,d=1-l;for(let t=0;t<p;t++){const e=t*b,n=Math.floor(e),r=Math.min(Math.ceil(e),c-1),i=e-n,u=1-i,p=o+n*a[2],g=o+r*a[2],m=s+n*a[2],y=s+r*a[2],x=d*u,k=d*i,_=l*u,I=l*i;for(let t=0;t<h;t++){const e=v[w++];f[p+t]+=e*x,f[g+t]+=e*k,f[m+t]+=e*_,f[y+t]+=e*I}}}}return n.makeTensorInfo([l,c,u,h],"float32",f)}const lD={kernelName:Nn,backendName:"cpu",kernelFunc:aD};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function uD(t){const{inputs:e,backend:n,attrs:r}=t,{images:i}=e,{alignCorners:o,halfPixelCenters:s,size:a}=r;PS(i,"resizeNearestNeighbor");const l=U(i.shape),[u,c]=a,[h,d,p,f]=i.shape,g=n.data.get(i.dataId).values,m=new Float32Array(h*u*c*f),y=[o&&u>1?d-1:d,o&&c>1?p-1:p],b=[o&&u>1?u-1:u,o&&c>1?c-1:c],v=y[0]/b[0],w=y[1]/b[1];let x=0;for(let k=0;k<h;k++){const t=k*l[0];for(let e=0;e<u;e++){const n=s?v*(e+.5):v*e;let r=Math.min(d-1,o?Math.round(n):Math.floor(n));s&&(r=Math.max(0,r));const i=t+r*l[1];for(let t=0;t<c;t++){const e=s?w*(t+.5):w*t;let n=Math.min(p-1,o?Math.round(e):Math.floor(e));s&&(n=Math.max(0,n));const r=i+n*l[2];for(let t=0;t<f;t++){const e=g[r+t];m[x++]=e}}}}return n.makeTensorInfo([h,u,c,f],i.dtype,m)}const cD={kernelName:Sn,backendName:"cpu",kernelFunc:uD};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function hD(t){const{inputs:e,backend:n,attrs:r}=t,{images:i,dy:o}=e,{alignCorners:s}=r;PS([o,i],"resizeNearestNeighborGrad");const a=U(i.shape),l=U(o.shape),[u,c,h,d]=i.shape,[,p,f]=o.shape,g=new Float32Array(u*c*h*d),m=n.data.get(o.dataId).values,y=[s&&p>1?c-1:c,s&&f>1?h-1:h],b=[s&&p>1?p-1:p,s&&f>1?f-1:f],v=y[0]/b[0],w=y[1]/b[1],x=1/v,k=1/w,_=2*Math.ceil(x)+2,I=2*Math.ceil(k)+2;for(let C=0;C<u;C++){const t=C*a[0];for(let e=0;e<c;e++){const n=t+e*a[1],r=Math.floor(e*x),i=Math.floor(r-_/2);for(let o=0;o<h;o++){const r=n+o*a[2],u=Math.floor(o*k),y=Math.floor(u-I/2);for(let n=0;n<d;n++){let a=0;for(let r=0;r<_;r++){const u=r+i;if(u<0||u>=p)continue;const d=t+u*l[1],g=u*v,b=Math.min(c-1,s?Math.round(g):Math.floor(g));if(e===b)for(let t=0;t<I;t++){const e=t+y;if(e<0||e>=f)continue;const r=d+e*l[2],i=e*w,u=Math.min(h-1,s?Math.round(i):Math.floor(i));o===u&&(a+=m[r+n])}}g[r+n]=a}}}}return n.makeTensorInfo(i.shape,i.dtype,g)}const dD={kernelName:Tn,backendName:"cpu",kernelFunc:hD};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function pD(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{dims:o}=r;PS(i,"reverse");const s=i.shape.length,a=T(o,i.shape);if(0===s)return HS({inputs:{x:i},backend:n});const l=new _i(i.shape,i.dtype),u=n.bufferSync(i);for(let c=0;c<l.size;c++){const t=l.indexToLoc(c),e=t.slice();a.forEach((t=>e[t]=i.shape[t]-1-e[t])),l.set(u.get(...e),...t)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}const fD={kernelName:Rn,backendName:"cpu",kernelFunc:pD},gD={kernelName:xr,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:i,fillValue:o,center:s}=e,a=n,l=N(r.dtype,w(r.shape)),[u,c,h,d]=r.shape,[p,f]=Jp(s,c,h),g=255,m=Math.sin(i),y=Math.cos(i),b=a.data.get(r.dataId).values;for(let w=0;w<u;w++){const t=w*h*c*d;for(let e=0;e<c;e++){const n=e*(h*d);for(let r=0;r<h;r++){const i=r*d;for(let s=0;s<d;s++){const a=[u,e,r,s],v=a[2],w=a[1];let x=(v-p)*y-(w-f)*m,k=(v-p)*m+(w-f)*y;x=Math.round(x+p),k=Math.round(k+f);let _=o;if("number"!==typeof o&&(_=3===s?g:o[s]),x>=0&&x<h&&k>=0&&k<c){const e=k*(h*d),n=x*d,r=t+e+n+s;_=b[r]}const I=t+n+i+s;l[I]=_}}}}const v=a.write(l,r.shape,r.dtype);return{dataId:v,shape:r.shape,dtype:r.dtype}}},mD=WS($n,(t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2===0?e:e+1})),yD={kernelName:$n,backendName:"cpu",kernelFunc:mD},bD=BS((t=>1/Math.sqrt(t))),vD=US(Dn,bD),wD={kernelName:Dn,backendName:"cpu",kernelFunc:vD};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function xD(t,e,n,r,i,o,s,a,l,u){const c=[r/i,i],h=t.values,d=e.values;if(0===r)return As(n,e.dtype);const p=l instanceof _i?l:As(c,e.dtype);"string"===typeof l||"number"===typeof l?p.values.fill(l):"boolean"===typeof l&&p.values.fill(+l);for(let f=0;f<o;f++){const t=[];let o=0;for(let e=0;e<s;e++){const n=h[f*s+e];t.push(n),o+=n*a[e]}if(o<0||o>=r/i)throw new Error(`Invalid indices: ${t} does not index into ${n}`);for(let n=0;n<i;n++)u?p.values[o*i+n]+=d[f*i+n]:p.values[o*i+n]=0===e.rank?d[0]:d[f*i+n]}return p}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function kD(t){const{inputs:e,backend:n,attrs:r}=t,{indices:i,updates:o}=e,{shape:s}=r,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:h}=af(o,i,s),d=!0,p=n.bufferSync(i),f=n.bufferSync(o),g=xD(p,f,s,h,u,l,a,c,0,d);return n.makeTensorInfo(s,g.dtype,g.values)}const _D={kernelName:On,backendName:"cpu",kernelFunc:kD};
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function ID(t,e){let n=0,r=t.length,i=0;while(n<r)i=Math.floor((n+r)/2),t[i]<e?n=i+1:r=i;return r}function CD(t,e){let n=0,r=t.length,i=0;while(n<r)i=Math.floor((n+r)/2),t[i]<=e?n=i+1:r=i;return r}function SD(t,e,n,r,i,o){const s=A("int32",n*i);for(let a=0;a<n;++a){const n=t.slice(a*r,(a+1)*r),l=a*i;for(let t=0;t<i;++t)s[l+t]="left"===o?ID(n,e[t+l]):CD(n,e[t+l])}return s}
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function TD(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:i,values:o}=e,{side:s}=r,a=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values,u=SD(a,l,i.shape[0],i.shape[1],o.shape[1],s);return n.makeTensorInfo(o.shape,"int32",u)}const ED={kernelName:Mn,backendName:"cpu",kernelFunc:TD};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function ND(t){const{inputs:e,backend:n}=t,{condition:r,t:i,e:o}=e;PS([r,i,o],"select");const s=r.shape.length,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,u=n.data.get(o.dataId).values,c=zi(i.dtype,o.dtype),h=q(w(i.shape),c);let d=0;const p=0===s||s>1||1===i.shape.length?1:w(i.shape.slice(1));for(let f=0;f<a.length;f++)for(let t=0;t<p;t++)1===a[f]?h[d++]=l[f]:h[d++]=u[f];return n.makeTensorInfo(i.shape,c,h)}const AD={kernelName:Pn,backendName:"cpu",kernelFunc:ND},RD=lf,$D=uf,DD=WS(Ln,(t=>t>=0?$D*t:RD*(Math.exp(t)-1))),OD={kernelName:Ln,backendName:"cpu",kernelFunc:DD},FD=WS(Un,(t=>t<0?-1:t>0?1:0)),MD={kernelName:Un,backendName:"cpu",kernelFunc:FD},PD=WS(Bn,(t=>Math.sin(t))),LD={kernelName:Bn,backendName:"cpu",kernelFunc:PD},zD=WS(Wn,(t=>Math.sinh(t))),BD={kernelName:Wn,backendName:"cpu",kernelFunc:zD},WD=1.1920928955078125e-7,UD=Math.log(WD)+2,VD=WS(jn,(t=>{const e=t>-UD,n=t<UD,r=Math.exp(t);let i;return i=n?r:e?t:Math.log(1+r),i})),jD={kernelName:jn,backendName:"cpu",kernelFunc:VD};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function HD(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{blockShape:o,paddings:s}=r;PS([i],"spaceToBatchND");const a=w(o),l=[[0,0]];l.push(...s);for(let w=1+o.length;w<i.shape.length;++w)l.push([0,0]);const u=S$.kernelFunc({inputs:{x:i},backend:n,attrs:{paddings:l,constantValue:0}}),c=Zp(u.shape,o,a,!1),h=Qp(c.length,o.length,!1),d=tf(u.shape,o,a,!1),p={x:u},f={shape:c},g=xT({inputs:p,backend:n,attrs:f}),m={x:g},y={perm:h},b=PT({inputs:m,backend:n,attrs:y}),v={x:b},x={shape:d},k=xT({inputs:v,backend:n,attrs:x});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(b),k}const GD={kernelName:qn,backendName:"cpu",kernelFunc:HD};
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function qD(t,e,n,r,i,o,s){const a=e[0],l=o[0],u=new Array(l),c=new Array(a),h=e[1];if(0===l){if(0!==a)throw new Error(Ff(a));const t=A(n,0),e=A(i,0);return[t,[0,h],e,u,c]}let d=!0,p=0;const f=new Array(l).fill(0);for(let m=0;m<a;++m){const e=t[m*h];if(e<0)throw new Error(Mf(m,e));if(e>=l)throw new Error(Pf(m,e,l));++f[e],d=d&&e>=p,p=e}let g=!0;for(let m=0;m<l;++m){const t=0===f[m];u[m]=t,g=g&&!t,f[m]=Math.max(f[m],1),m>0&&(f[m]+=f[m-1])}if(g&&d){const e=t,n=r;for(let t=0;t<a;++t)c[t]=t;return[e,[a,h],n,u,c]}{const e=f[l-1],o=A(n,e*h),d=A(i,e),p=new Array(l).fill(0);for(let n=0;n<a;++n){const e=t[n*h],i=p[e],s=(0===e?0:f[e-1])+i;p[e]++;for(let r=0;r<h;++r)o[s*h+r]=t[n*h+r];d[s]=r[n],c[n]=s}for(let t=0;t<l;++t){const e=p[t];if(0===e){const e=0===t?0:f[t-1];o[e*h+0]=t;for(let t=1;t<h;++t)o[e*h+t]=0;d[e]=s}}return[o,[e,h],d,u,c]}}
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function KD(t){const{inputs:e,backend:n}=t,{indices:r,values:i,denseShape:o,defaultValue:s}=e;if(1!==o.shape.length)throw new Error(`Dense shape must be a vector, saw:\n        ${o.shape}`);if(2!==r.shape.length)throw new Error(`Indices must be a matrix, saw:\n        ${r.shape}`);if(1!==i.shape.length)throw new Error(`Values must be a vector, saw:\n        ${i.shape}`);if(0!==s.shape.length)throw new Error(`Default value must be a scalar, saw:\n        ${s.shape}`);const a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,u=n.data.get(o.dataId).values,c=n.data.get(s.dataId).values[0],[h,d,p,f,g]=qD(a,r.shape,r.dtype,l,i.dtype,u,c);return[n.makeTensorInfo(d,r.dtype,h),n.makeTensorInfo([d[0]],i.dtype,p),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map((t=>Number(t))))),n.makeTensorInfo([g.length],r.dtype,new Int32Array(g))]}const XD={kernelName:Yn,backendName:"cpu",kernelFunc:KD};
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function YD(t,e,n,r,i){const o=w(r),s=e[0],a=i.length,l=[];let u=1,c=-1;for(let m=0;m<a;++m){const t=i[m];if(-1===t){if(-1!==c)throw new Error(Lf(c,m));c=m,l.push(1)}else{if(t<0)throw new Error(zf(m,t));u*=t,l.push(t)}}if(-1!==c){if(u<=0)throw new Error(Bf());const t=Math.trunc(o/u);if(u*t!==o)throw new Error(Wf(r,l));l[c]=t}const h=w(l);if(h!==o)throw new Error(Uf(r,l));const d=r.length,p=[];if(d>0){p[d-1]=1;for(let t=d-2;t>=0;--t)p[t]=p[t+1]*r[t+1]}const f=[];if(a>0){f[a-1]=1;for(let t=a-2;t>=0;--t)f[t]=f[t+1]*l[t+1]}const g=A(n,s*a);for(let m=0;m<s;++m){let e=0;for(let n=0;n<d;++n)e+=t[m*d+n]*p[n];for(let t=0;t<a;++t)g[m*a+t]=Math.trunc(e/f[t]),e%=f[t]}return[g,[s,a],l]}
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function JD(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:i,newShape:o}=e;if(2!==r.shape.length)throw new Error(`Input indices should be a matrix but received shape\n        ${r.shape}`);if(1!==i.shape.length)throw new Error(`Input shape should be a vector but received shape\n        ${i.shape}`);if(1!==o.shape.length)throw new Error(`Target shape should be a vector but received shape ${o.shape}`);const s=Array.from(n.data.get(i.dataId).values),a=n.data.get(r.dataId).values,l=Array.from(n.data.get(o.dataId).values),[u,c,h]=YD(a,r.shape,r.dtype,s,l);return[n.makeTensorInfo(c,r.dtype,u),n.makeTensorInfo([h.length],o.dtype,new Int32Array(h))]}const ZD={kernelName:Jn,backendName:"cpu",kernelFunc:JD};
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function QD(t,e,n,r,i,o=!1,s=0){const a=r.length,l=[e[0],t.length/e[0]],u=l[1],c=a>0?i[a-1]+1:0,h=c;if(h<0)throw new Error(Vf());const d=e.slice();d[0]=h;const p=d.reduce(((t,e)=>t*e),1),f=A(n,p);if(0===a)return h>0&&f.fill(s),[f,d];if(h<=0)throw new Error(Vf());let g=0,m=1,y=0,b=i[g];while(1){let e=0;if(m<a){if(e=i[m],b===e){++m;continue}if(b>=e)throw new Error(jf())}if(b<0||b>=h)throw new Error(Hf(b,h));b>y&&f.fill(s,y*u,b*u);for(let n=g;n<m;++n){const e=r[n];if(e<0||e>=l[0])throw new Error(Gf(n,r[n],l[0]));for(let n=0;n<u;n++)f[b*u+n]+=t[e*u+n]}if(o)for(let t=0;t<u;t++)f[b*u+t]/=m-g;if(g=m,++m,y=b+1,b=e,m>a)break}return y<h&&f.fill(s,y*u,h*u),[f,d]}
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function tO(t){const{inputs:e,backend:n}=t,{data:r,indices:i,segmentIds:o}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.shape.length)throw new Error(`Indices should be a vector but received shape\n          ${i.shape}`);if(1!==o.shape.length)throw new Error(`Segment ids should be a vector but received shape\n          ${o.shape}`);if(i.shape[0]!==o.shape[0])throw new Error("segmentIds and indices should have same size.");const s=n.data.get(r.dataId).values,a=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values,[u,c]=QD(s,r.shape,r.dtype,a,l,!0);return n.makeTensorInfo(c,r.dtype,u)}const eO={kernelName:Zn,backendName:"cpu",kernelFunc:tO};
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function nO(t){const{inputs:e,backend:n}=t,{data:r,indices:i,segmentIds:o}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.shape.length)throw new Error(`Indices should be a vector but received shape\n         ${i.shape}`);if(1!==o.shape.length)throw new Error(`Segment ids should be a vector but received shape\n         ${o.shape}`);if(i.shape[0]!==o.shape[0])throw new Error("segmentIds and indices should have same size.");const s=n.data.get(r.dataId).values,a=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values,[u,c]=QD(s,r.shape,r.dtype,a,l);return n.makeTensorInfo(c,r.dtype,u)}const rO={kernelName:Qn,backendName:"cpu",kernelFunc:nO};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function iO(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:i,sparseValues:o,defaultValue:s}=e,{outputShape:a}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:h,outputSize:d}=af(o,i,a),p=!1,f=n.bufferSync(i);let g;switch(o.dtype){case"bool":{const t=n.bufferSync(o),e=Boolean(n.data.get(s.dataId).values[0]);g=xD(f,t,a,d,c,u,l,h,e,p);break}case"float32":{const t=n.bufferSync(o),e=n.data.get(s.dataId).values[0];g=xD(f,t,a,d,c,u,l,h,e,p);break}case"int32":{const t=n.bufferSync(o),e=n.data.get(s.dataId).values[0];g=xD(f,t,a,d,c,u,l,h,e,p);break}case"string":{const t=n.bufferSync(o),e=si(n.data.get(s.dataId).values[0]);g=xD(f,t,a,d,c,u,l,h,e,p);break}default:throw new Error(`Unsupported type ${o.dtype}`)}return n.makeTensorInfo(a,g.dtype,g.values)}const oO={kernelName:tr,backendName:"cpu",kernelFunc:iO};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function sO(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{numOrSizeSplits:o,axis:s}=r,a=T(s,i.shape)[0],l=Of(i,o,a),u=new Array(i.shape.length).fill(0),c=i.shape.slice();return l.map((t=>{const e=[...c];e[a]=t;const r=vE({inputs:{x:i},backend:n,attrs:{begin:u,size:e}});return u[a]+=t,r}))}const aO={kernelName:Kn,backendName:"cpu",kernelFunc:sO},lO=BS((t=>Math.sqrt(t))),uO=WS(Hn,(t=>Math.sqrt(t))),cO={kernelName:Hn,backendName:"cpu",kernelFunc:uO},hO={kernelName:nr,backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,r=e;PS(n,"square");const i=r.data.get(n.dataId).values,o=new Float32Array(i.length);for(let a=0;a<i.length;++a){const t=i[a];o[a]=t*t}const s=r.write(o,n.shape,n.dtype);return{dataId:s,shape:n.shape,dtype:n.dtype}}},dO=XS(((t,e)=>{const n=t-e;return n*n})),pO=gT(er,dO),fO={kernelName:er,backendName:"cpu",kernelFunc:pO},gO=BS(((t,e)=>{const{pattern:n,replaceGlobal:r,rewrite:i}=e;return t.replace(new RegExp(n,r?"g":""),i)})),mO=US(rr,gO),yO={kernelName:rr,backendName:"cpu",kernelFunc:mO},bO=WS(vr,((t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha})),vO={kernelName:vr,backendName:"cpu",kernelFunc:bO};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function wO(t,e,n,r){const i=As(t,e.dtype);for(let o=0;o<i.size;o++){const t=i.indexToLoc(o),s=new Array(t.length);for(let e=0;e<s.length;e++)s[e]=t[e]*n[e]+r[e];i.set(e.get(...s),...t)}return i}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function xO(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{begin:o,end:s,strides:a,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:h,shrinkAxisMask:d}=r;PS(i,"stridedSlice");const{finalShapeSparse:p,finalShape:f,isIdentity:g,sliceDim0:m,isSimpleSlice:b,begin:v,end:w,strides:x}=ll(i.shape,o,s,a,l,u,c,h,d);let k;if(g)k=xT({inputs:{x:i},backend:n,attrs:{shape:f}});else if(m||b){y(i.shape.length>=1,(()=>`Input must have rank at least 1, got: ${i.shape.length}`));const t=Xa(v,w,x),e=vE({inputs:{x:i},backend:n,attrs:{begin:v,size:t}});k=xT({inputs:{x:e},backend:n,attrs:{shape:f}}),n.disposeIntermediateTensorInfo(e)}else{const t=n.bufferSync(i),e=wO(p,t,x,v);k=n.makeTensorInfo(f,e.dtype,e.values)}return k}const kO={kernelName:ir,backendName:"cpu",kernelFunc:xO};
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class _O{constructor(t,e,n,r,i,o){this.separator=oi(t),this.nGramWidths=e,this.leftPad=oi(n),this.rightPad=oi(r),this.padWidth=i,this.preserveShort=o}getPadWidth(t){return Math.min(this.padWidth<0?t-1:this.padWidth,t-1)}getNumNGrams(t,e){const n=this.getPadWidth(e);return Math.max(0,t+2*n-e+1)}createNGrams(t,e,n,r,i,o){for(let s=0;s<i;++s){const a=this.getPadWidth(o),l=Math.max(0,a-s),u=Math.max(0,a-(i-(s+1))),c=o-(l+u),h=e+(l>0?0:s-a);let d=0;d+=l*this.leftPad.length;for(let e=0;e<c;++e)d+=t[h+e].length;d+=u*this.rightPad.length;const p=l+u+c-1;d+=p*this.separator.length,n[r+s]=new Uint8Array(d);const f=n[r+s];let g=0;const m=t=>t.forEach((t=>f[g++]=t));for(let t=0;t<l;++t)m(this.leftPad),m(this.separator);for(let e=0;e<c-1;++e)m(t[h+e]),m(this.separator);if(c>0){m(t[h+c-1]);for(let t=0;t<u;++t)m(this.separator),m(this.rightPad)}else{for(let t=0;t<u-1;++t)m(this.rightPad),m(this.separator);m(this.rightPad)}}}compute(t,e){const n=t.length,r=e.length;if(r>0){let t=e[0];if(0!==t)throw new Error(`First split value must be 0, got ${t}`);for(let i=1;i<r;++i){let r=e[i]>=t;if(r=r&&e[i]<=n,!r)throw new Error(`Invalid split value ${e[i]}, must be in [${t}, ${n}]`);t=e[i]}if(t!==n)throw new Error(`Last split value must be data size. Expected ${n}, got ${t}`)}const i=r-1,o=A("int32",r);if(0===n||0===r){const t=new Array(n);for(let e=0;e<=i;++e)o[e]=0;return[t,o]}o[0]=0;for(let a=1;a<=i;++a){const t=e[a]-e[a-1];let n=0;this.nGramWidths.forEach((e=>{n+=this.getNumNGrams(t,e)})),this.preserveShort&&t>0&&0===n&&(n=1),o[a]=o[a-1]+n}const s=new Array(o[i]);for(let a=0;a<i;++a){const n=e[a];let r=o[a];if(this.nGramWidths.forEach((i=>{const o=e[a+1]-e[a],l=this.getNumNGrams(o,i);this.createNGrams(t,n,s,r,l,i),r+=l})),this.preserveShort&&r===o[a]){const i=e[a+1]-e[a];if(0===i)continue;const o=i+2*this.padWidth,l=1;this.createNGrams(t,n,s,r,l,o)}}return[s,o]}}function IO(t,e,n,r,i,o,s,a){return new _O(n,r,i,o,s,a).compute(t,e)}
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function CO(t){const{inputs:e,backend:n,attrs:r}=t,{separator:i,nGramWidths:o,leftPad:s,rightPad:a,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:h}=e,d=n.data.get(c.dataId).values,p=n.data.get(h.dataId).values,[f,g]=IO(d,p,i,o,s,a,l,u);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(h.shape,"int32",g)]}const SO={kernelName:or,backendName:"cpu",kernelFunc:CO};
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function TO(t,e,n,r){if(!t.length)return;if(0===e.length){for(let e=0;e<t.length;++e)r.push(t.subarray(e,e+1));return}if(1===e.length){const i=e[0];let o=t.indexOf(i);while(-1!==o){const e=t.subarray(0,o);n&&0===e.length||r.push(e),t=t.subarray(o+1),o=t.indexOf(i)}return void(n&&0===t.length||r.push(t))}let i=0;for(let o=0;o<t.length+1;o++)if(o===t.length||-1!==e.indexOf(t[o])){const e=t.subarray(i,o);n&&0===e.length||r.push(e),i=o+1}}function EO(t,e,n){const r=t.length,i=[];let o=0,s=0;const a=new Array(r);for(let d=0;d<r;++d){const r=i.length;TO(t[d],e,n,i);const l=i.length-r;a[d]=l,o+=l,s=Math.max(s,l)}const l=A("int32",2*o),u=new Array(o),c=[r,s];let h=0;for(let d=0;d<r;++d)for(let t=0;t<a[d];++t)l[2*h]=d,l[2*h+1]=t,u[h]=i[h],++h;return[l,u,c]}
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function NO(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:i}=r,{input:o,delimiter:s}=e;if("string"!==o.dtype)throw new Error("Input must be of datatype string");if(1!==o.shape.length)throw new Error(`Input must be a vector, got shape: ${o.shape}`);if(0!==s.shape.length)throw new Error(`Delimiter must be a scalar, got shape: ${s.shape}`);const a=n.data.get(o.dataId).values,l=n.data.get(s.dataId).values[0],[u,c,h]=EO(a,l,i),d=c.length;return[n.makeTensorInfo([d,2],"int32",u),n.makeTensorInfo([d],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(h))]}const AO={kernelName:sr,backendName:"cpu",kernelFunc:NO};
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function RO(t,e){const n=A("int32",t.length);for(let r=0;r<t.length;++r)n[r]=ti(t[r]).modulo(e).getLowBitsUnsigned();return n}
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function $O(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:i}=r,{input:o}=e;if("string"!==o.dtype)throw new Error("Input must be of datatype string");if(i<=0)throw new Error("Number of buckets must be at least 1");const s=n.data.get(o.dataId).values,a=RO(s,i);return n.makeTensorInfo(o.shape,"int32",a)}const DO={kernelName:ar,backendName:"cpu",kernelFunc:$O},OO=WS(ur,(t=>Math.tan(t))),FO={kernelName:ur,backendName:"cpu",kernelFunc:OO},MO=WS(cr,(t=>Math.tanh(t))),PO={kernelName:cr,backendName:"cpu",kernelFunc:MO};
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function LO(t){const{inputs:e,backend:n}=t,{tensor:r,indices:i,updates:o}=e,{sliceRank:s,numUpdates:a,sliceSize:l,strides:u,outputSize:c}=af(o,i,r.shape),h=!1,d=n.bufferSync(i),p=n.bufferSync(o),f=n.bufferSync(r),g=xD(d,p,r.shape,c,l,a,s,u,f,h);return n.makeTensorInfo(r.shape,g.dtype,g.values)}const zO={kernelName:Fn,backendName:"cpu",kernelFunc:LO};
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function BO(t,e){const n=new Array(t.rank);for(let i=0;i<n.length;i++)n[i]=t.shape[i]*e[i];const r=As(n,t.dtype);for(let i=0;i<r.values.length;++i){const e=r.indexToLoc(i),n=new Array(t.rank);for(let r=0;r<n.length;r++)n[r]=e[r]%t.shape[r];const o=t.locToIndex(n);r.values[i]=t.values[o]}return r}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function WO(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{reps:o}=r;PS(i,"tile");const s=BO(n.bufferSync(i),o);return n.makeTensorInfo(s.shape,s.dtype,s.values)}const UO={kernelName:hr,backendName:"cpu",kernelFunc:WO},VO=(t,e)=>{const n=e.value-t.value;return 0===n?t.index-e.index:n};function jO(t,e,n=0,r=t.length-1){while(r>n){if(r-n>600){const i=r-n+1,o=e-n+1,s=Math.log(i),a=.5*Math.exp(2*s/3),l=.5*Math.sqrt(s*a*(i-a)/i)*Math.sign(o-i/2),u=Math.max(n,Math.floor(e-o*a/i+l)),c=Math.min(r,Math.floor(e+(i-o)*a/i+l));jO(t,e,u,c)}const i=t[e];let o=n,s=r;g(t,n,e),VO(t[r],i)>0&&g(t,n,r);while(o<s){g(t,o,s),o++,s--;while(VO(t[o],i)<0)o+=1;while(VO(t[s],i)>0)s-=1}0===VO(t[n],i)?g(t,n,s):(s+=1,g(t,s,r)),s<=e&&(n=s+1),e<=s&&(r=s-1)}}function HO(t,e,n,r,i){const o=e[e.length-1],[s,a]=[t.length/o,o],l=N(n,s*r),u=N("int32",s*r);for(let h=0;h<s;h++){const e=h*a,n=t.subarray(e,e+a);let o=new Array(n.length);n.forEach(((t,e)=>o[e]={value:t,index:e})),r<o.length&&(jO(o,r),o=o.slice(0,r)),i&&o.sort(VO);const s=h*r,c=l.subarray(s,s+r),d=u.subarray(s,s+r);for(let t=0;t<r;t++)c[t]=o[t].value,d[t]=o[t].index}const c=e.slice();return c[c.length-1]=r,[As(c,n,l),As(c,"int32",u)]}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function GO(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{k:o,sorted:s}=r;PS(i,"topk");const a=n.data.get(i.dataId).values,[l,u]=HO(a,i.shape,i.dtype,o,s);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(u.shape,u.dtype,u.values)]}const qO={kernelName:dr,backendName:"cpu",kernelFunc:GO};
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function KO(t){const{inputs:e,attrs:n,backend:r}=t,{image:i,transforms:o}=e,{interpolation:s,fillMode:a,fillValue:l,outputShape:u}=n,[c,h,d,p]=i.shape,[f,g]=null!=u?u:[h,d],m=[c,f,g,p],y=U(i.shape),b=y[0],v=y[1],x=y[2],k=U(m),_=k[0],I=k[1],C=k[2],S=N(i.dtype,w(m));S.fill(l);const T=r.data.get(i.dataId).values,E=r.data.get(o.dataId).values;for(let w=0;w<c;++w){const t=1===o.shape[0]?E:E.subarray(8*w,8*w+8);for(let e=0;e<f;++e)for(let n=0;n<g;++n)for(let r=0;r<p;++r){let i;const o=t[6]*n+t[7]*e+1;if(0===o)continue;const u=(t[0]*n+t[1]*e+t[2])/o,c=(t[3]*n+t[4]*e+t[5])/o,p=YO(u,d,a),f=YO(c,h,a);switch(s){case"nearest":i=nF(T,h,d,b,v,x,w,f,p,r,l);break;case"bilinear":i=rF(T,h,d,b,v,x,w,f,p,r,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${s}`)}const g=w*_+e*I+n*C+r;S[g]=i}return r.makeTensorInfo(m,i.dtype,S)}const A=r.write(S,m,i.dtype);return{dataId:A,shape:i.shape,dtype:i.dtype}}const XO={kernelName:pr,backendName:"cpu",kernelFunc:KO};function YO(t,e,n){switch(n){case"reflect":return JO(t,e);case"wrap":return ZO(t,e);case"nearest":return tF(t,e);case"constant":default:return QO(t,e)}}function JO(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const t=2*e;n<t&&(n=t*Math.trunc(-n/t)+n),n=n<-e?n+t:-n-1}else if(n>e-1)if(e<=1)n=0;else{const t=2*e;n-=t*Math.trunc(n/t),n>=e&&(n=t-n-1)}return p(0,n,e-1)}function ZO(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const t=e-1;n+=e*(Math.trunc(-n/t)+1)}else if(n>e-1)if(e<=1)n=0;else{const t=e-1;n-=e*Math.trunc(n/t)}return p(0,n,e-1)}function QO(t,e){return t}function tF(t,e){return p(0,t,e-1)}function eF(t,e,n,r,i,o,s,a,l,u,c){const h=s*r+a*i+l*o+u;return 0<=a&&a<e&&0<=l&&l<n?t[h]:c}function nF(t,e,n,r,i,o,s,a,l,u,c){const h=Math.round(a),d=Math.round(l);return eF(t,e,n,r,i,o,s,h,d,u,c)}function rF(t,e,n,r,i,o,s,a,l,u,c){const h=Math.floor(a),d=Math.floor(l),p=h+1,f=d+1,g=(f-l)*eF(t,e,n,r,i,o,s,h,d,u,c)+(l-d)*eF(t,e,n,r,i,o,s,h,f,u,c),m=(f-l)*eF(t,e,n,r,i,o,s,p,d,u,c)+(l-d)*eF(t,e,n,r,i,o,s,p,f,u,c);return(p-a)*g+(a-h)*m}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function iF(t,e,n,r){const i=T(e,n)[0],o=[1,n[0],1];for(let f=0;f<i;f++)o[0]*=n[f];o[1]=n[i];for(let f=i+1;f<n.length;f++)o[2]*=n[f];const s=new Map,a=new Int32Array(n[i]),l=new _i(o,r,t),u=[],c=1===o[0]&&1===o[2];for(let f=0;f<n[i];f++){let e;if(c)e=t[f].toString();else{const t=[];for(let e=0;e<o[0];e++)for(let n=0;n<o[2];n++)t.push(l.get(e,f,n));e=t.join(",")}const n=s.get(e);if(null!=n)a[f]=n;else{const t=s.size;s.set(e,t),a[f]=t,u.push(f)}}const h=o.slice();h[1]=s.size;const d=new _i(h,r);u.forEach(((t,e)=>{for(let n=0;n<o[0];n++)for(let r=0;r<o[2];r++)d.set(l.get(n,t,r),n,e,r)}));const p=n.slice();return p[i]=h[1],{outputValues:d.values,outputShape:p,indices:a}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function oF(t){const{inputs:e,attrs:n,backend:r}=t,{axis:i}=n,{x:o}=e;PS(o,"unique");const s=r.data.get(o.dataId).values,{outputValues:a,outputShape:l,indices:u}=iF(s,i,o.shape,o.dtype);return[r.makeTensorInfo(l,o.dtype,a),r.makeTensorInfo([u.length],"int32",u)]}const sF={kernelName:gr,backendName:"cpu",kernelFunc:oF};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function aF(t){const{inputs:e,backend:n,attrs:r}=t,{value:i}=e;let{axis:o}=r;o<0&&(o+=i.shape.length);const s=i.shape.length,a=i.shape[o],l=new Array(s-1);let u=0;for(let p=0;p<s;p++)p!==o&&(l[u++]=i.shape[p]);const c=new Array(s).fill(0),h=i.shape.slice();h[o]=1;const d=new Array(a);for(let p=0;p<d.length;p++){c[o]=p;const t=vE({inputs:{x:i},backend:n,attrs:{begin:c,size:h}});d[p]=xT({inputs:{x:t},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(t)}return d}const lF={kernelName:mr,backendName:"cpu",kernelFunc:aF};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function uF(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,segmentIds:o}=e,{numSegments:s}=r;PS(i,"unsortedSegmentSum");const a=i.shape.length,l=o.shape.length,u=[],c=[],h=a-l;let d=o;for(let f=0;f<h;++f){const t=QN({inputs:{input:d},backend:n,attrs:{dim:f+1}});d=t,c.push(t)}for(let f=0;f<s;++f){const t=ei(f,"int32"),e=n.makeTensorInfo([],"int32",t),r=BN({inputs:{a:e,b:d},backend:n}),o=pT({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),s=RN({inputs:{a:o,b:i},backend:n}),a=DN({inputs:{x:s},backend:n,attrs:{axis:0,keepDims:!1}});u.push(a),c.push(e),c.push(r),c.push(o),c.push(s),c.push(a)}const p=_$({inputs:u,backend:n,attrs:{axis:0}});return c.forEach((t=>n.disposeIntermediateTensorInfo(t))),p}const cF={kernelName:yr,backendName:"cpu",kernelFunc:uF},hF=[ST,NT,RT,DT,wT,FT,BT,UT,jT,GT,KT,YT,ZT,eE,rE,uE,hE,pE,gE,IT,yE,kE,SE,NE,RE,fT,OE,ME,lT,LE,VE,HE,qE,XE,JE,QE,eN,rN,oN,aN,uN,hN,pN,gN,yN,vN,xN,_N,IN,CN,SN,EN,MN,jS,LN,WN,XN,ZN,tA,rA,yA,vA,xA,IA,TA,NA,RA,OA,PA,BA,VA,GS,HA,WE,qA,XA,JA,KS,tR,rR,sR,uR,hR,fR,mR,vR,xR,_R,SR,NR,RR,DR,FR,PR,zR,WR,VR,GR,KR,JR,e$,$N,i$,a$,c$,p$,m$,b$,k$,I$,S$,N$,ZS,$$,U$,G$,Q$,nD,hT,sA,iD,tT,nT,kT,sD,lD,cD,dD,fD,gD,yD,wD,_D,ED,AD,OD,oT,MD,LD,BD,wE,QR,jD,GD,XD,ZD,eO,rO,oO,aO,cO,hO,fO,yO,vO,kO,SO,AO,DO,cA,ON,FO,PO,zO,UO,qO,XO,LT,sF,lF,cF,w$];for(const ZX of hF)$r(ZX);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const dF={},pF={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function fF(t,e){dF[t]=e}function gF(t,e){if(!(t in dF)||null!=e){const n=yF(t,e);if(null===n)return console.log("Could not get context for WebGL version",t),null;dF[t]=n}const n=dF[t];return null==n||n.isContextLost()?(delete dF[t],gF(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),dF[t])}function mF(t){if(it().getBool("IS_SAFARI")||"undefined"===typeof OffscreenCanvas||2!==t){if("undefined"!==typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}return new OffscreenCanvas(300,150)}function yF(t,e){if(1!==t&&2!==t)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=null==e?mF(t):e;return n.addEventListener("webglcontextlost",(e=>{e.preventDefault(),delete dF[t]}),!1),it().getBool("SOFTWARE_WEBGL_ENABLED")&&(pF.failIfMajorPerformanceCaveat=!1),1===t?n.getContext("webgl",pF)||n.getContext("experimental-webgl",pF):n.getContext("webgl2",pF)}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
var bF,vF,wF;function xF(t,e){return[e,t]}function kF(t,e){return t*e}function _F(t){const e=w(t),n=Math.ceil(e/4);return _(n)}function IF(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function CF(t,e){const[n,r]=IF(t,e);return n*r*4}function SF(t,e){const n=t;let r,i,o,s,a,l,u,c,h,d;return 2===it().getNumber("WEBGL_VERSION")?(r=n.R32F,i=n.R16F,o=n.RGBA16F,s=n.RGBA32F,a=n.RED,u=4,c=1,h=n.HALF_FLOAT,d=n.FLOAT,l=n.RGBA8):(r=t.RGBA,i=t.RGBA,o=t.RGBA,s=n.RGBA,a=t.RGBA,u=4,c=4,h=null!=e?e.HALF_FLOAT_OES:null,d=t.FLOAT,l=t.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:i,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:s,textureFormatFloat:a,downloadTextureFormat:l,downloadUnpackNumChannels:u,defaultNumChannels:c,textureTypeHalfFloat:h,textureTypeFloat:d}}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function TF(t,e){const n=e();return it().getBool("DEBUG")&&EF(t),n}function EF(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+$F(t,e))}(function(t){t[t["DENSE"]=0]="DENSE",t[t["SHARED_BATCH"]=1]="SHARED_BATCH"})(bF||(bF={})),function(t){t[t["RENDER"]=0]="RENDER",t[t["UPLOAD"]=1]="UPLOAD",t[t["PIXELS"]=2]="PIXELS",t[t["DOWNLOAD"]=3]="DOWNLOAD"}(vF||(vF={})),function(t){t[t["UNPACKED_FLOAT16"]=0]="UNPACKED_FLOAT16",t[t["UNPACKED_FLOAT32"]=1]="UNPACKED_FLOAT32",t[t["PACKED_4X1_UNSIGNED_BYTE"]=2]="PACKED_4X1_UNSIGNED_BYTE",t[t["PACKED_2X2_FLOAT32"]=3]="PACKED_2X2_FLOAT32",t[t["PACKED_2X2_FLOAT16"]=4]="PACKED_2X2_FLOAT16"}(wF||(wF={}));const NF=5.96e-8,AF=65504;function RF(t){return!!(it().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===t||NF<Math.abs(t)&&Math.abs(t)<AF)}function $F(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function DF(t,e){return eM(t,(()=>t.getExtension(e)),'Extension "'+e+'" not supported on this browser.')}function OF(t,e){const n=eM(t,(()=>t.createShader(t.VERTEX_SHADER)),"Unable to create vertex WebGLShader.");if(TF(t,(()=>t.shaderSource(n,e))),TF(t,(()=>t.compileShader(n))),!1===t.getShaderParameter(n,t.COMPILE_STATUS))throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function FF(t,e){const n=eM(t,(()=>t.createShader(t.FRAGMENT_SHADER)),"Unable to create fragment WebGLShader.");if(TF(t,(()=>t.shaderSource(n,e))),TF(t,(()=>t.compileShader(n))),it().get("ENGINE_COMPILE_ONLY"))return n;if(!1===t.getShaderParameter(n,t.COMPILE_STATUS))throw PF(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const MF=/ERROR: [0-9]+:([0-9]+):/g;function PF(t,e){const n=MF.exec(e);if(null==n)return console.log(`Couldn't parse line number in error: ${e}`),void console.log(t);const r=+n[1],i=t.split("\n"),o=i.length.toString().length+2,s=i.map(((t,e)=>I((e+1).toString(),o)+t));let a=0;for(let h=0;h<s.length;h++)a=Math.max(s[h].length,a);const l=s.slice(0,r-1),u=s.slice(r-1,r),c=s.slice(r);console.log(l.join("\n")),console.log(e.split("\n")[0]),console.log(`%c ${I(u[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(c.join("\n"))}function LF(t){return eM(t,(()=>t.createProgram()),"Unable to create WebGLProgram.")}function zF(t,e){if(TF(t,(()=>t.linkProgram(e))),!it().get("ENGINE_COMPILE_ONLY")&&!1===t.getProgramParameter(e,t.LINK_STATUS))throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function BF(t,e){if(TF(t,(()=>t.validateProgram(e))),!1===t.getProgramParameter(e,t.VALIDATE_STATUS))throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function WF(t,e){const n=eM(t,(()=>t.createBuffer()),"Unable to create WebGLBuffer");return TF(t,(()=>t.bindBuffer(t.ARRAY_BUFFER,n))),TF(t,(()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW))),n}function UF(t,e){const n=eM(t,(()=>t.createBuffer()),"Unable to create WebGLBuffer");return TF(t,(()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n))),TF(t,(()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW))),n}function VF(t){return eM(t,(()=>t.createTexture()),"Unable to create WebGLTexture.")}function jF(t,e){const n=it().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const n=`[${t}x${e}]`;throw new Error("Requested texture size "+n+" is invalid.")}if(t>n||e>n){const r=`[${t}x${e}]`,i=`[${n}x${n}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+i+".")}}function HF(t){return eM(t,(()=>t.createFramebuffer()),"Unable to create WebGLFramebuffer.")}function GF(t,e,n,r,i,o,s){const a=t.getAttribLocation(e,n);return-1!==a&&(TF(t,(()=>t.bindBuffer(t.ARRAY_BUFFER,r))),TF(t,(()=>t.vertexAttribPointer(a,i,t.FLOAT,!1,o,s))),TF(t,(()=>t.enableVertexAttribArray(a))),!0)}function qF(t,e,n){nM(t,n),TF(t,(()=>t.activeTexture(t.TEXTURE0+n))),TF(t,(()=>t.bindTexture(t.TEXTURE_2D,e)))}function KF(t,e,n){return eM(t,(()=>t.getUniformLocation(e,n)),'uniform "'+n+'" not present in program.')}function XF(t,e,n){return t.getUniformLocation(e,n)}function YF(t,e,n,r){TF(t,(()=>qF(t,e,r))),TF(t,(()=>t.uniform1i(n,r)))}function JF(t,e,n){TF(t,(()=>t.bindFramebuffer(t.FRAMEBUFFER,n))),TF(t,(()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0)))}function ZF(t,e){TF(t,(()=>t.bindFramebuffer(t.FRAMEBUFFER,e))),TF(t,(()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0)))}function QF(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+tM(t,e))}function tM(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function eM(t,e,n){const r=TF(t,(()=>e()));if(null==r)throw new Error(n);return r}function nM(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n){const t=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${t}.`)}}function rM(t,e=2){return w(t.slice(0,t.length-e))}function iM(t){if(0===t.length)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function oM(t){let e=[1,1,1];const n=0===t.length||1===t.length&&1===t[0];return n||(e=[rM(t),...iM(t)]),e}function sM(t,e=!1){let n=it().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=it().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");if(r===1/0&&it().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),e&&(n*=2,r*=2,t=t.map(((e,n)=>n>=t.length-2?f(t[n]):t[n])),1===t.length&&(t=[2,t[0]])),2!==t.length){const e=E(t);t=e.newShape}let i=w(t),o=null;t.length<=1&&i<=n?o=[1,i]:2===t.length&&t[0]<=n&&t[1]<=n?o=t:3===t.length&&t[0]*t[1]<=n&&t[2]<=n?o=[t[0]*t[1],t[2]]:3===t.length&&t[0]<=n&&t[1]*t[2]<=n?o=[t[0],t[1]*t[2]]:4===t.length&&t[0]*t[1]*t[2]<=n&&t[3]<=n?o=[t[0]*t[1]*t[2],t[3]]:4===t.length&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(o=[t[0],t[1]*t[2]*t[3]]);const s=null!=o&&Math.max(...o)>r&&Math.min(...o)<=(e?2:1)&&Math.min(...o)>0;if(null==o||s)if(e){const e=rM(t);let n=2,r=2;t.length&&([n,r]=iM(t)),i=e*(n/2)*(r/2),o=_(i).map((t=>2*t))}else o=_(i);return o}function aM(t){return t%2===0}function lM(t,e){if(t=t.slice(-2),e=e.slice(-2),x(t,e))return!0;if(!t.length||!e.length)return!0;if(0===t[0]||0===t[1]||0===e[0]||0===e[1])return!0;if(t.length!==e.length){const n=t[t.length-1],r=e[e.length-1];if(n===r)return!0;if(aM(n)&&aM(r)&&(1===t[0]||1===e[0]))return!0}return t[1]===e[1]&&aM(t[0])&&aM(e[0])}let uM,cM;function hM(t){if(null==uM){const e=gF(t);uM=e.getParameter(e.MAX_TEXTURE_SIZE)}return uM}function dM(t){if(null==cM){const e=gF(t);cM=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,cM)}function pM(t){if(0===t)return 0;let e;const n=gF(t);return e=fM(n,"EXT_disjoint_timer_query_webgl2")&&2===t?2:fM(n,"EXT_disjoint_timer_query")?1:0,e}function fM(t,e){const n=t.getExtension(e);return null!=n}function gM(t){try{const e=gF(t);if(null!=e)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function mM(t){if(0===t)return!1;const e=gF(t);if(1===t){if(!fM(e,"OES_texture_float"))return!1}else if(!fM(e,"EXT_color_buffer_float"))return!1;const n=bM(e);return n}function yM(t){if(0===t)return!1;const e=gF(t);if(1!==t){if(fM(e,"EXT_color_buffer_float"))return bM(e);const t="EXT_color_buffer_half_float";if(fM(e,t)){const n=e.getExtension(t);return vM(e,n)}return!1}if(!fM(e,"OES_texture_float"))return!1;if(!fM(e,"WEBGL_color_buffer_float"))return!1;const n=bM(e);return n}function bM(t){const e=SF(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n);const r=1,i=1;t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,r,i,0,e.textureFormatFloat,e.textureTypeFloat,null);const o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const s=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(o),s}function vM(t,e){const n=SF(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r);const i=1,o=1;t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,i,o,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const s=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,s),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);const a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(s),a}function wM(t){if(2!==t)return!1;const e=gF(t),n=null!=e.fenceSync;return n}function xM(t,e){Array.isArray(t)||(t=[t]),t.forEach((t=>{null!=t&&y("complex64"!==t.dtype,(()=>`${e} does not support complex64 tensors in the WebGL backend.`))}))}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const kM=it();
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function _M(){let t,e,n,r,i,o,s,a,l,u;return 2===it().getNumber("WEBGL_VERSION")?(t="#version 300 es",e="in",n="out",r="in",i="texture",o="outputColor",s="out vec4 outputColor;",a=it().getBool("WEBGL2_ISNAN_CUSTOM")?"\n      bool isnan_custom(float val) {\n        uint floatToUint = floatBitsToUint(val);\n        return (floatToUint & 0x7fffffffu) > 0x7f800000u;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ":"",l="",u="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(t="",e="attribute",n="varying",r="varying",i="texture2D",o="gl_FragColor",s="",a="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",l="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",u="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:i,output:o,defineOutput:s,defineSpecialNaN:a,defineSpecialInf:l,defineRound:u}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function IM(t,e,n="index"){const r=U(e);return r.map(((e,i)=>{const o=`int ${t[i]} = ${n} / ${e}`,s=i===r.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * ${e}`:`index -= ${t[i]} * ${e}`;return`${o}; ${s};`})).join("")}function CM(t,e,n="index"){const r=U(e);return r.map(((e,i)=>{const o=`int ${t[i]} = ${n} / outShapeStrides[${i}]`,s=i===r.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * outShapeStrides[${i}]`:`index -= ${t[i]} * outShapeStrides[${i}]`;return`${o}; ${s};`})).join("")}function SM(t,e){const n=t.length,r=t.map((t=>`${e}[${t}]`)),i=new Array(n-1);i[n-2]=r[n-1];for(let o=n-3;o>=0;--o)i[o]=`(${i[o+1]} * ${r[o+1]})`;return i}function TM(t,e,n="index"){const r=t.map(((t,e)=>e)),i=SM(r,e);return i.map(((e,r)=>{const o=`int ${t[r]} = ${n} / ${i[r]}`,s=r===i.length-1?`int ${t[r+1]} = ${n} - ${t[r]} * ${i[r]}`:`index -= ${t[r]} * ${i[r]}`;return`${o}; ${s};`})).join("")}function EM(t){const e=U(t).map((t=>t.toString()));return`\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;\n  }\n`}function NM(){return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n"}kM.registerFlag("HAS_WEBGL",(()=>kM.getNumber("WEBGL_VERSION")>0)),kM.registerFlag("WEBGL_VERSION",(()=>gM(2)?2:gM(1)?1:0)),kM.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",(()=>!1)),kM.registerFlag("WEBGL_BUFFER_SUPPORTED",(()=>2===kM.get("WEBGL_VERSION"))),kM.registerFlag("WEBGL_CPU_FORWARD",(()=>!0)),kM.registerFlag("WEBGL_FORCE_F16_TEXTURES",(()=>!1)),kM.registerFlag("WEBGL_PACK",(()=>kM.getBool("HAS_WEBGL"))),kM.registerFlag("WEBGL_PACK_NORMALIZATION",(()=>kM.getBool("WEBGL_PACK"))),kM.registerFlag("WEBGL_PACK_CLIP",(()=>kM.getBool("WEBGL_PACK"))),kM.registerFlag("WEBGL_PACK_DEPTHWISECONV",(()=>kM.getBool("WEBGL_PACK"))),kM.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(()=>kM.getBool("WEBGL_PACK"))),kM.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(()=>kM.getBool("WEBGL_PACK"))),kM.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(()=>kM.getBool("WEBGL_PACK"))),kM.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(()=>kM.getBool("WEBGL_PACK"))),kM.registerFlag("WEBGL_PACK_REDUCE",(()=>kM.getBool("WEBGL_PACK"))),kM.registerFlag("WEBGL_LAZILY_UNPACK",(()=>kM.getBool("WEBGL_PACK"))),kM.registerFlag("WEBGL_CONV_IM2COL",(()=>kM.getBool("WEBGL_PACK"))),kM.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",(()=>kM.getBool("WEBGL_PACK"))),kM.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(()=>hM(kM.getNumber("WEBGL_VERSION")))),kM.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(()=>dM(kM.getNumber("WEBGL_VERSION")))),kM.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(()=>{const t=kM.getNumber("WEBGL_VERSION");return 0===t?0:pM(t)})),kM.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(()=>kM.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!ro())),kM.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(()=>mM(kM.getNumber("WEBGL_VERSION")))),kM.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(()=>!kM.getBool("WEBGL_FORCE_F16_TEXTURES")&&kM.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))),kM.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(()=>yM(kM.getNumber("WEBGL_VERSION")))),kM.registerFlag("WEBGL_FENCE_API_ENABLED",(()=>wM(kM.getNumber("WEBGL_VERSION")))),kM.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(()=>{const t=kM.getBool("WEBGL_RENDER_FLOAT32_ENABLED");return t?4:0})),kM.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",(()=>-1),(t=>{if("number"!==typeof t)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${t}.`);if(t<0&&-1!==t)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)})),kM.registerFlag("WEBGL_FLUSH_THRESHOLD",(()=>ro()?1:-1),(t=>{if("number"!==typeof t)throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${t}.`);if(t<0&&-1!==t)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)})),kM.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",(()=>128)),kM.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",(()=>!1)),kM.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",(()=>1e5)),kM.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",(()=>128)),kM.registerFlag("WEBGL_EXP_CONV",(()=>!1)),kM.registerFlag("SOFTWARE_WEBGL_ENABLED",(()=>kM.getBool("IS_TEST"))),kM.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",(()=>1/0)),kM.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",(()=>!1)),kM.registerFlag("WEBGL2_ISNAN_CUSTOM",(()=>!1)),kM.registerFlag("ENGINE_COMPILE_ONLY",(()=>!1));const AM="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",{getBroadcastDims:RM}=o;function $M(t,e,n){const r=[];if(t.forEach((t=>{const e=w(t.shapeInfo.logicalShape);if(t.shapeInfo.isUniform?r.push(`uniform float ${t.name}${e>1?`[${e}]`:""};`):(r.push(`uniform sampler2D ${t.name};`),r.push(`uniform int offset${t.name};`)),n.enableShapeUniforms){const{uniformShape:e}=wP(n.packedInputs,t.shapeInfo.logicalShape,t.shapeInfo.texShape);switch(e.length){case 1:r.push(`uniform int ${t.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${t.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${t.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${t.name}Shape;`);break;default:break}r.push(`uniform ivec2 ${t.name}TexShape;`)}})),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break;default:break}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach((t=>{r.push(`uniform ${t.type} ${t.name}${t.arrayIndex?`[${t.arrayIndex}]`:""};`)}));const i=r.join("\n"),o=t.map((t=>FM(t,e,n.packedInputs,n.enableShapeUniforms))).join("\n"),s=e.texShape,a=_M(),l=LM(a);let u,c,h=WM(a);e.isPacked?(u=MM(e.logicalShape,s,n.enableShapeUniforms),c=BM(a)):(u=PM(e.logicalShape,s,n.enableShapeUniforms),c=zM(a)),n.packedInputs&&(h+=HM);const d=[h,l,c,i,u,o,n.userCode].join("\n");return d}function DM(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return oP(t,e);case 1:return aP(t,e);case 2:return uP(t,e);case 3:return hP(t,e);case 4:return pP(t,e);case 5:return fP(t);case 6:return gP(t);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function OM(t,e){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return iP(t);case 1:return sP(t,e);case 2:return lP(t,e);case 3:return cP(t,e);default:return dP(t,e)}}function FM(t,e,n=!1,r){let i="";i+=n?OM(t,r):DM(t,r);const o=t.shapeInfo.logicalShape,s=e.logicalShape;return o.length<=s.length&&(i+=n?yP(t,e):bP(t,e)),i}function MM(t,e,n){switch(t.length){case 0:return GM();case 1:return qM(t,e,n);case 2:return eP(t,e,n);case 3:return XM(t,e,n);default:return JM(t,e,n)}}function PM(t,e,n){switch(t.length){case 0:return GM();case 1:return KM(t,e,n);case 2:return nP(t,e,n);case 3:return YM(t,e,n);case 4:return ZM(t,e,n);case 5:return QM(t,e);case 6:return tP(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function LM(t){return`\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ${t.texture2D}(textureSampler, uv).r;\n    }\n  `}function zM(t){return`\n    void setOutput(float val) {\n      ${t.output} = vec4(val, 0, 0, 0);\n    }\n  `}function BM(t){return`\n    void setOutput(vec4 val) {\n      ${t.output} = val;\n    }\n  `}function WM(t){const e=`${t.version}\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ${t.varyingFs} vec2 resultUV;\n    ${t.defineOutput}\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ${t.defineSpecialNaN}\n    ${t.defineSpecialInf}\n    ${t.defineRound}\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ${UM}\n    ${VM}\n    ${jM}\n  `;return e}const UM="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",VM="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",jM="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",HM="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function GM(){return"\n    int getOutputCoords() {\n      return 0;\n    }\n  "}function qM(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return 1===r[0]?n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));\n      }\n    ":`\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ${r[1]}.0);\n      }\n    `:1===r[1]?n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));\n      }\n    ":`\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ${r[0]}.0);\n      }\n    `:n?"\n    int getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);\n    }\n  ":`\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);\n    }\n  `}function KM(t,e,n){return 1===e[0]?n?"\n      int getOutputCoords() {\n        return int(resultUV.x * float(outTexShape[1]));\n      }\n    ":`\n      int getOutputCoords() {\n        return int(resultUV.x * ${e[1]}.0);\n      }\n    `:1===e[1]?n?"\n      int getOutputCoords() {\n        return int(resultUV.y * float(outTexShape[0]));\n      }\n    ":`\n      int getOutputCoords() {\n        return int(resultUV.y * ${e[0]}.0);\n      }\n    `:n?"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      return resTexRC.x * outTexShape[1] + resTexRC.y;\n    }\n  ":`\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${e[0]}, ${e[1]}));\n      return resTexRC.x * ${e[1]} + resTexRC.y;\n    }\n  `}function XM(t,e,n){if(n)return"\n    ivec3 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],i=Math.ceil(t[2]/2),o=i*Math.ceil(t[1]/2);return`\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n      int index = resTexRC.x * ${r[1]} + resTexRC.y;\n\n      int b = index / ${o};\n      index -= b * ${o};\n\n      int r = 2 * (index / ${i});\n      int c = imod(index, ${i}) * 2;\n\n      return ivec3(b, r, c);\n    }\n  `}function YM(t,e,n){if(n){const e=CM(["r","c","d"],t);return`\n  ivec3 getOutputCoords() {\n    ivec2 resTexRC = ivec2(resultUV.yx *\n                           vec2(outTexShape[0], outTexShape[1]));\n    int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n    ${e}\n    return ivec3(r, c, d);\n  }\n`}const r=IM(["r","c","d"],t);return`\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${e[0]}, ${e[1]}));\n      int index = resTexRC.x * ${e[1]} + resTexRC.y;\n      ${r}\n      return ivec3(r, c, d);\n    }\n  `}function JM(t,e,n){if(n)return"\n    ivec4 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatchN = texelsInBatch * outShape[1];\n\n      int b2 = index / texelsInBatchN;\n      index -= b2 * texelsInBatchN;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec4(b2, b, r, c);\n    }\n  ";const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],i=Math.ceil(t[t.length-1]/2),o=i*Math.ceil(t[t.length-2]/2);let s=o,a="",l="b, r, c";for(let u=2;u<t.length-1;u++)s*=t[t.length-u-1],a=`\n      int b${u} = index / ${s};\n      index -= b${u} * ${s};\n    `+a,l=`b${u}, `+l;return`\n    ivec${t.length} getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n      int index = resTexRC.x * ${r[1]} + resTexRC.y;\n\n      ${a}\n\n      int b = index / ${o};\n      index -= b * ${o};\n\n      int r = 2 * (index / ${i});\n      int c = imod(index, ${i}) * 2;\n\n      return ivec${t.length}(${l});\n    }\n  `}function ZM(t,e,n){if(n){const e=CM(["r","c","d","d2"],t);return`\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      ${e}\n      return ivec4(r, c, d, d2);\n    }\n  `}const r=IM(["r","c","d","d2"],t);return`\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(${e[0]}, ${e[1]}));\n      int index = resTexRC.x * ${e[1]} + resTexRC.y;\n      ${r}\n      return ivec4(r, c, d, d2);\n    }\n  `}function QM(t,e){const n=IM(["r","c","d","d2","d3"],t);return`\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},\n                             ${e[1]}));\n\n      int index = resTexRC.x * ${e[1]} + resTexRC.y;\n\n      ${n}\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  `}function tP(t,e){const n=IM(["r","c","d","d2","d3","d4"],t);return`\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(${e[0]}, ${e[1]}));\n      int index = resTexRC.x * ${e[1]} + resTexRC.y;\n\n      ${n}\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  `}function eP(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(x(t,e))return n?"\n      ivec2 getOutputCoords() {\n        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));\n      }\n    `;const i=Math.ceil(t[1]/2);return n?"\n    ivec2 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec2(r, c);\n    }\n  ":`\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n\n      int index = resTexRC.x * ${r[1]} + resTexRC.y;\n      int r = 2 * (index / ${i});\n      int c = imod(index, ${i}) * 2;\n\n      return ivec2(r, c);\n    }\n  `}function nP(t,e,n){return x(t,e)?n?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));\n      }\n    `:1===t[1]?n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(${e[0]}, ${e[1]}));\n        int index = resTexRC.x * ${e[1]} + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    `:1===t[0]?n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(${e[0]}, ${e[1]}));\n        int index = resTexRC.x * ${e[1]} + resTexRC.y;\n        return ivec2(0, index);\n      }\n    `:n?"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      int r = index / outShape[1];\n      int c = index - r * outShape[1];\n      return ivec2(r, c);\n    }\n  ":`\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${e[0]}, ${e[1]}));\n      int index = resTexRC.x * ${e[1]} + resTexRC.y;\n      int r = index / ${t[1]};\n      int c = index - r * ${t[1]};\n      return ivec2(r, c);\n    }\n  `}function rP(t){return`offset${t}`}function iP(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=_M();return`\n    vec4 ${n}() {\n      return ${r.texture2D}(${e}, halfCR);\n    }\n  `}function oP(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${r}() {return ${n};}`;const[i,o]=t.shapeInfo.texShape;if(1===i&&1===o)return`\n      float ${r}() {\n        return sampleTexture(${n}, halfCR);\n      }\n    `;const s=rP(n);if(e)return`\n    float ${r}() {\n      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${s});\n      return sampleTexture(${n}, uv);\n    }\n  `;const[a,l]=t.shapeInfo.texShape;return`\n    float ${r}() {\n      vec2 uv = uvFromFlat(${a}, ${l}, ${s});\n      return sampleTexture(${n}, uv);\n    }\n  `}function sP(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t.shapeInfo.texShape,o=_M();if(e)return`\n    vec4 ${r}(int index) {\n      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));\n      vec2 uv = packedUVfrom1D(\n        packedTexShape[0], packedTexShape[1], index);\n      return ${o.texture2D}(${n}, uv);\n    }\n  `;const s=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];return`\n    vec4 ${r}(int index) {\n      vec2 uv = packedUVfrom1D(\n        ${s[0]}, ${s[1]}, index);\n      return ${o.texture2D}(${n}, uv);\n    }\n  `}function aP(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`\n      float ${r}(int index) {\n        ${mP(t)}\n      }\n    `;const i=t.shapeInfo.texShape,o=i[0],s=i[1];if(1===s&&1===o)return`\n      float ${r}(int index) {\n        return sampleTexture(${n}, halfCR);\n      }\n    `;const a=rP(n);return 1===s?e?`\n      float ${r}(int index) {\n        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${n}TexShape[0]));\n        return sampleTexture(${n}, uv);\n      }\n    `:`\n      float ${r}(int index) {\n        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${o}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `:1===o?e?`\n      float ${r}(int index) {\n        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${n}TexShape[1]), 0.5);\n        return sampleTexture(${n}, uv);\n      }\n    `:`\n      float ${r}(int index) {\n        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${s}.0, 0.5);\n        return sampleTexture(${n}, uv);\n      }\n    `:e?`\n    float ${r}(int index) {\n      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${a});\n      return sampleTexture(${n}, uv);\n    }\n  `:`\n    float ${r}(int index) {\n      vec2 uv = uvFromFlat(${o}, ${s}, index + ${a});\n      return sampleTexture(${n}, uv);\n    }\n  `}function lP(t,e){const n=t.shapeInfo.logicalShape,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t.shapeInfo.texShape,s=o[0],a=o[1],l=_M();if(null!=o&&x(n,o))return e?`\n      vec4 ${i}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);\n\n        return ${l.texture2D}(${r}, uv);\n      }\n    `:`\n      vec4 ${i}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${s}.0);\n\n        return ${l.texture2D}(${r}, uv);\n      }\n    `;if(e)return`\n    vec4 ${i}(int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);\n      return ${l.texture2D}(${r}, uv);\n    }\n  `;const u=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],c=Math.ceil(n[1]/2);return`\n    vec4 ${i}(int row, int col) {\n      vec2 uv = packedUVfrom2D(${c}, ${u[0]}, ${u[1]}, row, col);\n      return ${l.texture2D}(${r}, uv);\n    }\n  `}function uP(t,e){const n=t.shapeInfo.logicalShape,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t.shapeInfo.texShape;if(null!=o&&x(n,o)){if(e)return`\n      float ${i}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `;const t=o[0],n=o[1];return`\n    float ${i}(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(${n}.0, ${t}.0);\n      return sampleTexture(${r}, uv);\n    }\n  `}const{newShape:s,keptDims:a}=E(n),l=s;if(l.length<n.length){const n=xP(t,l),r=["row","col"];return`\n      ${DM(n,e)}\n      float ${i}(int row, int col) {\n        return ${i}(${kP(r,a)});\n      }\n    `}if(t.shapeInfo.isUniform)return`\n      float ${i}(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));\n        ${mP(t)}\n      }\n    `;const u=o[0],c=o[1],h=rP(r);return 1===c?e?`\n      float ${i}(int row, int col) {\n        float index = dot(vec3(row, col, ${h}), vec3(${r}Shape[1], 1, 1));\n        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n    float ${i}(int row, int col) {\n      float index = dot(vec3(row, col, ${h}), vec3(${n[1]}, 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);\n      return sampleTexture(${r}, uv);\n    }\n  `:1===u?e?`\n      float ${i}(int row, int col) {\n        float index = dot(vec3(row, col, ${h}), vec3(${r}Shape[1], 1, 1));\n        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n    float ${i}(int row, int col) {\n      float index = dot(vec3(row, col, ${h}), vec3(${n[1]}, 1, 1));\n      vec2 uv = vec2((index + 0.5) / ${c}.0, 0.5);\n      return sampleTexture(${r}, uv);\n    }\n  `:e?`\n      float ${i}(int row, int col) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ${r}Shape[1] + col + ${h};\n        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n  float ${i}(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ${n[1]} + col + ${h};\n    vec2 uv = uvFromFlat(${u}, ${c}, index);\n    return sampleTexture(${r}, uv);\n  }\n`}function cP(t,e){const n=t.shapeInfo.logicalShape,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t.shapeInfo.texShape,s=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];if(1===n[0]){const r=n.slice(1),o=[1,2],s=xP(t,r),a=["b","row","col"];return`\n        ${OM(s,e)}\n        vec4 ${i}(int b, int row, int col) {\n          return ${i}(${kP(a,o)});\n        }\n      `}const a=_M();if(e)return`\n    vec4 ${i}(int b, int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom3D(\n        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);\n      return ${a.texture2D}(${r}, uv);\n    }\n  `;const l=s[0],u=s[1],c=Math.ceil(n[2]/2),h=c*Math.ceil(n[1]/2);return`\n    vec4 ${i}(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ${l}, ${u}, ${h}, ${c}, b, row, col);\n      return ${a.texture2D}(${r}, uv);\n    }\n  `}function hP(t,e){const n=t.shapeInfo.logicalShape,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[1]*n[2],s=n[2],{newShape:a,keptDims:l}=E(n),u=a;if(u.length<n.length){const n=xP(t,u),r=["row","col","depth"];return`\n        ${DM(n,e)}\n        float ${i}(int row, int col, int depth) {\n          return ${i}(${kP(r,l)});\n        }\n      `}if(t.shapeInfo.isUniform)return`\n      float ${i}(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(${o}, ${s}, 1)));\n        ${mP(t)}\n      }\n    `;const c=t.shapeInfo.texShape,h=c[0],d=c[1],p=t.shapeInfo.flatOffset;if(d===o&&null==p)return e?`\n      float ${i}(int row, int col, int depth) {\n        int stride1 = ${r}Shape[2];\n        float texR = float(row);\n        float texC = dot(vec2(col, depth), vec2(stride1, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n        float ${i}(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(${s}, 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(${d}.0, ${h}.0);\n          return sampleTexture(${r}, uv);\n        }\n      `;if(d===s&&null==p)return e?`\n      float ${i}(int row, int col, int depth) {\n        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));\n        float texC = float(depth);\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n    float ${i}(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${d}.0, ${h}.0);\n      return sampleTexture(${r}, uv);\n    }\n  `;const f=rP(r);return e?`\n    float ${i}(int row, int col, int depth) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int stride0 = ${r}Shape[1] * ${r}Shape[2];\n      int stride1 = ${r}Shape[2];\n      int index = row * stride0 + col * stride1 + depth + ${f};\n      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);\n      return sampleTexture(${r}, uv);\n    }\n    `:`\n      float ${i}(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ${o} + col * ${s} + depth + ${f};\n        vec2 uv = uvFromFlat(${h}, ${d}, index);\n        return sampleTexture(${r}, uv);\n      }\n  `}function dP(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=_M();if(e)return`\n    vec4 ${r}(int b2, int b, int row, int col) {\n      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));\n      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);\n      texelsInBatch *= ${n}Shape[1];\n      index = b2 * texelsInBatch + index;\n      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));\n      int texR = index / packedTexShape[1];\n      int texC = index - texR * packedTexShape[1];\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${i.texture2D}(${n}, uv);\n    }\n  `;const o=t.shapeInfo.logicalShape,s=o.length,a=t.shapeInfo.texShape,l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],u=l[0],c=l[1],h=Math.ceil(o[s-1]/2);let d=h*Math.ceil(o[s-2]/2),p="int b, int row, int col",f=`b * ${d} + (row / 2) * ${h} + (col / 2)`;for(let g=2;g<s-1;g++)p=`int b${g}, `+p,d*=o[s-g-1],f=`b${g} * ${d} + `+f;return`\n    vec4 ${r}(${p}) {\n      int index = ${f};\n      int texR = index / ${c};\n      int texC = index - texR * ${c};\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${c}, ${u});\n      return ${i.texture2D}(${n}, uv);\n    }\n  `}function pP(t,e){const n=t.shapeInfo.logicalShape,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[3],s=n[2]*o,a=n[1]*s,{newShape:l,keptDims:u}=E(n);if(l.length<n.length){const n=xP(t,l),r=["row","col","depth","depth2"];return`\n      ${DM(n,e)}\n      float ${i}(int row, int col, int depth, int depth2) {\n        return ${i}(${kP(r,u)});\n      }\n    `}if(t.shapeInfo.isUniform)return`\n      float ${i}(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(${a}, ${s}, ${o}, 1)));\n        ${mP(t)}\n      }\n    `;const c=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,d=h[0],p=h[1],f=`int stride2 = ${r}Shape[3];`,g=`int stride1 = ${r}Shape[2] * stride2;`,m=`int stride0 = ${r}Shape[1] * stride1;`;if(p===a&&null==c)return e?`\n      float ${i}(int row, int col, int depth, int depth2) {\n        ${f}\n        ${g}\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(stride1, stride2, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n      float ${i}(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(${s}, ${o}, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${p}.0, ${d}.0);\n        return sampleTexture(${r}, uv);\n      }\n    `;if(p===o&&null==c)return e?`\n      float ${i}(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n      float ${i}(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(${n[1]*n[2]}, ${n[2]}, 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${p}.0, ${d}.0);\n        return sampleTexture(${r}, uv);\n      }\n    `;const y=rP(r);return e?`\n    float ${i}(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      ${f}\n      ${g}\n      ${m}\n      int index = row * stride0 + col * stride1 +\n          depth * stride2 + depth2;\n      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${y});\n      return sampleTexture(${r}, uv);\n    }\n  `:`\n    float ${i}(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${a} + col * ${s} +\n          depth * ${o} + depth2;\n      vec2 uv = uvFromFlat(${d}, ${p}, index + ${y});\n      return sampleTexture(${r}, uv);\n    }\n  `}function fP(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=e[4],o=e[3]*i,s=e[2]*o,a=e[1]*s,{newShape:l,keptDims:u}=E(e);if(l.length<e.length){const e=xP(t,l),n=["row","col","depth","depth2","depth3"];return`\n      ${DM(e)}\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        return ${r}(${kP(n,u)});\n      }\n    `}if(t.shapeInfo.isUniform)return`\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(${a}, ${s}, ${o}, ${i})) +\n          depth3;\n        ${mP(t)}\n      }\n    `;const c=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,d=h[0],p=h[1];if(p===a&&null==c)return`\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(${s}, ${o}, ${i}, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${p}.0, ${d}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `;if(p===i&&null==c)return`\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(${e[1]*e[2]*e[3]},\n               ${e[2]*e[3]}, ${e[3]}, 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${p}.0, ${d}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `;const f=rP(n);return`\n    float ${r}(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${a} + col * ${s} + depth * ${o} +\n          depth2 * ${i} + depth3 + ${f};\n      vec2 uv = uvFromFlat(${d}, ${p}, index);\n      return sampleTexture(${n}, uv);\n    }\n  `}function gP(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:i,keptDims:o}=E(e);if(i.length<e.length){const e=xP(t,i),n=["row","col","depth","depth2","depth3","depth4"];return`\n      ${DM(e)}\n      float ${r}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ${r}(${kP(n,o)});\n      }\n    `}const s=e[5],a=e[4]*s,l=e[3]*a,u=e[2]*l,c=e[1]*u;if(t.shapeInfo.isUniform)return`\n      float ${r}(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(${c}, ${u}, ${l}, ${a})) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(${s}, 1)));\n        ${mP(t)}\n      }\n    `;const h=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,p=d[0],f=d[1];if(f===c&&null==h)return`\n      float ${r}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(${u}, ${l}, ${a}, ${s})) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${f}.0, ${p}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `;if(f===s&&null==h)return`\n      float ${r}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(${e[1]*e[2]*e[3]*e[4]},\n               ${e[2]*e[3]*e[4]},\n               ${e[3]*e[4]},\n               ${e[4]})) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${f}.0, ${p}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `;const g=rP(n);return`\n    float ${r}(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${c} + col * ${u} + depth * ${l} +\n          depth2 * ${a} + depth3 * ${s} + depth4 + ${g};\n      vec2 uv = uvFromFlat(${p}, ${f}, index);\n      return sampleTexture(${n}, uv);\n    }\n  `}function mP(t){const e=t.name,n=w(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`\n    for (int i = 0; i < ${n}; i++) {\n      if (i == index) {\n        return ${e}[i];\n      }\n    }\n  `}function yP(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",o=t.shapeInfo.logicalShape.length,s=e.logicalShape.length,a=RM(t.shapeInfo.logicalShape,e.logicalShape),l=vP(s),u=s-o;let c;const h=["x","y","z","w","u","v"];c=0===o?"":s<2&&a.length>=1?"coords = 0;":a.map((t=>`coords.${h[t+u]} = 0;`)).join("\n");let d="";d=s<2&&o>0?"coords":t.shapeInfo.logicalShape.map(((t,e)=>`coords.${h[e+u]}`)).join(", ");let p="return outputValue;";const f=w(t.shapeInfo.logicalShape),g=1===f,m=w(e.logicalShape),y=1===m;if(1!==o||g||y){if(g&&!y)p=1===s?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(a.length){const t=o-2,e=o-1;a.indexOf(t)>-1&&a.indexOf(e)>-1?p="return vec4(outputValue.x);":a.indexOf(t)>-1?p="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(e)>-1&&(p="return vec4(outputValue.xx, outputValue.zz);")}}else p="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return`\n    vec4 ${i}() {\n      ${l} coords = getOutputCoords();\n      ${c}\n      vec4 outputValue = get${r}(${d});\n      ${p}\n    }\n  `}function bP(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",o=e.texShape,s=t.shapeInfo.texShape,a=t.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!t.shapeInfo.isUniform&&a===l&&null==t.shapeInfo.flatOffset&&x(s,o))return`\n      float ${i}() {\n        return sampleTexture(${n}, resultUV);\n      }\n    `;const u=vP(l),c=RM(t.shapeInfo.logicalShape,e.logicalShape),h=l-a;let d;const p=["x","y","z","w","u","v"];d=0===a?"":l<2&&c.length>=1?"coords = 0;":c.map((t=>`coords.${p[t+h]} = 0;`)).join("\n");let f="";return f=l<2&&a>0?"coords":t.shapeInfo.logicalShape.map(((t,e)=>`coords.${p[e+h]}`)).join(", "),`\n    float ${i}() {\n      ${u} coords = getOutputCoords();\n      ${d}\n      return get${r}(${f});\n    }\n  `}function vP(t){if(t<=1)return"int";if(2===t)return"ivec2";if(3===t)return"ivec3";if(4===t)return"ivec4";if(5===t)return"ivec5";if(6===t)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function wP(t,e,n){const{newShape:r,keptDims:i}=E(e),o=e.length,s=t&&3===o&&1===e[0],a=s?e.slice(1):r,l=!t&&o>1&&!x(e,n)&&r.length<o||s,u=l?a:e;return{useSqueezeShape:l,uniformShape:u,keptDims:i}}function xP(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function kP(t,e){return e.map((e=>t[e])).join(", ")}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function _P(t,e,n,r){const i=n.map(((t,n)=>{const r={logicalShape:t.shape,texShape:t.isUniform?null:t.texData.texShape,isUniform:t.isUniform,isPacked:!t.isUniform&&t.texData.isPacked,flatOffset:null};return null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0&&(r.flatOffset=t.texData.slice.flatOffset),{name:e.variableNames[n],shapeInfo:r}})),o=i.map((t=>t.shapeInfo)),s={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},a=$M(i,s,e),l=FF(t.gl,a),u=t.createProgram(l);return it().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:a,webGLProgram:u,inShapeInfos:o,outShapeInfo:s,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(t.buildVao(u),Object.assign({program:e,fragmentShader:l,source:a,webGLProgram:u,inShapeInfos:o,outShapeInfo:s},IP(t,e,u)))}function IP(t,e,n){const r=[],i=[];let o,s,a,l=null,u=null;u=t.getUniformLocation(n,"NAN",!1),1===it().getNumber("WEBGL_VERSION")&&(l=t.getUniformLocation(n,"INFINITY",!1));const c=!1;for(const h of e.variableNames){const i={name:h,uniform:t.getUniformLocation(n,h,c),offset:t.getUniformLocation(n,`offset${h}`,c)};e.enableShapeUniforms&&(i.shape=t.getUniformLocation(n,`${h}Shape`,c),i.texShape=t.getUniformLocation(n,`${h}TexShape`,c)),r.push(i)}if(e.enableShapeUniforms&&(o=t.getUniformLocation(n,"outShape",c),a=t.getUniformLocation(n,"outShapeStrides",c),s=t.getUniformLocation(n,"outTexShape",c)),e.customUniforms)for(const h of e.customUniforms)i.push(t.getUniformLocation(n,h.name,c));return{variablesLocations:r,customUniformLocations:i,infLoc:l,nanLoc:u,outShapeLocation:o,outShapeStridesLocation:a,outTexShapeLocation:s}}function CP(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach(((t,n)=>{const r=t.logicalShape,i=e[n],o=i.shape;if(!x(r,o))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${r} and ${o} must match`);if(t.isUniform&&i.isUniform)return;const s=t.texShape,a=i.isUniform?null:i.texData.texShape;if(!x(s,a))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${s} and ${a} must match`)}))}function SP(t,e,n,r,i){e.program.enableShapeUniforms||(CP(e.inShapeInfos,n),CP([e.outShapeInfo],[r]));const o=r.texData.texture,s=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(o.texture,s[0],s[1]):t.setOutputMatrixTexture(o.texture,s[0],s[1]),t.setProgram(e.webGLProgram),t.bindVertexArray(e.webGLProgram.vao),1===it().getNumber("WEBGL_VERSION")&&null!==e.infLoc&&t.gl.uniform1f(e.infLoc,1/0),null!==e.nanLoc&&t.gl.uniform1f(e.nanLoc,NaN);for(let l=0;l<n.length;++l){const r=n[l],{uniform:i,offset:o,shape:s,texShape:a}=e.variablesLocations[l];if(s){const{uniformShape:n}=wP(e.program.packedInputs,r.shape,r.texData.texShape);switch(n.length){case 1:t.gl.uniform1iv(s,new Int32Array(n));break;case 2:t.gl.uniform2iv(s,new Int32Array(n));break;case 3:t.gl.uniform3iv(s,new Int32Array(n));break;case 4:t.gl.uniform4iv(s,new Int32Array(n));break;default:break}}if(a&&t.gl.uniform2i(a,r.texData.texShape[0],r.texData.texShape[1]),null!=i)if(r.isUniform)if(w(r.shape)<2)t.gl.uniform1f(i,r.uniformValues[0]);else{let e=r.uniformValues;e instanceof Float32Array||(e=new Float32Array(e)),t.gl.uniform1fv(i,e)}else null!=r.texData.slice&&null!=o&&t.gl.uniform1i(o,r.texData.slice.flatOffset),t.setInputMatrixTexture(r.texData.texture.texture,i,l)}const a=e.outShapeLocation;if(a)switch(r.shape.length){case 1:t.gl.uniform1iv(a,new Int32Array(r.shape));break;case 2:t.gl.uniform2iv(a,new Int32Array(r.shape));break;case 3:t.gl.uniform3iv(a,new Int32Array(r.shape));break;case 4:t.gl.uniform4iv(a,new Int32Array(r.shape));break;default:break}if(e.outShapeStridesLocation){const n=U(r.shape);switch(r.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(n));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(n));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(n));break;default:break}}if(e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),e.program.customUniforms&&i)for(let l=0;l<e.program.customUniforms.length;++l){const n=e.program.customUniforms[l],r=e.customUniformLocations[l],o=i[l];if("float"===n.type)t.gl.uniform1fv(r,o);else if("vec2"===n.type)t.gl.uniform2fv(r,o);else if("vec3"===n.type)t.gl.uniform3fv(r,o);else if("vec4"===n.type)t.gl.uniform4fv(r,o);else if("int"===n.type)t.gl.uniform1iv(r,o);else if("ivec2"===n.type)t.gl.uniform2iv(r,o);else if("ivec3"===n.type)t.gl.uniform3iv(r,o);else{if("ivec4"!==n.type)throw Error(`uniform type ${n.type} is not supported yet.`);t.gl.uniform4iv(r,o)}}t.executeProgram()}function TP(t,e,n){let r="";e.concat(n).forEach((e=>{const i=null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!e.isUniform){const o=e.texData.texShape,{useSqueezeShape:s,uniformShape:a,keptDims:l}=wP(t.packedInputs,e.shape,o);let u="",c="",h="";if(1===a.length&&t.packedInputs){const t=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];u=`${t[0]>1}_${t[1]>1}`}else if(2!==a.length||t.packedInputs){if(a.length>2&&!t.packedInputs){const t=U(a);h=`${t[0]===o[1]}_${t[t.length-1]===o[1]}`}}else c=`${a[0]>1}_${a[1]>1}`;const d=e.shape.length,p=2===a.length&&x(e.shape,o),f=1===w(e.shape),g=ma(e.shape,n.shape),m=!t.packedInputs&&d===n.shape.length&&x(o,n.texData.texShape),y=t.packedInputs||a.length>2?"":`${o[0]>1}_${o[1]>1}`;r+=`${d}_${m}_${s?l:""}_${a.length}_${f}_${g}_${p}_${u}_${c}_${h}_${y}_${i}`}else{const t=e.isUniform?"uniform":e.texData.texShape;r+=`${e.shape}_${t}_${i}`}}));const i=t.userCode;let o=t.constructor.name;return o+="_"+r+"_"+i+`${it().getNumber("WEBGL_VERSION")}`,o}function EP(t){return it().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class NP{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=bF.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const e=_M();this.outputShape=t,this.enableShapeUniforms=EP(this.outputShape.length),this.userCode=`\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ${this.enableShapeUniforms?CM(["r","c","d"],t):IM(["r","c","d"],t)}\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ${e.output} = result;\n      }\n    `}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class AP{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=bF.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const e=_M();this.outputShape=t,this.enableShapeUniforms=EP(this.outputShape.length),this.userCode=`\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ${this.enableShapeUniforms?CM(["r","c","d"],t):IM(["r","c","d"],t)}\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ${e.output} = result;\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class RP{constructor(t){this.variableNames=["A"],this.outTexUsage=vF.DOWNLOAD;const e=_M();this.outputShape=t,this.userCode=`\n      ${AM}\n\n      void main() {\n        float x = getAAtOutCoords();\n        ${e.output} = encode_float(x);\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class $P{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=vF.DOWNLOAD;const e=_M();this.outputShape=t,this.userCode=`\n      ${AM}\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ${e.output} = encode_float(x);\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const DP={R:0,G:1,B:2,A:3};class OP{constructor(t,e=!1,n="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=_M();this.outputShape=t,this.enableShapeUniforms=EP(this.outputShape.length);let i="result";e&&(i="floor(result * 255. + 0.5)");let o="";for(let s=0;s<n.length;s++){const t=n[s];o+=`\n          if(offset == ${s}) {\n            result = values[${DP[t]}];\n          }`}this.userCode=`\n      ${this.enableShapeUniforms?NM():EM(t)}\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int flatIndex = getFlatIndex(coords);\n        float result = 0.;\n        int offset = imod(flatIndex, ${n.length});\n\n        flatIndex = idiv(flatIndex, ${n.length}, 1.);\n\n        int r = flatIndex / texShape[1];\n        if (r < texShape[0]) {\n          int c = imod(flatIndex, texShape[1]);\n          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n          vec4 values = ${r.texture2D}(A, uv);\n          ${o}\n        }\n        ${r.output} = vec4(${i}, 0., 0., 0.);\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class FP{constructor(t,e=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=_M();this.outputShape=t,this.enableShapeUniforms=EP(this.outputShape.length);let r="",i="result";e&&(i="floor(result * 255. + 0.5)");for(let o=0;o<=1;o++)for(let e=0;e<=1;e++){const i=2*o+e;r+=`\n          localCoords = coords;\n          if(localCoords[2] + ${e} < ${this.enableShapeUniforms?"outShape[2]":`${t[2]}`}) {\n          localCoords[2] += ${e};\n          if (localCoords[1] + ${o} < ${this.enableShapeUniforms?"outShape[1]":`${t[1]}`}) {\n            localCoords[1] += ${o};\n\n            flatIndex = getFlatIndex(localCoords);\n            offset = imod(flatIndex, 4);\n\n            flatIndex = idiv(flatIndex, 4, 1.);\n\n            int r = flatIndex / texShape[1];\n            int c = imod(flatIndex, texShape[1]);\n            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n            values = ${n.texture2D}(A, uv);\n\n            if (offset == 0) {\n              result[${i}] = values[0];\n            } else if (offset == 1) {\n              result[${i}] = values[1];\n            } else if (offset == 2) {\n              result[${i}] = values[2];\n            } else {\n              result[${i}] = values[3];\n            }\n          }\n        }\n        `}this.userCode=`\n        ${this.enableShapeUniforms?NM():EM(t)}\n\n        void main() {\n          ivec3 coords = getOutputCoords();\n\n          vec4 result = vec4(0.);\n          int flatIndex, r, c, offset;\n          ivec3 localCoords;\n          vec2 uv;\n          vec4 values;\n\n          ${r}\n\n          ${n.output} = ${i};\n        }\n    `}}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function MP(t){const e=_M(),n=`${e.version}\n    precision highp float;\n    ${e.attribute} vec3 clipSpacePos;\n    ${e.attribute} vec2 uv;\n    ${e.varyingVs} vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }`;return OF(t,n)}function PP(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return WF(t,e)}function LP(t){const e=new Uint16Array([0,1,2,2,1,3]);return UF(t,e)}function zP(t,e,n,r,i,o){jF(e,n);const s=VF(t),a=t.TEXTURE_2D;return TF(t,(()=>t.bindTexture(a,s))),TF(t,(()=>t.texParameteri(a,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE))),TF(t,(()=>t.texParameteri(a,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE))),TF(t,(()=>t.texParameteri(a,t.TEXTURE_MIN_FILTER,t.NEAREST))),TF(t,(()=>t.texParameteri(a,t.TEXTURE_MAG_FILTER,t.NEAREST))),1===it().getNumber("WEBGL_VERSION")?TF(t,(()=>t.texImage2D(a,0,r,e,n,0,i,o,null))):TF(t,(()=>t.texStorage2D(a,1,r,e,n))),TF(t,(()=>t.bindTexture(t.TEXTURE_2D,null))),{texture:s,texShape:[n,e]}}function BP(t){return t.internalFormatFloat}function WP(t,e,n,r){const[i,o]=xF(e,n);return zP(t,i,o,BP(r),r.textureFormatFloat,t.FLOAT)}function UP(t){return t.internalFormatHalfFloat}function VP(t,e,n,r){const[i,o]=xF(e,n);return zP(t,i,o,UP(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function jP(t){return t.downloadTextureFormat}function HP(t,e,n,r){const[i,o]=xF(e,n);return zP(t,i,o,jP(r),t.RGBA,t.UNSIGNED_BYTE)}function GP(t){return t.internalFormatPackedFloat}function qP(t,e,n,r){const[i,o]=IF(e,n);return zP(t,i,o,GP(r),t.RGBA,t.FLOAT)}function KP(t){return t.internalFormatPackedHalfFloat}function XP(t,e,n,r){const[i,o]=IF(e,n);return zP(t,i,o,KP(r),t.RGBA,r.textureTypeHalfFloat)}function YP(t,e,n){const r=0,i=12,o=20;TF(t,(()=>t.bindBuffer(t.ARRAY_BUFFER,n)));const s=GF(t,e,"clipSpacePos",n,3,o,r);return s&&GF(t,e,"uv",n,2,o,i)}function JP(t,e,n,r,i,o){let s,a,l;TF(t,(()=>t.bindTexture(t.TEXTURE_2D,e))),i instanceof Uint8Array?(s=new Uint8Array(n*r*4),a=t.UNSIGNED_BYTE,l=t.RGBA):(s=new Float32Array(n*r*4),a=t.FLOAT,l=o.internalFormatPackedFloat),s.set(i),2===it().getNumber("WEBGL_VERSION")?TF(t,(()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,r,t.RGBA,a,s))):TF(t,(()=>t.texImage2D(t.TEXTURE_2D,0,l,n,r,0,t.RGBA,a,s))),TF(t,(()=>t.bindTexture(t.TEXTURE_2D,null)))}function ZP(t,e,n){TF(t,(()=>t.bindTexture(t.TEXTURE_2D,e))),n.data instanceof Uint8Array?2===it().getNumber("WEBGL_VERSION")?TF(t,(()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data))):TF(t,(()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data))):2===it().getNumber("WEBGL_VERSION")?TF(t,(()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n))):TF(t,(()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n))),TF(t,(()=>t.bindTexture(t.TEXTURE_2D,null)))}function QP(t,e,n,r){const i=t.createBuffer();TF(t,(()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,i)));const o=4,s=4,a=o*s*e*n;return TF(t,(()=>t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ))),TF(t,(()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0))),TF(t,(()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null))),i}function tL(t,e,n){const r=t,i=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}function eL(t,e,n,r){const[i,o]=xF(e,n),s=4,a=new Uint8Array(kF(e*n,s));return TF(t,(()=>t.readPixels(0,0,i,o,r.downloadTextureFormat,t.UNSIGNED_BYTE,a))),new Float32Array(a.buffer)}function nL(t,e,n,r,i,o,s,a){const l=t,u=new Float32Array(CF(o,s));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,u),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),u}function rL(t,e,n){const r=new Float32Array(e*n*4);return TF(t,(()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,r))),r}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class iL{constructor(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const e=it().getNumber("WEBGL_VERSION");if(null!=t?(this.gl=t,fF(e,t)):this.gl=gF(e),t=this.gl,2===it().getNumber("WEBGL_VERSION")){const e=t;this.createVertexArray=()=>TF(e,(()=>e.createVertexArray())),this.bindVertexArray=t=>TF(e,(()=>e.bindVertexArray(t))),this.deleteVertexArray=t=>TF(e,(()=>e.deleteVertexArray(t))),this.getVertexArray=()=>TF(e,(()=>e.getParameter(e.VERTEX_ARRAY_BINDING)))}else if(null!=t){const e=t.getExtension("OES_vertex_array_object");if(null==e)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>TF(t,(()=>e.createVertexArrayOES())),this.bindVertexArray=n=>TF(t,(()=>e.bindVertexArrayOES(n))),this.deleteVertexArray=n=>TF(t,(()=>e.deleteVertexArrayOES(n))),this.getVertexArray=()=>TF(t,(()=>t.getParameter(e.VERTEX_ARRAY_BINDING_OES)))}let n="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),1===it().getNumber("WEBGL_VERSION")){const t="OES_texture_float",e="OES_texture_half_float";if(this.textureFloatExtension=DF(this.gl,t),fM(this.gl,e))this.textureHalfFloatExtension=DF(this.gl,e);else if(it().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),fM(this.gl,r))this.colorBufferHalfFloatExtension=DF(this.gl,r);else if(it().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",fM(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!fM(this.gl,r))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(r)}this.vertexBuffer=PP(this.gl),this.indexBuffer=LP(this.gl),this.framebuffer=HF(this.gl),this.textureConfig=SF(this.gl,this.textureHalfFloatExtension)}get debug(){return it().getBool("DEBUG")}dispose(){if(this.disposed)return;null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const t=this.gl;TF(t,(()=>t.finish())),TF(t,(()=>t.bindFramebuffer(t.FRAMEBUFFER,null))),TF(t,(()=>t.deleteFramebuffer(this.framebuffer))),TF(t,(()=>t.bindBuffer(t.ARRAY_BUFFER,null))),TF(t,(()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null))),TF(t,(()=>t.deleteBuffer(this.indexBuffer))),this.disposed=!0}createFloat32MatrixTexture(t,e){return this.throwIfDisposed(),WP(this.gl,t,e,this.textureConfig)}createFloat16MatrixTexture(t,e){return this.throwIfDisposed(),VP(this.gl,t,e,this.textureConfig)}createUnsignedBytesMatrixTexture(t,e){return this.throwIfDisposed(),HP(this.gl,t,e,this.textureConfig)}uploadPixelDataToTexture(t,e){this.throwIfDisposed(),ZP(this.gl,t,e)}uploadDenseMatrixToTexture(t,e,n,r){this.throwIfDisposed(),JP(this.gl,t,e,n,r,this.textureConfig)}createFloat16PackedMatrixTexture(t,e){return this.throwIfDisposed(),XP(this.gl,t,e,this.textureConfig)}createPackedMatrixTexture(t,e){return this.throwIfDisposed(),qP(this.gl,t,e,this.textureConfig)}deleteMatrixTexture(t){this.throwIfDisposed(),this.outputTexture===t&&(ZF(this.gl,this.framebuffer),this.outputTexture=null),TF(this.gl,(()=>this.gl.deleteTexture(t)))}downloadByteEncodedFloatMatrixFromOutputTexture(t,e,n){return this.downloadMatrixDriver(t,(()=>eL(this.gl,e,n,this.textureConfig)))}downloadPackedMatrixFromBuffer(t,e,n,r,i,o){return nL(this.gl,t,e,n,r,i,o,this.textureConfig)}downloadFloat32MatrixFromBuffer(t,e){return tL(this.gl,t,e)}createBufferFromTexture(t,e,n){this.bindTextureToFrameBuffer(t);const r=QP(this.gl,e,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const t=this.createFence(this.gl);return this.pollFence(t)}createFence(t){let e,n;if(it().getBool("WEBGL_FENCE_API_ENABLED")){const r=t,i=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),n=()=>{const t=r.clientWaitSync(i,0,0);return t===r.ALREADY_SIGNALED||t===r.CONDITION_SATISFIED},e=i}else it().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),n=()=>this.isQueryAvailable(e,it().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):n=()=>!0;return{query:e,isFencePassed:n}}downloadMatrixFromPackedTexture(t,e,n){return this.downloadMatrixDriver(t,(()=>rL(this.gl,e,n)))}createProgram(t){this.throwIfDisposed();const e=this.gl;null==this.vertexShader&&(this.vertexShader=MP(e));const n=LF(e);TF(e,(()=>e.attachShader(n,this.vertexShader))),TF(e,(()=>e.attachShader(n,t))),zF(e,n);const r=Object.assign(n,{vao:this.createVertexArray()});return this.debug&&BF(e,r),r}buildVao(t){this.setProgram(t),this.bindVertexArray(t.vao);const e=this.gl;TF(e,(()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer))),YP(e,t,this.vertexBuffer)}deleteProgram(t){this.throwIfDisposed(),t===this.program&&(this.program=null),null!=t&&(TF(this.gl,(()=>this.gl.deleteProgram(t))),this.deleteVertexArray(t.vao))}setProgram(t){this.throwIfDisposed(),this.program=t,null!=this.program&&this.debug&&BF(this.gl,this.program),TF(this.gl,(()=>this.gl.useProgram(t)))}getUniformLocation(t,e,n=!0){return this.throwIfDisposed(),n?KF(this.gl,t,e):XF(this.gl,t,e)}getAttributeLocation(t,e){return this.throwIfDisposed(),TF(this.gl,(()=>this.gl.getAttribLocation(t,e)))}getUniformLocationNoThrow(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)}setInputMatrixTexture(t,e,n){this.throwIfDisposed(),this.throwIfNoProgram(),YF(this.gl,t,e,n)}setOutputMatrixTexture(t,e,n){this.setOutputMatrixTextureDriver(t,n,e)}setOutputPackedMatrixTexture(t,e,n){this.throwIfDisposed();const[r,i]=IF(e,n);this.setOutputMatrixTextureDriver(t,r,i)}setOutputMatrixWriteRegion(t,e,n,r){this.setOutputMatrixWriteRegionDriver(n,t,r,e)}setOutputPackedMatrixWriteRegion(t,e,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){null!=this.program&&BF(this.gl,this.program),QF(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const t=this.gl;if(this.debug){const t=this.getVertexArray();console.assert(t===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}TF(t,(()=>t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),TF(this.gl,(()=>this.gl.finish()))}getQueryTimerExtension(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=DF(this.gl,2===it().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(2===it().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const t=this.gl,e=this.getQueryTimerExtensionWebGL2(),n=t.createQuery();return t.beginQuery(e.TIME_ELAPSED_EXT,n),n}const t=this.getQueryTimerExtensionWebGL1(),e=t.createQueryEXT();return t.beginQueryEXT(t.TIME_ELAPSED_EXT,e),e}endQuery(){if(2===it().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const t=this.gl,e=this.getQueryTimerExtensionWebGL2();return void t.endQuery(e.TIME_ELAPSED_EXT)}const t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(t){return await C((()=>this.disposed||this.isQueryAvailable(t,it().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")))),this.getQueryTime(t,it().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(t,e){if(0===e)return null;if(2===e){const e=this.gl,n=e.getQueryParameter(t,e.QUERY_RESULT);return n/1e6}{const e=this.getQueryTimerExtensionWebGL1(),n=e.getQueryObjectEXT(t,e.QUERY_RESULT_EXT);return n/1e6}}isQueryAvailable(t,e){if(0===e)return!0;if(2===e){const e=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=e.getQueryParameter(t,e.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(n.GPU_DISJOINT_EXT)),r&&!this.disjoint}{const e=this.getQueryTimerExtensionWebGL1(),n=e.getQueryObjectEXT(t,e.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(e.GPU_DISJOINT_EXT)),n&&!this.disjoint}}pollFence(t){return new Promise((e=>{this.addItemToPoll((()=>t.isFencePassed()),(()=>e()))}))}pollItems(){const t=oL(this.itemsToPoll.map((t=>t.isDoneFn)));for(let e=0;e<=t;++e){const{resolveFn:t}=this.itemsToPoll[e];t()}this.itemsToPoll=this.itemsToPoll.slice(t+1)}addItemToPoll(t,e){if(this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1)return;let n;"setTimeoutCustom"in it().platform&&(n=it().platform.setTimeoutCustom.bind(it().platform)),C((()=>(this.pollItems(),0===this.itemsToPoll.length)),(()=>0),null,n)}bindTextureToFrameBuffer(t){this.throwIfDisposed(),JF(this.gl,t,this.framebuffer),this.debug&&QF(this.gl)}unbindTextureToFrameBuffer(){null!=this.outputTexture?(JF(this.gl,this.outputTexture,this.framebuffer),this.debug&&QF(this.gl)):ZF(this.gl,this.framebuffer)}downloadMatrixDriver(t,e){this.bindTextureToFrameBuffer(t);const n=e();return this.unbindTextureToFrameBuffer(),n}setOutputMatrixTextureDriver(t,e,n){this.throwIfDisposed();const r=this.gl;JF(r,t,this.framebuffer),this.debug&&QF(r),this.outputTexture=t,TF(r,(()=>r.viewport(0,0,e,n))),TF(r,(()=>r.scissor(0,0,e,n)))}setOutputMatrixWriteRegionDriver(t,e,n,r){this.throwIfDisposed(),TF(this.gl,(()=>this.gl.scissor(t,e,n,r)))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(null==this.program)throw new Error("No GPU program is currently set.")}}function oL(t){let e=0;for(;e<t.length;++e){const n=t[e]();if(!n)break}return e-1}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const{addImpl:sL,bincountImpl:aL,bincountReduceImpl:lL,bitwiseAndImpl:uL,castImpl:cL,ceilImpl:hL,concatImpl:dL,equalImpl:pL,expImpl:fL,expm1Impl:gL,floorImpl:mL,gatherNdImpl:yL,gatherV2Impl:bL,greaterImpl:vL,greaterEqualImpl:wL,lessImpl:xL,lessEqualImpl:kL,linSpaceImpl:_L,logImpl:IL,maxImpl:CL,maximumImpl:SL,minimumImpl:TL,multiplyImpl:EL,negImpl:NL,notEqualImpl:AL,prodImpl:RL,raggedGatherImpl:$L,raggedRangeImpl:DL,raggedTensorToTensorImpl:OL,rangeImpl:FL,rsqrtImpl:ML,scatterImpl:PL,sigmoidImpl:LL,simpleAbsImpl:zL,sliceImpl:BL,sparseFillEmptyRowsImpl:WL,sparseReshapeImpl:UL,sparseSegmentReductionImpl:VL,sqrtImpl:jL,staticRegexReplaceImpl:HL,stridedSliceImpl:GL,stringNGramsImpl:qL,stringSplitImpl:KL,stringToHashBucketFastImpl:XL,subImpl:YL,tileImpl:JL,topKImpl:ZL,transposeImpl:QL,uniqueImpl:tz}=s;
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function ez(t,e){return["x","y","z","w","u","v"].slice(0,e).map((e=>`${t}.${e}`))}function nz(t,e){return 1===e?[t]:ez(t,e)}function rz(t,e){if(1===t)return"rc";let n="";for(let r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class iz{constructor(t){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.enableShapeUniforms=EP(this.outputShape.length),0===this.rank)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{const t=nz("rc",this.rank),e=vP(this.rank),n=this.getOutOfBoundsCondition(t),r=this.getSetup(t),i=this.getOutput(t);this.userCode=`\n        void main() {\n          ${e} rc = getOutputCoords();\n\n          if(${n}) {\n            setOutput(vec4(0));\n          } else {\n            ${r}\n\n            setOutput(vec4(${i}));\n          }\n        }\n      `}}getSourceCoordsArr(t){const e=[];for(let n=0;n<=1;n++)for(let r=0;r<=1;r++){let i=`${0===n?"r":"rp1"}, ${0===r?"c":"cp1"}`;for(let e=2;e<this.rank;e++)i=`${t[t.length-1-e]},`+i;e.push(i)}return e}getOutOfBoundsCondition(t){if(1===this.rank)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let e="";for(let n=this.rank-2;n<this.rank;n++)e+=`${t[n]} >= ${this.enableShapeUniforms?`outShape[${n}]`:this.outputShape[n]}`,n<this.rank-1&&(e+="||");return e}getSetup(t){if(1===this.rank)return"";const e=t.slice(-2),n=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],r=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`\n      int r = ${e[0]};\n      int c = ${e[1]};\n      int rp1 = r + 1;\n      int cp1 = c + 1;\n\n      bool cEdge = cp1 >= ${n};\n      bool rEdge = rp1 >= ${r};\n    `}getOutput(t){const e=this.getSourceCoordsArr(t);if(1===this.rank){const t=this.enableShapeUniforms?"outShape":this.outputShape[0];return`getA(rc), (rc + 1 >= ${t} ? 0. : getA(rc + 1)), 0, 0`}return`getA(${e[0]}),\n            cEdge ? 0. : getA(${e[1]}),\n            rEdge ? 0. : getA(${e[2]}),\n            rEdge || cEdge ? 0. : getA(${e[3]})`}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class oz{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=t,this.enableShapeUniforms=EP(this.outputShape.length);let n="";for(let r=0;r<4;r++){let t="thisRC = rc;";r%2===1&&(t+="thisRC.z += 1;"),r>1&&(t+="thisRC.y += 1;"),n+=`\n        ${t}\n        ${r>0?"if(thisRC.y < rows && thisRC.z < cols){":""}\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[${r}] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ${r>0?"}":""}\n      `}this.userCode=`\n      ${sz(e,this.enableShapeUniforms)}\n      ${this.enableShapeUniforms?NM():EM(t)}\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ${this.enableShapeUniforms?"outShape[1]":t[1]};\n        int cols = ${this.enableShapeUniforms?"outShape[2]":t[2]};\n\n        ${n}\n\n        setOutput(result);\n      }\n    `}}function sz(t,e){const n=e?TM(["r","c","d"],"inputShape"):IM(["r","c","d"],t);return`\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ${n}\n      return ivec3(r, c, d);\n    }\n  `}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class az{constructor(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(t,e,n){const r=dz(e,n),i=pz(t,r,n);i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]);const o=uz(t,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();const t=this.freeTextures[i].pop();return this.usedTextures[i].push(t),t}let s;return r===wF.PACKED_2X2_FLOAT32?s=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):r===wF.PACKED_2X2_FLOAT16?s=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):r===wF.UNPACKED_FLOAT32?s=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):r===wF.UNPACKED_FLOAT16?s=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):r===wF.PACKED_4X1_UNSIGNED_BYTE&&(s=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[i].push(s),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),s}releaseTexture(t,e,n,r){if(null==this.freeTextures)return;const i=dz(n,r),o=pz(e,i,r);o in this.freeTextures||(this.freeTextures[o]=[]);const s=uz(e,i,this.gpgpu.gl,this.gpgpu.textureConfig,r),a=it().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==a&&this._numBytesAllocated>a?(this.gpgpu.deleteMatrixTexture(t.texture),this._numBytesAllocated-=s):(this.freeTextures[o].push(t),this.numFreeTextures++,this._numBytesFree+=s),this.numUsedTextures--;const l=this.usedTextures[o],u=l&&l.indexOf(t);if(null==u||u<0)throw new Error("Cannot release a texture that was never provided by this texture manager");l[u]=l[l.length-1],l.pop(),this.log()}log(){if(!this.logEnabled)return;const t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${t})`);const e=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*e)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(null!=this.freeTextures){for(const t in this.freeTextures)this.freeTextures[t].forEach((t=>{this.gpgpu.deleteMatrixTexture(t.texture)}));for(const t in this.usedTextures)this.usedTextures[t].forEach((t=>{this.gpgpu.deleteMatrixTexture(t.texture)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function lz(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function uz(t,e,n,r,i){const o=cz(e,r);let s;if(i){const[e,n]=IF(t[0],t[1]);s=e*n}else{const[e,n]=xF(t[0],t[1]);s=e*n}const a=lz(n,o);return s*a}function cz(t,e){switch(t){case wF.PACKED_2X2_FLOAT32:return GP(e);case wF.PACKED_2X2_FLOAT16:return KP(e);case wF.UNPACKED_FLOAT32:return BP(e);case wF.UNPACKED_FLOAT16:return UP(e);case wF.PACKED_4X1_UNSIGNED_BYTE:return jP(e);default:throw new Error(`Unknown physical texture type ${t}`)}}function hz(t){return it().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?wF.PACKED_2X2_FLOAT32:wF.UNPACKED_FLOAT32:t?wF.PACKED_2X2_FLOAT16:wF.UNPACKED_FLOAT16}function dz(t,e){if(t===vF.UPLOAD)return wF.PACKED_2X2_FLOAT32;if(t===vF.RENDER||null==t)return hz(e);if(t===vF.DOWNLOAD||t===vF.PIXELS)return wF.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function pz(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class fz{constructor(t,e){this.variableNames=["A"],this.outputShape=t,this.enableShapeUniforms=EP(this.outputShape.length),this.userCode=`\n      float unaryOperation(float x) {\n        ${e}\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    `}}const gz="if (isnan(x)) return x;",mz="return x;",yz="return abs(x);";const bz="return (x >= 0.0) ? x : (exp(x) - 1.0);",vz=gz+"\n  return (x < 0.0) ? 0.0 : x;\n",wz=gz+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",xz="return x;",kz="return 1.0 / (1.0 + exp(-1.0 * x));",_z="return x;",Iz="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",Cz="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Sz="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Tz="return 1.0 / (1.0 + exp(-1.0 * x));";class Ez{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.enableShapeUniforms=EP(this.outputShape.length),this.userCode=`\n      vec4 unaryOperation(vec4 x) {\n        ${e}\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Nz{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t,this.enableShapeUniforms=EP(this.outputShape.length);const e=t.length,n=nz("rc",e),r=vP(e),i=rz(e,n),o=n.slice(-2),s=e<=1?"rc":`vec2(${o.join(",")})`;this.userCode=`\n      void main() {\n        ${r} rc = getOutputCoords();\n        vec4 packedInput = getA(${i});\n\n        setOutput(getChannel(packedInput, ${s}));\n      }\n    `}}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const Az=Zf,Rz=1e-7,$z=1e-4,Dz={};function Oz(t){return t in Dz||(Dz[t]={}),Dz[t]}const Fz=it().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),Mz=600;function Pz(){return null==it().global.screen?1024:it().global.screen.height*it().global.screen.width*window.devicePixelRatio*Mz/1024/1024}class Lz extends c{nextDataId(){return Lz.nextDataId++}constructor(t){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!it().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let e;if(null!=t){if(t instanceof iL)e=t;else{const n=gF(it().getNumber("WEBGL_VERSION"),t);e=new iL(n)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const t=gF(it().getNumber("WEBGL_VERSION"));e=new iL(t),this.binaryCache=Oz(it().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=e,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new az(this.gpgpu),this.numMBBeforeWarning=Pz(),this.texData=new u(this,ko())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(t,e,n,r,i,o){const s=this.makeTensorInfo(e,n),a=this.texData.get(s.dataId);a.isPacked=!1,a.texture={texture:t,texShape:[r,i]},a.texShape=[r,i];const l=oM(e),u=new OP(l,!1,o),c=this.runWebGLProgram(u,[s],n,[[r,i]]);return c.shape=e,a.texture=null,this.disposeIntermediateTensorInfo(s),c.dataId}write(t,e,n){if((it().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||it().getBool("DEBUG"))&&this.checkNumericalProblems(t),"complex64"===n&&null!=t)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:e,dtype:n,values:t,usage:vF.UPLOAD,refCount:1}),r}refCount(t){if(this.texData.has(t)){const e=this.texData.get(t);return e.refCount}return 0}incRef(t){const e=this.texData.get(t);e.refCount++}decRef(t){if(this.texData.has(t)){const e=this.texData.get(t);e.refCount--}}move(t,e,n,r,i){if(it().getBool("DEBUG")&&this.checkNumericalProblems(e),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:n,dtype:r,values:e,usage:vF.UPLOAD,refCount:i})}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}readSync(t){const e=this.texData.get(t),{values:n,dtype:r,complexTensorInfos:i,slice:o,shape:s,isPacked:a}=e;if(null!=o){let e;e=a?new Ez(s,xz):new fz(s,xz);const n=this.runWebGLProgram(e,[{dataId:t,shape:s,dtype:r}],r),i=this.readSync(n.dataId);return this.disposeIntermediateTensorInfo(n),i}if(null!=n)return this.convertAndCacheOnCPU(t);if("string"===r)return n;const l=null!=this.activeTimers;let u,c;if(l&&(u=ii()),"complex64"===r){const t=this.readSync(i.real.dataId),e=this.readSync(i.imag.dataId);c=mf(t,e)}else c=this.getValuesFromTexture(t);return l&&(this.downloadWaitMs+=ii()-u),this.convertAndCacheOnCPU(t,c)}async read(t){if(this.pendingRead.has(t)){const e=this.pendingRead.get(t);return new Promise((t=>e.push(t)))}const e=this.texData.get(t),{values:n,shape:r,slice:i,dtype:o,complexTensorInfos:s,isPacked:a}=e;if(null!=i){let e;e=a?new Ez(r,xz):new fz(r,xz);const n=this.runWebGLProgram(e,[{dataId:t,shape:r,dtype:o}],o),i=this.read(n.dataId);return this.disposeIntermediateTensorInfo(n),i}if(null!=n)return this.convertAndCacheOnCPU(t);if(it().getBool("DEBUG")&&!it().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===it().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let l,u,c=null;if("complex64"!==o&&it().get("WEBGL_BUFFER_SUPPORTED")){l=this.decode(t);const e=this.texData.get(l.dataId);c=this.gpgpu.createBufferFromTexture(e.texture.texture,..._F(r))}if(this.pendingRead.set(t,[]),"complex64"!==o&&await this.gpgpu.createAndWaitForFence(),"complex64"===o){const t=await Promise.all([this.read(s.real.dataId),this.read(s.imag.dataId)]),e=t[0],n=t[1];u=mf(e,n)}else if(null==c)u=this.getValuesFromTexture(t);else{const t=w(r);u=this.gpgpu.downloadFloat32MatrixFromBuffer(c,t)}if(null!=l&&this.disposeIntermediateTensorInfo(l),null!=c){const t=this.gpgpu.gl;TF(t,(()=>t.deleteBuffer(c)))}const h=this.convertAndCacheOnCPU(t,u),d=this.pendingRead.get(t);return this.pendingRead.delete(t),d.forEach((t=>t(h))),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t)&&ko().removeDataId(t,this),this.pendingDeletes--),h}readToGPU(t,e={}){const n=this.texData.get(t),{values:r,shape:i,slice:o,dtype:s,isPacked:a,texture:l}=n;if("complex64"===s)throw new Error("Does not support reading texture for complex64 dtype.");if(null!=o){let n;n=a?new Ez(i,xz):new fz(i,xz);const r=this.runWebGLProgram(n,[{dataId:t,shape:i,dtype:s}],s),o=this.readToGPU(r,e);return this.disposeIntermediateTensorInfo(r),o}if(null==l)throw null!=r?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const u=this.decode(t,e.customTexShape),c=ko().makeTensorFromTensorInfo(u),h=this.texData.get(u.dataId);return Object.assign({tensorRef:c},h.texture)}bufferSync(t){const e=this.readSync(t.dataId);if("string"===t.dtype)try{const n=e.map((t=>si(t)));return As(t.shape,t.dtype,n)}catch(n){throw new Error("Failed to decode encoded string bytes into utf-8")}return As(t.shape,t.dtype,e)}checkNumericalProblems(t){if(null!=t)for(let e=0;e<t.length;e++){const n=t[e];if(!RF(n)){if(it().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error(`The value ${n} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`);throw Error(`The value ${n} cannot be represented on this device.`)}}}getValuesFromTexture(t){const{shape:e,dtype:n,isPacked:r}=this.texData.get(t),i=w(e);if(it().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const n=this.decode(t),r=this.texData.get(n.dataId),o=this.gpgpu.downloadMatrixFromPackedTexture(r.texture.texture,..._F(e)).subarray(0,i);return this.disposeIntermediateTensorInfo(n),o}const o=it().getBool("WEBGL_PACK")&&!0===r,s=o?oM(e):e,a=o?new $P(s):new RP(s),l=this.runWebGLProgram(a,[{shape:s,dtype:n,dataId:t}],"float32"),u=this.texData.get(l.dataId),c=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(u.texture.texture,u.texShape[0],u.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(l),c}timerAvailable(){return it().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(t){const e=this.activeTimers,n=[];let r=!1;null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,t();const i=li(this.activeTimers.map((t=>t.query))).filter((t=>null!=t)),o=li(this.activeTimers.map((t=>t.name))).filter((t=>null!=t));this.activeTimers=e,r&&(this.programTimersStack=null);const s={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(it().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const t=await Promise.all(i);s["kernelMs"]=m(t),s["getExtraProfileInfo"]=()=>t.map(((t,e)=>({name:o[e],ms:t}))).map((t=>`${t.name}: ${t.ms}`)).join(", ")}else s["kernelMs"]={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,s})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return it().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:ii(),endMs:null}}endTimer(t){return it().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=ii(),t)}async getQueryTime(t){if(it().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(t);const e=t;return e.endMs-e.startMs}disposeData(t,e=!1){if(this.pendingDisposal.has(t))return!1;if(!this.texData.has(t))return!0;if(e?this.texData.get(t).refCount=0:this.texData.get(t).refCount--,!e&&this.texData.get(t).refCount>0)return!1;if(this.pendingRead.has(t))return this.pendingDisposal.add(t),this.pendingDeletes++,!1;this.releaseGPUData(t);const{complexTensorInfos:n}=this.texData.get(t);return null!=n&&(this.disposeData(n.real.dataId,e),this.disposeData(n.imag.dataId,e)),this.texData.delete(t),!0}releaseGPUData(t){const{texture:e,dtype:n,texShape:r,usage:i,isPacked:o,slice:s}=this.texData.get(t),a=s&&s.origDataId||t,l=this.dataRefCount.get(a);l>1?this.dataRefCount.set(a,l-1):(this.dataRefCount.delete(a),null!=e&&(this.numBytesInGPU-=this.computeBytes(r,n),this.textureManager.releaseTexture(e,r,i,o)));const u=this.texData.get(t);u.texture=null,u.texShape=null,u.isPacked=!1,u.slice=null}getTexture(t){return this.uploadToGPU(t),this.texData.get(t).texture.texture}getDataInfo(t){return this.texData.get(t)}shouldExecuteOnCPU(t,e=Fz){return it().getBool("WEBGL_CPU_FORWARD")&&t.every((t=>null==this.texData.get(t.dataId).texture&&w(t.shape)<e))}getGPGPUContext(){return this.gpgpu}where(t){Cr("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const e=t.dataSync();return Az(t.shape,e)}packedUnaryOp(t,e,n){const r=new Ez(t.shape,e),i=this.compileAndRun(r,[t],n);return ko().makeTensorFromTensorInfo(i)}abs(t){if(this.shouldExecuteOnCPU([t])&&"complex64"!==t.dtype){const e=zL(this.texData.get(t.dataId).values);return this.makeOutput(t.shape,t.dtype,e)}if(it().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,yz,t.dtype);const e=new fz(t.shape,yz),n=this.compileAndRun(e,[t]);return ko().makeTensorFromTensorInfo(n)}makeTensorInfo(t,e,n){let r;if("string"===e&&null!=n&&n.length>0&&M(n[0])){const i=n.map((t=>oi(t)));r=this.write(i,t,e)}else r=this.write(n,t,e);return this.texData.get(r).usage=null,{dataId:r,shape:t,dtype:e}}makeOutput(t,e,n){return ko().makeTensorFromTensorInfo(this.makeTensorInfo(t,e,n),this)}unpackTensor(t){const e=new Nz(t.shape);return this.runWebGLProgram(e,[t],t.dtype)}packTensor(t){const e=new iz(t.shape),n=!0;return this.runWebGLProgram(e,[t],t.dtype,null,n)}packedReshape(t,e){const n=[rM(t.shape),...iM(t.shape)],r={dtype:t.dtype,shape:n,dataId:t.dataId},i=[rM(e),...iM(e)],o=new oz(i,n),s=!0,a=[n],l=this.runWebGLProgram(o,[r],t.dtype,a,s);return{dataId:l.dataId,shape:e,dtype:l.dtype}}decode(t,e){const n=this.texData.get(t),{isPacked:r,shape:i,dtype:o}=n;if(null!=e){const t=w(i),n=e[0]*e[1]*4;y(t<=n,(()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data."))}const s=oM(i);let a;a=r?new AP(s):new NP(s);const l=!0,u=[null!=e?e:_F(s)],c=this.runWebGLProgram(a,[{shape:s,dtype:o,dataId:t}],o,u,l,e);return{dtype:o,shape:i,dataId:c.dataId}}runWebGLProgram(t,e,n,r,i=!1,o){const s=this.makeTensorInfo(t.outputShape,n),a=this.texData.get(s.dataId);if(t.packedOutput&&(a.isPacked=!0),t.outPackingScheme===bF.DENSE){const e=null!=o?o:_F(t.outputShape);a.texShape=e.map((t=>2*t))}if(null!=t.outTexUsage&&(a.usage=t.outTexUsage),0===w(s.shape))return a.values=N(s.dtype,0),s;const l=[],u=e.map((e=>{if("complex64"===e.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let n=this.texData.get(e.dataId);if(null==n.texture){if(!t.packedInputs&&w(e.shape)<=it().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:e.shape,texData:null,isUniform:!0,uniformValues:n.values};t.packedInputs&&(n.isPacked=!0,n.shape=e.shape)}if(this.uploadToGPU(e.dataId),!!n.isPacked!==!!t.packedInputs)e=n.isPacked?this.unpackTensor(e):this.packTensor(e),l.push(e),n=this.texData.get(e.dataId);else if(n.isPacked&&!lM(n.shape,e.shape)){const t=e,r=e.shape;e.shape=n.shape,e=this.packedReshape(e,r),l.push(e),n=this.texData.get(e.dataId),t.shape=r}return{shape:e.shape,texData:n,isUniform:!1}}));this.uploadToGPU(s.dataId);const c={shape:s.shape,texData:a,isUniform:!1},h=TP(t,u,c),d=this.getAndSaveBinary(h,(()=>_P(this.gpgpu,t,u,c))),p=null!=this.activeTimers;let f;p&&(f=this.startTimer()),it().get("ENGINE_COMPILE_ONLY")||SP(this.gpgpu,d,u,c,r),l.forEach((t=>this.disposeIntermediateTensorInfo(t))),p&&(f=this.endTimer(f),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(f)}));const g=it().getNumber("WEBGL_FLUSH_THRESHOLD");if(g>0){const t=ii();t-this.lastGlFlushTime>g&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=t)}if(!it().getBool("WEBGL_LAZILY_UNPACK")&&a.isPacked&&!1===i){const t=this.unpackTensor(s);return this.disposeIntermediateTensorInfo(s),t}return s}compileAndRun(t,e,n,r,i=!1){n=n||e[0].dtype;const o=this.runWebGLProgram(t,e,n,r,i);return o}getAndSaveBinary(t,e){return t in this.binaryCache||(this.binaryCache[t]=e()),this.binaryCache[t]}getTextureManager(){return this.textureManager}dispose(){if(!this.disposed){if(!it().getBool("IS_TEST")){const t=Object.keys(this.binaryCache);t.forEach((t=>{this.gpgpu.deleteProgram(this.binaryCache[t].webGLProgram),delete this.binaryCache[t]}))}this.textureManager.dispose(),null!=this.canvas&&"undefined"!==typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0}}floatPrecision(){return null==this.floatPrecisionValue&&(this.floatPrecisionValue=Io((()=>{if(!it().get("WEBGL_RENDER_FLOAT32_ENABLED")){const t=it().getBool("DEBUG");it().set("DEBUG",!1);const e=this.abs(Qs(1e-8)).dataSync()[0];if(it().set("DEBUG",t),e>0)return 32}return 16}))),this.floatPrecisionValue}epsilon(){return 32===this.floatPrecision()?Rz:$z}uploadToGPU(t){const e=this.texData.get(t),{shape:n,dtype:r,values:i,texture:o,usage:s,isPacked:a}=e;if(null!=o)return;const l=null!=this.activeTimers;let u;l&&(u=ii());let c=e.texShape;if(null==c&&(c=sM(n,a),e.texShape=c),null!=i){const t=oM(n);let o,s=c[1],h=c[0];const d=i instanceof Uint8Array||i instanceof Uint8ClampedArray;!a&&d||([s,h]=IF(c[0],c[1])),o=a?new FP(t,d):new OP(t,d);const p=d?[h,s]:c,f=this.makeTensorInfo(p,r),g=this.texData.get(f.dataId);g.usage=d?vF.PIXELS:vF.UPLOAD,g.texShape=p,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(f.dataId),s,h,i);const m=[[h,s]],y=!0,b=this.runWebGLProgram(o,[f],r,m,y),v=this.texData.get(b.dataId);e.texShape=v.texShape,e.isPacked=v.isPacked,e.usage=v.usage,it().get("ENGINE_COMPILE_ONLY")?this.disposeData(b.dataId):(e.texture=v.texture,e.values=null,this.texData.delete(b.dataId)),this.disposeIntermediateTensorInfo(f),l&&(this.uploadWaitMs+=ii()-u)}else{const t=this.acquireTexture(c,s,r,a);e.texture=t}}convertAndCacheOnCPU(t,e){const n=this.texData.get(t),{dtype:r}=n;return null!=e&&(n.values=zz(e,r)),n.values}acquireTexture(t,e,n,r){if(this.numBytesInGPU+=this.computeBytes(t,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){const t=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${t} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(t,e,r)}computeBytes(t,e){return t[0]*t[1]*O(e)}checkCompileCompletion(){for(const[,t]of Object.entries(this.binaryCache))this.checkCompletion_(t)}async checkCompileCompletionAsync(){const t=[];if(this.gpgpu.parallelCompilationExtension){for(const[,e]of Object.entries(this.binaryCache))t.push(this.checkCompletionAsync_(e));return Promise.all(t)}for(const[,e]of Object.entries(this.binaryCache)){const n=new Promise((t=>{try{this.checkCompletion_(e),t(!0)}catch(n){throw n}}));t.push(n)}return Promise.all(t)}async checkCompletionAsync_(t){return this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(t):(await Wp(),this.checkCompletionAsync_(t))}checkCompletion_(t){if(!1===this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.gl.LINK_STATUS)){if(console.log(this.gpgpu.gl.getProgramInfoLog(t.webGLProgram)),!1===this.gpgpu.gl.getShaderParameter(t.fragmentShader,this.gpgpu.gl.COMPILE_STATUS))throw PF(t.source,this.gpgpu.gl.getShaderInfoLog(t.fragmentShader)),new Error("Failed to compile fragment shader.");throw new Error("Failed to link vertex and fragment shaders.")}return!0}getUniformLocations(){for(const t of Object.values(this.binaryCache)){this.gpgpu.buildVao(t.webGLProgram);const{variablesLocations:e,customUniformLocations:n,infLoc:r,nanLoc:i,outShapeLocation:o,outShapeStridesLocation:s,outTexShapeLocation:a}=IP(this.gpgpu,t.program,t.webGLProgram);t.variablesLocations=e,t.customUniformLocations=n,t.infLoc=r,t.nanLoc=i,t.outShapeLocation=o,t.outShapeStridesLocation=s,t.outTexShapeLocation=a}}createTensorFromGPUData(t,e,n){t.channels=t.channels||"RGBA";const{texture:r,height:i,width:o,channels:s}=t,a=ko().backend;if(!a.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const l=a.writeTexture(r,e,n,i,o,s);return ko().makeTensorFromDataId(l,e,n,a)}}function zz(t,e){if("float32"===e||"complex64"===e)return t;if("int32"===e||"bool"===e){const n="int32"===e?new Int32Array(t.length):new Uint8Array(t.length);for(let e=0;e<n.length;++e)n[e]=Math.round(t[e]);return n}throw new Error(`Unknown dtype ${e}`)}Lz.nextDataId=0;
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
io()&&To("webgl",(()=>new Lz),2);const Bz="\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n";class Wz{constructor(t,e,n){this.variableNames=["A","B"],this.outputShape=ba(e,n),this.enableShapeUniforms=EP(this.outputShape.length),this.userCode=`\n      float binaryOperation(float a, float b) {\n        ${t}\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const Uz="\n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n";class Vz{constructor(t,e,n,r=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=ba(e,n);const i=this.outputShape.length;this.enableShapeUniforms=EP(i);let o="";if(r)if(0===i||1===w(this.outputShape))o="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else{const t=vP(i);if(o=`\n          ${t} coords = getOutputCoords();\n        `,1===i)this.enableShapeUniforms?o+="\n            result.y = (coords + 1) >= outShape ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ":o+=`\n            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          `;else{const t=nz("coords",i);this.enableShapeUniforms?o+=`\n            bool nextRowOutOfBounds =\n              (${t[i-2]} + 1) >= outShape[${i} - 2];\n            bool nextColOutOfBounds =\n              (${t[i-1]} + 1) >= outShape[${i} - 1];\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          `:o+=`\n            bool nextRowOutOfBounds =\n              (${t[i-2]} + 1) >= ${this.outputShape[i-2]};\n            bool nextColOutOfBounds =\n              (${t[i-1]} + 1) >= ${this.outputShape[i-1]};\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          `}}this.userCode=`\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ${t}\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ${o}\n\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function jz(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const Hz={kernelName:Te,backendName:"webgl",kernelFunc:jz};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Gz(t){const{inputs:e,backend:n}=t,{real:r,imag:i}=e,o=n.makeTensorInfo(r.shape,"complex64"),s=n.texData.get(o.dataId),a=jz({inputs:{x:r},backend:n}),l=jz({inputs:{x:i},backend:n});return s.complexTensorInfos={real:a,imag:l},o}const qz={kernelName:Lt,backendName:"webgl",kernelFunc:Gz},Kz="return (a < 0.) ? b * a : a;",Xz="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";function Yz(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{alpha:o}=r,s=n.makeTensorInfo([],"float32",ei(o,"float32")),a=it().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Vz(Xz,i.shape,s.shape):new Wz(Kz,i.shape,s.shape),l=n.runWebGLProgram(a,[i,s],"float32");return n.disposeIntermediateTensorInfo(s),l}const Jz={kernelName:De,backendName:"webgl",kernelFunc:Yz},Zz="return (a < 0.) ? b * a : a;",Qz="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";function tB(t){const{inputs:e,backend:n}=t,{x:r,alpha:i}=e,o=it().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Vz(Qz,r.shape,i.shape):new Wz(Zz,r.shape,i.shape);return n.runWebGLProgram(o,[r,i],"float32")}const eB={kernelName:mn,backendName:"webgl",kernelFunc:tB},nB="if (isnan(x)) return x;";function rB({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:r}){return({inputs:i,backend:o})=>{const{x:s}=i,a=o,l=r||s.dtype;if(a.shouldExecuteOnCPU([s])&&null!=n){const t=a.texData.get(s.dataId),e=n(t.values,l);return a.makeTensorInfo(s.shape,l,e)}const u=it().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=e;let c;return c=u?new Ez(s.shape,e):new fz(s.shape,t),a.runWebGLProgram(c,[s],l)}}function iB({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:i,dtype:o}){return({inputs:s,backend:a})=>{const{a:l,b:u}=s,c=a;if(r&&"complex64"===l.dtype){const e=c.texData.get(l.dataId),n=c.texData.get(u.dataId),[r,i]=[[e.complexTensorInfos.real,n.complexTensorInfos.real],[e.complexTensorInfos.imag,n.complexTensorInfos.imag]].map((e=>{const[n,r]=e,i={dataId:n.dataId,dtype:n.dtype,shape:l.shape},o={dataId:r.dataId,dtype:r.dtype,shape:u.shape},s=new Wz(t,l.shape,u.shape);return c.runWebGLProgram(s,[i,o],zi(n.dtype,r.dtype))})),o=Gz({inputs:{real:r,imag:i},backend:c});return c.disposeIntermediateTensorInfo(r),c.disposeIntermediateTensorInfo(i),o}const h=o||zi(l.dtype,u.dtype);if(("string"===l.dtype||"string"===u.dtype||c.shouldExecuteOnCPU([l,u]))&&null!=i){const t=c.texData.get(l.dataId).values,e=c.texData.get(u.dataId).values,n="string"===l.dtype?Yf(t):t,r="string"===l.dtype?Yf(e):e,[o,s]=i(l.shape,u.shape,n,r,h),a=c.makeTensorInfo(s,h),d=c.texData.get(a.dataId);return d.values=o,a}const d=it().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=e;let p;return p=d?new Vz(e,l.shape,u.shape,n):new Wz(t,l.shape,u.shape),c.runWebGLProgram(p,[l,u],h)}}function oB(t,e=!1){if("linear"===t)return e?_z:mz;if("relu"===t)return e?Cz:vz;if("elu"===t)return e?Iz:bz;if("relu6"===t)return e?Sz:wz;if("prelu"===t)return e?Qz:Zz;if("leakyrelu"===t)return e?Xz:Kz;if("sigmoid"===t)return e?Tz:kz;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class sB{constructor(t,e,n,r=!1,i=!1,o=!1,s=null,a=!1,l=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.enableShapeUniforms=EP(this.outputShape.length);const u=r?t[1]:t[2],c=Math.ceil(u/2),h=r?"i * 2, rc.y":"rc.y, i * 2",d=i?"rc.z, i * 2":"i * 2, rc.z",p=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],f=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let g="",m="";s&&(g=a?`vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ${s}\n        }`:l?`vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ${s}\n        }`:`vec4 activation(vec4 x) {\n          ${s}\n        }`,m="result = activation(result);");const y=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),l&&this.variableNames.push("leakyreluAlpha");let b="rc.x",v="rc.x";t[0]<e[0]?b=`imod(rc.x, ${t[0]})`:e[0]<t[0]&&(v=`imod(rc.x, ${e[0]})`),this.userCode=`\n      ${g}\n      // Don't use uniform for sharedDimensionPacked for performance.\n      const float sharedDimension = ${c}.0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        int batchA = ${b};\n        int batchB = ${v};\n        for (int i = 0; i < ${c}; i++) {\n          vec4 a = getMatrixA(batchA, ${h});\n          vec4 b = getMatrixB(batchB, ${d});\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (${p[0]} * ${f[0]});\n          result += (${p[1]} * ${f[1]});\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ${y}\n\n        ${m}\n\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const aB={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class lB{constructor(t,e,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=ba(e,n),this.userCode=`\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ${t}\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const uB="return a * b;";function cB(t){const{inputs:e,backend:n}=t,{a:r,b:i}=e,o=zi(r.dtype,i.dtype);if("complex64"===r.dtype){const t=n.texData.get(r.dataId),e=n.texData.get(i.dataId),o=new lB(aB.REAL,r.shape,i.shape),s=new lB(aB.IMAG,r.shape,i.shape),a=[{dataId:t.complexTensorInfos.real.dataId,dtype:t.complexTensorInfos.real.dtype,shape:r.shape},{dataId:t.complexTensorInfos.imag.dataId,dtype:t.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:e.complexTensorInfos.real.dataId,dtype:e.complexTensorInfos.real.dtype,shape:i.shape},{dataId:e.complexTensorInfos.imag.dataId,dtype:e.complexTensorInfos.imag.dtype,shape:i.shape}],l=n.runWebGLProgram(o,a,"float32"),u=n.runWebGLProgram(s,a,"float32"),c=Gz({inputs:{real:l,imag:u},backend:n});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(u),c}if(n.shouldExecuteOnCPU([r,i])){const t=n.texData.get(r.dataId),e=n.texData.get(i.dataId),[s,a]=EL(r.shape,i.shape,t.values,e.values,o),l=n.makeTensorInfo(a,o),u=n.texData.get(l.dataId);return u.values=s,l}let s;return s=it().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Vz(uB,r.shape,i.shape):new Wz(uB,r.shape,i.shape),n.runWebGLProgram(s,[r,i],o)}const hB={kernelName:on,backendName:"webgl",kernelFunc:cB};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function dB(t,e,n){const r=[rM(t.shape),...iM(t.shape)],i={dtype:t.dtype,shape:r,dataId:t.dataId},o=[rM(e),...iM(e)],s=new oz(o,r),a=!0,l=[r],u=n.runWebGLProgram(s,[i],t.dtype,l,a);return{dataId:u.dataId,shape:e,dtype:u.dtype}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function pB(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{shape:o}=r,s=n,a=w(i.shape),l=S(o,a),u=w(l);y(a===u,(()=>`The new shape (${l}) has ${u} elements and the old shape (${i.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`));const c=s.texData.get(i.dataId);return!c.isPacked||lM(i.shape,l)||null!==c.texture&&lM(c.shape,l)?(s.incRef(i.dataId),{dataId:i.dataId,shape:l,dtype:i.dtype}):dB(i,l,s)}const fB={kernelName:Cn,backendName:"webgl",kernelFunc:pB};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class gB{constructor(t,e){this.variableNames=["x"];const{windowSize:n,batchSize:r,inSize:i,outSize:o}=t;this.outputShape=[r,o];const s=4*Math.floor(n/4),a=n%4;let l="sumValue += dot(values, ones);";if(null!=e){const t=1/e;l=`sumValue += dot(values * ${k(t)?t.toPrecision(2):t}, ones);`}let u="";i%n>0&&(u=`\n        if (inIdx < 0 || inIdx >= ${i}) {\n          return 0.0;\n        }\n      `),this.userCode=`\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ${u}\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${n};\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ${s}; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ${l}\n        }\n\n        int inIdx = inOffset + ${s};\n        if (${1===a}) {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ${l}\n        } else if (${2===a}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ${l}\n        } else if (${3===a}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ${l}\n        }\n        setOutput(sumValue);\n      }\n    `}}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class mB{constructor(t,e){this.variableNames=["x"];const{windowSize:n,batchSize:r,inSize:i,outSize:o}=t;this.outputShape=[r,o];let s="0.0",a="";"prod"===e?s="1.0":"min"===e?(s="1.0 / 1e-20",a="min"):"max"===e&&(s="-1.0 / 1e-20",a="max");let l=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"sum"===e?l="sumValue":"prod"===e?l="prodValue":"all"===e?l="allValue":"any"===e&&(l="anyValue");const u=4*Math.floor(n/4),c=n%4;let h=`\n      if (${"sum"===e}) {\n        sumValue += dot(values, ones);\n      } else if (${"prod"===e}) {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ${a}(values, minMaxValue);\n        if (${"min"===e} || ${"max"===e}) {\n          minMaxValue = ${a}(values, minMaxValue);\n          bvec4 isNaN = isnan(values);\n          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {\n            minMaxValue = vec4(NAN);\n          }\n        }\n      }\n    `,d="vec4";"all"===e?(s="1.0",h="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",d="bvec4"):"any"===e&&(s="0.0",h="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",d="bvec4");let p="";i%n>0&&(p=`\n        if (inIdx < 0 || inIdx >= ${i}) {\n          return initializationValue;\n        }\n      `),this.userCode=`\n      const float initializationValue = ${s};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ${p}\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${n};\n\n        vec4 minMaxValue = vec4(${s});\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ${u}; i += 4) {\n          int inIdx = inOffset + i;\n          ${d} values = ${d}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ${h}\n        }\n\n        int inIdx = inOffset + ${u};\n        if (${1===c}) {\n          ${d} values = ${d}(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ${h}\n        } else if (${2===c}) {\n          ${d} values = ${d}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ${h}\n        } else if (${3===c}) {\n          ${d} values = ${d}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ${h}\n        }\n        setOutput(${l});\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function yB(t){const e=[];while(0===e.length||1!==e[e.length-1].outSize){const n=e.length?e[e.length-1].outSize:t[1],r=Yp(n);e.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return e}function bB(t,e,n,r){const i=yB(t.shape);let o=t;for(let s=0;s<i.length;s++){const{inSize:a,windowSize:l,outSize:u}=i[s];let c,h;c="mean"===n?0===s?new gB({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:u},a):new gB({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:u}):new mB({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:u},n),h=o,o=r.runWebGLProgram(c,[o],e),h.dataId!==t.dataId&&r.disposeIntermediateTensorInfo(h)}return o}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class vB{constructor(t,e){this.variableNames=["A"];const n=new Array(t.length);for(let o=0;o<n.length;o++)n[o]=t[e[o]];this.outputShape=n,this.rank=n.length;const r=vP(this.rank),i=wB(e);this.userCode=`\n    void main() {\n      ${r} resRC = getOutputCoords();\n      setOutput(getA(${i}));\n    }\n    `}}function wB(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e);for(let i=0;i<t.length;i++)r[t[i]]=n[i];return r.join()}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class xB{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const n=new Array(t.length);for(let u=0;u<n.length;u++)n[u]=t[e[u]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const r=vP(this.rank),i=ez("rc",this.rank),o=new Array(this.rank);for(let u=0;u<e.length;u++)o[e[u]]=i[u];const s=`vec2(${o.slice(-2).join()})`,a=`++${i[this.rank-1]} < ${n[this.rank-1]}`,l=`getChannel(getA(${o.join()}), ${s})`;this.userCode=`\n    void main() {\n      ${r} rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ${l};\n      if(${a}) {\n        result[1] = ${l};\n      }\n      --${i[this.rank-1]};\n      if(++${i[this.rank-2]} < ${n[this.rank-2]}) {\n        result[2] = ${l};\n        if(${a}) {\n          result[3] = ${l};\n        }\n      }\n      setOutput(result);\n    }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function kB(t,e,n){const r=it().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new xB(t.shape,e):new vB(t.shape,e);return n.runWebGLProgram(r,[t],t.dtype)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function _B(t,e,n,r){const i=e,o=t.shape.length,s=T(i,t.shape);let a=s;const l=dc(a,o),u=null!=l;let c=t;u&&(c=kB(t,l,r),a=fc(a.length,o)),hc("sum",a,o);const[h,d]=uc(c.shape,a);let p=h;n&&(p=cc(h,s));const f=w(d),g=w(t.shape),m=g/f,y=pB({inputs:{x:c},attrs:{shape:[m,f]},backend:r}),b=Bi(t.dtype),v=bB(y,b,"sum",r),x=pB({inputs:{x:v},attrs:{shape:p},backend:r});return r.disposeIntermediateTensorInfo(y),r.disposeIntermediateTensorInfo(v),u&&r.disposeIntermediateTensorInfo(c),x}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function IB(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:o,keepDims:s}=r;return _B(i,o,s,n)}const CB={kernelName:Gn,backendName:"webgl",kernelFunc:IB};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function SB(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{perm:o}=r,s=n,a=i.shape.length,l=new Array(a);for(let c=0;c<l.length;c++)l[c]=i.shape[o[c]];let u;if(s.shouldExecuteOnCPU([i])){const t=s.texData.get(i.dataId),e=t.values,n=QL(e,i.shape,i.dtype,o,l);u=s.makeTensorInfo(l,i.dtype);const r=s.texData.get(u.dataId);r.values=n}else u=kB(i,o,s);return u}const TB={kernelName:fr,backendName:"webgl",kernelFunc:SB},EB=1e3;function NB({a:t,b:e,transposeA:n,transposeB:r,backend:i,bias:o=null,preluActivationWeights:s=null,leakyreluAlpha:a=0,activation:l=null}){const u=t.shape.length,c=e.shape.length,h=n?t.shape[u-2]:t.shape[u-1],d=r?e.shape[c-1]:e.shape[c-2],p=n?t.shape[u-1]:t.shape[u-2],f=r?e.shape[c-2]:e.shape[c-1],g=t.shape.slice(0,-2),m=e.shape.slice(0,-2),b=w(g),v=w(m),x=ba(t.shape.slice(0,-2),e.shape.slice(0,-2)),k=x.concat([p,f]);y(h===d,(()=>`Error in matMul: inner shapes (${h}) and (${d}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${r} must match.`));const _=n?[b,h,p]:[b,p,h],I=r?[v,f,d]:[v,d,f],C=pB({inputs:{x:t},backend:i,attrs:{shape:_}}),S=pB({inputs:{x:e},backend:i,attrs:{shape:I}}),T=[C,S],E=Math.max(b,v),N=n?C.shape[1]:C.shape[2],A=null!=o,R=null!=s,$="leakyrelu"===l,D=null!=l?oB(l,!0):null,O=A||R||$||null!=D;let F;if((1===p||1===f)&&N>EB&&!1===O){let t=C,e=S;n&&(t=SB({inputs:{x:C},backend:i,attrs:{perm:[0,2,1]}}),T.push(t)),r&&(e=SB({inputs:{x:S},backend:i,attrs:{perm:[0,2,1]}}),T.push(e));const o=1!==f,s=1===f;let a=t;o&&(a=pB({inputs:{x:t},backend:i,attrs:{shape:[E,N,1]}}),T.push(a));const l=1===f?2:1;let u=e;s&&(u=pB({inputs:{x:e},backend:i,attrs:{shape:[E,1,N]}}),T.push(u));const c=cB({inputs:{a:a,b:u},backend:i});F=IB({inputs:{x:c},backend:i,attrs:{axis:l,keepDims:!0}}),T.push(c)}else{const l=zi(t.dtype,e.dtype),u=new sB(_,I,[E,p,f],n,r,A,D,R,$),c=[C,S];if(null!=o&&c.push(o),R&&c.push(s),$){const t=i.makeTensorInfo([],"float32",ei(a,"float32"));c.push(t),T.push(t)}F=i.runWebGLProgram(u,c,l)}const M=pB({inputs:{x:F},backend:i,attrs:{shape:k}});T.push(F);for(const y of T)i.disposeIntermediateTensorInfo(y);return M}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function AB(t){const{inputs:e,backend:n,attrs:r}=t,{a:i,b:o,bias:s,preluActivationWeights:a}=e,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:h}=r;return NB({a:i,b:o,transposeA:l,transposeB:u,backend:n,bias:s,preluActivationWeights:a,leakyreluAlpha:h,activation:c})}const RB={kernelName:kr,backendName:"webgl",kernelFunc:AB},$B="return abs(x);";function DB(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])&&"complex64"!==r.dtype){const t=n.texData.get(r.dataId),e=zL(t.values);return n.makeTensorInfo(r.shape,r.dtype,e)}let i;return i=it().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new Ez(r.shape,$B):new fz(r.shape,$B),n.runWebGLProgram(i,[r],r.dtype)}const OB={kernelName:ht,backendName:"webgl",kernelFunc:DB},FB=gz+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n",MB=rB({opSnippet:FB}),PB={kernelName:dt,backendName:"webgl",kernelFunc:MB},LB=gz+"\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));",zB=rB({opSnippet:LB}),BB={kernelName:pt,backendName:"webgl",kernelFunc:zB},WB="return a + b;",UB=iB({opSnippet:WB,packedOpSnippet:WB,supportsComplex:!0,cpuKernelImpl:sL}),VB={kernelName:ft,backendName:"webgl",kernelFunc:UB};
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class jB{constructor(t,e){this.outputShape=[],this.outputShape=t,this.variableNames=e.map(((t,e)=>`T${e}`));const n=[];this.variableNames.forEach((t=>{n.push(`float v${t} = get${t}AtOutCoords();`)}));const r=this.variableNames.map((t=>`v${t}`)).join(" + ");this.userCode=`\n      void main() {\n        ${n.join("\n        ")}\n\n        float result = ${r};\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class HB{constructor(t,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=e.map(((t,e)=>`T${e}`));const n=[];this.variableNames.forEach((t=>{n.push(`vec4 v${t} = get${t}AtOutCoords();`)}));const r=this.variableNames.map((t=>`v${t}`)).join(" + ");this.userCode=`\n      void main() {\n        ${n.join("\n        ")}\n\n        vec4 result = ${r};\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function GB(t){const{inputs:e,backend:n}=t,r=e;if(1===r.length)return jz({inputs:{x:r[0]},backend:n});if(r.length>it().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const t=Math.floor(r.length/2),e=GB({inputs:r.slice(0,t),backend:n}),i=GB({inputs:r.slice(t),backend:n});return GB({inputs:[e,i],backend:n})}const i=r.map((t=>t.dtype)).reduce(((t,e)=>zi(t,e))),o=r.map((t=>t.shape)),s=it().getBool("WEBGL_PACK"),a=s?new HB(r[0].shape,o):new jB(r[0].shape,o);return n.runWebGLProgram(a,r,i)}const qB={kernelName:gt,backendName:"webgl",kernelFunc:GB};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function KB(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:o,keepDims:s}=r,a=i.shape.length,l=T(o,i.shape);let u=l;const c=dc(u,a);let h=i;null!=c&&(h=SB({inputs:{x:i},backend:n,attrs:{perm:c}}),u=fc(u.length,a)),hc("all",u,a);const[d,p]=uc(h.shape,u),f=w(p),g=pB({inputs:{x:h},backend:n,attrs:{shape:[-1,f]}}),m=bB(g,g.dtype,"all",n);let y;if(s){const t=cc(d,l);y=pB({inputs:{x:m},backend:n,attrs:{shape:t}})}else y=pB({inputs:{x:m},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),null!=c&&n.disposeIntermediateTensorInfo(h),y}const XB={kernelName:mt,backendName:"webgl",kernelFunc:KB};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function YB(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:o,keepDims:s}=r,a=i.shape.length,l=T(o,i.shape);let u=l;const c=dc(u,a);let h=i;null!=c&&(h=SB({inputs:{x:i},backend:n,attrs:{perm:c}}),u=fc(u.length,a)),hc("any",u,a);const[d,p]=uc(h.shape,u),f=w(p),g=pB({inputs:{x:h},backend:n,attrs:{shape:[-1,f]}}),m=bB(g,g.dtype,"any",n);let y;if(s){const t=cc(d,l);y=pB({inputs:{x:m},backend:n,attrs:{shape:t}})}else y=pB({inputs:{x:m},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),null!=c&&n.disposeIntermediateTensorInfo(h),y}const JB={kernelName:yt,backendName:"webgl",kernelFunc:YB};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class ZB{constructor(t,e,n){this.variableNames=["A"];const{windowSize:r,batchSize:i,outSize:o}=t;n||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];const s="max"===e?">":"<",a=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${r};\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ${r}; i++) {\n          int inIdx = ${a};\n          float candidate = getA(batch, inIdx);\n          if (candidate ${s} bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    `}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class QB{constructor(t,e,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,y(t.length>2,(()=>`Packed arg${n.charAt(0).toUpperCase()+n.slice(1)} supports only inputs with rank above 2.`));const i=t[t.length-1],o=Math.ceil(i/e);this.outputShape=t.slice(0,-1),o>1&&this.outputShape.push(o),r||this.variableNames.push("bestIndicesA");const s=this.outputShape,a=s.length,l=vP(a),u=nz("coords",a);let c,h;if(1===o){h=a+1;const t=vP(h);c=`\n        ${t} sourceLocR = ${t}(${u.join()}, 0);\n        ++${u[a-1]};\n        ${t} sourceLocG = ${t}(${u.join()}, 0);\n        ++${u[a-2]};\n        ${t} sourceLocA = ${t}(${u.join()}, 0);\n        --${u[a-1]};\n        ${t} sourceLocB = ${t}(${u.join()}, 0);\n        --${u[a-2]};`}else h=a,c=`\n        ${l} sourceLocR = coords;\n        ++${u[a-1]};\n        ${l} sourceLocG = coords;\n        ++${u[a-2]};\n        ${l} sourceLocA = coords;\n        --${u[a-1]};\n        ${l} sourceLocB = coords;\n        --${u[a-2]};`;const d=["x","y","z","w","u","v"].slice(0,h),p="."+d[h-1],f=d.map((t=>"int "+t)),g=nz("sourceLocR",h-1).concat("inIdx.r"),m=nz("sourceLocG",h-1).concat("inIdx.g"),b=nz("sourceLocB",h-1).concat("inIdx.b"),v=nz("sourceLocA",h-1).concat("inIdx.a"),w="max"===n?"greaterThan":"lessThan",x=r?"":`\n          inIdx = round(vec4(getBestIndicesAChannel(${g.join()}),\n                             getBestIndicesAChannel(${m.join()}),\n                             getBestIndicesAChannel(${b.join()}),\n                             getBestIndicesAChannel(${v.join()})));`,k=`vec4(\n            getAChannel(${g.join()}),\n            hasNextCol ? getAChannel(${m.join()}) : 0.,\n            hasNextRow ? getAChannel(${b.join()}) : 0.,\n            hasNextRow && hasNextCol ? getAChannel(${v.join()}) : 0.)`,_=r?"":`\n      float getBestIndicesAChannel(${f.join()}) {\n        return getChannel(getBestIndicesA(${d.join()}),\n                                          vec2(${d.slice(-2).join()}));\n      }`;this.userCode=`\n      float getAChannel(${f.join()}) {\n        return getChannel(getA(${d.join()}),\n                               vec2(${d.slice(-2).join()}));\n      }\n      ${_}\n      void main() {\n        ${l} coords = getOutputCoords();\n        bool hasNextCol = ${u[a-1]} < ${s[a-1]-1};\n        bool hasNextRow = ${u[a-2]} < ${s[a-2]-1};\n        ${c}\n        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},\n          sourceLocB${p}, sourceLocA${p}) * ${e};\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ${k};\n\n        for (int i = 0; i < ${e}; i++) {\n          inIdx = srcIdx;\n          ${x}\n          vec4 candidate = ${k};\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(${w}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function tW(t,e,n,r=null){let i=e.shape[0],o=e.shape[1];null!=r&&(i=r.shape[0],o=r.shape[1]);const s=Yp(o),a={windowSize:s,inSize:o,batchSize:i,outSize:Math.ceil(o/s)},l=new ZB(a,n,null==r),u=[e];null!=r&&u.push(r);const c=t.runWebGLProgram(l,u,"int32");if(1===c.shape[1])return c;const h=tW(t,e,n,c);return t.disposeIntermediateTensorInfo(c),h}function eW(t,e,n,r=null){const i=null!=r?r.shape:e.shape,o=i[i.length-1],s=Yp(o),a=new QB(i,s,n,null==r),l=null==r?[e]:[e,r],u=t.runWebGLProgram(a,l,"int32");if(u.shape.length===e.shape.length){const r=eW(t,e,n,u);return t.disposeIntermediateTensorInfo(u),r}return u}function nW(t,e,n,r){const i=[n];if(hc("arg"+r.charAt(0).toUpperCase()+r.slice(1),i,e.shape.length),!it().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const n=[],o=t.texData.get(e.dataId),s=null!==o&&o.isPacked;let a=e;s&&(a=t.unpackTensor(e),n.push(a));const[l,u]=uc(a.shape,i),c=w(u),h=pB({inputs:{x:a},backend:t,attrs:{shape:[-1,c]}});n.push(h);const d=tW(t,h,r);n.push(d);const p=pB({inputs:{x:d},backend:t,attrs:{shape:l}});return n.forEach((e=>t.disposeIntermediateTensorInfo(e))),p}return eW(t,e,r)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function rW(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:o}=r;let s=T(o,i.shape);const a=dc(s,i.shape.length);let l=i;const u=[];null!=a&&(l=SB({inputs:{x:i},backend:n,attrs:{perm:a}}),u.push(l),s=fc(s.length,l.shape.length)),hc("argMax",[s[0]],l.shape.length);const c=nW(n,l,s[0],"max");return u.forEach((t=>n.disposeIntermediateTensorInfo(t))),c}const iW={kernelName:bt,backendName:"webgl",kernelFunc:rW};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function oW(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:o}=r;let s=T(o,i.shape);const a=dc(s,i.shape.length);let l=i;const u=[];null!=a&&(l=SB({inputs:{x:i},backend:n,attrs:{perm:a}}),u.push(l),s=fc(s.length,l.shape.length)),hc("argMin",[s[0]],l.shape.length);const c=nW(n,l,s[0],"min");return u.forEach((t=>n.disposeIntermediateTensorInfo(t))),c}const sW={kernelName:vt,backendName:"webgl",kernelFunc:oW},aW=gz+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n",lW=rB({opSnippet:aW}),uW={kernelName:wt,backendName:"webgl",kernelFunc:lW},cW=gz+"return log(x + sqrt(x * x + 1.0));",hW=rB({opSnippet:cW}),dW={kernelName:xt,backendName:"webgl",kernelFunc:hW},pW=gz+"\n  return atan(x);\n",fW=rB({opSnippet:pW}),gW={kernelName:kt,backendName:"webgl",kernelFunc:fW},mW=Bz+"\n  return atan(a, b);\n",yW="\n  vec4 result = atan(a, b);\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+Uz+"\n  return result;\n",bW=iB({opSnippet:mW,packedOpSnippet:yW}),vW={kernelName:It,backendName:"webgl",kernelFunc:bW},wW=gz+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;",xW=rB({opSnippet:wW}),kW={kernelName:_t,backendName:"webgl",kernelFunc:xW};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class _W{constructor(t,e,n,r=!1,i=!1){if(this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");const o=t.filterWidth,s=t.strideHeight,a=t.strideWidth,l=t.dilationHeight,u=t.dilationWidth,c=t.effectiveFilterHeight,h=t.effectiveFilterWidth,d=t.padInfo.top,p=t.padInfo.left;this.outputShape=t.outShape;const f="avg"===e,g=`((batch  * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + d`,m=`(xR * ${t.inWidth} + xC) * ${t.inChannels} + d`;let y="0.0";if(f||(y="-1.0 / 1e-20"),n){const e=">=";return void(this.userCode=`\n        const ivec2 strides = ivec2(${s}, ${a});\n        const ivec2 pads = ivec2(${d}, ${p});\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ${c};\n              wR += ${l}) {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${h};\n                wC += ${u}) {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ${e} currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ${r?i?g:m:`wR * ${h} + wC`};\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      `)}const b="max";let v=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"avg"===e&&(v="avgValue / max(count, 1.0)");const w=4*Math.floor(o/4),x=o%4,k=`\n      if (${f}) {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ${b}(values, minMaxValue);\n      }\n    `;this.userCode=`\n      const ivec2 strides = ivec2(${s}, ${a});\n      const ivec2 pads = ivec2(${d}, ${p});\n      const float initializationValue = ${y};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ${t.inWidth}) {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(${y});\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ${c};\n            wR += ${l}) {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ${t.inHeight}) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${w}; wC += 4) {\n            int xC = xCCorner + wC * ${u};\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${u}, d),\n              getValue(batch, xR, xC + 2 * ${u}, d),\n              getValue(batch, xR, xC + 3 * ${u}, d)\n            );\n\n            ${k}\n          }\n\n          int xC = xCCorner + ${w};\n          if (${1===x}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ${k}\n          } else if (${2===x}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${u}, d),\n              initializationValue,\n              initializationValue\n            );\n\n            ${k}\n          } else if (${3===x}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${u}, d),\n              getValue(batch, xR, xC + 2 * ${u}, d),\n              initializationValue\n            );\n\n            ${k}\n          }\n        }\n        setOutput(${v});\n      }\n    `}}class IW{constructor(t,e,n,r=!1,i=!1){if(this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");const o=t.filterWidth,s=t.strideDepth,a=t.strideHeight,l=t.strideWidth,u=t.dilationDepth,c=t.dilationHeight,h=t.dilationWidth,d=t.effectiveFilterDepth,p=t.effectiveFilterHeight,f=t.effectiveFilterWidth,g=t.padInfo.front,m=t.padInfo.top,y=t.padInfo.left;this.outputShape=t.outShape;const b="avg"===e;let v="0.0";if(b||(v="-1.0 / 1e-20"),n){const e=">=";return void(this.userCode=`\n        const ivec3 strides =\n            ivec3(${s}, ${a}, ${l});\n        const ivec3 pads = ivec3(${g}, ${m}, ${y});\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ${d};\n              wD += ${u}) {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ${t.inDepth}) {\n              continue;\n            }\n\n            for (int wR = 0; wR < ${p};\n                wR += ${c}) {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ${t.inHeight}) {\n                continue;\n              }\n\n              for (int wC = 0; wC < ${f};\n                  wC += ${h}) {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ${t.inWidth}) {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ${e} currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ${r?i?`(((batch * ${t.inDepth} + xD) * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`((xD * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`wD * ${p} * ${f} +\n                      wR * ${f} + wC`};\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      `)}const w="max";let x=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"avg"===e&&(x="avgValue / max(count, 1.0)");const k=4*Math.floor(o/4),_=o%4,I=`\n      if (${b}) {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ${w}(values, minMaxValue);\n      }\n    `;this.userCode=`\n      const ivec3 strides =\n        ivec3(${s}, ${a}, ${l});\n      const ivec3 pads = ivec3(${g}, ${m}, ${y});\n      const float initializationValue = ${v};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ${t.inWidth}) {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(${v});\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ${d};\n            wD += ${u}) {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ${t.inDepth}) {\n            continue;\n          }\n\n          for (int wR = 0; wR < ${p};\n            wR += ${c}) {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${k}; wC += 4) {\n              int xC = xCCorner + wC * ${h};\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${h}, ch),\n                getValue(batch, xD, xR, xC + 2 * ${h}, ch),\n                getValue(batch, xD, xR, xC + 3 * ${h}, ch)\n              );\n\n              ${I}\n            }\n\n            int xC = xCCorner + ${k};\n            if (${1===_}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ${I}\n            } else if (${2===_}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${h}, ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ${I}\n            } else if (${3===_}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${h}, ch),\n                getValue(batch, xD, xR, xC + 2 * ${h}, ch),\n                initializationValue\n              );\n\n              ${I}\n            }\n          }\n        }\n        setOutput(${x});\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function CW(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e;xM(i,"avgPool");const{filterSize:o,strides:s,pad:a,dimRoundingMode:l}=r,u=1;y($l(s,u),(()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${u}'`));const c=bl(i.shape,o,s,u,a,l);if(1===c.filterWidth&&1===c.filterHeight&&x(c.inShape,c.outShape))return jz({inputs:{x:i},backend:n});const h=new _W(c,"avg",!1);return n.runWebGLProgram(h,[i],"float32")}const SW={kernelName:Ct,backendName:"webgl",kernelFunc:CW};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function TW(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{filterSize:o,strides:s,pad:a,dimRoundingMode:l,dataFormat:u}=r,c=[1,1,1],h=vl(i.shape,o,s,c,a,l,u),d=new IW(h,"avg",!1);return n.runWebGLProgram(d,[i],"float32")}const EW={kernelName:Tt,backendName:"webgl",kernelFunc:TW};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class NW{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,i=t.strideWidth,o=t.dilationHeight,s=t.dilationWidth,a=t.effectiveFilterHeight,l=t.effectiveFilterWidth,u=a-1-t.padInfo.top,c=l-1-t.padInfo.left,h=1/(e*n);this.userCode=`\n      const ivec2 pads = ivec2(${u}, ${c});\n      const float avgMultiplier = float(${h});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${a};\n            wR += ${o}) {\n          float dyR = float(dyRCorner + wR) / ${r}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ${l};\n            wC+= ${s}) {\n            float dyC = float(dyCCorner + wC) / ${i}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class AW{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const e=t.filterDepth,n=t.filterHeight,r=t.filterWidth,i=t.strideDepth,o=t.strideHeight,s=t.strideWidth,a=t.dilationDepth,l=t.dilationHeight,u=t.dilationWidth,c=t.effectiveFilterDepth,h=t.effectiveFilterHeight,d=t.effectiveFilterWidth,p=c-1-t.padInfo.front,f=h-1-t.padInfo.top,g=d-1-t.padInfo.left,m=1/(e*n*r);this.userCode=`\n      const ivec3 pads = ivec3(${p}, ${f}, ${g});\n      const float avgMultiplier = float(${m});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ${c};\n            wD += ${a}) {\n          float dyD = float(dyDCorner + wD) / ${i}.0;\n\n          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ${h};\n              wR += ${l}) {\n            float dyR = float(dyRCorner + wR) / ${o}.0;\n\n            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ${d};\n                wC += ${u}) {\n              float dyC = float(dyCCorner + wC) / ${s}.0;\n\n              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function RW(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,input:o}=e,s=o,{filterSize:a,strides:l,pad:u,dimRoundingMode:c}=r,h=[1,1,1],d=vl(s.shape,a,l,h,u,c),p=new AW(d);return n.runWebGLProgram(p,[i],s.dtype)}const $W={kernelName:Et,backendName:"webgl",kernelFunc:RW};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function DW(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,input:o}=e,s=o;xM([i,o],"avgPoolGrad");const{filterSize:a,strides:l,pad:u}=r,c=bl(s.shape,a,l,1,u),h=new NW(c);return n.runWebGLProgram(h,[i],s.dtype)}const OW={kernelName:St,backendName:"webgl",kernelFunc:DW};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function FW(t){const{inputs:e,backend:n,attrs:r}=t,{a:i,b:o}=e,{transposeA:s,transposeB:a}=r;return NB({a:i,b:o,transposeA:s,transposeB:a,backend:n})}const MW={kernelName:Nt,backendName:"webgl",kernelFunc:FW};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class PW{constructor(t,e,n,r,i,o){this.outputShape=[],this.variableNames=["x","mean","variance"],ba(t,e),ba(t,n);let s="0.0";null!=r&&(ba(t,r),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");let a="1.0";null!=i&&(ba(t,i),this.variableNames.push("scale"),a="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ${s};\n        float scale = ${a};\n        float inv = scale * inversesqrt(variance + float(${o}));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class LW{constructor(t,e,n,r,i,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],ba(t,e),ba(t,n);let s="vec4(0.0)";null!=r&&(ba(t,r),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");let a="vec4(1.0)";null!=i&&(ba(t,i),this.variableNames.push("scale"),a="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`\n      void main() {\n        vec4 offset = ${s};\n        vec4 scale = ${a};\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(${o}));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const zW=({inputs:t,backend:e,attrs:n})=>{const{x:r,mean:i,variance:o,offset:s,scale:a}=t;y(i.shape.length===o.shape.length,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),y(null==s||i.shape.length===s.shape.length,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),y(null==a||i.shape.length===a.shape.length,(()=>"Batch normalization gradient requires mean and scale to have equal ranks."));let{varianceEpsilon:l}=n;null==l&&(l=.001);const u=[r,i,o];let c=null;null!=s&&(c=s.shape,u.push(s));let h=null;null!=a&&(h=a.shape,u.push(a));const d=it().getBool("WEBGL_PACK_NORMALIZATION")?new LW(r.shape,i.shape,o.shape,c,h,l):new PW(r.shape,i.shape,o.shape,c,h,l),p=e.runWebGLProgram(d,u,u[0].dtype);return p},BW={kernelName:ke,backendName:"webgl",kernelFunc:zW};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class WW{constructor(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;const e=vP(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=VW(this.rank);let r;const i=t.map(((t,e)=>`sourceLoc.${UW[e]} = start[${e}] + coords.${UW[e]};`));r=`\n        ${e} sourceLoc;\n        ${e} coords = getOutputCoords();\n        ${i.join("\n")}\n      `,this.userCode=`\n      void main() {\n        ${r}\n        setOutput(getSource(${n}));\n      }\n    `}}const UW=["x","y","z","w","u","v"];function VW(t){if(1===t)return"sourceLoc";if(t<=6)return UW.slice(0,t).map((t=>"sourceLoc."+t)).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class jW{constructor(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const e=vP(this.rank),n=nz("coords",this.rank),r=nz("sourceLoc",this.rank),i=1===this.rank?"sourceLoc":`vec2(${r.slice(-2).join()})`,o=`getChannel(getSource(${r.join()}), ${i})`,s=`\n      result.x = ${o};\n      if (++${n[this.rank-1]} < ${t[this.rank-1]}) {\n        ++${r[this.rank-1]};\n        result.y = ${o};\n        --${r[this.rank-1]};\n      }\n    `,a=1===this.rank?"":`\n      --${n[this.rank-1]};\n      if (++${n[this.rank-2]} < ${t[this.rank-2]}) {\n        ++${r[this.rank-2]};\n        result.z = ${o};\n        if (++${n[this.rank-1]} < ${t[this.rank-1]}) {\n          ++${r[this.rank-1]};\n          result.w = ${o};\n        }\n      }\n    `,l=this.rank<=4?`sourceLoc = coords +\n            ${e}(${t.map(((t,e)=>`start[${e}]`)).join()});`:t.map(((t,e)=>`${r[e]} = ${n[e]} + start[${e}];`)).join("\n");this.userCode=`\n      void main() {\n        ${e} coords = getOutputCoords();\n        ${e} sourceLoc;\n        ${l}\n        vec4 result = vec4(0.);\n        ${s}\n        ${a}\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function HW(t,e,n,r){const i=r.texData.get(t.dataId),o=r.makeTensorInfo(n,t.dtype),s=r.texData.get(o.dataId);Object.assign(s,i),s.refCount=1,s.shape=n,s.dtype=t.dtype;let a=sl(e,U(t.shape));i.slice&&(a+=i.slice.flatOffset),s.slice={flatOffset:a,origDataId:i.slice&&i.slice.origDataId||t.dataId};const l=r.dataRefCount.get(s.slice.origDataId)||1;return r.dataRefCount.set(s.slice.origDataId,l+1),o}function GW(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{begin:o,size:s}=r,[a,l]=al(i,o,s);if(qa(i,a,l),0===w(l))return n.makeTensorInfo(l,i.dtype,[]);if(n.shouldExecuteOnCPU([i])||"string"===i.dtype){const t=n.texData.get(i.dataId),e=BL(t.values,a,l,i.shape,i.dtype);return n.makeTensorInfo(l,i.dtype,e)}const{isPacked:u}=n.texData.get(i.dataId),c=ol(i.shape,a,l);if(u||!c){const t=it().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new jW(l):new WW(l),e=[a];return n.runWebGLProgram(t,[i],i.dtype,e)}return n.uploadToGPU(i.dataId),HW(i,a,l,n)}const qW={kernelName:zn,backendName:"webgl",kernelFunc:GW},KW=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{blockShape:o,crops:s}=r;y(i.shape.length<=4,(()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"));const a=o.reduce(((t,e)=>t*e)),l=Zp(i.shape,o,a),u=Qp(l.length,o.length),c=tf(i.shape,o,a),h=ef(s,o.length),d=nf(c,s,o.length),p=[],f=pB({inputs:{x:i},backend:n,attrs:{shape:l}}),g=SB({inputs:{x:f},backend:n,attrs:{perm:u}}),m=pB({inputs:{x:g},backend:n,attrs:{shape:c}}),b=GW({inputs:{x:m},backend:n,attrs:{begin:h,size:d}});return p.push(f),p.push(g),p.push(m),p.forEach((t=>n.disposeIntermediateTensorInfo(t))),b},XW={kernelName:At,backendName:"webgl",kernelFunc:KW};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function YW(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,weights:o}=e,{size:s}=r,a=n.readSync(i.dataId),l=n.readSync(o.dataId),u=aL(a,l,o.dtype,o.shape,s);return n.makeTensorInfo([s],o.dtype,u)}const JW={kernelName:Rt,backendName:"webgl",kernelFunc:YW},ZW="\n  int r = int(a.r) & int(b.r);\n  int g = int(a.g) & int(b.g);\n  int rb = int(a.b) & int(b.b);\n  int ra = int(a.a) & int(b.a);\n  return vec4(r, g, rb, ra);\n",QW="\n  return float(int(a.r) & int(b.r));\n";function tU(t){const{inputs:e,backend:n}=t,{a:r,b:i}=e,o=it().getBool("WEBGL_PACK_BINARY_OPERATIONS"),s=it().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([r,i])||1===s){const t=n.texData.get(r.dataId).values,e=n.texData.get(i.dataId).values,[o,s]=uL(r.shape,i.shape,t,e,r.dtype),a=n.makeTensorInfo(s,r.dtype),l=n.texData.get(a.dataId);return l.values=o,a}let a;return a=o?new Vz(ZW,r.shape,i.shape,!1):new Wz(QW,r.shape,i.shape),n.runWebGLProgram(a,[r,i],r.dtype)}const eU={kernelName:$t,backendName:"webgl",kernelFunc:tU};
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function nU(t){const{inputs:e,backend:n}=t,{s0:r,s1:i}=e,o=n.readSync(r.dataId),s=n.readSync(i.dataId),a=ba(Array.from(o),Array.from(s));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const rU={kernelName:Ot,backendName:"webgl",kernelFunc:nU},iU="return float(a != b);",oU=iB({opSnippet:iU,cpuKernelImpl:AL,dtype:"bool"}),sU={kernelName:an,backendName:"webgl",kernelFunc:oU};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function aU(t){const{inputs:e,backend:n}=t,{input:r}=e,i=n.texData.get(r.dataId);return jz({inputs:{x:i.complexTensorInfos.real},backend:n})}const lU={kernelName:kn,backendName:"webgl",kernelFunc:aU},uU="return float(int(x));";function cU(t,e){const n=new fz(t.shape,uU),r=e.runWebGLProgram(n,[t],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function hU(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{dtype:o}=r;if("complex64"===o){if("complex64"===i.dtype)return jz({inputs:{x:i},backend:n});const t=zc(i.shape),e=hU({inputs:{x:i},backend:n,attrs:{dtype:"float32"}}),r=Gz({inputs:{real:e,imag:t},backend:n});return t.dispose(),n.disposeIntermediateTensorInfo(e),r}if("complex64"===i.dtype){const t=aU({inputs:{input:i},backend:n}),e=hU({inputs:{x:t},backend:n,attrs:{dtype:o}});return n.disposeIntermediateTensorInfo(t),e}if(!D(i.dtype,o)){const t=jz({inputs:{x:i},backend:n});return{dataId:t.dataId,shape:t.shape,dtype:o}}if(n.shouldExecuteOnCPU([i])){const t=n.texData.get(i.dataId).values,[e,r,s]=cL(t,i.shape,i.dtype,o);return n.makeTensorInfo(e,r,s)}if("int32"===o)return cU(i,n);if("bool"===o){const t=n.makeTensorInfo([],"bool",N("bool",1)),e={a:i,b:t},r=oU({inputs:e,backend:n});return n.disposeIntermediateTensorInfo(t),r}throw new Error(`Error in Cast: failed to cast ${i.dtype} to ${o}`)}const dU={kernelName:Ft,backendName:"webgl",kernelFunc:hU},pU="return ceil(x);",fU=rB({opSnippet:pU,packedOpSnippet:pU,cpuKernelImpl:hL}),gU={kernelName:Mt,backendName:"webgl",kernelFunc:fU};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class mU{constructor(t){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode="\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class yU{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode="\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function bU(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{clipValueMin:o,clipValueMax:s}=r;let a;a=it().getBool("WEBGL_PACK_CLIP")?new yU(i.shape):new mU(i.shape);const l=[[o],[s]];return n.runWebGLProgram(a,[i],i.dtype,l)}const vU={kernelName:Pt,backendName:"webgl",kernelFunc:bU};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class wU{constructor(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function xU(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function kU(t){const{inputs:e,backend:n}=t,{x:r}=e,i=n.texData.get(r.dataId),o=new wU(r.shape),s=[xU(r,i.complexTensorInfos.real),xU(r,i.complexTensorInfos.imag)];return n.runWebGLProgram(o,s,s[0].dtype)}const _U={kernelName:zt,backendName:"webgl",kernelFunc:kU};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class IU{constructor(t){this.outputShape=[],this.outputShape=Vp(t,1),this.variableNames=t.map(((t,e)=>`T${e}`));const e=new Array(t.length-1);e[0]=t[0][1];for(let o=1;o<e.length;o++)e[o]=e[o-1]+t[o][1];const n=[`if (yC < ${e[0]}) setOutput(getT0(yR, yC));`];for(let o=1;o<e.length;o++){const t=e[o-1];n.push(`else if (yC < ${e[o]}) setOutput(getT${o}(yR, yC-${t}));`)}const r=e.length,i=e[e.length-1];n.push(`else setOutput(getT${r}(yR, yC-${i}));`),this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ${n.join("\n        ")}\n      }\n    `}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class CU{constructor(t,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Vp(t,e);const n=this.outputShape,r=n.length,i=vP(r),o=nz("coords",r),s=["x","y","z","w","u","v"].slice(0,r);this.variableNames=t.map(((t,e)=>`T${e}`));const a=new Array(t.length-1);a[0]=t[0][e];for(let f=1;f<a.length;f++)a[f]=a[f-1]+t[f][e];const l=s[e],u=s.slice(-2),c=s.join();let h=`if (${l} < ${a[0]}) {\n        return getChannel(\n            getT0(${c}), vec2(${u.join()}));\n        }`;for(let f=1;f<a.length;f++){const t=a[f-1];h+=`\n        if (${l} < ${a[f]}  && ${l} >= ${a[f-1]}) {\n          return getChannel(\n            getT${f}(${SU(s,l,t)}),\n            vec2(${SU(u,l,t)}));\n        }`}const d=a.length,p=a[a.length-1];h+=`\n        return getChannel(\n          getT${d}(${SU(s,l,p)}),\n          vec2(${SU(u,l,p)}));`,this.userCode=`\n      float getValue(${s.map((t=>"int "+t))}) {\n        ${h}\n      }\n\n      void main() {\n        ${i} coords = getOutputCoords();\n        vec4 result = vec4(getValue(${o}), 0., 0., 0.);\n\n        ${o[r-1]} = ${o[r-1]} + 1;\n        if (${o[r-1]} < ${n[r-1]}) {\n          result.g = getValue(${o});\n        }\n\n        ${o[r-2]} = ${o[r-2]} + 1;\n        if (${o[r-2]} < ${n[r-2]}) {\n          result.a = getValue(${o});\n        }\n\n        ${o[r-1]} = ${o[r-1]} - 1;\n        if (${o[r-2]} < ${n[r-2]} &&\n            ${o[r-1]} < ${n[r-1]}) {\n          result.b = getValue(${o});\n        }\n        setOutput(result);\n      }\n    `}}function SU(t,e,n){const r=t.indexOf(e),i=t.map(((t,e)=>e===r?`${t} - ${n}`:t));return i.join()}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function TU(t){const{inputs:e,backend:n}=t,{input:r}=e,i=n.texData.get(r.dataId);return jz({inputs:{x:i.complexTensorInfos.imag},backend:n})}const EU={kernelName:Ne,backendName:"webgl",kernelFunc:TU};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function NU(t,e,n){const r=t[0].dtype;if("complex64"===r){const r=t.map((t=>aU({inputs:{input:t},backend:n}))),i=t.map((t=>TU({inputs:{input:t},backend:n}))),o=NU(r,e,n),s=NU(i,e,n),a=Gz({inputs:{real:o,imag:s},backend:n});return r.forEach((t=>n.disposeIntermediateTensorInfo(t))),i.forEach((t=>n.disposeIntermediateTensorInfo(t))),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),a}let i=n.shouldExecuteOnCPU(t);if("string"===r&&(i=!0),i){const i=t.map((t=>{const r=w(t.shape.slice(e)),i=[-1,r];return pB({inputs:{x:t},backend:n,attrs:{shape:i}})})),o=i.map((t=>({vals:n.readSync(t.dataId),shape:t.shape}))),s=Vp(i.map((t=>t.shape)),1),a=1===i[0].shape[0],l=dL(o,s,r,a),u=Vp(t.map((t=>t.shape)),e),c=n.makeTensorInfo(u,r,l);return i.forEach((t=>n.disposeIntermediateTensorInfo(t))),c}const o=t.filter((t=>w(t.shape)>0)),s=it().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&o[0].shape.length>1;if(1===o.length){const e=s?new fz(t[0].shape,xz):new Ez(t[0].shape,xz);return n.runWebGLProgram(e,t,r)}const a=it().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(o.length>a){const t=[];for(let i=0;i<o.length;i+=a){const r=o.slice(i,i+a);t.push(NU(r,e,n))}const r=NU(t,e,n);for(const e of t)n.disposeIntermediateTensorInfo(e);return r}if(s){const t=new CU(o.map((t=>t.shape)),e);return n.runWebGLProgram(t,o,r)}const{tensors2D:l,outShape:u}=AU(o,e,n),c=new IU(l.map((t=>t.shape))),h=n.runWebGLProgram(c,l,r);l.forEach((t=>n.disposeIntermediateTensorInfo(t)));const d=pB({inputs:{x:h},attrs:{shape:u},backend:n});return n.disposeIntermediateTensorInfo(h),d}function AU(t,e,n){const r=Vp(t.map((t=>t.shape)),e),i=t.map((t=>pB({inputs:{x:t},attrs:{shape:[-1,w(t.shape.slice(e))]},backend:n})));return{tensors2D:i,outShape:r}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function RU(t){const{inputs:e,backend:n,attrs:r}=t,{axis:i}=r,o=T(i,e[0].shape)[0],s=e.map((t=>t.shape));Up(s,o);const a=Vp(e.map((t=>t.shape)),o);if(0===w(a))return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter((t=>w(t.shape)>0));return 1===l.length?jz({inputs:{x:l[0]},backend:n}):NU(l,o,n)}const $U={kernelName:Bt,backendName:"webgl",kernelFunc:RU};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class DU{constructor(t,e=!1,n=null,r=!1,i=!1){this.variableNames=["x","W"],this.outputShape=t.outShape;const o=t.padInfo.top,s=t.padInfo.left,a=t.strideHeight,l=t.strideWidth,u=t.dilationHeight,c=t.dilationWidth,h=t.filterHeight,d=t.filterWidth,p=4*Math.floor(t.inChannels/4),f=t.inChannels%4,g="channelsLast"===t.dataFormat,m=g?1:2,y=g?2:3,b=g?3:1;let v="",w="";n&&(v=r?`float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ${n}\n        }`:i?`float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ${n}\n        }`:`\n          float activation(float x) {\n            ${n}\n          }\n        `,w="result = activation(result);");const x=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${v}\n\n      const ivec2 strides = ivec2(${a}, ${l});\n      const ivec2 pads = ivec2(${o}, ${s});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[${b}];\n\n        ivec2 xRCCorner =\n            ivec2(coords[${m}], coords[${y}]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${h}; wR++) {\n          int xR = xRCorner + wR * ${u};\n\n          if (xR < 0 || xR >= ${t.inHeight}) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${d}; wC++) {\n            int xC = xCCorner + wC * ${c};\n\n            if (xC < 0 || xC >= ${t.inWidth}) {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ${p}; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (${g}) {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (${1===f}) {\n\n              if (${g}) {\n                dotProd +=\n                    getX(batch, xR, xC, ${p}) *\n                    getW(wR, wC, ${p}, d2);\n              } else {\n                dotProd +=\n                    getX(batch, ${p}, xR, xC) *\n                    getW(wR, wC, ${p}, d2);\n              }\n\n            } else if (${2===f}) {\n              vec2 wValues = vec2(\n                getW(wR, wC, ${p}, d2),\n                getW(wR, wC, ${p} + 1, d2)\n              );\n\n              if (${g}) {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ${p}),\n                  getX(batch, xR, xC, ${p} + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ${p}, xR, xC),\n                  getX(batch, ${p} + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (${3===f}) {\n              vec3 wValues = vec3(\n                getW(wR, wC, ${p}, d2),\n                getW(wR, wC, ${p} + 1, d2),\n                getW(wR, wC, ${p} + 2, d2)\n              );\n\n              if (${g}) {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ${p}),\n                  getX(batch, xR, xC, ${p} + 1),\n                  getX(batch, xR, xC, ${p} + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ${p}, xR, xC),\n                  getX(batch, ${p} + 1, xR, xC),\n                  getX(batch, ${p} + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ${x}\n        ${w}\n        setOutput(result);\n      }\n    `}}class OU{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const e=t.padInfo.front,n=t.padInfo.top,r=t.padInfo.left,i=t.strideDepth,o=t.strideHeight,s=t.strideWidth,a=t.dilationDepth,l=t.dilationHeight,u=t.dilationWidth,c=t.filterDepth,h=t.filterHeight,d=t.filterWidth,p=4*Math.floor(t.inChannels/4),f=t.inChannels%4;this.userCode=`\n      const ivec3 strides = ivec3(${i}, ${o}, ${s});\n      const ivec3 pads = ivec3(${e}, ${n}, ${r});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ${c}; wF++) {\n          int xF = xFCorner + wF * ${a};\n\n          if (xF < 0 || xF >= ${t.inDepth}) {\n            continue;\n          }\n\n          for (int wR = 0; wR < ${h}; wR++) {\n            int xR = xRCorner + wR * ${l};\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${d}; wC++) {\n              int xC = xCCorner + wC * ${u};\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ${p}; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (${1===f}) {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ${p}) *\n                  getW(wF, wR, wC, ${p}, d2);\n              } else if (${2===f}) {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ${p}),\n                  getX(batch, xF, xR, xC, ${p} + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ${p}, d2),\n                  getW(wF, wR, wC, ${p} + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (${3===f}) {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ${p}),\n                  getX(batch, xF, xR, xC, ${p} + 1),\n                  getX(batch, xF, xR, xC, ${p} + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ${p}, d2),\n                  getW(wF, wR, wC, ${p} + 1, d2),\n                  getW(wF, wR, wC, ${p} + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class FU{constructor(t,e=!1,n=null,r=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=EP(this.outputShape.length);const o=t.padInfo.left,s=t.strideWidth,a=t.dilationWidth,l=t.filterHeight,u=t.filterWidth,c=u;let h="\n       int xR; int xC; int xCOffset;\n       vec4 wTexel; vec4 previous; vec4 final;";for(let f=0;f<u;f++)h+=`\n           vec4 xTexelC${2*f};\n           int xTexelC${2*f}Ready;\n           vec4 xTexelC${2*f+1};\n           int xTexelC${2*f+1}Ready;\n           vec4 xC${f};`;h+=`\n     for (int r = 0; r < ${l}; r++) {\n      for (int d1 = 0; d1 < ${t.inChannels}; d1 += 2) {\n       `;for(let f=0;f<u;f++)h+=`\n           xTexelC${2*f} = vec4(0.0);\n           xTexelC${2*f}Ready = 0;\n           xTexelC${2*f+1} = vec4(0.0);\n           xTexelC${2*f+1}Ready = 0;\n           xC${f} = vec4(0.0);`;h+="\n         xR = xRCorner + r * dilations[0];\n         if (xR >=0 && xR < inDims[0]) {\n       ";for(let m=0;m<(c+1)/2;m++){const e=2*m;if(h+=`\n           xC = xCCorner + ${e*a};\n           `,1===s){if(e<u&&(o%2===1?(h+=`\n                 xCOffset = xC + 1;\n                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${e}Ready == 0) {\n                   xTexelC${e} = getX(batch, xR, xCOffset, d1);\n\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC${e}.zw = vec2(0.0);\n                   }\n                   xTexelC${e}Ready = 1;\n                 }\n               `,h+=1===a&&e>0?`\n                 xC${e} = vec4(xTexelC${e-2}.zw, xTexelC${e}.xy);\n                 `:`\n                   xCOffset = xC + 1 - 2;\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       previous.zw = vec2(0.0);\n                     }\n\n                     xC${e} = vec4(previous.zw, xTexelC${e}.xy);\n                   } else {\n                     xC${e} = vec4(0.0, 0.0, xTexelC${e}.xy);\n                   }\n                   `):h+=`\n                 if (xC >= 0 && xC < inDims[1] && xTexelC${e}Ready == 0) {\n                   xTexelC${e} = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC${e}.zw = vec2(0.0);\n                   }\n                   xTexelC${e}Ready = 1;\n                 }\n\n                 xC${e} = xTexelC${e};\n                 `,e+1<u)){const t=o%2===0?f(a):a;a%2===0&&o%2===1||a%2!==0&&o%2!==1?(h+=`\n                   xCOffset = xC + imod(pads[1], 2) + ${t};\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${e+1}Ready == 0) {\n                     xTexelC${e+1} = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       xTexelC${e+1}.zw = vec2(0.0);\n                     }\n                     xTexelC${e+1}Ready = 1;\n                   }\n                   `,h+=a>1?`\n                     xCOffset -= 2;\n                     if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                      previous = getX(batch, xR, xCOffset, d1);\n                      xC${e+1} = vec4(previous.zw, xTexelC${e+1}.xy);\n                     } else {\n                      xC${e+1} = vec4(0.0, 0.0, xTexelC${e+1}.xy);\n                     }\n                     `:`\n                     xC${e+1} = vec4(xTexelC${e}.zw, xTexelC${e+1}.xy);\n                     `):h+=1===t?`\n                     xC${e+1} = xTexelC${e};\n                     `:`\n                     xCOffset = xC + ${t};\n\n                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${e+1}Ready == 0) {\n                       xTexelC${e+1} = getX(batch, xR, xCOffset, d1);\n                       if (xCOffset + 1 >= inDims[1]) {\n                         xTexelC${e+1}.zw = vec2(0.0);\n                       }\n                       xTexelC${e+1}Ready = 1;\n                     }\n\n                     xC${e+1} = xTexelC${e+1};\n                     `}}else e<u&&(o%2===1?(h+=`\n                 xCOffset = xC + 1 - strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${e}Ready == 0) {\n                   xTexelC${e} = getX(batch, xR, xCOffset, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC${e}.zw = vec2(0.0);\n                   }\n                   xTexelC${e}Ready = 1;\n                 }\n\n                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${e+1}Ready == 0) {\n                   xTexelC${e+1} = getX(batch, xR, xC + 1, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xC + 2 >= inDims[1]) {\n                     xTexelC${e+1}.zw = vec2(0.0);\n                   }\n                   xTexelC${e+1}Ready = 1;\n                 }\n\n                 xC${e} = vec4(xTexelC${e}.zw, xTexelC${e+1}.zw);\n               `,e+1<u&&(h+=`\n                   final = vec4(0.0);\n                   xCOffset = xC + 1 + strides[1];\n                   if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                     final = getX(batch, xR, xCOffset, d1);\n                   }\n                   xC${e+1} = vec4(xTexelC${e+1}.xy, final.xy);\n                 `)):(h+=`\n                 if(xC >= 0 && xC < inDims[1] && xTexelC${e}Ready == 0) {\n                   xTexelC${e} = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC${e}.zw = vec2(0.0);\n                   }\n                   xTexelC${e}Ready = 1;\n                 }\n\n                 xCOffset = xC + strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${e+1}Ready == 0) {\n                   xTexelC${e+1} = getX(batch, xR, xCOffset, d1);\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC${e+1}.zw = vec2(0.);\n                   }\n                   xTexelC${e+1}Ready = 1;\n                 }\n\n                 xC${e} = vec4(\n                   xTexelC${e}.xy, xTexelC${e+1}.xy);\n               `,e+1<u&&(h+=`\n                   xC${e+1} = vec4(xTexelC${e}.zw, xTexelC${e+1}.zw);\n                 `)));e<u&&(h+=`\n             wTexel = getW(r, ${e}, d1, d2);\n             dotProd += xC${e}.xxzz * vec4(wTexel.xy, wTexel.xy);\n             if(d1 + 1 < ${t.inChannels}) {\n               dotProd += xC${e}.yyww * vec4(wTexel.zw, wTexel.zw);\n             }\n           `,e+1<u&&(h+=`\n               wTexel = getW(r, ${e+1}, d1, d2);\n               dotProd += xC${e+1}.xxzz * vec4(wTexel.xy, wTexel.xy);\n               if(d1 + 1 < ${t.inChannels}) {\n                 dotProd += xC${e+1}.yyww * vec4(wTexel.zw, wTexel.zw);\n               }\n             `))}h+="\n     }\n   ",h+="\n     }\n   ",h+="\n     }\n   ";let d="",p="";n&&(d=r?`vec4 activation(vec4 a) {\n           vec4 b = getPreluActivationWeightsAtOutCoords();\n           ${n}\n         }`:i?`vec4 activation(vec4 a) {\n           vec4 b = getLeakyreluAlphaAtOutCoords();\n           ${n}\n         }`:`vec4 activation(vec4 x) {\n           ${n}\n         }`,p="result = activation(result);");const g=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n       ${d}\n\n       void main() {\n         ivec4 coords = getOutputCoords();\n         int batch = coords.x;\n         ivec2 xRCCorner = coords.yz * strides - pads;\n         int d2 = coords.w;\n         int xRCorner = xRCCorner.x;\n         int xCCorner = xRCCorner.y;\n\n         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n         vec4 dotProd = vec4(0.000000000000001);\n\n         ${h}\n\n         vec4 result = dotProd - vec4(0.000000000000001);\n         ${g}\n         ${p}\n         setOutput(result);\n       }\n     `}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class MU{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=t,this.enableShapeUniforms=EP(this.outputShape.length);const{dataFormat:n}=e,r=_M(),i="channelsLast"===n,o=i?1:2,s=i?2:3,a=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${t[2]} && pos < ${t[1]}) {`;let l="";for(let u=0;u<=1;u++)for(let t=0;t<=1;t++)l+=`\n          blockIndex = rc.z + ${t};\n          pos = rc.y + ${u};\n\n          ${a}\n            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];\n            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);\n\n            if(d0 < inputShape[${o}] && d0 >= 0) {\n              // Use custom imod instead mod. On Intel GPU, mod may generate\n              // unexpected value.\n              // https://github.com/tensorflow/tfjs/issues/5447\n              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];\n              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /\n                  inChannels);\n\n              if(d1 < inputShape[${s}] && d1 >= 0) {\n\n                ch = imod(pos, inChannels);\n\n                if (${i}) {\n                  innerDims = vec2(d1, ch);\n                  result[${2*u+t}] = getChannel(\n                    getA(rc.x, d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[${2*u+t}] = getChannel(\n                    getA(rc.x, ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        `;this.userCode=`\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ${l}\n\n        ${r.output} = result;\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function PU(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&1===n&&t[0]>1?[t[0],1]:null}function LU({x:t,filter:e,convInfo:n,backend:r,bias:i=null,preluActivationWeights:o=null,leakyreluAlpha:s=0,activation:a=null}){const l=t.shape,u=r.texData.get(t.dataId),c=n.inChannels,h=l[0]*l[1]*l[2],d=n.outChannels,p="channelsLast"===n.dataFormat,f=!1,g=!1;let m;const b=[];if(null!=o){const t=PU(o.shape,p);null!=t&&(o=pB({inputs:{x:o},backend:r,attrs:{shape:t}}),b.push(o))}if(null!=i){const t=PU(i.shape,p);null!=t&&(i=pB({inputs:{x:i},backend:r,attrs:{shape:t}}),b.push(i))}const v=(1===h||1===d)&&c>EB,w=!v&&u.isPacked&&p&&null!=u.texture&&l[2]%2!==0&&x(u.shape.slice(-3),l.slice(-3));if(w){const c=l[0]*l[1]*(l[2]+1),h={dataId:t.dataId,shape:[1,c,n.inChannels],dtype:t.dtype},d=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,y(lM(u.shape,h.shape),(()=>`packed reshape ${u.shape} to ${h.shape} isn't free`));const p=pB({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});b.push(p);const v=NB({a:h,b:p,backend:r,transposeA:f,transposeB:g,bias:i,activation:a,preluActivationWeights:o,leakyreluAlpha:s}),w=r.texData.get(v.dataId);y(w.isPacked,(()=>"batchMatMul result is expected to be packed")),u.shape=d,w.shape=n.outShape,m=jz({inputs:{x:v},backend:r}),m.shape=n.outShape,b.push(v)}else{const l=n.outHeight*n.outWidth,u=pB({inputs:{x:t},backend:r,attrs:{shape:p?[n.batchSize,l,n.inChannels]:[n.batchSize,n.inChannels,l]}}),c=pB({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}}),h=NB({a:p?u:c,b:p?c:u,transposeA:!p,transposeB:g,backend:r,bias:i,activation:a,preluActivationWeights:o,leakyreluAlpha:s});m=pB({inputs:{x:h},backend:r,attrs:{shape:n.outShape}}),b.push(u),b.push(c),b.push(h)}for(const y of b)r.disposeIntermediateTensorInfo(y);return m}function zU({x:t,filter:e,convInfo:n,backend:r,bias:i=null,preluActivationWeights:o=null,leakyreluAlpha:s=0,activation:a=null}){const{filterWidth:l,filterHeight:u,inChannels:c,outWidth:h,outHeight:d,dataFormat:p}=n,f="channelsLast"===p,g=l*u*c,m=d*h,y=[n.batchSize,g,m],b=!0,v=!1,x=[];if(null!=o){const t=PU(o.shape,f);null!=t&&(o=pB({inputs:{x:o},backend:r,attrs:{shape:t}}),x.push(o))}if(null!=i){const t=PU(i.shape,f);null!=t&&(i=pB({inputs:{x:i},backend:r,attrs:{shape:t}}),x.push(i))}const k=pB({inputs:{x:e},backend:r,attrs:{shape:[1,g,w(e.shape)/g]}});x.push(k);const _=new MU(y,n),I=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],C=r.runWebGLProgram(_,[t],"float32",I),S=pB({inputs:{x:C},backend:r,attrs:{shape:y}});x.push(C),x.push(S);const T=null!=i,E=null!=o,N="leakyrelu"===a,A=a?oB(a,!0):null,R=new sB(f?S.shape:k.shape,f?k.shape:S.shape,f?[n.batchSize,m,n.outChannels]:[n.batchSize,n.outChannels,m],b,v,T,A,E,N),$=f?[S,k]:[k,S];if(i&&$.push(i),E&&$.push(o),N){const t=r.makeTensorInfo([],"float32",ei(s,"float32"));$.push(t),x.push(t)}const D=r.runWebGLProgram(R,$,"float32"),O=pB({inputs:{x:D},backend:r,attrs:{shape:n.outShape}});x.push(D);for(const w of x)r.disposeIntermediateTensorInfo(w);return O}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function BU(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:o}=e,{strides:s,pad:a,dataFormat:l,dilations:u,dimRoundingMode:c}=r,h=Ol(l),d=wl(i.shape,o.shape,s,u,a,c,!1,h);let p;if(1!==d.filterHeight||1!==d.filterWidth||1!==d.dilationHeight||1!==d.dilationWidth||1!==d.strideHeight||1!==d.strideWidth||"SAME"!==d.padInfo.type&&"VALID"!==d.padInfo.type)if(d.strideWidth<=2&&"channelsLast"===h&&it().getBool("WEBGL_EXP_CONV")){const t=new FU(d),e=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];p=n.runWebGLProgram(t,[i,o],"float32",e)}else if(it().getBool("WEBGL_CONV_IM2COL"))p=zU({x:i,filter:o,convInfo:d,backend:n});else{const t=new DU(d);p=n.runWebGLProgram(t,[i,o],"float32")}else p=LU({x:i,filter:o,convInfo:d,backend:n});const f=pB({inputs:{x:p},backend:n,attrs:{shape:d.outShape}});return n.disposeIntermediateTensorInfo(p),f}const WU={kernelName:Wt,backendName:"webgl",kernelFunc:BU};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class UU{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const e=t.strideHeight,n=t.strideWidth,r=t.padInfo.top,i=t.padInfo.left,o="channelsLast"===t.dataFormat;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ${t.batchSize}; b++) {\n          for (int yR = 0; yR < ${t.outHeight}; yR++) {\n            int xR = wR + yR * ${e} - ${r};\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int yC = 0; yC < ${t.outWidth}; yC++) {\n              int xC = wC + yC * ${n} - ${i};\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              ${o?"float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);":"float dyValue = getDy(b, d2, yR, yC);\n              float xValue = getX(b, d1, xR, xC);\n              dotProd += (xValue * dyValue);"}\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class VU{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,i=t.strideWidth,o="channelsLast"===t.dataFormat,s=e-1-t.padInfo.top,a=n-1-t.padInfo.left,l=o?1:2,u=o?2:3,c=o?3:1;this.userCode=`\n      const ivec2 pads = ivec2(${s}, ${a});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[${c}];\n\n        ivec2 dyCorner = ivec2(coords[${l}], coords[${u}]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${e}; wR++) {\n          float dyR = float(dyRCorner + wR) / ${r}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ${e} - 1 - wR;\n\n          for (int wC = 0; wC < ${n}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${i}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ${n} - 1 - wC;\n\n            for (int d2 = 0; d2 < ${t.outChannels}; d2++) {\n\n              if (${o}) {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class jU{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const e=t.strideDepth,n=t.strideHeight,r=t.strideWidth,i=t.padInfo.front,o=t.padInfo.top,s=t.padInfo.left;this.userCode=`\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ${t.batchSize}; b++) {\n          for (int yF = 0; yF < ${t.outDepth}; yF++) {\n            int xF = wF + yF * ${e} - ${i};\n\n            if (xF < 0 || xF >= ${t.inDepth}) {\n              continue;\n            }\n\n            for (int yR = 0; yR < ${t.outHeight}; yR++) {\n              int xR = wR + yR * ${n} - ${o};\n\n              if (xR < 0 || xR >= ${t.inHeight}) {\n                continue;\n              }\n\n              for (int yC = 0; yC < ${t.outWidth}; yC++) {\n                int xC = wC + yC * ${r} - ${s};\n\n                if (xC < 0 || xC >= ${t.inWidth}) {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class HU{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterDepth,n=t.filterHeight,r=t.filterWidth,i=t.strideDepth,o=t.strideHeight,s=t.strideWidth,a=e-1-t.padInfo.front,l=n-1-t.padInfo.top,u=r-1-t.padInfo.left;this.userCode=`\n      const ivec3 pads = ivec3(${a}, ${l}, ${u});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ${e}; wF++) {\n          float dyF = float(dyFCorner + wF) / ${i}.0;\n\n          if (dyF < 0.0 || dyF >= ${t.outDepth}.0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ${e} - 1 - wF;\n\n          for (int wR = 0; wR < ${n}; wR++) {\n            float dyR = float(dyRCorner + wR) / ${o}.0;\n\n            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ${n} - 1 - wR;\n\n            for (int wC = 0; wC < ${r}; wC++) {\n              float dyC = float(dyCCorner + wC) / ${s}.0;\n\n              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ${r} - 1 - wC;\n\n              for (int d2 = 0; d2 < ${t.outChannels}; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function GU(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,dy:o}=e,{strides:s,pad:a,dataFormat:l,dimRoundingMode:u,filterShape:c}=r,h=Ol(l),d=wl(i.shape,c,s,1,a,u,!1,h),p=new UU(d);return n.runWebGLProgram(p,[i,o],"float32")}const qU={kernelName:Ut,backendName:"webgl",kernelFunc:GU};
/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class KU{constructor(t){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=t.inShape,this.enableShapeUniforms=EP(this.outputShape.length);const e=t.filterHeight,n=t.filterWidth,r=e-1-t.padInfo.top,i=n-1-t.padInfo.left;this.userCode=`\n      const ivec2 pads = ivec2(${r}, ${i});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n\n        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        vec4 result = vec4(0.);\n        for (int wR = 0; wR < ${e}; wR++) {\n          float dyR = float(dyRCorner + wR) / strides[0];\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n          int wRPerm = ${e} - 1 - wR;\n\n          for (int wC = 0; wC < ${n}; wC++) {\n            int wCPerm = ${n} - 1 - wC;\n\n            float dyC = float(dyCCorner + wC) / strides[1];\n            bool idyCVal = (dyC >= 0.0) && (dyC < ${t.outWidth}.0)\n              && (fract(dyC) == 0.0);\n            int idyC = int(dyC);\n\n            float dyC2 = float(dyCCorner + wC + 1) / strides[1];\n            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${t.outWidth}.0)\n              && (fract(dyC2) == 0.0);\n            int idyC2 = int(dyC2);\n\n            if (idyCVal && idyCVal2) {\n              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?\n                  dySample : getDy(batch, idyR, idyC2, d2);\n\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n\n                dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample2.xy : dySample2.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal) {\n              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal2) {\n              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC2, d2);\n                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            }\n          }\n        }\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function XU(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,filter:o}=e,{inputShape:s,strides:a,pad:l,dataFormat:u,dimRoundingMode:c}=r,h=Ol(u),d=wl(s,o.shape,a,1,l,c,!1,h);if(it().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&"channelsLast"===h){const t=[[d.strideHeight,d.strideWidth]],e=new KU(d);return n.runWebGLProgram(e,[i,o],"float32",t)}{const t=new VU(d);return n.runWebGLProgram(t,[i,o],"float32")}}const YU={kernelName:Vt,backendName:"webgl",kernelFunc:XU};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function JU(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:o}=e,{strides:s,pad:a,dilations:l}=r,u=xl(i.shape,o.shape,s,l,a),c=new OU(u);return n.runWebGLProgram(c,[i,o],"float32")}const ZU={kernelName:jt,backendName:"webgl",kernelFunc:JU};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function QU(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,dy:o}=e,{strides:s,pad:a,filterShape:l}=r,u=xl(i.shape,l,s,1,a),c=new jU(u);return n.runWebGLProgram(c,[i,o],"float32")}const tV={kernelName:Ht,backendName:"webgl",kernelFunc:QU};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function eV(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,filter:o}=e,{pad:s,strides:a,inputShape:l}=r,u=xl(l,o.shape,a,1,s),c=new HU(u);return n.runWebGLProgram(c,[i,o],"float32")}const nV={kernelName:Gt,backendName:"webgl",kernelFunc:eV},rV=nB+"\n  return cos(x);\n",iV=`\n  vec4 result = cos(x);\n  bvec4 isNaN = isnan(x);\n  ${Uz}\n  return result;\n`,oV=rB({opSnippet:rV,packedOpSnippet:iV}),sV={kernelName:qt,backendName:"webgl",kernelFunc:oV},aV="\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n",lV=rB({opSnippet:aV}),uV={kernelName:Kt,backendName:"webgl",kernelFunc:lV};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class cV{constructor(t,e,n,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[o,s,a,l]=t,[u]=e,[c,h]=n;this.outputShape=[u,c,h,l];const d="bilinear"===r?1:0,[p,f]=[s-1+".0",a-1+".0"],[g,m,y]=c>1?[""+(s-1)/(c-1),"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${p}`],[b,v,w]=h>1?[""+(a-1)/(h-1),"(x2-x1) * width_ratio",`x1*${f} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${f}`];this.userCode=`\n      const float height_ratio = float(${g});\n      const float width_ratio = float(${b});\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ${o}) {\n          return;\n        }\n\n        float height_scale = ${m};\n        float width_scale = ${v};\n\n        float in_y = ${y};\n        if( in_y < 0.0 || in_y > ${p} ) {\n          setOutput(float(${i}));\n          return;\n        }\n        float in_x = ${w};\n        if( in_x < 0.0 || in_x > ${f} ) {\n          setOutput(float(${i}));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(${d} == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const hV=t=>{const{inputs:e,backend:n,attrs:r}=t,{image:i,boxes:o,boxInd:s}=e,{cropSize:a,method:l,extrapolationValue:u}=r,c=new cV(i.shape,o.shape,a,l,u);return n.runWebGLProgram(c,[i,o,s],"float32")},dV={kernelName:Jt,backendName:"webgl",kernelFunc:hV};var pV;(function(t){t["Prod"]="*",t["Sum"]="+"})(pV||(pV={}));class fV{constructor(t,e,n,r){this.op=t,this.outputShape=e,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const i=this.outputShape.length,o=this.op===pV.Prod?"1.0":"0.0",s=n?o:`getX(${gV(i,"coords",this.op)})`,a=this.outputShape[this.outputShape.length-1];let l="",u="";n?(l=r?"end != "+(a-1):"end != 0",u=r?"end + 1":"end - 1"):(l=r?`end + pow2 < ${a}`:"end >= pow2",u=r?"end + pow2":"end - pow2"),this.userCode=`\n      void main() {\n        ${vP(i)} coords = getOutputCoords();\n        int end = ${mV(i,"coords",this.op)};\n        float val = ${s};\n        int pow2 = int(pow(2.0, index));\n        if (${l}) {\n          int idx = ${u};\n          ${mV(i,"coords",this.op)} = idx;\n          val ${this.op}= getX(${gV(i,"coords",this.op)});\n        }\n        setOutput(val);\n      }\n    `}}function gV(t,e,n){if(1===t)return`${e}`;if(2===t)return`${e}.x, ${e}.y`;if(3===t)return`${e}.x, ${e}.y, ${e}.z`;if(4===t)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function mV(t,e,n){if(1===t)return`${e}`;if(2===t)return`${e}.y`;if(3===t)return`${e}.z`;if(4===t)return`${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function yV(t,e,n,r,i,o){const s=e.shape.length,a=dc([r],s);let l=e;null!=a&&(l=SB({inputs:{x:e},backend:n,attrs:{perm:a}}));const u=fc(1,s)[0];if(u!==s-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${r}`);const c=l.shape[u];let h=jz({inputs:{x:l},backend:n});for(let d=0;d<=Math.ceil(Math.log2(c))-1;d++){const e=new fV(t,l.shape,!1,o),r=[[d]],i=h;h=n.runWebGLProgram(e,[h],h.dtype,r),n.disposeIntermediateTensorInfo(i)}if(i){const e=new fV(t,l.shape,i,o),r=h;h=n.runWebGLProgram(e,[h],h.dtype),n.disposeIntermediateTensorInfo(r)}if(null!=a){const t=pc(a),e=SB({inputs:{x:h},backend:n,attrs:{perm:t}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(l),e}return h}
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function bV(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:o,exclusive:s,reverse:a}=r;return yV(pV.Prod,i,n,o,s,a)}const vV={kernelName:Xt,backendName:"webgl",kernelFunc:bV};
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function wV(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:o,exclusive:s,reverse:a}=r;return yV(pV.Sum,i,n,o,s,a)}const xV={kernelName:Yt,backendName:"webgl",kernelFunc:wV};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function kV(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,weights:o}=e,{size:s,binaryOutput:a}=r;if(1===i.shape.length){const t=n.readSync(i.dataId),e=n.readSync(o.dataId),r=aL(t,e,o.dtype,o.shape,s);return n.makeTensorInfo([s],o.dtype,r)}if(2===i.shape.length){const t=n.bufferSync(i),e=n.bufferSync(o),r=lL(t,e,s,a);return n.makeTensorInfo(r.shape,o.dtype,r.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${i.shape.length}.`)}const _V={kernelName:Zt,backendName:"webgl",kernelFunc:kV};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class IV{constructor(t,e,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=n,this.userCode=`\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ${this.getHeightCoordString()};\n      int w = ${this.getWidthCoordString()};\n      int d = ${this.getDepthCoordString()};\n\n      int in_h = h / ${e};\n      int offset_h = imod(h, ${e});\n      int in_w = w / ${e};\n      int offset_w = imod(w, ${e});\n      int offset_d = (offset_h * ${e} + offset_w) *\n        ${this.getOutputDepthSize()};\n      int in_d = d + offset_d;\n\n      float result = ${this.getInputSamplingString()};\n      setOutput(result);\n    }\n  `}getHeightCoordString(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}getWidthCoordString(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}getDepthCoordString(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}getOutputDepthSize(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function CV(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{blockSize:o,dataFormat:s}=r,a=i.shape[0],l="NHWC"===s?i.shape[1]:i.shape[2],u="NHWC"===s?i.shape[2]:i.shape[3],c="NHWC"===s?i.shape[3]:i.shape[1],h=l*o,d=u*o,p=c/(o*o),f="NHWC"===s?[a,h,d,p]:[a,p,h,d],g=new IV(f,o,s);return n.runWebGLProgram(g,[i],i.dtype)}const SV={kernelName:Qt,backendName:"webgl",kernelFunc:CV};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class TV{constructor(t,e=!1,n=null,r=!1,i=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=EP(this.outputShape.length);const o=t.filterHeight,s=t.filterWidth,a=t.outChannels/t.inChannels;let l="",u="";n&&(l=r?`float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ${n}\n        }`:i?`float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ${n}\n        }`:`\n          float activation(float x) {\n            ${n}\n          }\n        `,u="result = activation(result);");const c=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${l}\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ${a};\n        int q = d2 - d1 * ${a};\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ${o}; wR++) {\n          int xR = xRCorner + wR * dilations[0];\n\n          if (xR < 0 || xR >= inDims[0]) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${s}; wC++) {\n            int xC = xCCorner + wC * dilations[1];\n\n            if (xC < 0 || xC >= inDims[1]) {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ${c}\n        ${u}\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class EV{constructor(t,e=!1,n=null,r=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=EP(this.outputShape.length);const o=t.outChannels/t.inChannels,s=t.padInfo.left,a=t.strideWidth,l=t.dilationWidth,u=t.filterHeight,c=t.filterWidth,h=c;let d="\n      int xR; int xC; int xCOffset;\n      vec4 wTexel; vec4 previous; vec4 final;";for(let f=0;f<c;f++)d+=`\n          vec4 xTexelC${2*f};\n          int xTexelC${2*f}Ready;\n          vec4 xTexelC${2*f+1};\n          int xTexelC${2*f+1}Ready;\n          vec4 xC${f};`;d+=`\n    for (int r = 0; r < ${u}; r++) {\n      `;for(let f=0;f<c;f++)d+=`\n          xTexelC${2*f} = vec4(0.0);\n          xTexelC${2*f}Ready = 0;\n          xTexelC${2*f+1} = vec4(0.0);\n          xTexelC${2*f+1}Ready = 0;\n          xC${f} = vec4(0.0);`;d+="\n        xR = xRCorner + r * dilations[0];\n        if (xR >=0 && xR < inDims[0]) {\n      ";for(let y=0;y<(h+1)/2;y++){const t=2*y;if(d+=`\n          xC = xCCorner + ${t*l};\n          `,1===a){if(t<c&&(s%2===1?(d+=`\n                xCOffset = xC + 1;\n                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t}Ready == 0) {\n                  xTexelC${t} = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC${t}.zw = vec2(0.0);\n                  }\n                  xTexelC${t}Ready = 1;\n                }\n              `,d+=1===l&&t>0?`\n                xC${t} = vec4(xTexelC${t-2}.zw, xTexelC${t}.xy);\n                `:`\n                  xCOffset = xC + 1 - 2;\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                    previous = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      previous.zw = vec2(0.0);\n                    }\n\n                    xC${t} = vec4(previous.zw, xTexelC${t}.xy);\n                  } else {\n                    xC${t} = vec4(0.0, 0.0, xTexelC${t}.xy);\n                  }\n                  `):d+=`\n                if (xC >= 0 && xC < inDims[1] && xTexelC${t}Ready == 0) {\n                  xTexelC${t} = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC${t}.zw = vec2(0.0);\n                  }\n                  xTexelC${t}Ready = 1;\n                }\n\n                xC${t} = xTexelC${t};\n                `,t+1<c)){const e=s%2===0?f(l):l;l%2===0&&s%2===1||l%2!==0&&s%2!==1?(d+=`\n                  xCOffset = xC + imod(pads[1], 2) + ${e};\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t+1}Ready == 0) {\n                    xTexelC${t+1} = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      xTexelC${t+1}.zw = vec2(0.0);\n                    }\n                    xTexelC${t+1}Ready = 1;\n                  }\n                  `,d+=l>1?`\n                    xCOffset -= 2;\n                    if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n                     xC${t+1} = vec4(previous.zw, xTexelC${t+1}.xy);\n                    } else {\n                     xC${t+1} = vec4(0.0, 0.0, xTexelC${t+1}.xy);\n                    }\n                    `:`\n                    xC${t+1} = vec4(xTexelC${t}.zw, xTexelC${t+1}.xy);\n                    `):d+=1===e?`\n                    xC${t+1} = xTexelC${t};\n                    `:`\n                    xCOffset = xC + ${e};\n\n                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t+1}Ready == 0) {\n                      xTexelC${t+1} = getX(batch, xR, xCOffset, d1);\n                      if (xCOffset + 1 >= inDims[1]) {\n                        xTexelC${t+1}.zw = vec2(0.0);\n                      }\n                      xTexelC${t+1}Ready = 1;\n                    }\n\n                    xC${t+1} = xTexelC${t+1};\n                    `}}else t<c&&(s%2===1?(d+=`\n                xCOffset = xC + 1 - strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t}Ready == 0) {\n                  xTexelC${t} = getX(batch, xR, xCOffset, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC${t}.zw = vec2(0.0);\n                  }\n                  xTexelC${t}Ready = 1;\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${t+1}Ready == 0) {\n                  xTexelC${t+1} = getX(batch, xR, xC + 1, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xC + 2 >= inDims[1]) {\n                    xTexelC${t+1}.zw = vec2(0.0);\n                  }\n                  xTexelC${t+1}Ready = 1;\n                }\n\n                xC${t} = vec4(xTexelC${t}.zw, xTexelC${t+1}.zw);\n              `,t+1<c&&(d+=`\n                  final = vec4(0.0);\n                  xCOffset = xC + 1 + strides[1];\n                  if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xC${t+1} = vec4(xTexelC${t+1}.xy, final.xy);\n                `)):(d+=`\n                if(xC >= 0 && xC < inDims[1] && xTexelC${t}Ready == 0) {\n                  xTexelC${t} = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC${t}.zw = vec2(0.0);\n                  }\n                  xTexelC${t}Ready = 1;\n                }\n\n                xCOffset = xC + strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t+1}Ready == 0) {\n                  xTexelC${t+1} = getX(batch, xR, xCOffset, d1);\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC${t+1}.zw = vec2(0.);\n                  }\n                  xTexelC${t+1}Ready = 1;\n                }\n\n                xC${t} = vec4(\n                  xTexelC${t}.xy, xTexelC${t+1}.xy);\n              `,t+1<c&&(d+=`\n                  xC${t+1} = vec4(xTexelC${t}.zw, xTexelC${t+1}.zw);\n                `)));t<c&&(d+=`\n            wTexel = getW(r, ${t}, d1, q);\n            dotProd += xC${t} * vec4(wTexel.xz, wTexel.xz);\n          `,t+1<c&&(d+=`\n              wTexel = getW(r, ${t+1}, d1, q);\n              dotProd += xC${t+1} * vec4(wTexel.xz, wTexel.xz);\n            `))}d+="\n    }\n  ",d+="\n      }\n    ";let p="",g="";n&&(p=r?`vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ${n}\n        }`:i?`vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ${n}\n        }`:`vec4 activation(vec4 x) {\n          ${n}\n        }`,g="result = activation(result);");const m=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${p}\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ${o};\n        int q = d2 - d1 * ${o};\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n        vec4 dotProd = vec4(0.000000000000001);\n\n        ${d}\n\n        vec4 result = dotProd - vec4(0.000000000000001);\n        ${m}\n        ${g}\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function NV(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:o}=e,{strides:s,pad:a,dilations:l,dimRoundingMode:u}=r;let c=l;null==c&&(c=[1,1]),y($l(s,c),(()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${s} and dilations '${c}'`));const h=wl(i.shape,o.shape,s,c,a,u,!0);let d;d=it().getBool("WEBGL_PACK_DEPTHWISECONV")&&h.strideWidth<=2&&h.outChannels/h.inChannels===1?new EV(h):new TV(h);const p=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];return n.runWebGLProgram(d,[i,o],"float32",p)}const AV={kernelName:te,backendName:"webgl",kernelFunc:NV};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class RV{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const e=t.strideHeight,n=t.strideWidth,r=t.padInfo.top,i=t.padInfo.left,o=t.outChannels/t.inChannels;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ${o} + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ${t.batchSize}; b++) {\n          for (int yR = 0; yR < ${t.outHeight}; yR++) {\n            int xR = wR + yR * ${e} - ${r};\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int yC = 0; yC < ${t.outWidth}; yC++) {\n              int xC = wC + yC * ${n} - ${i};\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class $V{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,i=t.strideWidth,o=e-1-t.padInfo.top,s=n-1-t.padInfo.left,a=t.outChannels/t.inChannels;this.userCode=`\n      const ivec2 pads = ivec2(${o}, ${s});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ${e}; wR++) {\n          float dyR = float(dyRCorner + wR) / ${r}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ${e} - 1 - wR;\n\n          for (int wC = 0; wC < ${n}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${i}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ${n} - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ${a}; dm++) {\n              int d2 = d1 * ${a} + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function DV(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,dy:o}=e,{strides:s,dilations:a,pad:l,dimRoundingMode:u,filterShape:c}=r,h=wl(i.shape,c,s,a,l,u,!0),d=new RV(h);return n.runWebGLProgram(d,[i,o],"float32")}const OV={kernelName:ee,backendName:"webgl",kernelFunc:DV};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function FV(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,filter:o}=e,{strides:s,dilations:a,pad:l,dimRoundingMode:u,inputShape:c}=r,h=wl(c,o.shape,s,a,l,u,!0),d=new $V(h);return n.runWebGLProgram(d,[i,o],"float32")}const MV={kernelName:ne,backendName:"webgl",kernelFunc:FV};
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class PV{constructor(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function LV(t){const{inputs:e,backend:n}=t,{x:r}=e,i=[...r.shape,...r.shape],o=w(r.shape),s=pB({inputs:{x:r},backend:n,attrs:{shape:[o]}}),a=new PV(o),l=n.runWebGLProgram(a,[s],s.dtype),u=pB({inputs:{x:l},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(l),u}const zV={kernelName:re,backendName:"webgl",kernelFunc:LV};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class BV{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const{inHeight:e,inWidth:n,padInfo:r,strideHeight:i,strideWidth:o,filterHeight:s,filterWidth:a,dilationHeight:l,dilationWidth:u}=t,{top:c,left:h}=r;this.userCode=`\n      const ivec2 strides = ivec2(${i}, ${o});\n      const ivec2 pads = ivec2(${c}, ${h});\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ${s}; h++) {\n          int hIn = hBeg + h * ${l};\n\n          if (hIn >= 0 && hIn < ${e}) {\n            for (int w = 0; w < ${a}; w++) {\n              int wIn = wBeg + w * ${u};\n\n              if (wIn >= 0 && wIn < ${n}) {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function WV(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:o}=e,{strides:s,pad:a,dilations:l}=r,u=yl(i.shape,o.shape,s,a,"NHWC",l);let c;const h=new BV(u);c=n.runWebGLProgram(h,[i,o],"float32");const d=pB({inputs:{x:c},backend:n,attrs:{shape:u.outShape}});return n.disposeIntermediateTensorInfo(c),d}const UV={kernelName:ie,backendName:"webgl",kernelFunc:WV};
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function VV(t){const{inputs:e,backend:n,attrs:r}=t,{equation:i}=r,o=e,{allDims:s,summedDims:a,idDims:l}=Ef(i,o.length);Af(s.length,l,o);const{path:u,steps:c}=Rf(a,l),h=c.length;let d=null,p=s.length;const f=[];for(let g=0;g<h;++g){for(const t of c[g]){const{permutationIndices:e,expandDims:r}=Nf(p,l[t]);let i;$f(e)?i=o[t]:(i=SB({inputs:{x:o[t]},backend:n,attrs:{perm:e}}),f.push(i));const s=i.shape.slice();for(let t=0;t<r.length;++t)s.splice(r[t],0,1);x(i.shape,s)||(i=pB({inputs:{x:i},backend:n,attrs:{shape:s}}),f.push(i)),null===d?d=i:(d=cB({inputs:{a:i,b:d},backend:n}),f.push(d))}g<h-1&&(u[g]>=0&&(d=IB({inputs:{x:d},backend:n,attrs:{axis:u[g]-(s.length-p),keepDims:!1}}),f.push(d)),p--)}for(const g of f)g!==d&&n.disposeIntermediateTensorInfo(g);return d}const jV={kernelName:ue,backendName:"webgl",kernelFunc:VV},HV="return (x >= 0.0) ? x : (exp(x) - 1.0);",GV="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",qV=rB({opSnippet:HV,packedOpSnippet:GV}),KV={kernelName:ce,backendName:"webgl",kernelFunc:qV},XV="return (b >= 0.0) ? a : a * (b + 1.0);",YV="\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",JV=t=>{const{inputs:e,backend:n}=t,{dy:r,y:i}=e,o=it().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Vz(YV,r.shape,i.shape):new Wz(XV,r.shape,i.shape);return n.runWebGLProgram(o,[r,i],r.dtype)},ZV={kernelName:he,backendName:"webgl",kernelFunc:JV},QV="\n  return vec4(equal(a, b));\n",tj="return float(a == b);",ej=iB({opSnippet:tj,packedOpSnippet:QV,dtype:"bool",cpuKernelImpl:pL}),nj={kernelName:pe,backendName:"webgl",kernelFunc:ej},rj=`\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = ${cf};\n  float a1 = ${hf};\n  float a2 = ${df};\n  float a3 = ${pf};\n  float a4 = ${ff};\n  float a5 = ${gf};\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n`,ij=rB({opSnippet:rj}),oj={kernelName:de,backendName:"webgl",kernelFunc:ij},sj=nB+"\n  return exp(x);\n",aj="\n  vec4 result = exp(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",lj=rB({opSnippet:sj,packedOpSnippet:aj,cpuKernelImpl:fL,dtype:"float32"}),uj={kernelName:fe,backendName:"webgl",kernelFunc:lj};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function cj(t){const{inputs:e,attrs:n,backend:r}=t,{dim:i}=n,{input:o}=e,s=o.shape.length,a=o.shape.slice();let l=i;return i<0&&(y(-(s+1)<=i,(()=>`Axis must be in the interval [${-(s+1)}, ${s}]`)),l=s+i+1),a.splice(l,0,1),pB({inputs:{x:o},backend:r,attrs:{shape:a}})}const hj={kernelName:ge,backendName:"webgl",kernelFunc:cj},dj="return exp(x) - 1.0;",pj=rB({opSnippet:dj,packedOpSnippet:dj,cpuKernelImpl:gL}),fj={kernelName:me,backendName:"webgl",kernelFunc:pj};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class gj{constructor(t,e,n){this.variableNames=["real","imag"];const r=e[1];this.outputShape=e;const i=n?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,o=n?`${r}.0`:"1.0";let s;if("real"===t)s="return real * expR - imag * expI;";else{if("imag"!==t)throw new Error(`FFT component must be either "real" or "imag", got ${t}.`);s="return real * expI + imag * expR;"}this.userCode=`\n      const float exponentMultiplier = ${i};\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ${s}\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(${r});\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ${r}; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ${o};\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function mj(t,e,n){const r=n.texData.get(t.dataId),i=w(t.shape),o=t.shape[t.shape.length-1],s=i/o,a=pB({inputs:{x:t},backend:n,attrs:{shape:[s,o]}}),l=a.shape,u=new gj("real",l,e),c=new gj("imag",l,e),h=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:l},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:l}],d=n.runWebGLProgram(u,h,"float32"),p=n.runWebGLProgram(c,h,"float32"),f=Gz({inputs:{real:d,imag:p},backend:n});n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p);const g=pB({inputs:{x:f},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(f),g}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function yj(t){const{inputs:e,backend:n}=t,{input:r}=e;return mj(r,!1,n)}const bj={kernelName:ye,backendName:"webgl",kernelFunc:yj};
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class vj{constructor(t,e){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function wj(t){const{backend:e,attrs:n}=t,{shape:r,value:i}=n;let{dtype:o}=n;if(o=o||z(i),"string"===o){const t=A(o,w(r));return t.fill(i),e.makeTensorInfo(r,o,t)}{const t=new vj(r,i),n=[[i]];return e.runWebGLProgram(t,[],o,n)}}const xj={kernelName:be,backendName:"webgl",kernelFunc:wj};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class kj{constructor(t){this.variableNames=["Image"],this.outputShape=[];const e=t[2];this.outputShape=t,this.userCode=`\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ${e} - x - 1;\n          float outputValue;\n          if(coordX >= 0 && coordX < ${e}) {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const _j={kernelName:ve,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,r=e,i=new kj(n.shape),o=r.runWebGLProgram(i,[n],n.dtype);return o}},Ij="return floor(x);",Cj=rB({opSnippet:Ij,packedOpSnippet:Ij,cpuKernelImpl:mL}),Sj={kernelName:we,backendName:"webgl",kernelFunc:Cj},Tj="\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",Ej="\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",Nj=iB({opSnippet:Tj,packedOpSnippet:Ej,dtype:"int32"}),Aj={kernelName:xe,backendName:"webgl",kernelFunc:Nj};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Rj{constructor(t){this.variableNames=["A"];const e=_M(),[n,r]=t;this.outputShape=t,this.userCode=`\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${n}.0);\n\n        vec4 values = ${e.texture2D}(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class $j{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const e=_M(),[n,r]=t;this.outputShape=t,this.userCode=`\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(${r}.0, ${n}.0);\n            vec4 values = ${e.texture2D}(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ${e.output} = result;\n      }\n    `}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const Dj={kernelName:wr,backendName:"webgl",kernelFunc:Mj};let Oj,Fj=it().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function Mj(t){const{inputs:e,backend:n,attrs:r}=t;let{pixels:i}=e;const{numChannels:o}=r,s="undefined"!==typeof HTMLVideoElement&&i instanceof HTMLVideoElement,a="undefined"!==typeof HTMLImageElement&&i instanceof HTMLImageElement,[l,u]=s?[i.videoWidth,i.videoHeight]:[i.width,i.height],c=[u,l],h=[u,l,o];if(a||s){const t=it().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");null!=Oj&&t===Fj||(Fj=t,Oj=document.createElement("canvas").getContext("2d",{willReadFrequently:Fj})),Oj.canvas.width=l,Oj.canvas.height=u,Oj.drawImage(i,0,0,l,u),i=Oj.canvas}const d=n.makeTensorInfo(c,"int32");n.texData.get(d.dataId).usage=vF.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(d.dataId),i);const p=it().getBool("WEBGL_PACK")?new $j(h):new Rj(h),f=n.runWebGLProgram(p,[d],"int32");return n.disposeData(d.dataId),f}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Pj(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:o,bias:s,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:c,dilations:h,dimRoundingMode:d,activation:p,leakyreluAlpha:f}=r,g=Ol(c),m=wl(i.shape,o.shape,l,h,u,d,!1,g);let y;const b=[],v=null!=s,w=null!=a,x="leakyrelu"===p,k=()=>{const t=[i,o],e=(t,e)=>{if("NCHW"===e&&1===t.shape.length&&1!==t.shape[0]){const e=pB({inputs:{x:t},backend:n,attrs:{shape:[t.shape[0],1,1]}});return b.push(e),e}return t};if(v&&t.push(e(s,c)),w&&t.push(e(a,c)),x){const e=n.makeTensorInfo([],"float32",ei(f,"float32"));t.push(e),b.push(e)}return t};if(1!==m.filterHeight||1!==m.filterWidth||1!==m.dilationHeight||1!==m.dilationWidth||1!==m.strideHeight||1!==m.strideWidth||"SAME"!==m.padInfo.type&&"VALID"!==m.padInfo.type)if(m.strideWidth<=2&&"channelsLast"===g&&it().getBool("WEBGL_EXP_CONV")){const t=p?oB(p,!0):null,e=new FU(m,v,t,w,x),r=[[m.padInfo.top,m.padInfo.left],[m.strideHeight,m.strideWidth],[m.dilationHeight,m.dilationWidth],[m.inHeight,m.inWidth]],i=k();y=n.runWebGLProgram(e,i,"float32",r)}else if(it().getBool("WEBGL_CONV_IM2COL"))y=zU({x:i,filter:o,convInfo:m,backend:n,bias:s,activation:p,preluActivationWeights:a,leakyreluAlpha:f});else{const t=p?oB(p,!1):null,e=new DU(m,v,t,w,x),r=k();y=n.runWebGLProgram(e,r,"float32")}else y=LU({x:i,filter:o,convInfo:m,backend:n,bias:s,activation:p,preluActivationWeights:a,leakyreluAlpha:f});const _=pB({inputs:{x:y},backend:n,attrs:{shape:m.outShape}});return b.push(y),b.forEach((t=>n.disposeIntermediateTensorInfo(t))),_}const Lj={kernelName:_r,backendName:"webgl",kernelFunc:Pj};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function zj(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:o,bias:s,preluActivationWeights:a}=e,{strides:l,pad:u,dilations:c,dimRoundingMode:h,activation:d,leakyreluAlpha:p}=r,f=[];let g=c;null==g&&(g=[1,1]),y($l(l,g),(()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${g}'`));const m=wl(i.shape,o.shape,l,g,u,h,!0),b=it().getBool("WEBGL_PACK_DEPTHWISECONV")&&m.strideWidth<=2&&m.outChannels/m.inChannels===1,v=d?oB(d,b):null,w=[i,o],x=null!=s,k=null!=a,_="leakyrelu"===d;if(x&&w.push(s),k&&w.push(a),_){const t=n.makeTensorInfo([],"float32",ei(p,"float32"));w.push(t),f.push(t)}let I;I=b?new EV(m,x,v,k,_):new TV(m,x,v,k,_);const C=[[m.padInfo.top,m.padInfo.left],[m.strideHeight,m.strideWidth],[m.dilationHeight,m.dilationWidth],[m.inHeight,m.inWidth]],S=n.runWebGLProgram(I,w,"float32",C);return f.forEach((t=>n.disposeIntermediateTensorInfo(t))),S}const Bj={kernelName:Ir,backendName:"webgl",kernelFunc:zj};class Wj{constructor(t,e,n,r){this.sliceDim=t,this.strides=e,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=n;const i=vP(n.length);let o="\n    int index;";for(let s=0;s<this.sliceDim;s++)o+=`\n          index = round(getIndices(coords[0], ${s}));\n          out_of_bounds = out_of_bounds || index < 0;\n          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[s]};\n          flattenIndex += index * ${this.strides[s]};`;this.userCode=`\n         void main() {\n          ${i} coords = getOutputCoords();\n          int flattenIndex = 0;\n          bool out_of_bounds = false;\n\n          ${o}\n\n          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));\n        }\n      `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Uj(t){const{inputs:e,backend:n}=t,{params:r,indices:i}=e,o=i.shape,s=o[o.length-1],a=w(r.shape),[l,u,c,h]=rf(r,i),d=pB({inputs:{x:i},backend:n,attrs:{shape:[u,s]}}),p=pB({inputs:{x:r},backend:n,attrs:{shape:[w(r.shape)/c,c]}});if(n.shouldExecuteOnCPU([r,i])||"string"===r.dtype){const t=n.readSync(i.dataId),e=n.bufferSync(r),o=yL(t,e,r.dtype,u,s,c,h,r.shape,a);return n.makeTensorInfo(l,r.dtype,o.values)}const f=new Wj(s,h,[u,c],r.shape),g=n.runWebGLProgram(f,[p,d],p.dtype),m=pB({inputs:{x:g},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),m}const Vj={kernelName:Ie,backendName:"webgl",kernelFunc:Uj};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class jj{constructor(t,e){this.variableNames=["A","indices"],this.outputShape=e,this.rank=e.length;const n=vP(this.rank),r=Hj(t,2);this.userCode=`\n      void main() {\n        ${n} resRC = getOutputCoords();\n        int index = int(getIndices(resRC.x, resRC.z));\n        float inBounds = (index >= 0) && (index < ${t[2]}) ? 1.0 : 0.0;\n        setOutput(inBounds * getA(${r}));\n      }\n    `}}function Hj(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let i=0;i<t.length;i++)2===i?r.push("index"):r.push(`${n[i]}`);return r.join()}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Gj(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,indices:o}=e,{axis:s,batchDims:a}=r,l=T(s,i.shape)[0];if(it().get("DEBUG")){const t=n.readSync(o.dataId),e=i.shape[l];for(let n=0;n<t.length;++n){const r=t[n];y(r<=e-1&&r>=0,(()=>`GatherV2: the index value ${r} is not in [0, ${e-1}]`))}}const u=Xf(i,o,l,a),c=w(o.shape),h=[],d=pB({inputs:{x:i},backend:n,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),p=pB({inputs:{x:o},backend:n,attrs:{shape:[u.batchSize,c/u.batchSize]}});h.push(d),h.push(p);const f=[u.batchSize,u.outerSize,c/u.batchSize,u.sliceSize];if(n.shouldExecuteOnCPU([i,o])||"string"===i.dtype){const t=n.bufferSync(p),e=n.bufferSync(d),r=bL(e,t,f);return h.forEach((t=>n.disposeIntermediateTensorInfo(t))),n.makeTensorInfo(u.outputShape,r.dtype,r.values)}const g=new jj(d.shape,f),m=n.runWebGLProgram(g,[d,p],d.dtype);h.push(m);const b=pB({inputs:{x:m},backend:n,attrs:{shape:u.outputShape}});return h.forEach((t=>n.disposeIntermediateTensorInfo(t))),b}const qj={kernelName:_e,backendName:"webgl",kernelFunc:Gj},Kj="return float(a > b);",Xj="\n  return vec4(greaterThan(a, b));\n",Yj=iB({opSnippet:Kj,packedOpSnippet:Xj,cpuKernelImpl:vL,dtype:"bool"}),Jj={kernelName:Ce,backendName:"webgl",kernelFunc:Yj},Zj="return float(a >= b);",Qj="\n  return vec4(greaterThanEqual(a, b));\n",tH=iB({opSnippet:Zj,packedOpSnippet:Qj,dtype:"bool",cpuKernelImpl:wL}),eH={kernelName:Se,backendName:"webgl",kernelFunc:tH};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function nH(t){const{inputs:e,backend:n}=t,{input:r}=e;return mj(r,!0,n)}const rH={kernelName:Ee,backendName:"webgl",kernelFunc:nH},iH="return float(!isnan(x) && !isinf(x));",oH=rB({opSnippet:iH,dtype:"bool"}),sH={kernelName:Ae,backendName:"webgl",kernelFunc:oH},aH="return float(isinf(x));",lH=rB({opSnippet:aH,dtype:"bool"}),uH={kernelName:Re,backendName:"webgl",kernelFunc:lH},cH="return float(isnan(x));",hH=rB({opSnippet:cH,dtype:"bool"}),dH={kernelName:$e,backendName:"webgl",kernelFunc:hH},pH="return float(a < b);",fH="\n  return vec4(lessThan(a, b));\n",gH=iB({opSnippet:pH,packedOpSnippet:fH,cpuKernelImpl:xL,dtype:"bool"}),mH={kernelName:Oe,backendName:"webgl",kernelFunc:gH},yH="return float(a <= b);",bH="\n  return vec4(lessThanEqual(a, b));\n",vH=iB({opSnippet:yH,packedOpSnippet:bH,cpuKernelImpl:kL,dtype:"bool"}),wH={kernelName:Fe,backendName:"webgl",kernelFunc:vH};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function xH(t){const{backend:e,attrs:n}=t,{start:r,stop:i,num:o}=n,s=_L(r,i,o);return e.makeTensorInfo([s.length],"float32",s)}const kH={kernelName:Me,backendName:"webgl",kernelFunc:xH},_H=nB+"\n  return x < 0.0 ? 0./0. : log(x);\n",IH="\n  vec4 result = log(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);\n  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);\n  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);\n  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);\n  return result;\n",CH=rB({opSnippet:_H,packedOpSnippet:IH,cpuKernelImpl:IL}),SH={kernelName:Pe,backendName:"webgl",kernelFunc:CH},TH=nB+"\n  return log(1.0 + x);\n",EH=rB({opSnippet:TH}),NH={kernelName:Le,backendName:"webgl",kernelFunc:EH},AH="return float(a >= 1.0 && b >= 1.0);",RH="\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",$H=iB({opSnippet:AH,packedOpSnippet:RH,dtype:"bool"}),DH={kernelName:ze,backendName:"webgl",kernelFunc:$H},OH="return float(!(x >= 1.0));",FH=rB({opSnippet:OH}),MH={kernelName:Be,backendName:"webgl",kernelFunc:FH},PH="return float(a >= 1.0 || b >= 1.0);",LH="\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",zH=iB({opSnippet:PH,packedOpSnippet:LH,dtype:"bool"}),BH={kernelName:We,backendName:"webgl",kernelFunc:zH};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class WH{constructor(t,e,n,r,i){this.variableNames=["x"],this.outputShape=[];const o=e,s=t[3]-1;let a;this.outputShape=t;const l=`float(${n}) + float(${r}) * sum`;a=.5===i?`inversesqrt(${l})`:1===i?`1.0/(${l})`:`exp(log(${l}) * float(-${i}));`,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -${o}; j <= ${o}; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ${s}) {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ${a};\n        setOutput(val);\n      }\n    `}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class UH{constructor(t,e,n,r,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const o=e,s=t[3]-1;let a;this.outputShape=t;const l=`float(${n}) + float(${r}) * sum`;a=.5===i?`inversesqrt(${l})`:1===i?`1.0/(${l})`:`exp(log(${l}) * float(-${i}));`,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ${this.outputShape[3]};\n        bool hasNextRow = c < ${this.outputShape[2]};\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ${o};\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ${o}; j <= ${o}; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${s}));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ${a};\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const VH=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{depthRadius:o,bias:s,alpha:a,beta:l}=r,u=it().getBool("WEBGL_PACK_NORMALIZATION")?new UH(i.shape,o,s,a,l):new WH(i.shape,o,s,a,l);return n.runWebGLProgram(u,[i],i.dtype)},jH={kernelName:Ve,backendName:"webgl",kernelFunc:VH};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class HH{constructor(t,e,n,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=e,this.bias=n,this.alpha=r,this.beta=i,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ${this.depth}; ++d) {\n          int depthBegin = int(max(0.0, float(d - ${e})));\n          int depthEnd = int(min(float(${this.depth}),\n              float(d + ${e} + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ${this.depth};\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(${r}) * norm + float(${n});\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(${r})\n                * float(${i})\n                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ${i});\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const GH=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:i,y:o,dy:s}=e,{depthRadius:a,bias:l,alpha:u,beta:c}=r,h=new HH(i.shape,a,l,u,c);return n.runWebGLProgram(h,[i,o,s],i.dtype)},qH={kernelName:je,backendName:"webgl",kernelFunc:GH};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function KH(t,e,n,r){const i=w(e),o=w(t.shape),s=o/i,a=pB({inputs:{x:t},attrs:{shape:[s,i]},backend:r}),l=bB(a,t.dtype,"max",r),u=pB({inputs:{x:l},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(l),u}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function XH(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{reductionIndices:o,keepDims:s}=r,a=i.shape.length,l=T(o,i.shape);let u=l;const c=dc(u,a),h=null!=c,d=n.shouldExecuteOnCPU([i]);let p=i;if(h){if(d){const t=n.texData.get(p.dataId),e=t.values,r=new Array(a);for(let n=0;n<r.length;n++)r[n]=i.shape[c[n]];const o=QL(e,i.shape,i.dtype,c,r);p=n.makeTensorInfo(r,i.dtype);const s=n.texData.get(p.dataId);s.values=o}else p=kB(i,c,n);u=fc(u.length,a)}hc("max",u,a);const[f,g]=uc(p.shape,u);let m,y=f;if(s&&(y=cc(f,l)),d){const t=n.texData.get(p.dataId),e=t.values,r=CL(e,w(g),y,i.dtype);m=n.makeTensorInfo(y,i.dtype);const o=n.texData.get(m.dataId);o.values=r}else m=KH(p,g,y,n);return h&&n.disposeIntermediateTensorInfo(p),m}const YH={kernelName:He,backendName:"webgl",kernelFunc:XH},JH=Bz+"\n  return max(a, b);\n",ZH="\n  vec4 result = vec4(max(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+Uz+"\n  return result;\n",QH=iB({opSnippet:JH,packedOpSnippet:ZH,cpuKernelImpl:SL}),tG={kernelName:Ge,backendName:"webgl",kernelFunc:QH};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function eG(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e;xM(i,"maxPool");const{filterSize:o,strides:s,pad:a,dimRoundingMode:l}=r,u=1;y($l(s,u),(()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${u}'`));const c=bl(i.shape,o,s,u,a,l);if(1===c.filterWidth&&1===c.filterHeight&&x(c.inShape,c.outShape))return jz({inputs:{x:i},backend:n});const h=new _W(c,"max",!1);return n.runWebGLProgram(h,[i],i.dtype)}const nG={kernelName:qe,backendName:"webgl",kernelFunc:eG};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function rG(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{filterSize:o,strides:s,pad:a,dataFormat:l,dimRoundingMode:u}=r,c=[1,1,1],h=vl(i.shape,o,s,c,a,u,l),d=new IW(h,"max",!1);return n.runWebGLProgram(d,[i],i.dtype)}const iG={kernelName:Xe,backendName:"webgl",kernelFunc:rG};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class oG{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const e=t.strideHeight,n=t.strideWidth,r=t.dilationHeight,i=t.effectiveFilterHeight,o=t.effectiveFilterWidth,s=i-1-t.padInfo.top,a=o-1-t.padInfo.left,l=i*o-1;this.userCode=`\n      const ivec2 pads = ivec2(${s}, ${a});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${i};\n          wR += ${r}) {\n          float dyR = float(dyRCorner + wR) / ${e}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ${o}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${n}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ${l} - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ${o} + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class sG{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const e=t.strideDepth,n=t.strideHeight,r=t.strideWidth,i=t.dilationDepth,o=t.dilationHeight,s=t.dilationWidth,a=t.effectiveFilterDepth,l=t.effectiveFilterHeight,u=t.effectiveFilterWidth,c=a-1-t.padInfo.front,h=l-1-t.padInfo.top,d=u-1-t.padInfo.left,p=a*l*u-1;this.userCode=`\n      const ivec3 pads = ivec3(${c}, ${h}, ${d});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ${a};\n           wD += ${i}) {\n          float dyD = float(dyDCorner + wD) / ${e}.0;\n\n          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ${l};\n              wR += ${o}) {\n            float dyR = float(dyRCorner + wR) / ${n}.0;\n\n            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ${u};\n                wC += ${s}) {\n              float dyC = float(dyCCorner + wC) / ${r}.0;\n\n              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ${p} -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ${l} * ${u} +\n                  wR * ${u} + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function aG(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,input:o}=e,s=o,{filterSize:a,strides:l,pad:u,dimRoundingMode:c}=r,h=[1,1,1],d=vl(s.shape,a,l,h,u,c),p=new IW(d,"max",!0),f=n.runWebGLProgram(p,[s],s.dtype),g=new sG(d),m=n.runWebGLProgram(g,[i,f],s.dtype);return n.disposeIntermediateTensorInfo(f),m}const lG={kernelName:Ye,backendName:"webgl",kernelFunc:aG};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function uG(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,input:o,output:s}=e,a=o;xM([o,s],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:h}=r,d=bl(a.shape,l,u,1,c,h),p=!0,f=new _W(d,"max",p),g=n.runWebGLProgram(f,[a],a.dtype),m=new oG(d),y=n.runWebGLProgram(m,[i,g],a.dtype);return n.disposeIntermediateTensorInfo(g),y}const cG={kernelName:Ke,backendName:"webgl",kernelFunc:uG};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function hG(t,e,n,r){let i=new _W(n,"max",!1);const o=r.runWebGLProgram(i,[t],"float32");i=new _W(n,"max",!0,!0,e);const s=r.runWebGLProgram(i,[t],"float32");return[o,s]}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const dG={kernelName:Je,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{filterSize:i,strides:o,pad:s,includeBatchInIndex:a}=e,l=n;y(4===r.shape.length,(()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`));const u=[1,1];y($l(o,u),(()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`));const c=bl(r.shape,i,o,u,s),[h,d]=hG(r,a,c,l);return[h,d]}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function pG(t,e,n,r){const i=w(e),o=w(t.shape),s=o/i,a=pB({inputs:{x:t},attrs:{shape:[s,i]},backend:r}),l=bB(a,"float32","mean",r),u=pB({inputs:{x:l},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(l),u}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const fG={kernelName:Ze,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{keepDims:i,axis:o}=e,s=n,a=r.shape.length,l=T(o,r.shape);let u=l;const c=dc(u,a),h=null!=c,d=s.shouldExecuteOnCPU([r]),p=[];let f=r;if(h){if(d){const t=s.texData.get(f.dataId),e=t.values,n=new Array(a);for(let s=0;s<n.length;s++)n[s]=r.shape[c[s]];const i=QL(e,r.shape,r.dtype,c,n);f=s.makeTensorInfo(n,r.dtype);const o=s.texData.get(f.dataId);o.values=i}else f=kB(r,c,s);p.push(f),u=fc(u.length,a)}hc("sum",u,a);const[g,m]=uc(f.shape,u);let y=g;i&&(y=cc(g,l));const b=pG(f,m,y,s);for(const v of p)s.disposeIntermediateTensorInfo(v);return b}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function gG(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:o,keepDims:s}=r,a=i.shape.length,l=T(o,i.shape);let u=l;const c=dc(u,a);let h=i;null!=c&&(h=SB({inputs:{x:i},backend:n,attrs:{perm:c}}),u=fc(u.length,i.shape.length)),hc("min",u,a);const[d,p]=uc(h.shape,u),f=w(p),g=pB({inputs:{x:h},backend:n,attrs:{shape:[-1,f]}}),m=bB(g,g.dtype,"min",n);let y;if(s){const t=cc(d,l);y=pB({inputs:{x:m},backend:n,attrs:{shape:t}})}else y=pB({inputs:{x:m},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),null!=c&&n.disposeIntermediateTensorInfo(h),y}const mG={kernelName:Qe,backendName:"webgl",kernelFunc:gG},yG=Bz+"\n  return min(a, b);\n",bG="\n  vec4 result = vec4(min(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+Uz+"\n  return result;\n",vG=iB({opSnippet:yG,packedOpSnippet:bG,cpuKernelImpl:TL}),wG={kernelName:tn,backendName:"webgl",kernelFunc:vG};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class xG{constructor(t,e,n){this.variableNames=["x"],this.outputShape=e.map(((e,n)=>e[0]+t[n]+e[1]));const r=t.length,i=vP(r),o=e.map((t=>t[0])).join(","),s=e.map(((e,n)=>e[0]+t[n])).join(","),a=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),l="reflect"===n?0:1;this.userCode=1!==r?`\n      ${i} start = ${i}(${o});\n      ${i} end = ${i}(${s});\n\n      void main() {\n        ${i} outC = getOutputCoords();\n        for (int i = 0; i < ${r}; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ${l};\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ${l};\n          }\n        }\n        ${i} coords = outC - start;\n        setOutput(getX(${a}));\n      }\n    `:`\n        int start = ${o};\n        int end = ${s};\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ${l};\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ${l};\n          }\n          setOutput(getX(outC - start));\n        }\n      `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class kG{constructor(t,e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map(((e,n)=>e[0]+t[n]+e[1]));const r=t.length,i=vP(r),o=e.map((t=>t[0])).join(","),s=e.map(((e,n)=>e[0]+t[n])).join(","),a=nz("rc",r),l=nz("source",r),u=`${a[r-1]} < ${this.outputShape[r-1]}`,c=1===r?"source":`vec2(${l.slice(-2).join()})`,h="reflect"===n?0:1;let d="";if(1===r){const t=`\n        ${i} source = rc;\n        if (source < start) {\n          source = start * 2 - source - ${h};\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ${h};\n        }\n        source -= start;\n      `;d=`\n        ${i} rc = outputLoc;\n        ${t}\n        result[0] = getChannel(getX(${l.join()}), ${c});\n        ${a[r-1]} += 1;\n        if(${u}) {\n          ${t}\n          result[1] = getChannel(getX(${l.join()}), ${c});\n        }\n      `}else{const t=`\n        ${i} source = rc;\n        ${i} lt = ${i}(lessThan(source, start));\n        ${i} gte = ${i}(greaterThanEqual(source, end));\n        ${i} orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ${h}) +\n                gte * ((end - 1) * 2 - source + ${h});\n        source -= start;\n      `;d=`\n        ${i} rc = outputLoc;\n        ${t}\n        result[0] = getChannel(getX(${l.join()}), ${c});\n        ${a[r-1]} += 1;\n        if(${u}) {\n          ${t}\n          result[1] = getChannel(getX(${l.join()}), ${c});\n        }\n        rc = outputLoc;\n        ${a[r-2]} += 1;\n        if(${a[r-2]} < ${this.outputShape[r-2]}) {\n          ${t}\n          result[2] = getChannel(getX(${l.join()}), ${c});\n          ${a[r-1]} += 1;\n          if(${u}) {\n            ${t}\n            result[3] = getChannel(getX(${l.join()}), ${c});\n          }\n        }\n      `}this.userCode=`\n      const ${i} start = ${i}(${o});\n      const ${i} end = ${i}(${s});\n\n      void main() {\n        ${i} outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ${d}\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const _G=({inputs:t,backend:e,attrs:n})=>{const{x:r}=t,{paddings:i,mode:o}=n,s=it().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new kG(r.shape,i,o):new xG(r.shape,i,o),a=e.runWebGLProgram(s,[r],r.dtype);return a},IG={kernelName:en,backendName:"webgl",kernelFunc:_G},CG="if (b == 0.0) return NAN;\n  return mod(a, b);",SG="\n  vec4 result = mod(a, b);\n  bvec4 isNaN = equal(b, vec4(0.0));\n  "+Uz+"\n  return result;\n",TG=iB({opSnippet:CG,packedOpSnippet:SG}),EG={kernelName:nn,backendName:"webgl",kernelFunc:TG};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class NG{constructor(t,e,n){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[t,n],this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ${e-1}; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(${e-1}));\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const AG="\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",RG="\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",$G=iB({opSnippet:AG,packedOpSnippet:RG,checkOutOfBounds:!0}),DG={kernelName:le,backendName:"webgl",kernelFunc:$G},OG="return a - b;",FG=iB({opSnippet:OG,packedOpSnippet:OG,supportsComplex:!0,cpuKernelImpl:YL}),MG={kernelName:lr,backendName:"webgl",kernelFunc:FG};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function PG(t){const{inputs:e,backend:n,attrs:r}=t,{logits:i}=e,{dim:o}=r,s=T([o],i.shape),a=XH({inputs:{x:i},backend:n,attrs:{reductionIndices:s,keepDims:!1}}),l=cc(a.shape,s),u=pB({inputs:{x:a},backend:n,attrs:{shape:l}}),c=FG({inputs:{a:i,b:u},backend:n}),h=lj({inputs:{x:c},backend:n}),d=IB({inputs:{x:h},backend:n,attrs:{axis:s,keepDims:!1}}),p=pB({inputs:{x:d},backend:n,attrs:{shape:l}}),f=$G({inputs:{a:h,b:p},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),f}const LG={kernelName:Xn,backendName:"webgl",kernelFunc:PG};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function zG(t){const{inputs:e,backend:n,attrs:r}=t,{logits:i}=e,{numSamples:o,seed:s,normalized:a}=r,l=a?i:PG({inputs:{logits:i},backend:n,attrs:{dim:i.shape.length-1}}),u=l.shape[0],c=l.shape[1],h=new NG(u,c,o),d=[[s]],p=n.runWebGLProgram(h,[l],"int32",d);return a||n.disposeIntermediateTensorInfo(l),p}const BG={kernelName:rn,backendName:"webgl",kernelFunc:zG},WG=gz+"\n  return -x;\n",UG="\n  vec4 result = -x;\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n";function VG(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])){const t=n.texData.get(r.dataId),[e,i]=NL(t.values,r.shape,r.dtype);return n.makeTensorInfo(i,r.dtype,e)}let i;return i=it().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new Ez(r.shape,UG):new fz(r.shape,WG),n.runWebGLProgram(i,[r],r.dtype)}const jG={kernelName:sn,backendName:"webgl",kernelFunc:VG},HG=Vd;function GG(t){Cr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:i,scores:o}=e,{maxOutputSize:s,iouThreshold:a,scoreThreshold:l}=r,u=n.readSync(i.dataId),c=n.readSync(o.dataId),{selectedIndices:h}=HG(u,c,s,a,l);return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}const qG={kernelName:ln,backendName:"webgl",kernelFunc:GG},KG=jd;function XG(t){Cr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:i,scores:o}=e,{maxOutputSize:s,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:u}=r,c=n.readSync(i.dataId),h=n.readSync(o.dataId),{selectedIndices:d,validOutputs:p}=KG(c,h,s,a,l,u);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}const YG={kernelName:un,backendName:"webgl",kernelFunc:XG},JG=Hd;function ZG(t){Cr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:i,scores:o}=e,{maxOutputSize:s,iouThreshold:a,scoreThreshold:l,softNmsSigma:u}=r,c=n.readSync(i.dataId),h=n.readSync(o.dataId),d=s,p=a,f=l,g=u,{selectedIndices:m,selectedScores:y}=JG(c,h,d,p,f,g);return[n.makeTensorInfo([m.length],"int32",new Int32Array(m)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}const QG={kernelName:cn,backendName:"webgl",kernelFunc:ZG};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class tq{constructor(t,e,n,r){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(${r}), float(${n}),\n                      float(index == coords.y)));\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const eq=t=>{const{inputs:e,backend:n,attrs:r}=t,{indices:i}=e,{dtype:o,depth:s,onValue:a,offValue:l}=r,u=w(i.shape),c=new tq(u,s,a,l),h=pB({inputs:{x:i},backend:n,attrs:{shape:[u]}}),d=n.runWebGLProgram(c,[h],o);n.disposeIntermediateTensorInfo(h);const p=[...i.shape,s],f=pB({inputs:{x:d},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(d),f},nq={kernelName:dn,backendName:"webgl",kernelFunc:eq};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function rq(t){const{inputs:e,backend:n}=t,{x:r}=e;if("complex64"===r.dtype){const t=aU({inputs:{input:r},backend:n}),e=rq({inputs:{x:t},backend:n}),i=TU({inputs:{input:r},backend:n}),o=rq({inputs:{x:i},backend:n}),s=Gz({inputs:{real:e,imag:o},backend:n});return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),s}return wj({attrs:{shape:r.shape,dtype:r.dtype,value:"string"===r.dtype?"":0},backend:n})}const iq={kernelName:br,backendName:"webgl",kernelFunc:rq};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function oq(t){const{inputs:e,backend:n}=t,{x:r}=e;if("string"===r.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===r.dtype){const t=aU({inputs:{input:r},backend:n}),e=oq({inputs:{x:t},backend:n}),i=TU({inputs:{input:r},backend:n}),o=rq({inputs:{x:i},backend:n}),s=Gz({inputs:{real:e,imag:o},backend:n});return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),s}return wj({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:n})}const sq={kernelName:hn,backendName:"webgl",kernelFunc:oq};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function aq(t){const{inputs:e,backend:n,attrs:r}=t,{axis:i}=r;if(1===e.length)return cj({inputs:{input:e[0]},backend:n,attrs:{dim:i}});const o=e[0].shape,s=e[0].dtype;e.forEach((t=>{b(o,t.shape,"All tensors passed to stack must have matching shapes"),y(s===t.dtype,(()=>"All tensors passed to stack must have matching dtypes"))}));const a=[],l=e.map((t=>{const e=cj({inputs:{input:t},backend:n,attrs:{dim:i}});return a.push(e),e})),u=RU({inputs:l,backend:n,attrs:{axis:i}});return a.forEach((t=>n.disposeIntermediateTensorInfo(t))),u}const lq={kernelName:pn,backendName:"webgl",kernelFunc:aq};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class uq{constructor(t,e,n){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=e.map(((e,n)=>e[0]+t[n]+e[1]));const r=t.length,i=vP(r),o=e.map((t=>t[0])).join(","),s=e.map(((e,n)=>e[0]+t[n])).join(","),a=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?`\n      ${i} start = ${i}(${o});\n      ${i} end = ${i}(${s});\n\n      void main() {\n        ${i} outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(value);\n        } else {\n          ${i} coords = outC - start;\n          setOutput(getX(${a}));\n        }\n      }\n    `:`\n        int start = ${o};\n        int end = ${s};\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(value);\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      `}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class cq{constructor(t,e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=e.map(((e,n)=>e[0]+t[n]+e[1]));const r=t.length,i=vP(r),o=e.map((t=>t[0])).join(","),s=e.map(((e,n)=>e[0]+t[n])).join(","),a=nz("rc",r),l=nz("source",r),u=`${a[r-1]} < ${this.outputShape[r-1]}`,c=1===r?"source":`vec2(${l.slice(-2).join()})`,h=[`${i} rc = outputLoc;`,`${a[r-1]} += 1;\n       if(${u}) {\n      `,1===r?"":`}\n       rc = outputLoc;\n       ${a[r-2]} += 1;\n       if(${a[r-2]} < ${this.outputShape[r-2]}) {`,1===r?"":`  ${a[r-1]} += 1;\n         if(${u}) {`],d=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let f=0,g=1===r?2:4;f<g;f++)p+=`\n        ${h[f]}\n        if (${d}) {\n          result[${f}] = float(value);\n        } else {\n          ${i} source = rc - start;\n          result[${f}] = getChannel(getX(${l.join()}), ${c});\n        }\n      `;p+=1===r?"} ":"}}",this.userCode=`\n      const ${i} start = ${i}(${o});\n      const ${i} end = ${i}(${s});\n\n      void main() {\n        ${i} outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ${p}\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const hq=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{paddings:o,constantValue:s}=r;if(0===w(i.shape)){const t=o.map(((t,e)=>t[0]+i.shape[e]+t[1]));return wj({backend:n,attrs:{shape:t,value:s,dtype:i.dtype}})}const a=it().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new cq(i.shape,o,s):new uq(i.shape,o,s),l=[[s]];return n.runWebGLProgram(a,[i],i.dtype,l)},dq={kernelName:fn,backendName:"webgl",kernelFunc:hq},pq="\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",fq="\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  bvec4 isNaN1 = lessThan(a, vec4(0.0));\n  bvec4 isNaN2 = lessThan(floor(b), b);\n  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);\n  "+Uz+"\n  return result;\n",gq=iB({opSnippet:pq,packedOpSnippet:fq}),mq={kernelName:gn,backendName:"webgl",kernelFunc:gq};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function yq(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:o,keepDims:s}=r,a=i.shape.length,l=[],u=T(o,i.shape);let c=u;const h=dc(c,a);let d,p=i;if(null!=h&&(p=SB({inputs:{x:i},backend:n,attrs:{perm:h}}),c=fc(c.length,a),l.push(p)),hc("prod",c,a),n.shouldExecuteOnCPU([p])){const t=n.texData.get(p.dataId).values,{outVals:e,outShape:r,outDtype:i}=RL(p.shape,p.dtype,t,c);d=n.makeTensorInfo(r,i,e)}else{const[t,e]=uc(p.shape,c),r=w(e),o=pB({inputs:{x:p},backend:n,attrs:{shape:[-1,r]}}),s=Bi(i.dtype),a=bB(o,s,"prod",n);d=pB({inputs:{x:a},backend:n,attrs:{shape:t}}),l.push(o),l.push(a)}if(s){l.push(d);const t=cc(d.shape,u);d=pB({inputs:{x:d},backend:n,attrs:{shape:t}})}return l.forEach((t=>n.disposeIntermediateTensorInfo(t))),d}const bq={kernelName:yn,backendName:"webgl",kernelFunc:yq};
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function vq(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:i,paramsDenseValues:o,indices:s}=e,{outputRaggedRank:a}=r,l=i.map((t=>n.readSync(t.dataId))),u=i.map((t=>t.shape)),c=n.readSync(o.dataId),h=n.readSync(s.dataId),[d,p,f]=$L(l,u,c,o.shape,o.dtype,h,s.shape,a),g=d.map((t=>n.makeTensorInfo([t.length],"int32",t))),m=n.makeTensorInfo(f,o.dtype,p);return g.concat([m])}const wq={kernelName:bn,backendName:"webgl",kernelFunc:vq};
/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function xq(t){const{inputs:e,backend:n}=t,{starts:r,limits:i,deltas:o}=e,s=n.readSync(r.dataId),a=n.readSync(i.dataId),l=n.readSync(o.dataId),[u,c]=DL(s,r.shape,r.dtype,a,i.shape,l,o.shape),h=n.makeTensorInfo([u.length],"int32",u),d=n.makeTensorInfo([c.length],r.dtype,c);return[h,d]}const kq={kernelName:vn,backendName:"webgl",kernelFunc:xq};
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function _q(t){const{inputs:e,backend:n,attrs:r}=t,{shape:i,values:o,defaultValue:s,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=r,u=n.readSync(i.dataId),c=n.readSync(o.dataId),h=n.readSync(s.dataId),d=a.map((t=>n.readSync(t.dataId))),p=a.map((t=>t.shape)),[f,g]=OL(u,i.shape,c,o.shape,o.dtype,h,s.shape,d,p,l);return n.makeTensorInfo(f,o.dtype,g)}const Iq={kernelName:wn,backendName:"webgl",kernelFunc:_q},Cq=t=>{const{backend:e,attrs:n}=t,{start:r,stop:i,step:o,dtype:s}=n,a=FL(r,i,o,s);return e.makeTensorInfo([a.length],s,a)},Sq={kernelName:xn,backendName:"webgl",kernelFunc:Cq},Tq="return 1.0 / x;",Eq=rB({opSnippet:Tq}),Nq={kernelName:_n,backendName:"webgl",kernelFunc:Eq},Aq=gz+"\n  return (x < 0.0) ? 0.0 : x;\n",Rq="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",$q=rB({opSnippet:Aq,packedOpSnippet:Rq}),Dq={kernelName:In,backendName:"webgl",kernelFunc:$q},Oq=gz+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",Fq="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Mq=rB({opSnippet:Oq,packedOpSnippet:Fq}),Pq={kernelName:An,backendName:"webgl",kernelFunc:Mq};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Lq{constructor(t,e,n,r,i){this.variableNames=["A"],this.outputShape=[];const[o,s,a,l]=t;this.outputShape=[o,e,n,l];const u=[r&&e>1?s-1:s,r&&n>1?a-1:a],c=[r&&e>1?e-1:e,r&&n>1?n-1:n];let h;h=i?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ${u[0]/c[0]},\n          ${u[1]/c[1]});\n      const vec2 inputShapeRC = vec2(${s}.0, ${a}.0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ${h};\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    `}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class zq{constructor(t,e,n,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,s,a,l]=t;this.outputShape=[o,e,n,l];const u=[r&&e>1?s-1:s,r&&n>1?a-1:a],c=[r&&e>1?e-1:e,r&&n>1?n-1:n];let h;h=i?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ${u[0]/c[0]},\n          ${u[1]/c[1]},\n          ${u[1]/c[1]});\n      const vec3 inputShapeRC = vec3(${s}.0, ${a}.0,\n                                     ${a}.0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ${h};\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ${l-1};\n        bool hasNextRow = coords.z < ${n-1};\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Bq(t){const{inputs:e,backend:n,attrs:r}=t,{images:i}=e,{alignCorners:o,halfPixelCenters:s,size:a}=r,[l,u]=a,c=it().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new zq(i.shape,l,u,o,s):new Lq(i.shape,l,u,o,s);return n.runWebGLProgram(c,[i],"float32")}const Wq={kernelName:En,backendName:"webgl",kernelFunc:Bq};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Uq{constructor(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e;const[,r,i]=e,[,o,s]=t,a=[n&&o>1?r-1:r,n&&s>1?i-1:i],l=[n&&o>1?o-1:o,n&&s>1?s-1:s],u=a[0]/l[0],c=a[1]/l[1],h=1/u,d=1/c,p=2*Math.ceil(h)+2,f=2*Math.ceil(d)+2;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(${u});\n        const float widthScale = float(${c});\n\n        const float invHeightScale = float(${h});\n        const float invWidthScale = float(${d});\n\n        const int winHeight = int(${p});\n        const int winWidth = int(${f});\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ${o}) {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ${s}) {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ${i-1}.0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Vq(t){const{inputs:e,backend:n,attrs:r}=t,{images:i,dy:o}=e,{alignCorners:s}=r,a=new Uq(o.shape,i.shape,s);return n.runWebGLProgram(a,[o],o.dtype)}const jq={kernelName:Nn,backendName:"webgl",kernelFunc:Vq};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Hq{constructor(t,e,n,r,i){this.variableNames=["A"],this.outputShape=[];const[o,s,a,l]=t;this.outputShape=[o,e,n,l];const u=[r&&e>1?s-1:s,r&&n>1?a-1:a],c=[r&&e>1?e-1:e,r&&n>1?n-1:n],h=r?"0.5":"0.0";let d;d=i?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ${u[0]/c[0]},\n          ${u[1]/c[1]});\n      const vec2 inputShapeRC = vec2(${s}.0, ${a}.0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ${d};\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    `}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Gq{constructor(t,e,n,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,s,a,l]=t;this.outputShape=[o,e,n,l];const u=[r&&e>1?s-1:s,r&&n>1?a-1:a],c=[r&&e>1?e-1:e,r&&n>1?n-1:n],h=r?"0.5":"0.0";let d;d=i?"max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ${u[0]/c[0]},\n          ${u[1]/c[1]},\n          ${u[1]/c[1]});\n      const vec3 inputShapeRC = vec3(${s}.0, ${a}.0,\n                                     ${a}.0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ${d};\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec3 sourceNearestRC = ivec3(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ${l-1};\n        bool hasNextRow = coords.z < ${n-1};\n\n        vec4 newValue = vec4(\n          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),\n          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);\n\n        setOutput(newValue);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function qq(t){const{inputs:e,backend:n,attrs:r}=t,{images:i}=e,{alignCorners:o,halfPixelCenters:s,size:a}=r,[l,u]=a,c=it().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Gq(i.shape,l,u,o,s):new Hq(i.shape,l,u,o,s);return n.runWebGLProgram(c,[i],i.dtype)}const Kq={kernelName:Sn,backendName:"webgl",kernelFunc:qq};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Xq{constructor(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e;const[,r,i]=e,[,o,s]=t,a=[n&&o>1?r-1:r,n&&s>1?i-1:i],l=[n&&o>1?o-1:o,n&&s>1?s-1:s],u=a[0]/l[0],c=a[1]/l[1],h=1/u,d=1/c,p=2*Math.ceil(h)+2,f=2*Math.ceil(d)+2;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(${u});\n        const float widthScale = float(${c});\n\n        const float invHeightScale = float(${h});\n        const float invWidthScale = float(${d});\n\n        const int winHeight = int(${p});\n        const int winWidth = int(${f});\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ${o}) {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ${s}) {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(${a[0]}) *\n                (float(dyR) / float(${l[0]}));\n\n            float sourceFracCol =\n                float(${a[1]}) *\n                  (float(dyC) / float(${l[1]}));\n\n            int sourceNearestRow = int(min(\n                float(int(${r}) - 1),\n                ${n} ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(${i}) - 1),\n                ${n} ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Yq(t){const{inputs:e,backend:n,attrs:r}=t,{images:i,dy:o}=e,{alignCorners:s}=r,a=new Xq(o.shape,i.shape,s);return n.runWebGLProgram(a,[o],o.dtype)}const Jq={kernelName:Tn,backendName:"webgl",kernelFunc:Yq};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Zq{constructor(t,e){this.variableNames=["x"];const n=t.length;if(n>4)throw new Error(`WebGL backend: Reverse of rank-${n} tensor is not yet supported`);if(this.outputShape=t,1===n)return void(this.userCode=`\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(${t[0]} - coord - 1));\n        }\n      `);const r=n=>-1!==e.indexOf(n)&&1!==t[n]?`${t[n]} - coords[${n}] - 1`:`coords[${n}]`,i=t.map(((t,e)=>r(e))).join(","),o=vP(n);this.userCode=`\n      void main() {\n        ${o} coords = getOutputCoords();\n        setOutput(getX(${i}));\n      }\n    `}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Qq{constructor(t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const n=t.length;if(n>4)throw new Error(`WebGL backend: Reverse of rank-${n} tensor is not yet supported`);this.outputShape=t;const r=nz("rc",n),i=`${r[n-1]} + 1 < ${this.outputShape[n-1]}`,o=`${r[n-2]} + 1 < ${this.outputShape[n-2]}`,s=vP(n);function a(t){return h(t)}function l(t){return t[n-1]="("+t[n-1]+" + 1)",h(t)}function u(t){return t[n-2]="("+t[n-2]+" + 1)",h(t)}function c(t){return t[n-1]="("+t[n-1]+" + 1)",t[n-2]="("+t[n-2]+" + 1)",h(t)}function h(e){const n=t.map(((t,n)=>d(n,e))),r=n.join(","),i=n.slice(-2).join(",");return`getChannel(getX(${r}), vec2(${i}))`}function d(n,r){return-1!==e.indexOf(n)&&1!==t[n]?`${t[n]} - ${r[n]} - 1`:`${r[n]}`}this.userCode=1===n?`\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(${t[0]} - rc - 1),\n            ${t[0]} - rc - 1);\n          if(${i}){\n              result.g = getChannel(getX(${t[0]} - (rc  + 1) - 1),\n                ${t[0]} - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      `:`\n        void main() {\n          ${s} rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ${a(r.slice())};\n          if(${i}){\n            result.g = ${l(r.slice())};\n          }\n          if(${o}) {\n            result.b = ${u(r.slice())};\n            if(${i}) {\n              result.a = ${c(r.slice())};\n            }\n          }\n          setOutput(result);\n        }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function tK(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{dims:o}=r,s=i.shape.length,a=T(o,i.shape);if(0===s)return jz({inputs:{x:i},backend:n});const l=it().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Qq(i.shape,a):new Zq(i.shape,a);return n.runWebGLProgram(l,[i],i.dtype)}const eK={kernelName:Rn,backendName:"webgl",kernelFunc:tK};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class nK{constructor(t,e){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const n=t[1],r=t[2];this.outputShape=t;let i="";i="number"===typeof e?`float outputValue = ${e.toFixed(2)};`:`\n        vec3 fill = vec3(${e.join(",")});\n        float outputValue = fill[coords[3]];`,this.userCode=`\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - params[0]) * params[3] -\n            (float(y) - params[1]) * params[2];\n          float coordYFloat = (float(x) - params[0]) * params[2] +\n            (float(y) - params[1]) * params[3];\n          int coordX = int(round(coordXFloat + params[0]));\n          int coordY = int(round(coordYFloat + params[1]));\n          ${i}\n          if(coordX >= 0 && coordX < ${r} && coordY >= 0 && coordY < ${n}) {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const rK={kernelName:xr,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:i,fillValue:o,center:s}=e,a=n,l=new nK(r.shape,o),[u,c]=Jp(s,r.shape[1],r.shape[2]),h=[[u,c,Math.sin(i),Math.cos(i)]],d=a.runWebGLProgram(l,[r],r.dtype,h);return d}},iK="\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n",oK=rB({opSnippet:iK}),sK={kernelName:$n,backendName:"webgl",kernelFunc:oK},aK="return inversesqrt(x);",lK=rB({opSnippet:aK,cpuKernelImpl:ML}),uK={kernelName:Dn,backendName:"webgl",kernelFunc:lK};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class cK{constructor(t,e,n,r,i,o,s=!0,a=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;const l=vP(i.length),u=vP(o.length);let c="";1===n?c="i":2===n&&(c="i, j");const h=`getIndices(${c})`;let d="";1===r?d="i":2===r&&(d="i, coords[1]");const p=`getUpdates(${d})`;let f="";a&&(f="coords[0], coords[1]");const g=`getDefaultValue(${f})`,m=e>1?"strides[j]":"strides";this.userCode=`\n        ${l} strides = ${l}(${i});\n\n        void main() {\n          ${u} coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ${t}; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ${e}; j++) {\n              int index = round(${h});\n              flattenedIndex += index * ${m};\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ${p};\n              found = true;\n            }\n          }\n          setOutput(mix(${g}, sum, float(found)));\n        }\n      `}}
/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class hK{constructor(t,e,n,r,i,o,s=!0,a=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o;const l=vP(i.length),u=vP(o.length);let c="";1===n?c="i":2===n&&(c="i, j");const h=`getIndices(${c})`;let d="";1===r?d="i":2===r&&(d="i, coords[1]");const p=`getUpdates(${d})`;let f="";a&&(f="coords[0], coords[1]");const g=`getDefaultValue(${f})`,m=e>1?"strides[j]":"strides",y=e>1?"strides[j + 1]":"strides";this.userCode=`\n        ${l} strides = ${l}(${i});\n\n        void main() {\n          ${u} coords = getOutputCoords();\n          vec4 sum = vec4(0.);\n          vec4 found = vec4(0.);\n          for (int i = 0; i < ${t}; i+=2) {\n            ivec2 flattenedIndex = ivec2(0);\n            for (int j = 0; j < ${e}; j+=2) {\n              ivec4 index = round(${h});\n              flattenedIndex += index.xz * ${m};\n              if (j + 1 < ${e}) {\n                flattenedIndex += index.yw * ${y};\n              }\n            }\n            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||\n                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {\n              vec4 updVals = ${p};\n              if (flattenedIndex[0] == coords[0]) {\n                sum.xy += updVals.xy;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[0] == coords[0] + 1) {\n                sum.zw += updVals.xy;\n                found.zw = vec2(1.);\n              }\n              if (flattenedIndex[1] == coords[0]) {\n                sum.xy += updVals.zw;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[1] == coords[0] + 1) {\n                sum.zw += updVals.zw;\n                found.zw = vec2(1.);\n              }\n            }\n          }\n          setOutput(mix(${g}, sum, found));\n        }\n      `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function dK(t){const{inputs:e,backend:n,attrs:r}=t,{indices:i,updates:o}=e,{shape:s}=r,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:h}=af(o,i,s),d=[h/u,u];if(0===h)return n.makeTensorInfo(s,i.dtype);const p=pB({inputs:{x:i},backend:n,attrs:{shape:[l,a]}}),f=pB({inputs:{x:o},backend:n,attrs:{shape:[l,u]}}),g=n.makeTensorInfo([],"float32",new Float32Array([0]));let m;m=it().getBool("WEBGL_PACK")?new hK(l,a,p.shape.length,f.shape.length,c,d):new cK(l,a,p.shape.length,f.shape.length,c,d);const y=n.runWebGLProgram(m,[f,p,g],f.dtype),b=pB({inputs:{x:y},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(g),b}const pK={kernelName:On,backendName:"webgl",kernelFunc:dK};
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class fK{constructor(t,e,n,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[t,n];const i="while (left < right) {",o=`for (int i = 0; i < ${Math.ceil(Math.log2(e+1))}; ++i) { if (left >= right) break;`,s=2===it().getNumber("WEBGL_VERSION")?i:o,a="left"===r?"<":"<=";this.userCode=`\n       int findBound(int batch, float value) {\n         int left = 0;\n         int right = numInputs;\n         int mid;\n         ${s}\n           mid = (left + right) / 2;\n           if (getSortedSequence(batch, mid) ${a} value) {\n             left = mid + 1;\n           } else {\n             right = mid;\n           }\n         }\n         return right;\n       }\n\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int valueIndex = coords[1];\n\n         float value = getValues(batch, valueIndex);\n\n         setOutput(float(findBound(batch, value)));\n       }\n     `}}
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function gK(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:i,values:o}=e,{side:s}=r,a=new fK(i.shape[0],i.shape[1],o.shape[1],s),l=[[i.shape[1]]];return n.runWebGLProgram(a,[i,o],"int32",l)}const mK={kernelName:Mn,backendName:"webgl",kernelFunc:gK};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class yK{constructor(t,e,n){let r,i;if(this.variableNames=["c","a","b"],this.outputShape=e,n>4)throw Error(`Where for rank ${n} is not yet supported`);if(1===n)i="resRC",r="resRC";else{const n=["resRC.x","resRC.y","resRC.z","resRC.w"],o=[],s=[];for(let r=0;r<e.length;r++)s.push(`${n[r]}`),r<t&&o.push(`${n[r]}`);r=o.join(),i=s.join()}const o=vP(n);this.userCode=`\n      void main() {\n        ${o} resRC = getOutputCoords();\n        float cVal = getC(${r});\n        if (cVal >= 1.0) {\n          setOutput(getA(${i}));\n        } else {\n          setOutput(getB(${i}));\n        }\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function bK(t){const{inputs:e,backend:n}=t,{condition:r,t:i,e:o}=e,s=new yK(r.shape.length,i.shape,i.shape.length);return n.runWebGLProgram(s,[r,i,o],zi(i.dtype,o.dtype))}const vK={kernelName:Pn,backendName:"webgl",kernelFunc:bK},wK=`\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ${lf};\n  float scale = ${uf};\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n`,xK=rB({opSnippet:wK}),kK={kernelName:Ln,backendName:"webgl",kernelFunc:xK},_K=nB+"\n  return 1.0 / (1.0 + exp(-1.0 * x));\n",IK="\n  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",CK=rB({opSnippet:_K,packedOpSnippet:IK,cpuKernelImpl:LL}),SK={kernelName:Vn,backendName:"webgl",kernelFunc:CK},TK="\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n",EK=rB({opSnippet:TK}),NK={kernelName:Un,backendName:"webgl",kernelFunc:EK},AK=nB+"\n  return sin(x);\n",RK=`\n  vec4 result = sin(x);\n  bvec4 isNaN = isnan(x);\n  ${Uz}\n  return result;\n`,$K=rB({opSnippet:AK,packedOpSnippet:RK}),DK={kernelName:Bn,backendName:"webgl",kernelFunc:$K},OK="\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n",FK=rB({opSnippet:OK}),MK={kernelName:Wn,backendName:"webgl",kernelFunc:FK},PK="\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n",LK=rB({opSnippet:PK}),zK={kernelName:jn,backendName:"webgl",kernelFunc:LK},BK=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{blockShape:o,paddings:s}=r;y(i.shape.length<=4,(()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"));const a=o.reduce(((t,e)=>t*e)),l=[[0,0]];l.push(...s);for(let y=1+o.length;y<i.shape.length;++y)l.push([0,0]);const u=[],c=hq({inputs:{x:i},backend:n,attrs:{paddings:l,constantValue:0}}),h=Zp(c.shape,o,a,!1),d=Qp(h.length,o.length,!1),p=tf(c.shape,o,a,!1),f=pB({inputs:{x:c},backend:n,attrs:{shape:h}}),g=SB({inputs:{x:f},backend:n,attrs:{perm:d}}),m=pB({inputs:{x:g},backend:n,attrs:{shape:p}});return u.push(c),u.push(f),u.push(g),u.forEach((t=>n.disposeIntermediateTensorInfo(t))),m},WK={kernelName:qn,backendName:"webgl",kernelFunc:BK};
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function UK(t){const{inputs:e,backend:n}=t,{indices:r,values:i,denseShape:o,defaultValue:s}=e;if(1!==o.shape.length)throw new Error(`Dense shape must be a vector, saw:\n         ${o.shape}`);if(2!==r.shape.length)throw new Error(`Indices must be a matrix, saw:\n         ${r.shape}`);if(1!==i.shape.length)throw new Error(`Values must be a vector, saw:\n         ${i.shape}`);if(0!==s.shape.length)throw new Error(`Default value must be a scalar, saw:\n        ${s.shape}`);const a=n.readSync(r.dataId),l=n.readSync(i.dataId),u=n.readSync(o.dataId),c=n.readSync(s.dataId)[0],[h,d,p,f,g]=WL(a,r.shape,r.dtype,l,i.dtype,u,c);return[n.makeTensorInfo(d,r.dtype,h),n.makeTensorInfo([d[0]],i.dtype,p),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map((t=>Number(t))))),n.makeTensorInfo([g.length],r.dtype,new Int32Array(g))]}const VK={kernelName:Yn,backendName:"webgl",kernelFunc:UK};
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function jK(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:i,newShape:o}=e;if(2!==r.shape.length)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(1!==i.shape.length)throw new Error(`Input shape should be a vector but received shape ${i.shape}`);if(1!==o.shape.length)throw new Error(`Target shape should be a vector but received shape ${o.shape}`);const s=Array.from(n.readSync(i.dataId)),a=n.readSync(r.dataId),l=Array.from(n.readSync(o.dataId)),[u,c,h]=UL(a,r.shape,r.dtype,s,l);return[n.makeTensorInfo(c,r.dtype,u),n.makeTensorInfo([h.length],o.dtype,new Int32Array(h))]}const HK={kernelName:Jn,backendName:"webgl",kernelFunc:jK};
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function GK(t){const{inputs:e,backend:n}=t,{data:r,indices:i,segmentIds:o}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.shape.length)throw new Error(`Indices should be a vector but received shape\n              ${i.shape}`);if(1!==o.shape.length)throw new Error(`Segment ids should be a vector but received shape\n              ${o.shape}`);const s=n.readSync(r.dataId),a=n.readSync(i.dataId),l=n.readSync(o.dataId),[u,c]=VL(s,r.shape,r.dtype,a,l,!0);return n.makeTensorInfo(c,r.dtype,u)}const qK={kernelName:Zn,backendName:"webgl",kernelFunc:GK};
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function KK(t){const{inputs:e,backend:n}=t,{data:r,indices:i,segmentIds:o}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.shape.length)throw new Error(`Indices should be a vector but received shape\n             ${i.shape}`);if(1!==o.shape.length)throw new Error(`Segment ids should be a vector but received shape\n             ${o.shape}`);const s=n.readSync(r.dataId),a=n.readSync(i.dataId),l=n.readSync(o.dataId),[u,c]=VL(s,r.shape,r.dtype,a,l);return n.makeTensorInfo(c,r.dtype,u)}const XK={kernelName:Qn,backendName:"webgl",kernelFunc:KK};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function YK(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:i,sparseValues:o,defaultValue:s}=e,{outputShape:a}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:h,outputSize:d}=af(o,i,a),p=!1;if("string"===o.dtype){const t=n.bufferSync(i),e=n.bufferSync(o),r=si(n.readSync(s.dataId)[0]),f=PL(t,e,a,d,c,u,l,h,r,p);return n.makeTensorInfo(a,f.dtype,f.values)}const f=new cK(u,l,i.shape.length,o.shape.length,h,[d,1],p),g=n.runWebGLProgram(f,[o,i,s],o.dtype),m=pB({inputs:{x:g},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(g),m}const JK={kernelName:tr,backendName:"webgl",kernelFunc:YK};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function ZK(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{numOrSizeSplits:o,axis:s}=r,a=T(s,i.shape)[0],l=Of(i,o,a),u=i.shape.length,c=new Array(u).fill(0),h=i.shape.slice();return l.map((t=>{const e=[...h];e[a]=t;const r=GW({inputs:{x:i},backend:n,attrs:{begin:c,size:e}});return c[a]+=t,r}))}const QK={kernelName:Kn,backendName:"webgl",kernelFunc:ZK},tX="return sqrt(x);",eX=rB({opSnippet:tX,packedOpSnippet:tX,cpuKernelImpl:jL}),nX={kernelName:Hn,backendName:"webgl",kernelFunc:eX},rX="return x * x;",iX=rB({opSnippet:rX}),oX={kernelName:nr,backendName:"webgl",kernelFunc:iX},sX="return (a - b) * (a - b);",aX=iB({opSnippet:sX,packedOpSnippet:sX}),lX={kernelName:er,backendName:"webgl",kernelFunc:aX};
/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function uX(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e;if("string"!==i.dtype)throw new Error("Input must be of datatype string");const o=n.readSync(i.dataId),s=Yf(o),a=HL(s,"string",r);return n.makeTensorInfo(i.shape,"string",a)}const cX={kernelName:rr,backendName:"webgl",kernelFunc:uX};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function hX({inputs:t,attrs:e,backend:n}){const{x:r}=t,i=gz+`\n    return x > 0.0 ? 1.0 : float(${e.alpha});\n  `,o=new fz(r.shape,i);return n.runWebGLProgram(o,[r],r.dtype)}const dX={kernelName:vr,backendName:"webgl",kernelFunc:hX};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class pX{constructor(t,e,n){this.variableNames=["x"],this.outputShape=n;const r=n.length,i=vP(n.length),o=vP(n.length);let s="";if(1===r)s="coords * strides + begin";else{let t=0;s=n.map(((e,r)=>(t++,1===n.length?`coords * strides[${r}] + begin[${r}]`:`coords[${t-1}] * strides[${r}] + begin[${r}]`))).join(",")}this.userCode=`\n      ${i} begin = ${i}(${t});\n      ${i} strides = ${i}(${e});\n\n      void main() {\n        ${o} coords = getOutputCoords();\n        setOutput(getX(${s}));\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function fX(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{begin:o,end:s,strides:a,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:h,shrinkAxisMask:d}=r,{finalShapeSparse:p,finalShape:f,isIdentity:g,sliceDim0:m,isSimpleSlice:b,begin:v,end:w,strides:x}=ll(i.shape,o,s,a,l,u,c,h,d);let k;if(g)k=pB({inputs:{x:i},backend:n,attrs:{shape:f}});else if(m||b){y(i.shape.length>=1,(()=>`Input must have rank at least 1, got: ${i.shape.length}`));const t=Xa(v,w,x),e=GW({inputs:{x:i},backend:n,attrs:{begin:v,size:t}});k=pB({inputs:{x:e},backend:n,attrs:{shape:f}}),n.disposeIntermediateTensorInfo(e)}else{const t=n.shouldExecuteOnCPU([i]);if(t){const t=n.readSync(i.dataId),e=As(i.shape,i.dtype,t),r=GL(p,e,x,v);k=n.makeTensorInfo(f,i.dtype,r.values)}else{const t=new pX(v,x,p);k=n.runWebGLProgram(t,[i],i.dtype)}}const _=pB({inputs:{x:k},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(k),_}const gX={kernelName:ir,backendName:"webgl",kernelFunc:fX};
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function mX(t){const{inputs:e,backend:n,attrs:r}=t,{separator:i,nGramWidths:o,leftPad:s,rightPad:a,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:h}=e,d=n.readSync(c.dataId),p=n.readSync(h.dataId),[f,g]=qL(d,p,i,o,s,a,l,u);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(h.shape,"int32",g)]}const yX={kernelName:or,backendName:"webgl",kernelFunc:mX};
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function bX(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:i}=r,{input:o,delimiter:s}=e;if("string"!==o.dtype)throw new Error("Input must be of datatype string");if(1!==o.shape.length)throw new Error(`Input must be a vector, got shape: ${o.shape}`);if(0!==s.shape.length)throw new Error(`Delimiter must be a scalar, got shape: ${s.shape}`);const a=n.readSync(o.dataId),l=n.readSync(s.dataId)[0],[u,c,h]=KL(a,l,i),d=c.length;return[n.makeTensorInfo([d,2],"int32",u),n.makeTensorInfo([d],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(h))]}const vX={kernelName:sr,backendName:"webgl",kernelFunc:bX};
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function wX(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:i}=r,{input:o}=e;if("string"!==o.dtype)throw new Error("Input must be of datatype string");if(i<=0)throw new Error("Number of buckets must be at least 1");const s=n.readSync(o.dataId),a=XL(s,i);return n.makeTensorInfo(o.shape,"int32",a)}const xX={kernelName:ar,backendName:"webgl",kernelFunc:wX},kX="return tan(x);",_X=rB({opSnippet:kX}),IX={kernelName:ur,backendName:"webgl",kernelFunc:_X},CX="\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n",SX=rB({opSnippet:CX}),TX={kernelName:cr,backendName:"webgl",kernelFunc:SX};
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function EX(t){const{inputs:e,backend:n,attrs:r}=t,{tensor:i,indices:o,updates:s}=e,{}=r,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:h}=af(s,o,i.shape),d=[h/u,u];if(0===h)return n.makeTensorInfo(i.shape,o.dtype);const p=pB({inputs:{x:o},backend:n,attrs:{shape:[l,a]}}),f=pB({inputs:{x:s},backend:n,attrs:{shape:[l,u]}}),g=pB({inputs:{x:i},backend:n,attrs:{shape:d}}),m=new cK(l,a,p.shape.length,f.shape.length,c,d,!1,!0),y=n.runWebGLProgram(m,[f,p,g],g.dtype),b=pB({inputs:{x:y},backend:n,attrs:{shape:i.shape}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),b}const NX={kernelName:Fn,backendName:"webgl",kernelFunc:EX};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class AX{constructor(t,e){this.variableNames=["A"];const n=new Array(t.length);for(let o=0;o<n.length;o++)n[o]=t[o]*e[o];this.outputShape=n,this.rank=n.length;const r=vP(this.rank),i=RX(t);this.userCode=`\n      void main() {\n        ${r} resRC = getOutputCoords();\n        setOutput(getA(${i}));\n      }\n    `}}function RX(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(1===e)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let i=0;i<t.length;i++)r.push(`imod(${n[i]}, ${t[i]})`);return r.join()}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function $X(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{reps:o}=r;if("string"===i.dtype||i.shape.length>5){const t=n.readSync(i.dataId),e="string"===i.dtype?t.map((t=>si(t))):t,r=As(i.shape,i.dtype,e),s=JL(r,o);return n.makeTensorInfo(s.shape,s.dtype,s.values)}const s=new AX(i.shape,o),a=n.runWebGLProgram(s,[i],i.dtype);return a}const DX={kernelName:hr,backendName:"webgl",kernelFunc:$X};class OX{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=t,this.userCode="\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // We compare elements pair-wise within a group of size 2 * inc.\n         // The comparing rule for each group alternates between ascending\n         // and descending. Within each group, we compare each pair at\n         // positions i and i+inc. To decide whether an element at position i\n         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than\n         // inc, it is in the first half of the group, we denote it as x0,\n         // otherwise we denote it as x1.\n         // For example, as shown in the Bitonic top K paper referenced above,\n         // Figure5(a) shows that element[1] is in the\n         // second half of the group when group size is 2, but it is in the\n         // first half of the group when group size is 4.\n\n         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;\n         int i = isFirstInPair ? elemIdx : elemIdx - inc;\n\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));\n         float x0 = i0 < n ? getX(batch, i0) : negativeInf;\n         float x1 = i1 < n ? getX(batch, i1) : negativeInf;\n\n         // Denotes which direction indices are in (ascending or descending).\n         bool reverse = imod(elemIdx, 2 * dir) >= dir;\n         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);\n         if (reverse == isGreater) { // Elements in opposite order of direction\n           int iTemp = i0;\n           i0 = i1;\n           i1 = iTemp;\n         }\n         if (isFirstInPair) {\n            setOutput(float(i0));\n         } else {\n            setOutput(float(i1));\n         }\n       }\n     "}}class FX{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=t,this.userCode="\n    void main() {\n         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // The output size is half of the previous size.\n         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),\n         // we only need to output the indices at positions |, the indices at\n         // positions _ can be thrown away, see Figure5(b) After Phase 2\n         // (Merge phase) in the Bitonic Top K paper referenced above.\n         // For example, the paper shows we only need to output the orange bars.\n         // The output sequence should look like this | | | | | | | |.\n         // Because the sequence is halved, to map the output index back\n         // to the previous sequence to find the corresponding value,\n         // we need to double the index. When we double the index,\n         // we basically interpolate a position, so 2i looks like\n         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position\n         // of each 2k positions by - elemIdx % k. E.g. for output at\n         // index 4,5,6,7, we want to get the corresponding element at\n         // original index 8,9,10,11, for output at index 8,9,10,11,\n         // we want to get the corresponding element at original index\n         // 16,17,18,19, so on and so forth.\n\n         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));\n\n         float x0 = getX(batch, i0);\n         float x1 = i1 < n ? getX(batch, i1) : x0;\n\n         setOutput(x0 >= x1 ? float(i0) : float(i1));\n       }\n     "}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function MX(t,e){null!==e&&t.disposeIntermediateTensorInfo(e)}function PX(t){let e=1;while(e<t)e*=2;return e}function LX(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{k:o,sorted:s}=r,a=it().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=it().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),u=i.shape,c=u[u.length-1];if(n.shouldExecuteOnCPU([i])||c<a||o>l){const t=n.readSync(i.dataId),[e,r]=ZL(t,u,i.dtype,o,s);return[n.makeTensorInfo(e.shape,e.dtype,e.values),n.makeTensorInfo(r.shape,r.dtype,r.values)]}if(0===o)return u[u.length-1]=0,[n.makeTensorInfo(u,i.dtype,[]),n.makeTensorInfo(u,"int32",[])];if(1===c)return[i,wj({attrs:{shape:u,dtype:"int32",value:0},backend:n})];const h=n.texData.get(i.dataId),d=null!==h&&h.isPacked,p=d?n.unpackTensor(i):i,f=w(u),g=f/c,m=pB({inputs:{x:p},attrs:{shape:[g,c]},backend:n});d&&MX(n,p);const y=PX(o),b=PX(c);let v=null;const x=()=>null===v?[m,m]:[m,v],k=(t,e,r)=>{const i=x(),o=new OX(r),s=null===v?1:0,a=[[c],[s],[Number.NEGATIVE_INFINITY],[t],[e]],l=v;v=n.runWebGLProgram(o,i,"int32",a),MX(n,l)};for(let w=1;w<y;w*=2){const t=2*w;for(let e=w;e>=1;e/=2)k(t,e,[g,b])}for(let w=b;w>y;w/=2){const t=x(),e=new FX([g,w/2]),r=null===v?1:0,i=[[c],[r],[y]],o=v;v=n.runWebGLProgram(e,t,"int32",i),MX(n,o);const s=y/2,a=2*s;for(let n=s;n>=1;n/=2)k(a,n,v.shape)}let _=v;v=GW({inputs:{x:v},backend:n,attrs:{begin:0,size:[g,o]}}),MX(n,_);let I=Gj({inputs:{x:m,indices:v},backend:n,attrs:{axis:1,batchDims:1}});MX(n,m);const C=u.slice(0,-1);C.push(o),_=v,v=pB({inputs:{x:v},attrs:{shape:C},backend:n}),MX(n,_);const S=I;return I=pB({inputs:{x:I},attrs:{shape:C},backend:n}),MX(n,S),[I,v]}const zX={kernelName:dr,backendName:"webgl",kernelFunc:LX};
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class BX{constructor(t,e,n,r,i,o){this.variableNames=["Image","Transforms"],this.outputShape=o;const s="nearest"===n?1:2;let a;switch(r){case"constant":a=1;break;case"reflect":a=2;break;case"wrap":a=3;break;case"nearest":a=4;break;default:a=1;break}this.userCode=`\n            float mapCoord(float outCoord, float len) {\n              float inCoord = outCoord;\n              if(${a} == 2) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    if (inCoord < sz2) {\n                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +\n                      inCoord;\n                    }\n                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    inCoord -= sz2 * float(int(float(inCoord / sz2)));\n                    if (inCoord >= len) {\n                      inCoord = sz2 - inCoord - 1.0;\n                    }\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (${a} == 3) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord -= len * float(int(float(inCoord / sz)));\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (${a} == 4) {\n                return clamp(outCoord, 0.0, len - 1.0);\n              } else {\n                return outCoord;\n              }\n            }\n\n            float readWithFillValue(int batch, int coordY, int coordX,\n              int channel) {\n              float outputValue;\n              if (0 <= coordY && coordY < ${t} && 0 <= coordX && coordX < ${e}) {\n                  outputValue = getImage(batch, coordY, coordX, channel);\n              } else {\n                outputValue = float(${i});\n              }\n              return outputValue;\n            }\n\n            void main() {\n              ivec4 coords = getOutputCoords();\n              float outputValue;\n              int batch = coords[0];\n              int x = coords[2];\n              int y = coords[1];\n              int channel = coords[3];\n              float xf = float(x);\n              float yf = float(y);\n              float a1 = getTransforms(batch, 0);\n              float a2 = getTransforms(batch, 1);\n              float a3 = getTransforms(batch, 2);\n              float b1 = getTransforms(batch, 3);\n              float b2 = getTransforms(batch, 4);\n              float b3 = getTransforms(batch, 5);\n              float c1 = getTransforms(batch, 6);\n              float c2 = getTransforms(batch, 7);\n              float projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = float(${i});\n              } else {\n                float inX = (a1 * xf + a2 * yf + a3) / projection;\n                float inY = (b1 * xf + b2 * yf + b3) / projection;\n                float mapX = mapCoord(inX, float(${e}));\n                float mapY = mapCoord(inY, float(${t}));\n\n                if (${s} == 1) {\n                  int coordY = int(round(mapY));\n                  int coordX = int(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  float yFloor = floor(mapY);\n                  float xFloor = floor(mapX);\n                  float yCeil = yFloor + 1.0;\n                  float xCeil = xFloor + 1.0;\n                  float valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);\n                  float valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutput(outputValue);\n            }\n        `}}
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function WX(t){const{inputs:e,backend:n,attrs:r}=t,{image:i,transforms:o}=e,{interpolation:s,fillMode:a,fillValue:l,outputShape:u}=r,[c,h,d,p]=i.shape,[f,g]=null!=u?u:[h,d],m=[c,f,g,p],y=new BX(h,d,s,a,l,m);return n.runWebGLProgram(y,[i,o],"float32")}const UX={kernelName:pr,backendName:"webgl",kernelFunc:WX};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function VX(t){const{inputs:e,attrs:n,backend:r}=t,{axis:i}=n,{x:o}=e;xM(o,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const s=r.readSync(o.dataId),{outputValues:a,outputShape:l,indices:u}=tz(s,i,o.shape,o.dtype);return[r.makeTensorInfo(l,o.dtype,a),r.makeTensorInfo([u.length],"int32",u)]}const jX={kernelName:gr,backendName:"webgl",kernelFunc:VX};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function HX(t){const{inputs:e,backend:n,attrs:r}=t,{value:i}=e;let{axis:o}=r;o<0&&(o+=i.shape.length);const s=i,a=s.shape.length,l=i.shape[o],u=new Array(a-1);let c=0;for(let g=0;g<a;g++)g!==o&&(u[c++]=s.shape[g]);const h=[],d=new Array(a).fill(0),p=s.shape.slice();p[o]=1;const f=new Array(l);for(let g=0;g<f.length;g++){d[o]=g;const t=GW({inputs:{x:s},backend:n,attrs:{begin:d,size:p}}),e=pB({inputs:{x:t},backend:n,attrs:{shape:u}});f[g]=e,h.push(t)}return h.forEach((t=>n.disposeIntermediateTensorInfo(t))),f}const GX={kernelName:mr,backendName:"webgl",kernelFunc:HX};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class qX{constructor(t,e){this.variableNames=["x","segmentIds"];const n=t.windowSize,r=t.batchSize,i=t.inSize,o=t.numSegments,s=o*Math.ceil(i/n);this.outputShape=[r,s];const a="0.0",l="sumValue",u=4*Math.floor(n/4),c=n%4,h="\n        sumValue += dot(values, segFilter);\n    ";let d="";i%n>0&&(d=`\n        if (inIdx < 0 || inIdx >= ${i}) {\n          return initializationValue;\n        }\n      `);let p="";i%n>0&&(p=`\n        if (inIdx < 0 || inIdx >= ${i}) {\n          return -1.0;\n        }\n      `),this.userCode=`\n      const float initializationValue = ${a};\n\n      float getValue(int batch, int inIdx) {\n        ${d}\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ${p}\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ${o})) * float(${n}));\n        int currentSeg = int(mod(float(outIdx), float(${o})));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ${u}; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ${h}\n        }\n\n        int inIdx = inOffset + ${u};\n        if (${1===c}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ${h}\n        } else if (${2===c}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ${h}\n        } else if (${3===c}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ${h}\n        }\n        setOutput(${l});\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function KX(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,segmentIds:o}=e,{numSegments:s}=r,a=i.shape.length,l=[];let u=0;const c=dc([u],a);let h=i;null!=c&&(h=SB({inputs:{x:i},backend:n,attrs:{perm:c}}),l.push(h),u=fc(1,a)[0]);const d=Kf(h.shape,u,s),p=w([h.shape[u]]),f=pB({inputs:{x:h},backend:n,attrs:{shape:[-1,p]}});l.push(f);const g=Bi(i.dtype),m=(t,e,r,i,o)=>{const s=t.shape[0],a=t.shape[1],u=qf(a,o),c={windowSize:u,inSize:a,batchSize:s,numSegments:o},h=new qX(c,e),d=n.compileAndRun(h,[t,r],i);if(l.push(d),d.shape[1]===o)return d;const p=Cq({backend:n,attrs:{start:0,stop:o,step:1,dtype:"float32"}}),f=$X({inputs:{x:p},backend:n,attrs:{reps:[a/u]}});l.push(p),l.push(f);const g=m(d,e,f,i,o);return g},y=m(f,"unsortedSegmentSum",o,g,s),b=pB({inputs:{x:y},backend:n,attrs:{shape:d}});let v=b;if(null!=c){l.push(b);const t=pc(c);v=SB({inputs:{x:v},backend:n,attrs:{perm:t}})}return l.forEach((t=>n.disposeIntermediateTensorInfo(t))),v}const XX={kernelName:yr,backendName:"webgl",kernelFunc:KX},YX=[RB,OB,PB,BB,VB,qB,XB,JB,iW,sW,uW,dW,gW,vW,kW,SW,EW,$W,OW,MW,BW,XW,JW,eU,rU,dU,gU,vU,qz,_U,$U,WU,qU,YU,ZU,tV,nV,sV,uV,dV,vV,xV,_V,SV,AV,OV,MV,zV,UV,jV,KV,ZV,nj,oj,uj,hj,fj,bj,xj,_j,Sj,Aj,Dj,Lj,Bj,Vj,qj,Jj,eH,Hz,rH,EU,sH,uH,dH,Jz,mH,wH,kH,SH,NH,DH,MH,BH,jH,qH,YH,tG,nG,iG,lG,cG,dG,fG,mG,wG,IG,EG,BG,hB,jG,qG,YG,QG,sU,nq,sq,lq,dq,mq,eB,bq,wq,kq,Iq,Sq,lU,DG,Nq,Dq,Pq,fB,Wq,jq,Kq,Jq,eK,rK,sK,uK,pK,mK,vK,kK,SK,NK,DK,MK,qW,LG,zK,WK,VK,HK,qK,XK,JK,QK,nX,oX,lX,cX,dX,gX,yX,vX,xX,MG,CB,IX,TX,NX,DX,zX,UX,TB,jX,GX,XX,iq];for(const ZX of YX)$r(ZX)},4870:function(t,e,n){"use strict";n.d(e,{Bj:function(){return o},Fl:function(){return Lt},IU:function(){return _t},Jd:function(){return I},PG:function(){return vt},SU:function(){return Ot},Um:function(){return mt},WL:function(){return Mt},X$:function(){return E},X3:function(){return kt},XI:function(){return Rt},Xl:function(){return It},dq:function(){return Nt},iH:function(){return At},j:function(){return S},lk:function(){return C},nZ:function(){return a},qj:function(){return gt},qq:function(){return w},yT:function(){return xt}});n(560);var r=n(7139);let i;class o{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this.parent=i,!t&&i&&(this.index=(i.scopes||(i.scopes=[])).push(this)-1)}get active(){return this._active}run(t){if(this._active){const e=i;try{return i=this,t()}finally{i=e}}else 0}on(){i=this}off(){i=this.parent}stop(t){if(this._active){let e,n;for(e=0,n=this.effects.length;e<n;e++)this.effects[e].stop();for(e=0,n=this.cleanups.length;e<n;e++)this.cleanups[e]();if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].stop(!0);if(!this.detached&&this.parent&&!t){const t=this.parent.scopes.pop();t&&t!==this&&(this.parent.scopes[this.index]=t,t.index=this.index)}this.parent=void 0,this._active=!1}}}function s(t,e=i){e&&e.active&&e.effects.push(t)}function a(){return i}const l=t=>{const e=new Set(t);return e.w=0,e.n=0,e},u=t=>(t.w&g)>0,c=t=>(t.n&g)>0,h=({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=g},d=t=>{const{deps:e}=t;if(e.length){let n=0;for(let r=0;r<e.length;r++){const i=e[r];u(i)&&!c(i)?i.delete(t):e[n++]=i,i.w&=~g,i.n&=~g}e.length=n}},p=new WeakMap;let f=0,g=1;const m=30;let y;const b=Symbol(""),v=Symbol("");class w{constructor(t,e=null,n){this.fn=t,this.scheduler=e,this.active=!0,this.deps=[],this.parent=void 0,s(this,n)}run(){if(!this.active)return this.fn();let t=y,e=k;while(t){if(t===this)return;t=t.parent}try{return this.parent=y,y=this,k=!0,g=1<<++f,f<=m?h(this):x(this),this.fn()}finally{f<=m&&d(this),g=1<<--f,y=this.parent,k=e,this.parent=void 0,this.deferStop&&this.stop()}}stop(){y===this?this.deferStop=!0:this.active&&(x(this),this.onStop&&this.onStop(),this.active=!1)}}function x(t){const{deps:e}=t;if(e.length){for(let n=0;n<e.length;n++)e[n].delete(t);e.length=0}}let k=!0;const _=[];function I(){_.push(k),k=!1}function C(){const t=_.pop();k=void 0===t||t}function S(t,e,n){if(k&&y){let e=p.get(t);e||p.set(t,e=new Map);let r=e.get(n);r||e.set(n,r=l());const i=void 0;T(r,i)}}function T(t,e){let n=!1;f<=m?c(t)||(t.n|=g,n=!u(t)):n=!t.has(y),n&&(t.add(y),y.deps.push(t))}function E(t,e,n,i,o,s){const a=p.get(t);if(!a)return;let u=[];if("clear"===e)u=[...a.values()];else if("length"===n&&(0,r.kJ)(t)){const t=Number(i);a.forEach(((e,n)=>{("length"===n||!(0,r.yk)(n)&&n>=t)&&u.push(e)}))}else switch(void 0!==n&&u.push(a.get(n)),e){case"add":(0,r.kJ)(t)?(0,r.S0)(n)&&u.push(a.get("length")):(u.push(a.get(b)),(0,r._N)(t)&&u.push(a.get(v)));break;case"delete":(0,r.kJ)(t)||(u.push(a.get(b)),(0,r._N)(t)&&u.push(a.get(v)));break;case"set":(0,r._N)(t)&&u.push(a.get(b));break}if(1===u.length)u[0]&&N(u[0]);else{const t=[];for(const e of u)e&&t.push(...e);N(l(t))}}function N(t,e){const n=(0,r.kJ)(t)?t:[...t];for(const r of n)r.computed&&A(r,e);for(const r of n)r.computed||A(r,e)}function A(t,e){(t!==y||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}const R=(0,r.fY)("__proto__,__v_isRef,__isVue"),$=new Set(Object.getOwnPropertyNames(Symbol).filter((t=>"arguments"!==t&&"caller"!==t)).map((t=>Symbol[t])).filter(r.yk)),D=O();function O(){const t={};return["includes","indexOf","lastIndexOf"].forEach((e=>{t[e]=function(...t){const n=_t(this);for(let e=0,i=this.length;e<i;e++)S(n,"get",e+"");const r=n[e](...t);return-1===r||!1===r?n[e](...t.map(_t)):r}})),["push","pop","shift","unshift","splice"].forEach((e=>{t[e]=function(...t){I();const n=_t(this)[e].apply(this,t);return C(),n}})),t}function F(t){const e=_t(this);return S(e,"has",t),e.hasOwnProperty(t)}class M{constructor(t=!1,e=!1){this._isReadonly=t,this._shallow=e}get(t,e,n){const i=this._isReadonly,o=this._shallow;if("__v_isReactive"===e)return!i;if("__v_isReadonly"===e)return i;if("__v_isShallow"===e)return o;if("__v_raw"===e)return n===(i?o?dt:ht:o?ct:ut).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(n)?t:void 0;const s=(0,r.kJ)(t);if(!i){if(s&&(0,r.RI)(D,e))return Reflect.get(D,e,n);if("hasOwnProperty"===e)return F}const a=Reflect.get(t,e,n);return((0,r.yk)(e)?$.has(e):R(e))?a:(i||S(t,"get",e),o?a:Nt(a)?s&&(0,r.S0)(e)?a:a.value:(0,r.Kn)(a)?i?yt(a):gt(a):a)}}class P extends M{constructor(t=!1){super(!1,t)}set(t,e,n,i){let o=t[e];if(wt(o)&&Nt(o)&&!Nt(n))return!1;if(!this._shallow&&(xt(n)||wt(n)||(o=_t(o),n=_t(n)),!(0,r.kJ)(t)&&Nt(o)&&!Nt(n)))return o.value=n,!0;const s=(0,r.kJ)(t)&&(0,r.S0)(e)?Number(e)<t.length:(0,r.RI)(t,e),a=Reflect.set(t,e,n,i);return t===_t(i)&&(s?(0,r.aU)(n,o)&&E(t,"set",e,n,o):E(t,"add",e,n)),a}deleteProperty(t,e){const n=(0,r.RI)(t,e),i=t[e],o=Reflect.deleteProperty(t,e);return o&&n&&E(t,"delete",e,void 0,i),o}has(t,e){const n=Reflect.has(t,e);return(0,r.yk)(e)&&$.has(e)||S(t,"has",e),n}ownKeys(t){return S(t,"iterate",(0,r.kJ)(t)?"length":b),Reflect.ownKeys(t)}}class L extends M{constructor(t=!1){super(!0,t)}set(t,e){return!0}deleteProperty(t,e){return!0}}const z=new P,B=new L,W=new P(!0),U=t=>t,V=t=>Reflect.getPrototypeOf(t);function j(t,e,n=!1,i=!1){t=t["__v_raw"];const o=_t(t),s=_t(e);n||((0,r.aU)(e,s)&&S(o,"get",e),S(o,"get",s));const{has:a}=V(o),l=i?U:n?St:Ct;return a.call(o,e)?l(t.get(e)):a.call(o,s)?l(t.get(s)):void(t!==o&&t.get(e))}function H(t,e=!1){const n=this["__v_raw"],i=_t(n),o=_t(t);return e||((0,r.aU)(t,o)&&S(i,"has",t),S(i,"has",o)),t===o?n.has(t):n.has(t)||n.has(o)}function G(t,e=!1){return t=t["__v_raw"],!e&&S(_t(t),"iterate",b),Reflect.get(t,"size",t)}function q(t){t=_t(t);const e=_t(this),n=V(e),r=n.has.call(e,t);return r||(e.add(t),E(e,"add",t,t)),this}function K(t,e){e=_t(e);const n=_t(this),{has:i,get:o}=V(n);let s=i.call(n,t);s||(t=_t(t),s=i.call(n,t));const a=o.call(n,t);return n.set(t,e),s?(0,r.aU)(e,a)&&E(n,"set",t,e,a):E(n,"add",t,e),this}function X(t){const e=_t(this),{has:n,get:r}=V(e);let i=n.call(e,t);i||(t=_t(t),i=n.call(e,t));const o=r?r.call(e,t):void 0,s=e.delete(t);return i&&E(e,"delete",t,void 0,o),s}function Y(){const t=_t(this),e=0!==t.size,n=void 0,r=t.clear();return e&&E(t,"clear",void 0,void 0,n),r}function J(t,e){return function(n,r){const i=this,o=i["__v_raw"],s=_t(o),a=e?U:t?St:Ct;return!t&&S(s,"iterate",b),o.forEach(((t,e)=>n.call(r,a(t),a(e),i)))}}function Z(t,e,n){return function(...i){const o=this["__v_raw"],s=_t(o),a=(0,r._N)(s),l="entries"===t||t===Symbol.iterator&&a,u="keys"===t&&a,c=o[t](...i),h=n?U:e?St:Ct;return!e&&S(s,"iterate",u?v:b),{next(){const{value:t,done:e}=c.next();return e?{value:t,done:e}:{value:l?[h(t[0]),h(t[1])]:h(t),done:e}},[Symbol.iterator](){return this}}}}function Q(t){return function(...e){return"delete"!==t&&("clear"===t?void 0:this)}}function tt(){const t={get(t){return j(this,t)},get size(){return G(this)},has:H,add:q,set:K,delete:X,clear:Y,forEach:J(!1,!1)},e={get(t){return j(this,t,!1,!0)},get size(){return G(this)},has:H,add:q,set:K,delete:X,clear:Y,forEach:J(!1,!0)},n={get(t){return j(this,t,!0)},get size(){return G(this,!0)},has(t){return H.call(this,t,!0)},add:Q("add"),set:Q("set"),delete:Q("delete"),clear:Q("clear"),forEach:J(!0,!1)},r={get(t){return j(this,t,!0,!0)},get size(){return G(this,!0)},has(t){return H.call(this,t,!0)},add:Q("add"),set:Q("set"),delete:Q("delete"),clear:Q("clear"),forEach:J(!0,!0)},i=["keys","values","entries",Symbol.iterator];return i.forEach((i=>{t[i]=Z(i,!1,!1),n[i]=Z(i,!0,!1),e[i]=Z(i,!1,!0),r[i]=Z(i,!0,!0)})),[t,n,e,r]}const[et,nt,rt,it]=tt();function ot(t,e){const n=e?t?it:rt:t?nt:et;return(e,i,o)=>"__v_isReactive"===i?!t:"__v_isReadonly"===i?t:"__v_raw"===i?e:Reflect.get((0,r.RI)(n,i)&&i in e?n:e,i,o)}const st={get:ot(!1,!1)},at={get:ot(!1,!0)},lt={get:ot(!0,!1)};const ut=new WeakMap,ct=new WeakMap,ht=new WeakMap,dt=new WeakMap;function pt(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function ft(t){return t["__v_skip"]||!Object.isExtensible(t)?0:pt((0,r.W7)(t))}function gt(t){return wt(t)?t:bt(t,!1,z,st,ut)}function mt(t){return bt(t,!1,W,at,ct)}function yt(t){return bt(t,!0,B,lt,ht)}function bt(t,e,n,i,o){if(!(0,r.Kn)(t))return t;if(t["__v_raw"]&&(!e||!t["__v_isReactive"]))return t;const s=o.get(t);if(s)return s;const a=ft(t);if(0===a)return t;const l=new Proxy(t,2===a?i:n);return o.set(t,l),l}function vt(t){return wt(t)?vt(t["__v_raw"]):!(!t||!t["__v_isReactive"])}function wt(t){return!(!t||!t["__v_isReadonly"])}function xt(t){return!(!t||!t["__v_isShallow"])}function kt(t){return vt(t)||wt(t)}function _t(t){const e=t&&t["__v_raw"];return e?_t(e):t}function It(t){return(0,r.Nj)(t,"__v_skip",!0),t}const Ct=t=>(0,r.Kn)(t)?gt(t):t,St=t=>(0,r.Kn)(t)?yt(t):t;function Tt(t){k&&y&&(t=_t(t),T(t.dep||(t.dep=l())))}function Et(t,e){t=_t(t);const n=t.dep;n&&N(n)}function Nt(t){return!(!t||!0!==t.__v_isRef)}function At(t){return $t(t,!1)}function Rt(t){return $t(t,!0)}function $t(t,e){return Nt(t)?t:new Dt(t,e)}class Dt{constructor(t,e){this.__v_isShallow=e,this.dep=void 0,this.__v_isRef=!0,this._rawValue=e?t:_t(t),this._value=e?t:Ct(t)}get value(){return Tt(this),this._value}set value(t){const e=this.__v_isShallow||xt(t)||wt(t);t=e?t:_t(t),(0,r.aU)(t,this._rawValue)&&(this._rawValue=t,this._value=e?t:Ct(t),Et(this,t))}}function Ot(t){return Nt(t)?t.value:t}const Ft={get:(t,e,n)=>Ot(Reflect.get(t,e,n)),set:(t,e,n,r)=>{const i=t[e];return Nt(i)&&!Nt(n)?(i.value=n,!0):Reflect.set(t,e,n,r)}};function Mt(t){return vt(t)?t:new Proxy(t,Ft)}class Pt{constructor(t,e,n,r){this._setter=e,this.dep=void 0,this.__v_isRef=!0,this["__v_isReadonly"]=!1,this._dirty=!0,this.effect=new w(t,(()=>{this._dirty||(this._dirty=!0,Et(this))})),this.effect.computed=this,this.effect.active=this._cacheable=!r,this["__v_isReadonly"]=n}get value(){const t=_t(this);return Tt(t),!t._dirty&&t._cacheable||(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}function Lt(t,e,n=!1){let i,o;const s=(0,r.mf)(t);s?(i=t,o=r.dG):(i=t.get,o=t.set);const a=new Pt(i,o,s||!o,n);return a}},3396:function(t,e,n){"use strict";n.d(e,{$d:function(){return s},FN:function(){return vn},Fl:function(){return Ln},HY:function(){return Pe},JJ:function(){return ue},Ko:function(){return Lt},P$:function(){return ut},Q6:function(){return gt},U2:function(){return ht},Uk:function(){return an},Us:function(){return Ae},Wm:function(){return nn},Y3:function(){return b},Y8:function(){return ot},YP:function(){return Y},_:function(){return en},aZ:function(){return mt},f3:function(){return ce},h:function(){return zn},iD:function(){return Ke},ic:function(){return Rt},j4:function(){return Xe},kq:function(){return un},nJ:function(){return at},nK:function(){return ft},uE:function(){return ln},up:function(){return V},w5:function(){return F},wg:function(){return Ve},wy:function(){return et}});n(560);var r=n(4870),i=n(7139);function o(t,e,n,r){let i;try{i=r?t(...r):t()}catch(o){a(o,e,n)}return i}function s(t,e,n,r){if((0,i.mf)(t)){const s=o(t,e,n,r);return s&&(0,i.tI)(s)&&s.catch((t=>{a(t,e,n)})),s}const l=[];for(let i=0;i<t.length;i++)l.push(s(t[i],e,n,r));return l}function a(t,e,n,r=!0){const i=e?e.vnode:null;if(e){let r=e.parent;const i=e.proxy,s=n;while(r){const e=r.ec;if(e)for(let n=0;n<e.length;n++)if(!1===e[n](t,i,s))return;r=r.parent}const a=e.appContext.config.errorHandler;if(a)return void o(a,null,10,[t,i,s])}l(t,n,i,r)}function l(t,e,n,r=!0){console.error(t)}let u=!1,c=!1;const h=[];let d=0;const p=[];let f=null,g=0;const m=Promise.resolve();let y=null;function b(t){const e=y||m;return t?e.then(this?t.bind(this):t):e}function v(t){let e=d+1,n=h.length;while(e<n){const r=e+n>>>1,i=h[r],o=S(i);o<t||o===t&&i.pre?e=r+1:n=r}return e}function w(t){h.length&&h.includes(t,u&&t.allowRecurse?d+1:d)||(null==t.id?h.push(t):h.splice(v(t.id),0,t),x())}function x(){u||c||(c=!0,y=m.then(E))}function k(t){const e=h.indexOf(t);e>d&&h.splice(e,1)}function _(t){(0,i.kJ)(t)?p.push(...t):f&&f.includes(t,t.allowRecurse?g+1:g)||p.push(t),x()}function I(t,e,n=(u?d+1:0)){for(0;n<h.length;n++){const e=h[n];if(e&&e.pre){if(t&&e.id!==t.uid)continue;0,h.splice(n,1),n--,e()}}}function C(t){if(p.length){const t=[...new Set(p)];if(p.length=0,f)return void f.push(...t);for(f=t,f.sort(((t,e)=>S(t)-S(e))),g=0;g<f.length;g++)f[g]();f=null,g=0}}const S=t=>null==t.id?1/0:t.id,T=(t,e)=>{const n=S(t)-S(e);if(0===n){if(t.pre&&!e.pre)return-1;if(e.pre&&!t.pre)return 1}return n};function E(t){c=!1,u=!0,h.sort(T);i.dG;try{for(d=0;d<h.length;d++){const t=h[d];t&&!1!==t.active&&o(t,null,14)}}finally{d=0,h.length=0,C(t),u=!1,y=null,(h.length||p.length)&&E(t)}}function N(t,e,...n){if(t.isUnmounted)return;const r=t.vnode.props||i.kT;let o=n;const a=e.startsWith("update:"),l=a&&e.slice(7);if(l&&l in r){const t=`${"modelValue"===l?"model":l}Modifiers`,{number:e,trim:s}=r[t]||i.kT;s&&(o=n.map((t=>(0,i.HD)(t)?t.trim():t))),e&&(o=n.map(i.h5))}let u;let c=r[u=(0,i.hR)(e)]||r[u=(0,i.hR)((0,i._A)(e))];!c&&a&&(c=r[u=(0,i.hR)((0,i.rs)(e))]),c&&s(c,t,6,o);const h=r[u+"Once"];if(h){if(t.emitted){if(t.emitted[u])return}else t.emitted={};t.emitted[u]=!0,s(h,t,6,o)}}function A(t,e,n=!1){const r=e.emitsCache,o=r.get(t);if(void 0!==o)return o;const s=t.emits;let a={},l=!1;if(!(0,i.mf)(t)){const r=t=>{const n=A(t,e,!0);n&&(l=!0,(0,i.l7)(a,n))};!n&&e.mixins.length&&e.mixins.forEach(r),t.extends&&r(t.extends),t.mixins&&t.mixins.forEach(r)}return s||l?((0,i.kJ)(s)?s.forEach((t=>a[t]=null)):(0,i.l7)(a,s),(0,i.Kn)(t)&&r.set(t,a),a):((0,i.Kn)(t)&&r.set(t,null),null)}function R(t,e){return!(!t||!(0,i.F7)(e))&&(e=e.slice(2).replace(/Once$/,""),(0,i.RI)(t,e[0].toLowerCase()+e.slice(1))||(0,i.RI)(t,(0,i.rs)(e))||(0,i.RI)(t,e))}let $=null,D=null;function O(t){const e=$;return $=t,D=t&&t.type.__scopeId||null,e}function F(t,e=$,n){if(!e)return t;if(t._n)return t;const r=(...n)=>{r._d&&Ge(-1);const i=O(e);let o;try{o=t(...n)}finally{O(i),r._d&&Ge(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function M(t){const{type:e,vnode:n,proxy:r,withProxy:o,props:s,propsOptions:[l],slots:u,attrs:c,emit:h,render:d,renderCache:p,data:f,setupState:g,ctx:m,inheritAttrs:y}=t;let b,v;const w=O(t);try{if(4&n.shapeFlag){const t=o||r,e=t;b=cn(d.call(e,t,p,s,g,f,m)),v=c}else{const t=e;0,b=cn(t.length>1?t(s,{attrs:c,slots:u,emit:h}):t(s,null)),v=e.props?c:P(c)}}catch(k){We.length=0,a(k,t,1),b=nn(ze)}let x=b;if(v&&!1!==y){const t=Object.keys(v),{shapeFlag:e}=x;t.length&&7&e&&(l&&t.some(i.tR)&&(v=L(v,l)),x=sn(x,v))}return n.dirs&&(x=sn(x),x.dirs=x.dirs?x.dirs.concat(n.dirs):n.dirs),n.transition&&(x.transition=n.transition),b=x,O(w),b}const P=t=>{let e;for(const n in t)("class"===n||"style"===n||(0,i.F7)(n))&&((e||(e={}))[n]=t[n]);return e},L=(t,e)=>{const n={};for(const r in t)(0,i.tR)(r)&&r.slice(9)in e||(n[r]=t[r]);return n};function z(t,e,n){const{props:r,children:i,component:o}=t,{props:s,children:a,patchFlag:l}=e,u=o.emitsOptions;if(e.dirs||e.transition)return!0;if(!(n&&l>=0))return!(!i&&!a||a&&a.$stable)||r!==s&&(r?!s||B(r,s,u):!!s);if(1024&l)return!0;if(16&l)return r?B(r,s,u):!!s;if(8&l){const t=e.dynamicProps;for(let e=0;e<t.length;e++){const n=t[e];if(s[n]!==r[n]&&!R(u,n))return!0}}return!1}function B(t,e,n){const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!0;for(let i=0;i<r.length;i++){const o=r[i];if(e[o]!==t[o]&&!R(n,o))return!0}return!1}function W({vnode:t,parent:e},n){while(e&&e.subTree===t)(t=e.vnode).el=n,e=e.parent}const U="components";function V(t,e){return H(U,t,!0,e)||t}const j=Symbol.for("v-ndc");function H(t,e,n=!0,r=!1){const o=$||bn;if(o){const n=o.type;if(t===U){const t=Mn(n,!1);if(t&&(t===e||t===(0,i._A)(e)||t===(0,i.kC)((0,i._A)(e))))return n}const s=G(o[t]||n[t],e)||G(o.appContext[t],e);return!s&&r?n:s}}function G(t,e){return t&&(t[e]||t[(0,i._A)(e)]||t[(0,i.kC)((0,i._A)(e))])}const q=t=>t.__isSuspense;function K(t,e){e&&e.pendingBranch?(0,i.kJ)(t)?e.effects.push(...t):e.effects.push(t):_(t)}const X={};function Y(t,e,n){return J(t,e,n)}function J(t,e,{immediate:n,deep:a,flush:l,onTrack:u,onTrigger:c}=i.kT){var h;const d=(0,r.nZ)()===(null==(h=bn)?void 0:h.scope)?bn:null;let p,f,g=!1,m=!1;if((0,r.dq)(t)?(p=()=>t.value,g=(0,r.yT)(t)):(0,r.PG)(t)?(p=()=>t,a=!0):(0,i.kJ)(t)?(m=!0,g=t.some((t=>(0,r.PG)(t)||(0,r.yT)(t))),p=()=>t.map((t=>(0,r.dq)(t)?t.value:(0,r.PG)(t)?tt(t):(0,i.mf)(t)?o(t,d,2):void 0))):p=(0,i.mf)(t)?e?()=>o(t,d,2):()=>{if(!d||!d.isUnmounted)return f&&f(),s(t,d,3,[b])}:i.dG,e&&a){const t=p;p=()=>tt(t())}let y,b=t=>{f=_.onStop=()=>{o(t,d,4),f=_.onStop=void 0}};if(En){if(b=i.dG,e?n&&s(e,d,3,[p(),m?[]:void 0,b]):p(),"sync"!==l)return i.dG;{const t=Wn();y=t.__watcherHandles||(t.__watcherHandles=[])}}let v=m?new Array(t.length).fill(X):X;const x=()=>{if(_.active)if(e){const t=_.run();(a||g||(m?t.some(((t,e)=>(0,i.aU)(t,v[e]))):(0,i.aU)(t,v)))&&(f&&f(),s(e,d,3,[t,v===X?void 0:m&&v[0]===X?[]:v,b]),v=t)}else _.run()};let k;x.allowRecurse=!!e,"sync"===l?k=x:"post"===l?k=()=>Ne(x,d&&d.suspense):(x.pre=!0,d&&(x.id=d.uid),k=()=>w(x));const _=new r.qq(p,k);e?n?x():v=_.run():"post"===l?Ne(_.run.bind(_),d&&d.suspense):_.run();const I=()=>{_.stop(),d&&d.scope&&(0,i.Od)(d.scope.effects,_)};return y&&y.push(I),I}function Z(t,e,n){const r=this.proxy,o=(0,i.HD)(t)?t.includes(".")?Q(r,t):()=>r[t]:t.bind(r,r);let s;(0,i.mf)(e)?s=e:(s=e.handler,n=e);const a=bn;_n(this);const l=J(o,s.bind(r),n);return a?_n(a):In(),l}function Q(t,e){const n=e.split(".");return()=>{let e=t;for(let t=0;t<n.length&&e;t++)e=e[n[t]];return e}}function tt(t,e){if(!(0,i.Kn)(t)||t["__v_skip"])return t;if(e=e||new Set,e.has(t))return t;if(e.add(t),(0,r.dq)(t))tt(t.value,e);else if((0,i.kJ)(t))for(let n=0;n<t.length;n++)tt(t[n],e);else if((0,i.DM)(t)||(0,i._N)(t))t.forEach((t=>{tt(t,e)}));else if((0,i.PO)(t))for(const n in t)tt(t[n],e);return t}function et(t,e){const n=$;if(null===n)return t;const r=Fn(n)||n.proxy,o=t.dirs||(t.dirs=[]);for(let s=0;s<e.length;s++){let[t,n,a,l=i.kT]=e[s];t&&((0,i.mf)(t)&&(t={mounted:t,updated:t}),t.deep&&tt(n),o.push({dir:t,instance:r,value:n,oldValue:void 0,arg:a,modifiers:l}))}return t}function nt(t,e,n,i){const o=t.dirs,a=e&&e.dirs;for(let l=0;l<o.length;l++){const u=o[l];a&&(u.oldValue=a[l].value);let c=u.dir[i];c&&((0,r.Jd)(),s(c,n,8,[t.el,u,t,e]),(0,r.lk)())}}const rt=Symbol("_leaveCb"),it=Symbol("_enterCb");function ot(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Nt((()=>{t.isMounted=!0})),$t((()=>{t.isUnmounting=!0})),t}const st=[Function,Array],at={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:st,onEnter:st,onAfterEnter:st,onEnterCancelled:st,onBeforeLeave:st,onLeave:st,onAfterLeave:st,onLeaveCancelled:st,onBeforeAppear:st,onAppear:st,onAfterAppear:st,onAppearCancelled:st},lt={name:"BaseTransition",props:at,setup(t,{slots:e}){const n=vn(),i=ot();let o;return()=>{const s=e.default&&gt(e.default(),!0);if(!s||!s.length)return;let a=s[0];if(s.length>1){let t=!1;for(const e of s)if(e.type!==ze){0,a=e,t=!0;break}}const l=(0,r.IU)(t),{mode:u}=l;if(i.isLeaving)return dt(a);const c=pt(a);if(!c)return dt(a);const h=ht(c,l,i,n);ft(c,h);const d=n.subTree,p=d&&pt(d);let f=!1;const{getTransitionKey:g}=c.type;if(g){const t=g();void 0===o?o=t:t!==o&&(o=t,f=!0)}if(p&&p.type!==ze&&(!Je(c,p)||f)){const t=ht(p,l,i,n);if(ft(p,t),"out-in"===u)return i.isLeaving=!0,t.afterLeave=()=>{i.isLeaving=!1,!1!==n.update.active&&n.update()},dt(a);"in-out"===u&&c.type!==ze&&(t.delayLeave=(t,e,n)=>{const r=ct(i,p);r[String(p.key)]=p,t[rt]=()=>{e(),t[rt]=void 0,delete h.delayedLeave},h.delayedLeave=n})}return a}}},ut=lt;function ct(t,e){const{leavingVNodes:n}=t;let r=n.get(e.type);return r||(r=Object.create(null),n.set(e.type,r)),r}function ht(t,e,n,r){const{appear:o,mode:a,persisted:l=!1,onBeforeEnter:u,onEnter:c,onAfterEnter:h,onEnterCancelled:d,onBeforeLeave:p,onLeave:f,onAfterLeave:g,onLeaveCancelled:m,onBeforeAppear:y,onAppear:b,onAfterAppear:v,onAppearCancelled:w}=e,x=String(t.key),k=ct(n,t),_=(t,e)=>{t&&s(t,r,9,e)},I=(t,e)=>{const n=e[1];_(t,e),(0,i.kJ)(t)?t.every((t=>t.length<=1))&&n():t.length<=1&&n()},C={mode:a,persisted:l,beforeEnter(e){let r=u;if(!n.isMounted){if(!o)return;r=y||u}e[rt]&&e[rt](!0);const i=k[x];i&&Je(t,i)&&i.el[rt]&&i.el[rt](),_(r,[e])},enter(t){let e=c,r=h,i=d;if(!n.isMounted){if(!o)return;e=b||c,r=v||h,i=w||d}let s=!1;const a=t[it]=e=>{s||(s=!0,_(e?i:r,[t]),C.delayedLeave&&C.delayedLeave(),t[it]=void 0)};e?I(e,[t,a]):a()},leave(e,r){const i=String(t.key);if(e[it]&&e[it](!0),n.isUnmounting)return r();_(p,[e]);let o=!1;const s=e[rt]=n=>{o||(o=!0,r(),_(n?m:g,[e]),e[rt]=void 0,k[i]===t&&delete k[i])};k[i]=t,f?I(f,[e,s]):s()},clone(t){return ht(t,e,n,r)}};return C}function dt(t){if(bt(t))return t=sn(t),t.children=null,t}function pt(t){return bt(t)?t.children?t.children[0]:void 0:t}function ft(t,e){6&t.shapeFlag&&t.component?ft(t.component.subTree,e):128&t.shapeFlag?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function gt(t,e=!1,n){let r=[],i=0;for(let o=0;o<t.length;o++){let s=t[o];const a=null==n?s.key:String(n)+String(null!=s.key?s.key:o);s.type===Pe?(128&s.patchFlag&&i++,r=r.concat(gt(s.children,e,a))):(e||s.type!==ze)&&r.push(null!=a?sn(s,{key:a}):s)}if(i>1)for(let o=0;o<r.length;o++)r[o].patchFlag=-2;return r}
/*! #__NO_SIDE_EFFECTS__ */function mt(t,e){return(0,i.mf)(t)?(()=>(0,i.l7)({name:t.name},e,{setup:t}))():t}const yt=t=>!!t.type.__asyncLoader
/*! #__NO_SIDE_EFFECTS__ */;const bt=t=>t.type.__isKeepAlive;RegExp,RegExp;function vt(t,e){return(0,i.kJ)(t)?t.some((t=>vt(t,e))):(0,i.HD)(t)?t.split(",").includes(e):!!(0,i.Kj)(t)&&t.test(e)}function wt(t,e){kt(t,"a",e)}function xt(t,e){kt(t,"da",e)}function kt(t,e,n=bn){const r=t.__wdc||(t.__wdc=()=>{let e=n;while(e){if(e.isDeactivated)return;e=e.parent}return t()});if(St(e,r,n),n){let t=n.parent;while(t&&t.parent)bt(t.parent.vnode)&&_t(r,e,n,t),t=t.parent}}function _t(t,e,n,r){const o=St(e,t,r,!0);Dt((()=>{(0,i.Od)(r[e],o)}),n)}function It(t){t.shapeFlag&=-257,t.shapeFlag&=-513}function Ct(t){return 128&t.shapeFlag?t.ssContent:t}function St(t,e,n=bn,i=!1){if(n){const o=n[t]||(n[t]=[]),a=e.__weh||(e.__weh=(...i)=>{if(n.isUnmounted)return;(0,r.Jd)(),_n(n);const o=s(e,n,t,i);return In(),(0,r.lk)(),o});return i?o.unshift(a):o.push(a),a}}const Tt=t=>(e,n=bn)=>(!En||"sp"===t)&&St(t,((...t)=>e(...t)),n),Et=Tt("bm"),Nt=Tt("m"),At=Tt("bu"),Rt=Tt("u"),$t=Tt("bum"),Dt=Tt("um"),Ot=Tt("sp"),Ft=Tt("rtg"),Mt=Tt("rtc");function Pt(t,e=bn){St("ec",t,e)}function Lt(t,e,n,r){let o;const s=n&&n[r];if((0,i.kJ)(t)||(0,i.HD)(t)){o=new Array(t.length);for(let n=0,r=t.length;n<r;n++)o[n]=e(t[n],n,void 0,s&&s[n])}else if("number"===typeof t){0,o=new Array(t);for(let n=0;n<t;n++)o[n]=e(n+1,n,void 0,s&&s[n])}else if((0,i.Kn)(t))if(t[Symbol.iterator])o=Array.from(t,((t,n)=>e(t,n,void 0,s&&s[n])));else{const n=Object.keys(t);o=new Array(n.length);for(let r=0,i=n.length;r<i;r++){const i=n[r];o[r]=e(t[i],i,r,s&&s[r])}}else o=[];return n&&(n[r]=o),o}const zt=t=>t?Cn(t)?Fn(t)||t.proxy:zt(t.parent):null,Bt=(0,i.l7)(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>zt(t.parent),$root:t=>zt(t.root),$emit:t=>t.emit,$options:t=>Xt(t),$forceUpdate:t=>t.f||(t.f=()=>w(t.update)),$nextTick:t=>t.n||(t.n=b.bind(t.proxy)),$watch:t=>Z.bind(t)}),Wt=(t,e)=>t!==i.kT&&!t.__isScriptSetup&&(0,i.RI)(t,e),Ut={get({_:t},e){const{ctx:n,setupState:o,data:s,props:a,accessCache:l,type:u,appContext:c}=t;let h;if("$"!==e[0]){const r=l[e];if(void 0!==r)switch(r){case 1:return o[e];case 2:return s[e];case 4:return n[e];case 3:return a[e]}else{if(Wt(o,e))return l[e]=1,o[e];if(s!==i.kT&&(0,i.RI)(s,e))return l[e]=2,s[e];if((h=t.propsOptions[0])&&(0,i.RI)(h,e))return l[e]=3,a[e];if(n!==i.kT&&(0,i.RI)(n,e))return l[e]=4,n[e];jt&&(l[e]=0)}}const d=Bt[e];let p,f;return d?("$attrs"===e&&(0,r.j)(t,"get",e),d(t)):(p=u.__cssModules)&&(p=p[e])?p:n!==i.kT&&(0,i.RI)(n,e)?(l[e]=4,n[e]):(f=c.config.globalProperties,(0,i.RI)(f,e)?f[e]:void 0)},set({_:t},e,n){const{data:r,setupState:o,ctx:s}=t;return Wt(o,e)?(o[e]=n,!0):r!==i.kT&&(0,i.RI)(r,e)?(r[e]=n,!0):!(0,i.RI)(t.props,e)&&(("$"!==e[0]||!(e.slice(1)in t))&&(s[e]=n,!0))},has({_:{data:t,setupState:e,accessCache:n,ctx:r,appContext:o,propsOptions:s}},a){let l;return!!n[a]||t!==i.kT&&(0,i.RI)(t,a)||Wt(e,a)||(l=s[0])&&(0,i.RI)(l,a)||(0,i.RI)(r,a)||(0,i.RI)(Bt,a)||(0,i.RI)(o.config.globalProperties,a)},defineProperty(t,e,n){return null!=n.get?t._.accessCache[e]=0:(0,i.RI)(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function Vt(t){return(0,i.kJ)(t)?t.reduce(((t,e)=>(t[e]=null,t)),{}):t}let jt=!0;function Ht(t){const e=Xt(t),n=t.proxy,o=t.ctx;jt=!1,e.beforeCreate&&qt(e.beforeCreate,t,"bc");const{data:s,computed:a,methods:l,watch:u,provide:c,inject:h,created:d,beforeMount:p,mounted:f,beforeUpdate:g,updated:m,activated:y,deactivated:b,beforeDestroy:v,beforeUnmount:w,destroyed:x,unmounted:k,render:_,renderTracked:I,renderTriggered:C,errorCaptured:S,serverPrefetch:T,expose:E,inheritAttrs:N,components:A,directives:R,filters:$}=e,D=null;if(h&&Gt(h,o,D),l)for(const r in l){const t=l[r];(0,i.mf)(t)&&(o[r]=t.bind(n))}if(s){0;const e=s.call(n,n);0,(0,i.Kn)(e)&&(t.data=(0,r.qj)(e))}if(jt=!0,a)for(const r in a){const t=a[r],e=(0,i.mf)(t)?t.bind(n,n):(0,i.mf)(t.get)?t.get.bind(n,n):i.dG;0;const s=!(0,i.mf)(t)&&(0,i.mf)(t.set)?t.set.bind(n):i.dG,l=Ln({get:e,set:s});Object.defineProperty(o,r,{enumerable:!0,configurable:!0,get:()=>l.value,set:t=>l.value=t})}if(u)for(const r in u)Kt(u[r],o,n,r);if(c){const t=(0,i.mf)(c)?c.call(n):c;Reflect.ownKeys(t).forEach((e=>{ue(e,t[e])}))}function O(t,e){(0,i.kJ)(e)?e.forEach((e=>t(e.bind(n)))):e&&t(e.bind(n))}if(d&&qt(d,t,"c"),O(Et,p),O(Nt,f),O(At,g),O(Rt,m),O(wt,y),O(xt,b),O(Pt,S),O(Mt,I),O(Ft,C),O($t,w),O(Dt,k),O(Ot,T),(0,i.kJ)(E))if(E.length){const e=t.exposed||(t.exposed={});E.forEach((t=>{Object.defineProperty(e,t,{get:()=>n[t],set:e=>n[t]=e})}))}else t.exposed||(t.exposed={});_&&t.render===i.dG&&(t.render=_),null!=N&&(t.inheritAttrs=N),A&&(t.components=A),R&&(t.directives=R)}function Gt(t,e,n=i.dG){(0,i.kJ)(t)&&(t=te(t));for(const o in t){const n=t[o];let s;s=(0,i.Kn)(n)?"default"in n?ce(n.from||o,n.default,!0):ce(n.from||o):ce(n),(0,r.dq)(s)?Object.defineProperty(e,o,{enumerable:!0,configurable:!0,get:()=>s.value,set:t=>s.value=t}):e[o]=s}}function qt(t,e,n){s((0,i.kJ)(t)?t.map((t=>t.bind(e.proxy))):t.bind(e.proxy),e,n)}function Kt(t,e,n,r){const o=r.includes(".")?Q(n,r):()=>n[r];if((0,i.HD)(t)){const n=e[t];(0,i.mf)(n)&&Y(o,n)}else if((0,i.mf)(t))Y(o,t.bind(n));else if((0,i.Kn)(t))if((0,i.kJ)(t))t.forEach((t=>Kt(t,e,n,r)));else{const r=(0,i.mf)(t.handler)?t.handler.bind(n):e[t.handler];(0,i.mf)(r)&&Y(o,r,t)}else 0}function Xt(t){const e=t.type,{mixins:n,extends:r}=e,{mixins:o,optionsCache:s,config:{optionMergeStrategies:a}}=t.appContext,l=s.get(e);let u;return l?u=l:o.length||n||r?(u={},o.length&&o.forEach((t=>Yt(u,t,a,!0))),Yt(u,e,a)):u=e,(0,i.Kn)(e)&&s.set(e,u),u}function Yt(t,e,n,r=!1){const{mixins:i,extends:o}=e;o&&Yt(t,o,n,!0),i&&i.forEach((e=>Yt(t,e,n,!0)));for(const s in e)if(r&&"expose"===s);else{const r=Jt[s]||n&&n[s];t[s]=r?r(t[s],e[s]):e[s]}return t}const Jt={data:Zt,props:re,emits:re,methods:ne,computed:ne,beforeCreate:ee,created:ee,beforeMount:ee,mounted:ee,beforeUpdate:ee,updated:ee,beforeDestroy:ee,beforeUnmount:ee,destroyed:ee,unmounted:ee,activated:ee,deactivated:ee,errorCaptured:ee,serverPrefetch:ee,components:ne,directives:ne,watch:ie,provide:Zt,inject:Qt};function Zt(t,e){return e?t?function(){return(0,i.l7)((0,i.mf)(t)?t.call(this,this):t,(0,i.mf)(e)?e.call(this,this):e)}:e:t}function Qt(t,e){return ne(te(t),te(e))}function te(t){if((0,i.kJ)(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function ee(t,e){return t?[...new Set([].concat(t,e))]:e}function ne(t,e){return t?(0,i.l7)(Object.create(null),t,e):e}function re(t,e){return t?(0,i.kJ)(t)&&(0,i.kJ)(e)?[...new Set([...t,...e])]:(0,i.l7)(Object.create(null),Vt(t),Vt(null!=e?e:{})):e}function ie(t,e){if(!t)return e;if(!e)return t;const n=(0,i.l7)(Object.create(null),t);for(const r in e)n[r]=ee(t[r],e[r]);return n}function oe(){return{app:null,config:{isNativeTag:i.NO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let se=0;function ae(t,e){return function(n,r=null){(0,i.mf)(n)||(n=(0,i.l7)({},n)),null==r||(0,i.Kn)(r)||(r=null);const o=oe();const s=new WeakSet;let a=!1;const l=o.app={_uid:se++,_component:n,_props:r,_container:null,_context:o,_instance:null,version:Un,get config(){return o.config},set config(t){0},use(t,...e){return s.has(t)||(t&&(0,i.mf)(t.install)?(s.add(t),t.install(l,...e)):(0,i.mf)(t)&&(s.add(t),t(l,...e))),l},mixin(t){return o.mixins.includes(t)||o.mixins.push(t),l},component(t,e){return e?(o.components[t]=e,l):o.components[t]},directive(t,e){return e?(o.directives[t]=e,l):o.directives[t]},mount(i,s,u){if(!a){0;const c=nn(n,r);return c.appContext=o,s&&e?e(c,i):t(c,i,u),a=!0,l._container=i,i.__vue_app__=l,Fn(c.component)||c.component.proxy}},unmount(){a&&(t(null,l._container),delete l._container.__vue_app__)},provide(t,e){return o.provides[t]=e,l},runWithContext(t){le=l;try{return t()}finally{le=null}}};return l}}let le=null;function ue(t,e){if(bn){let n=bn.provides;const r=bn.parent&&bn.parent.provides;r===n&&(n=bn.provides=Object.create(r)),n[t]=e}else 0}function ce(t,e,n=!1){const r=bn||$;if(r||le){const o=r?null==r.parent?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:le._context.provides;if(o&&t in o)return o[t];if(arguments.length>1)return n&&(0,i.mf)(e)?e.call(r&&r.proxy):e}else 0}function he(t,e,n,o=!1){const s={},a={};(0,i.Nj)(a,Ze,1),t.propsDefaults=Object.create(null),pe(t,e,s,a);for(const r in t.propsOptions[0])r in s||(s[r]=void 0);n?t.props=o?s:(0,r.Um)(s):t.type.props?t.props=s:t.props=a,t.attrs=a}function de(t,e,n,o){const{props:s,attrs:a,vnode:{patchFlag:l}}=t,u=(0,r.IU)(s),[c]=t.propsOptions;let h=!1;if(!(o||l>0)||16&l){let r;pe(t,e,s,a)&&(h=!0);for(const o in u)e&&((0,i.RI)(e,o)||(r=(0,i.rs)(o))!==o&&(0,i.RI)(e,r))||(c?!n||void 0===n[o]&&void 0===n[r]||(s[o]=fe(c,u,o,void 0,t,!0)):delete s[o]);if(a!==u)for(const t in a)e&&(0,i.RI)(e,t)||(delete a[t],h=!0)}else if(8&l){const n=t.vnode.dynamicProps;for(let r=0;r<n.length;r++){let o=n[r];if(R(t.emitsOptions,o))continue;const l=e[o];if(c)if((0,i.RI)(a,o))l!==a[o]&&(a[o]=l,h=!0);else{const e=(0,i._A)(o);s[e]=fe(c,u,e,l,t,!1)}else l!==a[o]&&(a[o]=l,h=!0)}}h&&(0,r.X$)(t,"set","$attrs")}function pe(t,e,n,o){const[s,a]=t.propsOptions;let l,u=!1;if(e)for(let r in e){if((0,i.Gg)(r))continue;const c=e[r];let h;s&&(0,i.RI)(s,h=(0,i._A)(r))?a&&a.includes(h)?(l||(l={}))[h]=c:n[h]=c:R(t.emitsOptions,r)||r in o&&c===o[r]||(o[r]=c,u=!0)}if(a){const e=(0,r.IU)(n),o=l||i.kT;for(let r=0;r<a.length;r++){const l=a[r];n[l]=fe(s,e,l,o[l],t,!(0,i.RI)(o,l))}}return u}function fe(t,e,n,r,o,s){const a=t[n];if(null!=a){const t=(0,i.RI)(a,"default");if(t&&void 0===r){const t=a.default;if(a.type!==Function&&!a.skipFactory&&(0,i.mf)(t)){const{propsDefaults:i}=o;n in i?r=i[n]:(_n(o),r=i[n]=t.call(null,e),In())}else r=t}a[0]&&(s&&!t?r=!1:!a[1]||""!==r&&r!==(0,i.rs)(n)||(r=!0))}return r}function ge(t,e,n=!1){const r=e.propsCache,o=r.get(t);if(o)return o;const s=t.props,a={},l=[];let u=!1;if(!(0,i.mf)(t)){const r=t=>{u=!0;const[n,r]=ge(t,e,!0);(0,i.l7)(a,n),r&&l.push(...r)};!n&&e.mixins.length&&e.mixins.forEach(r),t.extends&&r(t.extends),t.mixins&&t.mixins.forEach(r)}if(!s&&!u)return(0,i.Kn)(t)&&r.set(t,i.Z6),i.Z6;if((0,i.kJ)(s))for(let h=0;h<s.length;h++){0;const t=(0,i._A)(s[h]);me(t)&&(a[t]=i.kT)}else if(s){0;for(const t in s){const e=(0,i._A)(t);if(me(e)){const n=s[t],r=a[e]=(0,i.kJ)(n)||(0,i.mf)(n)?{type:n}:(0,i.l7)({},n);if(r){const t=ve(Boolean,r.type),n=ve(String,r.type);r[0]=t>-1,r[1]=n<0||t<n,(t>-1||(0,i.RI)(r,"default"))&&l.push(e)}}}}const c=[a,l];return(0,i.Kn)(t)&&r.set(t,c),c}function me(t){return"$"!==t[0]}function ye(t){const e=t&&t.toString().match(/^\s*(function|class) (\w+)/);return e?e[2]:null===t?"null":""}function be(t,e){return ye(t)===ye(e)}function ve(t,e){return(0,i.kJ)(e)?e.findIndex((e=>be(e,t))):(0,i.mf)(e)&&be(e,t)?0:-1}const we=t=>"_"===t[0]||"$stable"===t,xe=t=>(0,i.kJ)(t)?t.map(cn):[cn(t)],ke=(t,e,n)=>{if(e._n)return e;const r=F(((...t)=>xe(e(...t))),n);return r._c=!1,r},_e=(t,e,n)=>{const r=t._ctx;for(const o in t){if(we(o))continue;const n=t[o];if((0,i.mf)(n))e[o]=ke(o,n,r);else if(null!=n){0;const t=xe(n);e[o]=()=>t}}},Ie=(t,e)=>{const n=xe(e);t.slots.default=()=>n},Ce=(t,e)=>{if(32&t.vnode.shapeFlag){const n=e._;n?(t.slots=(0,r.IU)(e),(0,i.Nj)(e,"_",n)):_e(e,t.slots={})}else t.slots={},e&&Ie(t,e);(0,i.Nj)(t.slots,Ze,1)},Se=(t,e,n)=>{const{vnode:r,slots:o}=t;let s=!0,a=i.kT;if(32&r.shapeFlag){const t=e._;t?n&&1===t?s=!1:((0,i.l7)(o,e),n||1!==t||delete o._):(s=!e.$stable,_e(e,o)),a=e}else e&&(Ie(t,e),a={default:1});if(s)for(const i in o)we(i)||null!=a[i]||delete o[i]};function Te(t,e,n,s,a=!1){if((0,i.kJ)(t))return void t.forEach(((t,r)=>Te(t,e&&((0,i.kJ)(e)?e[r]:e),n,s,a)));if(yt(s)&&!a)return;const l=4&s.shapeFlag?Fn(s.component)||s.component.proxy:s.el,u=a?null:l,{i:c,r:h}=t;const d=e&&e.r,p=c.refs===i.kT?c.refs={}:c.refs,f=c.setupState;if(null!=d&&d!==h&&((0,i.HD)(d)?(p[d]=null,(0,i.RI)(f,d)&&(f[d]=null)):(0,r.dq)(d)&&(d.value=null)),(0,i.mf)(h))o(h,c,12,[u,p]);else{const e=(0,i.HD)(h),o=(0,r.dq)(h);if(e||o){const r=()=>{if(t.f){const n=e?(0,i.RI)(f,h)?f[h]:p[h]:h.value;a?(0,i.kJ)(n)&&(0,i.Od)(n,l):(0,i.kJ)(n)?n.includes(l)||n.push(l):e?(p[h]=[l],(0,i.RI)(f,h)&&(f[h]=p[h])):(h.value=[l],t.k&&(p[t.k]=h.value))}else e?(p[h]=u,(0,i.RI)(f,h)&&(f[h]=u)):o&&(h.value=u,t.k&&(p[t.k]=u))};u?(r.id=-1,Ne(r,n)):r()}else 0}}function Ee(){}const Ne=K;function Ae(t){return Re(t)}function Re(t,e){Ee();const n=(0,i.E9)();n.__VUE__=!0;const{insert:o,remove:s,patchProp:a,createElement:l,createText:u,createComment:c,setText:h,setElementText:d,parentNode:p,nextSibling:f,setScopeId:g=i.dG,insertStaticContent:m}=t,y=(t,e,n,r=null,i=null,o=null,s=!1,a=null,l=!!e.dynamicChildren)=>{if(t===e)return;t&&!Je(t,e)&&(r=Z(t),q(t,i,o,!0),t=null),-2===e.patchFlag&&(l=!1,e.dynamicChildren=null);const{type:u,ref:c,shapeFlag:h}=e;switch(u){case Le:b(t,e,n,r);break;case ze:v(t,e,n,r);break;case Be:null==t&&x(e,n,r,s);break;case Pe:O(t,e,n,r,i,o,s,a,l);break;default:1&h?T(t,e,n,r,i,o,s,a,l):6&h?F(t,e,n,r,i,o,s,a,l):(64&h||128&h)&&u.process(t,e,n,r,i,o,s,a,l,tt)}null!=c&&i&&Te(c,t&&t.ref,o,e||t,!e)},b=(t,e,n,r)=>{if(null==t)o(e.el=u(e.children),n,r);else{const n=e.el=t.el;e.children!==t.children&&h(n,e.children)}},v=(t,e,n,r)=>{null==t?o(e.el=c(e.children||""),n,r):e.el=t.el},x=(t,e,n,r)=>{[t.el,t.anchor]=m(t.children,e,n,r,t.el,t.anchor)},_=({el:t,anchor:e},n,r)=>{let i;while(t&&t!==e)i=f(t),o(t,n,r),t=i;o(e,n,r)},S=({el:t,anchor:e})=>{let n;while(t&&t!==e)n=f(t),s(t),t=n;s(e)},T=(t,e,n,r,i,o,s,a,l)=>{s=s||"svg"===e.type,null==t?E(e,n,r,i,o,s,a,l):R(t,e,i,o,s,a,l)},E=(t,e,n,r,s,u,c,h)=>{let p,f;const{type:g,props:m,shapeFlag:y,transition:b,dirs:v}=t;if(p=t.el=l(t.type,u,m&&m.is,m),8&y?d(p,t.children):16&y&&A(t.children,p,null,r,s,u&&"foreignObject"!==g,c,h),v&&nt(t,null,r,"created"),N(p,t,t.scopeId,c,r),m){for(const e in m)"value"===e||(0,i.Gg)(e)||a(p,e,null,m[e],u,t.children,r,s,J);"value"in m&&a(p,"value",null,m.value),(f=m.onVnodeBeforeMount)&&fn(f,r,t)}v&&nt(t,null,r,"beforeMount");const w=De(s,b);w&&b.beforeEnter(p),o(p,e,n),((f=m&&m.onVnodeMounted)||w||v)&&Ne((()=>{f&&fn(f,r,t),w&&b.enter(p),v&&nt(t,null,r,"mounted")}),s)},N=(t,e,n,r,i)=>{if(n&&g(t,n),r)for(let o=0;o<r.length;o++)g(t,r[o]);if(i){let n=i.subTree;if(e===n){const e=i.vnode;N(t,e,e.scopeId,e.slotScopeIds,i.parent)}}},A=(t,e,n,r,i,o,s,a,l=0)=>{for(let u=l;u<t.length;u++){const l=t[u]=a?hn(t[u]):cn(t[u]);y(null,l,e,n,r,i,o,s,a)}},R=(t,e,n,r,o,s,l)=>{const u=e.el=t.el;let{patchFlag:c,dynamicChildren:h,dirs:p}=e;c|=16&t.patchFlag;const f=t.props||i.kT,g=e.props||i.kT;let m;n&&$e(n,!1),(m=g.onVnodeBeforeUpdate)&&fn(m,n,e,t),p&&nt(e,t,n,"beforeUpdate"),n&&$e(n,!0);const y=o&&"foreignObject"!==e.type;if(h?$(t.dynamicChildren,h,u,n,r,y,s):l||V(t,e,u,null,n,r,y,s,!1),c>0){if(16&c)D(u,e,f,g,n,r,o);else if(2&c&&f.class!==g.class&&a(u,"class",null,g.class,o),4&c&&a(u,"style",f.style,g.style,o),8&c){const i=e.dynamicProps;for(let e=0;e<i.length;e++){const s=i[e],l=f[s],c=g[s];c===l&&"value"!==s||a(u,s,l,c,o,t.children,n,r,J)}}1&c&&t.children!==e.children&&d(u,e.children)}else l||null!=h||D(u,e,f,g,n,r,o);((m=g.onVnodeUpdated)||p)&&Ne((()=>{m&&fn(m,n,e,t),p&&nt(e,t,n,"updated")}),r)},$=(t,e,n,r,i,o,s)=>{for(let a=0;a<e.length;a++){const l=t[a],u=e[a],c=l.el&&(l.type===Pe||!Je(l,u)||70&l.shapeFlag)?p(l.el):n;y(l,u,c,null,r,i,o,s,!0)}},D=(t,e,n,r,o,s,l)=>{if(n!==r){if(n!==i.kT)for(const u in n)(0,i.Gg)(u)||u in r||a(t,u,n[u],null,l,e.children,o,s,J);for(const u in r){if((0,i.Gg)(u))continue;const c=r[u],h=n[u];c!==h&&"value"!==u&&a(t,u,h,c,l,e.children,o,s,J)}"value"in r&&a(t,"value",n.value,r.value)}},O=(t,e,n,r,i,s,a,l,c)=>{const h=e.el=t?t.el:u(""),d=e.anchor=t?t.anchor:u("");let{patchFlag:p,dynamicChildren:f,slotScopeIds:g}=e;g&&(l=l?l.concat(g):g),null==t?(o(h,n,r),o(d,n,r),A(e.children,n,d,i,s,a,l,c)):p>0&&64&p&&f&&t.dynamicChildren?($(t.dynamicChildren,f,n,i,s,a,l),(null!=e.key||i&&e===i.subTree)&&Oe(t,e,!0)):V(t,e,n,d,i,s,a,l,c)},F=(t,e,n,r,i,o,s,a,l)=>{e.slotScopeIds=a,null==t?512&e.shapeFlag?i.ctx.activate(e,n,r,s,l):P(e,n,r,i,o,s,l):L(t,e,l)},P=(t,e,n,r,i,o,s)=>{const a=t.component=yn(t,r,i);if(bt(t)&&(a.ctx.renderer=tt),Nn(a),a.asyncDep){if(i&&i.registerDep(a,B),!t.el){const t=a.subTree=nn(ze);v(null,t,e,n)}}else B(a,t,e,n,i,o,s)},L=(t,e,n)=>{const r=e.component=t.component;if(z(t,e,n)){if(r.asyncDep&&!r.asyncResolved)return void U(r,e,n);r.next=e,k(r.update),r.update()}else e.el=t.el,r.vnode=e},B=(t,e,n,o,s,a,l)=>{const u=()=>{if(t.isMounted){let e,{next:n,bu:r,u:o,parent:u,vnode:c}=t,h=n;0,$e(t,!1),n?(n.el=c.el,U(t,n,l)):n=c,r&&(0,i.ir)(r),(e=n.props&&n.props.onVnodeBeforeUpdate)&&fn(e,u,n,c),$e(t,!0);const d=M(t);0;const f=t.subTree;t.subTree=d,y(f,d,p(f.el),Z(f),t,s,a),n.el=d.el,null===h&&W(t,d.el),o&&Ne(o,s),(e=n.props&&n.props.onVnodeUpdated)&&Ne((()=>fn(e,u,n,c)),s)}else{let r;const{el:l,props:u}=e,{bm:c,m:h,parent:d}=t,p=yt(e);if($e(t,!1),c&&(0,i.ir)(c),!p&&(r=u&&u.onVnodeBeforeMount)&&fn(r,d,e),$e(t,!0),l&&rt){const n=()=>{t.subTree=M(t),rt(l,t.subTree,t,s,null)};p?e.type.__asyncLoader().then((()=>!t.isUnmounted&&n())):n()}else{0;const r=t.subTree=M(t);0,y(null,r,n,o,t,s,a),e.el=r.el}if(h&&Ne(h,s),!p&&(r=u&&u.onVnodeMounted)){const t=e;Ne((()=>fn(r,d,t)),s)}(256&e.shapeFlag||d&&yt(d.vnode)&&256&d.vnode.shapeFlag)&&t.a&&Ne(t.a,s),t.isMounted=!0,e=n=o=null}},c=t.effect=new r.qq(u,(()=>w(h)),t.scope),h=t.update=()=>c.run();h.id=t.uid,$e(t,!0),h()},U=(t,e,n)=>{e.component=t;const i=t.vnode.props;t.vnode=e,t.next=null,de(t,e.props,i,n),Se(t,e.children,n),(0,r.Jd)(),I(t),(0,r.lk)()},V=(t,e,n,r,i,o,s,a,l=!1)=>{const u=t&&t.children,c=t?t.shapeFlag:0,h=e.children,{patchFlag:p,shapeFlag:f}=e;if(p>0){if(128&p)return void H(u,h,n,r,i,o,s,a,l);if(256&p)return void j(u,h,n,r,i,o,s,a,l)}8&f?(16&c&&J(u,i,o),h!==u&&d(n,h)):16&c?16&f?H(u,h,n,r,i,o,s,a,l):J(u,i,o,!0):(8&c&&d(n,""),16&f&&A(h,n,r,i,o,s,a,l))},j=(t,e,n,r,o,s,a,l,u)=>{t=t||i.Z6,e=e||i.Z6;const c=t.length,h=e.length,d=Math.min(c,h);let p;for(p=0;p<d;p++){const r=e[p]=u?hn(e[p]):cn(e[p]);y(t[p],r,n,null,o,s,a,l,u)}c>h?J(t,o,s,!0,!1,d):A(e,n,r,o,s,a,l,u,d)},H=(t,e,n,r,o,s,a,l,u)=>{let c=0;const h=e.length;let d=t.length-1,p=h-1;while(c<=d&&c<=p){const r=t[c],i=e[c]=u?hn(e[c]):cn(e[c]);if(!Je(r,i))break;y(r,i,n,null,o,s,a,l,u),c++}while(c<=d&&c<=p){const r=t[d],i=e[p]=u?hn(e[p]):cn(e[p]);if(!Je(r,i))break;y(r,i,n,null,o,s,a,l,u),d--,p--}if(c>d){if(c<=p){const t=p+1,i=t<h?e[t].el:r;while(c<=p)y(null,e[c]=u?hn(e[c]):cn(e[c]),n,i,o,s,a,l,u),c++}}else if(c>p)while(c<=d)q(t[c],o,s,!0),c++;else{const f=c,g=c,m=new Map;for(c=g;c<=p;c++){const t=e[c]=u?hn(e[c]):cn(e[c]);null!=t.key&&m.set(t.key,c)}let b,v=0;const w=p-g+1;let x=!1,k=0;const _=new Array(w);for(c=0;c<w;c++)_[c]=0;for(c=f;c<=d;c++){const r=t[c];if(v>=w){q(r,o,s,!0);continue}let i;if(null!=r.key)i=m.get(r.key);else for(b=g;b<=p;b++)if(0===_[b-g]&&Je(r,e[b])){i=b;break}void 0===i?q(r,o,s,!0):(_[i-g]=c+1,i>=k?k=i:x=!0,y(r,e[i],n,null,o,s,a,l,u),v++)}const I=x?Fe(_):i.Z6;for(b=I.length-1,c=w-1;c>=0;c--){const t=g+c,i=e[t],d=t+1<h?e[t+1].el:r;0===_[c]?y(null,i,n,d,o,s,a,l,u):x&&(b<0||c!==I[b]?G(i,n,d,2):b--)}}},G=(t,e,n,r,i=null)=>{const{el:s,type:a,transition:l,children:u,shapeFlag:c}=t;if(6&c)return void G(t.component.subTree,e,n,r);if(128&c)return void t.suspense.move(e,n,r);if(64&c)return void a.move(t,e,n,tt);if(a===Pe){o(s,e,n);for(let t=0;t<u.length;t++)G(u[t],e,n,r);return void o(t.anchor,e,n)}if(a===Be)return void _(t,e,n);const h=2!==r&&1&c&&l;if(h)if(0===r)l.beforeEnter(s),o(s,e,n),Ne((()=>l.enter(s)),i);else{const{leave:t,delayLeave:r,afterLeave:i}=l,a=()=>o(s,e,n),u=()=>{t(s,(()=>{a(),i&&i()}))};r?r(s,a,u):u()}else o(s,e,n)},q=(t,e,n,r=!1,i=!1)=>{const{type:o,props:s,ref:a,children:l,dynamicChildren:u,shapeFlag:c,patchFlag:h,dirs:d}=t;if(null!=a&&Te(a,null,n,t,!0),256&c)return void e.ctx.deactivate(t);const p=1&c&&d,f=!yt(t);let g;if(f&&(g=s&&s.onVnodeBeforeUnmount)&&fn(g,e,t),6&c)Y(t.component,n,r);else{if(128&c)return void t.suspense.unmount(n,r);p&&nt(t,null,e,"beforeUnmount"),64&c?t.type.remove(t,e,n,i,tt,r):u&&(o!==Pe||h>0&&64&h)?J(u,e,n,!1,!0):(o===Pe&&384&h||!i&&16&c)&&J(l,e,n),r&&K(t)}(f&&(g=s&&s.onVnodeUnmounted)||p)&&Ne((()=>{g&&fn(g,e,t),p&&nt(t,null,e,"unmounted")}),n)},K=t=>{const{type:e,el:n,anchor:r,transition:i}=t;if(e===Pe)return void X(n,r);if(e===Be)return void S(t);const o=()=>{s(n),i&&!i.persisted&&i.afterLeave&&i.afterLeave()};if(1&t.shapeFlag&&i&&!i.persisted){const{leave:e,delayLeave:r}=i,s=()=>e(n,o);r?r(t.el,o,s):s()}else o()},X=(t,e)=>{let n;while(t!==e)n=f(t),s(t),t=n;s(e)},Y=(t,e,n)=>{const{bum:r,scope:o,update:s,subTree:a,um:l}=t;r&&(0,i.ir)(r),o.stop(),s&&(s.active=!1,q(a,t,e,n)),l&&Ne(l,e),Ne((()=>{t.isUnmounted=!0}),e),e&&e.pendingBranch&&!e.isUnmounted&&t.asyncDep&&!t.asyncResolved&&t.suspenseId===e.pendingId&&(e.deps--,0===e.deps&&e.resolve())},J=(t,e,n,r=!1,i=!1,o=0)=>{for(let s=o;s<t.length;s++)q(t[s],e,n,r,i)},Z=t=>6&t.shapeFlag?Z(t.component.subTree):128&t.shapeFlag?t.suspense.next():f(t.anchor||t.el),Q=(t,e,n)=>{null==t?e._vnode&&q(e._vnode,null,null,!0):y(e._vnode||null,t,e,null,null,null,n),I(),C(),e._vnode=t},tt={p:y,um:q,m:G,r:K,mt:P,mc:A,pc:V,pbc:$,n:Z,o:t};let et,rt;return e&&([et,rt]=e(tt)),{render:Q,hydrate:et,createApp:ae(Q,et)}}function $e({effect:t,update:e},n){t.allowRecurse=e.allowRecurse=n}function De(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function Oe(t,e,n=!1){const r=t.children,o=e.children;if((0,i.kJ)(r)&&(0,i.kJ)(o))for(let i=0;i<r.length;i++){const t=r[i];let e=o[i];1&e.shapeFlag&&!e.dynamicChildren&&((e.patchFlag<=0||32===e.patchFlag)&&(e=o[i]=hn(o[i]),e.el=t.el),n||Oe(t,e)),e.type===Le&&(e.el=t.el)}}function Fe(t){const e=t.slice(),n=[0];let r,i,o,s,a;const l=t.length;for(r=0;r<l;r++){const l=t[r];if(0!==l){if(i=n[n.length-1],t[i]<l){e[r]=i,n.push(r);continue}o=0,s=n.length-1;while(o<s)a=o+s>>1,t[n[a]]<l?o=a+1:s=a;l<t[n[o]]&&(o>0&&(e[r]=n[o-1]),n[o]=r)}}o=n.length,s=n[o-1];while(o-- >0)n[o]=s,s=e[s];return n}const Me=t=>t.__isTeleport;const Pe=Symbol.for("v-fgt"),Le=Symbol.for("v-txt"),ze=Symbol.for("v-cmt"),Be=Symbol.for("v-stc"),We=[];let Ue=null;function Ve(t=!1){We.push(Ue=t?null:[])}function je(){We.pop(),Ue=We[We.length-1]||null}let He=1;function Ge(t){He+=t}function qe(t){return t.dynamicChildren=He>0?Ue||i.Z6:null,je(),He>0&&Ue&&Ue.push(t),t}function Ke(t,e,n,r,i,o){return qe(en(t,e,n,r,i,o,!0))}function Xe(t,e,n,r,i){return qe(nn(t,e,n,r,i,!0))}function Ye(t){return!!t&&!0===t.__v_isVNode}function Je(t,e){return t.type===e.type&&t.key===e.key}const Ze="__vInternal",Qe=({key:t})=>null!=t?t:null,tn=({ref:t,ref_key:e,ref_for:n})=>("number"===typeof t&&(t=""+t),null!=t?(0,i.HD)(t)||(0,r.dq)(t)||(0,i.mf)(t)?{i:$,r:t,k:e,f:!!n}:t:null);function en(t,e=null,n=null,r=0,o=null,s=(t===Pe?0:1),a=!1,l=!1){const u={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&Qe(e),ref:e&&tn(e),scopeId:D,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:r,dynamicProps:o,dynamicChildren:null,appContext:null,ctx:$};return l?(dn(u,n),128&s&&t.normalize(u)):n&&(u.shapeFlag|=(0,i.HD)(n)?8:16),He>0&&!a&&Ue&&(u.patchFlag>0||6&s)&&32!==u.patchFlag&&Ue.push(u),u}const nn=rn;function rn(t,e=null,n=null,o=0,s=null,a=!1){if(t&&t!==j||(t=ze),Ye(t)){const r=sn(t,e,!0);return n&&dn(r,n),He>0&&!a&&Ue&&(6&r.shapeFlag?Ue[Ue.indexOf(t)]=r:Ue.push(r)),r.patchFlag|=-2,r}if(Pn(t)&&(t=t.__vccOpts),e){e=on(e);let{class:t,style:n}=e;t&&!(0,i.HD)(t)&&(e.class=(0,i.C_)(t)),(0,i.Kn)(n)&&((0,r.X3)(n)&&!(0,i.kJ)(n)&&(n=(0,i.l7)({},n)),e.style=(0,i.j5)(n))}const l=(0,i.HD)(t)?1:q(t)?128:Me(t)?64:(0,i.Kn)(t)?4:(0,i.mf)(t)?2:0;return en(t,e,n,o,s,l,a,!0)}function on(t){return t?(0,r.X3)(t)||Ze in t?(0,i.l7)({},t):t:null}function sn(t,e,n=!1){const{props:r,ref:o,patchFlag:s,children:a}=t,l=e?pn(r||{},e):r,u={__v_isVNode:!0,__v_skip:!0,type:t.type,props:l,key:l&&Qe(l),ref:e&&e.ref?n&&o?(0,i.kJ)(o)?o.concat(tn(e)):[o,tn(e)]:tn(e):o,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:a,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==Pe?-1===s?16:16|s:s,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&sn(t.ssContent),ssFallback:t.ssFallback&&sn(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return u}function an(t=" ",e=0){return nn(Le,null,t,e)}function ln(t,e){const n=nn(Be,null,t);return n.staticCount=e,n}function un(t="",e=!1){return e?(Ve(),Xe(ze,null,t)):nn(ze,null,t)}function cn(t){return null==t||"boolean"===typeof t?nn(ze):(0,i.kJ)(t)?nn(Pe,null,t.slice()):"object"===typeof t?hn(t):nn(Le,null,String(t))}function hn(t){return null===t.el&&-1!==t.patchFlag||t.memo?t:sn(t)}function dn(t,e){let n=0;const{shapeFlag:r}=t;if(null==e)e=null;else if((0,i.kJ)(e))n=16;else if("object"===typeof e){if(65&r){const n=e.default;return void(n&&(n._c&&(n._d=!1),dn(t,n()),n._c&&(n._d=!0)))}{n=32;const r=e._;r||Ze in e?3===r&&$&&(1===$.slots._?e._=1:(e._=2,t.patchFlag|=1024)):e._ctx=$}}else(0,i.mf)(e)?(e={default:e,_ctx:$},n=32):(e=String(e),64&r?(n=16,e=[an(e)]):n=8);t.children=e,t.shapeFlag|=n}function pn(...t){const e={};for(let n=0;n<t.length;n++){const r=t[n];for(const t in r)if("class"===t)e.class!==r.class&&(e.class=(0,i.C_)([e.class,r.class]));else if("style"===t)e.style=(0,i.j5)([e.style,r.style]);else if((0,i.F7)(t)){const n=e[t],o=r[t];!o||n===o||(0,i.kJ)(n)&&n.includes(o)||(e[t]=n?[].concat(n,o):o)}else""!==t&&(e[t]=r[t])}return e}function fn(t,e,n,r=null){s(t,e,7,[n,r])}const gn=oe();let mn=0;function yn(t,e,n){const o=t.type,s=(e?e.appContext:t.appContext)||gn,a={uid:mn++,vnode:t,type:o,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,scope:new r.Bj(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:ge(o,s),emitsOptions:A(o,s),emit:null,emitted:null,propsDefaults:i.kT,inheritAttrs:o.inheritAttrs,ctx:i.kT,data:i.kT,props:i.kT,attrs:i.kT,slots:i.kT,refs:i.kT,setupState:i.kT,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return a.ctx={_:a},a.root=e?e.root:a,a.emit=N.bind(null,a),t.ce&&t.ce(a),a}let bn=null;const vn=()=>bn||$;let wn,xn,kn="__VUE_INSTANCE_SETTERS__";(xn=(0,i.E9)()[kn])||(xn=(0,i.E9)()[kn]=[]),xn.push((t=>bn=t)),wn=t=>{xn.length>1?xn.forEach((e=>e(t))):xn[0](t)};const _n=t=>{wn(t),t.scope.on()},In=()=>{bn&&bn.scope.off(),wn(null)};function Cn(t){return 4&t.vnode.shapeFlag}let Sn,Tn,En=!1;function Nn(t,e=!1){En=e;const{props:n,children:r}=t.vnode,i=Cn(t);he(t,n,i,e),Ce(t,r);const o=i?An(t,e):void 0;return En=!1,o}function An(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=(0,r.Xl)(new Proxy(t.ctx,Ut));const{setup:s}=n;if(s){const n=t.setupContext=s.length>1?On(t):null;_n(t),(0,r.Jd)();const l=o(s,t,0,[t.props,n]);if((0,r.lk)(),In(),(0,i.tI)(l)){if(l.then(In,In),e)return l.then((n=>{Rn(t,n,e)})).catch((e=>{a(e,t,0)}));t.asyncDep=l}else Rn(t,l,e)}else $n(t,e)}function Rn(t,e,n){(0,i.mf)(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:(0,i.Kn)(e)&&(t.setupState=(0,r.WL)(e)),$n(t,n)}function $n(t,e,n){const o=t.type;if(!t.render){if(!e&&Sn&&!o.render){const e=o.template||Xt(t).template;if(e){0;const{isCustomElement:n,compilerOptions:r}=t.appContext.config,{delimiters:s,compilerOptions:a}=o,l=(0,i.l7)((0,i.l7)({isCustomElement:n,delimiters:s},r),a);o.render=Sn(e,l)}}t.render=o.render||i.dG,Tn&&Tn(t)}_n(t),(0,r.Jd)();try{Ht(t)}finally{(0,r.lk)(),In()}}function Dn(t){return t.attrsProxy||(t.attrsProxy=new Proxy(t.attrs,{get(e,n){return(0,r.j)(t,"get","$attrs"),e[n]}}))}function On(t){const e=e=>{t.exposed=e||{}};return{get attrs(){return Dn(t)},slots:t.slots,emit:t.emit,expose:e}}function Fn(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy((0,r.WL)((0,r.Xl)(t.exposed)),{get(e,n){return n in e?e[n]:n in Bt?Bt[n](t):void 0},has(t,e){return e in t||e in Bt}}))}function Mn(t,e=!0){return(0,i.mf)(t)?t.displayName||t.name:t.name||e&&t.__name}function Pn(t){return(0,i.mf)(t)&&"__vccOpts"in t}const Ln=(t,e)=>(0,r.Fl)(t,e,En);function zn(t,e,n){const r=arguments.length;return 2===r?(0,i.Kn)(e)&&!(0,i.kJ)(e)?Ye(e)?nn(t,null,[e]):nn(t,e):nn(t,null,e):(r>3?n=Array.prototype.slice.call(arguments,2):3===r&&Ye(n)&&(n=[n]),nn(t,e,n))}const Bn=Symbol.for("v-scx"),Wn=()=>{{const t=ce(Bn);return t}};const Un="3.3.11"},9242:function(t,e,n){"use strict";n.d(e,{iM:function(){return yt},nr:function(){return ft},ri:function(){return xt}});n(560);var r=n(3396),i=n(7139),o=n(4870);const s="http://www.w3.org/2000/svg",a="undefined"!==typeof document?document:null,l=a&&a.createElement("template"),u={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,r)=>{const i=e?a.createElementNS(s,t):a.createElement(t,n?{is:n}:void 0);return"select"===t&&r&&null!=r.multiple&&i.setAttribute("multiple",r.multiple),i},createText:t=>a.createTextNode(t),createComment:t=>a.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>a.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,r,i,o){const s=n?n.previousSibling:e.lastChild;if(i&&(i===o||i.nextSibling)){while(1)if(e.insertBefore(i.cloneNode(!0),n),i===o||!(i=i.nextSibling))break}else{l.innerHTML=r?`<svg>${t}</svg>`:t;const i=l.content;if(r){const t=i.firstChild;while(t.firstChild)i.appendChild(t.firstChild);i.removeChild(t)}e.insertBefore(i,n)}return[s?s.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}},c="transition",h="animation",d=Symbol("_vtc"),p=(t,{slots:e})=>(0,r.h)(r.P$,b(t),e);p.displayName="Transition";const f={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},g=p.props=(0,i.l7)({},r.nJ,f),m=(t,e=[])=>{(0,i.kJ)(t)?t.forEach((t=>t(...e))):t&&t(...e)},y=t=>!!t&&((0,i.kJ)(t)?t.some((t=>t.length>1)):t.length>1);function b(t){const e={};for(const i in t)i in f||(e[i]=t[i]);if(!1===t.css)return e;const{name:n="v",type:r,duration:o,enterFromClass:s=`${n}-enter-from`,enterActiveClass:a=`${n}-enter-active`,enterToClass:l=`${n}-enter-to`,appearFromClass:u=s,appearActiveClass:c=a,appearToClass:h=l,leaveFromClass:d=`${n}-leave-from`,leaveActiveClass:p=`${n}-leave-active`,leaveToClass:g=`${n}-leave-to`}=t,b=v(o),w=b&&b[0],I=b&&b[1],{onBeforeEnter:S,onEnter:T,onEnterCancelled:E,onLeave:A,onLeaveCancelled:R,onBeforeAppear:$=S,onAppear:D=T,onAppearCancelled:O=E}=e,F=(t,e,n)=>{k(t,e?h:l),k(t,e?c:a),n&&n()},M=(t,e)=>{t._isLeaving=!1,k(t,d),k(t,g),k(t,p),e&&e()},P=t=>(e,n)=>{const i=t?D:T,o=()=>F(e,t,n);m(i,[e,o]),_((()=>{k(e,t?u:s),x(e,t?h:l),y(i)||C(e,r,w,o)}))};return(0,i.l7)(e,{onBeforeEnter(t){m(S,[t]),x(t,s),x(t,a)},onBeforeAppear(t){m($,[t]),x(t,u),x(t,c)},onEnter:P(!1),onAppear:P(!0),onLeave(t,e){t._isLeaving=!0;const n=()=>M(t,e);x(t,d),N(),x(t,p),_((()=>{t._isLeaving&&(k(t,d),x(t,g),y(A)||C(t,r,I,n))})),m(A,[t,n])},onEnterCancelled(t){F(t,!1),m(E,[t])},onAppearCancelled(t){F(t,!0),m(O,[t])},onLeaveCancelled(t){M(t),m(R,[t])}})}function v(t){if(null==t)return null;if((0,i.Kn)(t))return[w(t.enter),w(t.leave)];{const e=w(t);return[e,e]}}function w(t){const e=(0,i.He)(t);return e}function x(t,e){e.split(/\s+/).forEach((e=>e&&t.classList.add(e))),(t[d]||(t[d]=new Set)).add(e)}function k(t,e){e.split(/\s+/).forEach((e=>e&&t.classList.remove(e)));const n=t[d];n&&(n.delete(e),n.size||(t[d]=void 0))}function _(t){requestAnimationFrame((()=>{requestAnimationFrame(t)}))}let I=0;function C(t,e,n,r){const i=t._endId=++I,o=()=>{i===t._endId&&r()};if(n)return setTimeout(o,n);const{type:s,timeout:a,propCount:l}=S(t,e);if(!s)return r();const u=s+"end";let c=0;const h=()=>{t.removeEventListener(u,d),o()},d=e=>{e.target===t&&++c>=l&&h()};setTimeout((()=>{c<l&&h()}),a+1),t.addEventListener(u,d)}function S(t,e){const n=window.getComputedStyle(t),r=t=>(n[t]||"").split(", "),i=r(`${c}Delay`),o=r(`${c}Duration`),s=T(i,o),a=r(`${h}Delay`),l=r(`${h}Duration`),u=T(a,l);let d=null,p=0,f=0;e===c?s>0&&(d=c,p=s,f=o.length):e===h?u>0&&(d=h,p=u,f=l.length):(p=Math.max(s,u),d=p>0?s>u?c:h:null,f=d?d===c?o.length:l.length:0);const g=d===c&&/\b(transform|all)(,|$)/.test(r(`${c}Property`).toString());return{type:d,timeout:p,propCount:f,hasTransform:g}}function T(t,e){while(t.length<e.length)t=t.concat(t);return Math.max(...e.map(((e,n)=>E(e)+E(t[n]))))}function E(t){return"auto"===t?0:1e3*Number(t.slice(0,-1).replace(",","."))}function N(){return document.body.offsetHeight}function A(t,e,n){const r=t[d];r&&(e=(e?[e,...r]:[...r]).join(" ")),null==e?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}const R=Symbol("_vod");function $(t,e,n){const r=t.style,o=(0,i.HD)(n);if(n&&!o){if(e&&!(0,i.HD)(e))for(const t in e)null==n[t]&&O(r,t,"");for(const t in n)O(r,t,n[t])}else{const i=r.display;o?e!==n&&(r.cssText=n):e&&t.removeAttribute("style"),R in t&&(r.display=i)}}const D=/\s*!important$/;function O(t,e,n){if((0,i.kJ)(n))n.forEach((n=>O(t,e,n)));else if(null==n&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const r=P(t,e);D.test(n)?t.setProperty((0,i.rs)(r),n.replace(D,""),"important"):t[r]=n}}const F=["Webkit","Moz","ms"],M={};function P(t,e){const n=M[e];if(n)return n;let r=(0,i._A)(e);if("filter"!==r&&r in t)return M[e]=r;r=(0,i.kC)(r);for(let i=0;i<F.length;i++){const n=F[i]+r;if(n in t)return M[e]=n}return e}const L="http://www.w3.org/1999/xlink";function z(t,e,n,r,o){if(r&&e.startsWith("xlink:"))null==n?t.removeAttributeNS(L,e.slice(6,e.length)):t.setAttributeNS(L,e,n);else{const r=(0,i.Pq)(e);null==n||r&&!(0,i.yA)(n)?t.removeAttribute(e):t.setAttribute(e,r?"":n)}}function B(t,e,n,r,o,s,a){if("innerHTML"===e||"textContent"===e)return r&&a(r,o,s),void(t[e]=null==n?"":n);const l=t.tagName;if("value"===e&&"PROGRESS"!==l&&!l.includes("-")){t._value=n;const r="OPTION"===l?t.getAttribute("value"):t.value,i=null==n?"":n;return r!==i&&(t.value=i),void(null==n&&t.removeAttribute(e))}let u=!1;if(""===n||null==n){const r=typeof t[e];"boolean"===r?n=(0,i.yA)(n):null==n&&"string"===r?(n="",u=!0):"number"===r&&(n=0,u=!0)}try{t[e]=n}catch(c){0}u&&t.removeAttribute(e)}function W(t,e,n,r){t.addEventListener(e,n,r)}function U(t,e,n,r){t.removeEventListener(e,n,r)}const V=Symbol("_vei");function j(t,e,n,r,i=null){const o=t[V]||(t[V]={}),s=o[e];if(r&&s)s.value=r;else{const[n,a]=G(e);if(r){const s=o[e]=Y(r,i);W(t,n,s,a)}else s&&(U(t,n,s,a),o[e]=void 0)}}const H=/(?:Once|Passive|Capture)$/;function G(t){let e;if(H.test(t)){let n;e={};while(n=t.match(H))t=t.slice(0,t.length-n[0].length),e[n[0].toLowerCase()]=!0}const n=":"===t[2]?t.slice(3):(0,i.rs)(t.slice(2));return[n,e]}let q=0;const K=Promise.resolve(),X=()=>q||(K.then((()=>q=0)),q=Date.now());function Y(t,e){const n=t=>{if(t._vts){if(t._vts<=n.attached)return}else t._vts=Date.now();(0,r.$d)(J(t,n.value),e,5,[t])};return n.value=t,n.attached=X(),n}function J(t,e){if((0,i.kJ)(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map((t=>e=>!e._stopped&&t&&t(e)))}return e}const Z=t=>111===t.charCodeAt(0)&&110===t.charCodeAt(1)&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,Q=(t,e,n,r,o=!1,s,a,l,u)=>{"class"===e?A(t,r,o):"style"===e?$(t,n,r):(0,i.F7)(e)?(0,i.tR)(e)||j(t,e,n,r,a):("."===e[0]?(e=e.slice(1),1):"^"===e[0]?(e=e.slice(1),0):tt(t,e,r,o))?B(t,e,r,s,a,l,u):("true-value"===e?t._trueValue=r:"false-value"===e&&(t._falseValue=r),z(t,e,r,o))};function tt(t,e,n,r){if(r)return"innerHTML"===e||"textContent"===e||!!(e in t&&Z(e)&&(0,i.mf)(n));if("spellcheck"===e||"draggable"===e||"translate"===e)return!1;if("form"===e)return!1;if("list"===e&&"INPUT"===t.tagName)return!1;if("type"===e&&"TEXTAREA"===t.tagName)return!1;if("width"===e||"height"===e){const e=t.tagName;if("IMG"===e||"VIDEO"===e||"CANVAS"===e||"SOURCE"===e)return!1}return(!Z(e)||!(0,i.HD)(n))&&e in t}
/*! #__NO_SIDE_EFFECTS__ */
/*! #__NO_SIDE_EFFECTS__ */
"undefined"!==typeof HTMLElement&&HTMLElement;const et=new WeakMap,nt=new WeakMap,rt=Symbol("_moveCb"),it=Symbol("_enterCb"),ot={name:"TransitionGroup",props:(0,i.l7)({},g,{tag:String,moveClass:String}),setup(t,{slots:e}){const n=(0,r.FN)(),i=(0,r.Y8)();let s,a;return(0,r.ic)((()=>{if(!s.length)return;const e=t.moveClass||`${t.name||"v"}-move`;if(!ut(s[0].el,n.vnode.el,e))return;s.forEach(st),s.forEach(at);const r=s.filter(lt);N(),r.forEach((t=>{const n=t.el,r=n.style;x(n,e),r.transform=r.webkitTransform=r.transitionDuration="";const i=n[rt]=t=>{t&&t.target!==n||t&&!/transform$/.test(t.propertyName)||(n.removeEventListener("transitionend",i),n[rt]=null,k(n,e))};n.addEventListener("transitionend",i)}))})),()=>{const l=(0,o.IU)(t),u=b(l);let c=l.tag||r.HY;s=a,a=e.default?(0,r.Q6)(e.default()):[];for(let t=0;t<a.length;t++){const e=a[t];null!=e.key&&(0,r.nK)(e,(0,r.U2)(e,u,i,n))}if(s)for(let t=0;t<s.length;t++){const e=s[t];(0,r.nK)(e,(0,r.U2)(e,u,i,n)),et.set(e,e.el.getBoundingClientRect())}return(0,r.Wm)(c,null,a)}}};ot.props;function st(t){const e=t.el;e[rt]&&e[rt](),e[it]&&e[it]()}function at(t){nt.set(t,t.el.getBoundingClientRect())}function lt(t){const e=et.get(t),n=nt.get(t),r=e.left-n.left,i=e.top-n.top;if(r||i){const e=t.el.style;return e.transform=e.webkitTransform=`translate(${r}px,${i}px)`,e.transitionDuration="0s",t}}function ut(t,e,n){const r=t.cloneNode(),i=t[d];i&&i.forEach((t=>{t.split(/\s+/).forEach((t=>t&&r.classList.remove(t)))})),n.split(/\s+/).forEach((t=>t&&r.classList.add(t))),r.style.display="none";const o=1===e.nodeType?e:e.parentNode;o.appendChild(r);const{hasTransform:s}=S(r);return o.removeChild(r),s}const ct=t=>{const e=t.props["onUpdate:modelValue"]||!1;return(0,i.kJ)(e)?t=>(0,i.ir)(e,t):e};function ht(t){t.target.composing=!0}function dt(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const pt=Symbol("_assign"),ft={created(t,{modifiers:{lazy:e,trim:n,number:r}},o){t[pt]=ct(o);const s=r||o.props&&"number"===o.props.type;W(t,e?"change":"input",(e=>{if(e.target.composing)return;let r=t.value;n&&(r=r.trim()),s&&(r=(0,i.h5)(r)),t[pt](r)})),n&&W(t,"change",(()=>{t.value=t.value.trim()})),e||(W(t,"compositionstart",ht),W(t,"compositionend",dt),W(t,"change",dt))},mounted(t,{value:e}){t.value=null==e?"":e},beforeUpdate(t,{value:e,modifiers:{lazy:n,trim:r,number:o}},s){if(t[pt]=ct(s),t.composing)return;const a=o||"number"===t.type?(0,i.h5)(t.value):t.value,l=null==e?"":e;if(a!==l){if(document.activeElement===t&&"range"!==t.type){if(n)return;if(r&&t.value.trim()===l)return}t.value=l}}};const gt=["ctrl","shift","alt","meta"],mt={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&0!==t.button,middle:t=>"button"in t&&1!==t.button,right:t=>"button"in t&&2!==t.button,exact:(t,e)=>gt.some((n=>t[`${n}Key`]&&!e.includes(n)))},yt=(t,e)=>t._withMods||(t._withMods=(n,...r)=>{for(let t=0;t<e.length;t++){const r=mt[e[t]];if(r&&r(n,e))return}return t(n,...r)}),bt=(0,i.l7)({patchProp:Q},u);let vt;function wt(){return vt||(vt=(0,r.Us)(bt))}const xt=(...t)=>{const e=wt().createApp(...t);const{mount:n}=e;return e.mount=t=>{const r=kt(t);if(!r)return;const o=e._component;(0,i.mf)(o)||o.render||o.template||(o.template=r.innerHTML),r.innerHTML="";const s=n(r,!1,r instanceof SVGElement);return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),s},e};function kt(t){if((0,i.HD)(t)){const e=document.querySelector(t);return e}return t}},7139:function(t,e,n){"use strict";n.d(e,{C_:function(){return J},DM:function(){return m},E9:function(){return V},F7:function(){return l},Gg:function(){return N},HD:function(){return w},He:function(){return W},Kj:function(){return b},Kn:function(){return k},NO:function(){return a},Nj:function(){return z},Od:function(){return h},PO:function(){return T},Pq:function(){return Q},RI:function(){return p},S0:function(){return E},W7:function(){return S},WV:function(){return nt},Z6:function(){return o},_A:function(){return $},_N:function(){return g},aU:function(){return P},dG:function(){return s},fY:function(){return r},h5:function(){return B},hR:function(){return M},hq:function(){return rt},ir:function(){return L},j5:function(){return G},kC:function(){return F},kJ:function(){return f},kT:function(){return i},l7:function(){return c},mf:function(){return v},rs:function(){return O},tI:function(){return _},tR:function(){return u},yA:function(){return tt},yk:function(){return x},yl:function(){return H},zw:function(){return it}});n(560);function r(t,e){const n=Object.create(null),r=t.split(",");for(let i=0;i<r.length;i++)n[r[i]]=!0;return e?t=>!!n[t.toLowerCase()]:t=>!!n[t]}const i={},o=[],s=()=>{},a=()=>!1,l=t=>111===t.charCodeAt(0)&&110===t.charCodeAt(1)&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),u=t=>t.startsWith("onUpdate:"),c=Object.assign,h=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},d=Object.prototype.hasOwnProperty,p=(t,e)=>d.call(t,e),f=Array.isArray,g=t=>"[object Map]"===C(t),m=t=>"[object Set]"===C(t),y=t=>"[object Date]"===C(t),b=t=>"[object RegExp]"===C(t),v=t=>"function"===typeof t,w=t=>"string"===typeof t,x=t=>"symbol"===typeof t,k=t=>null!==t&&"object"===typeof t,_=t=>(k(t)||v(t))&&v(t.then)&&v(t.catch),I=Object.prototype.toString,C=t=>I.call(t),S=t=>C(t).slice(8,-1),T=t=>"[object Object]"===C(t),E=t=>w(t)&&"NaN"!==t&&"-"!==t[0]&&""+parseInt(t,10)===t,N=r(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),A=t=>{const e=Object.create(null);return n=>{const r=e[n];return r||(e[n]=t(n))}},R=/-(\w)/g,$=A((t=>t.replace(R,((t,e)=>e?e.toUpperCase():"")))),D=/\B([A-Z])/g,O=A((t=>t.replace(D,"-$1").toLowerCase())),F=A((t=>t.charAt(0).toUpperCase()+t.slice(1))),M=A((t=>{const e=t?`on${F(t)}`:"";return e})),P=(t,e)=>!Object.is(t,e),L=(t,e)=>{for(let n=0;n<t.length;n++)t[n](e)},z=(t,e,n)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:n})},B=t=>{const e=parseFloat(t);return isNaN(e)?t:e},W=t=>{const e=w(t)?Number(t):NaN;return isNaN(e)?t:e};let U;const V=()=>U||(U="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:{});const j="Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt,console",H=r(j);function G(t){if(f(t)){const e={};for(let n=0;n<t.length;n++){const r=t[n],i=w(r)?Y(r):G(r);if(i)for(const t in i)e[t]=i[t]}return e}if(w(t)||k(t))return t}const q=/;(?![^(]*\))/g,K=/:([^]+)/,X=/\/\*[^]*?\*\//g;function Y(t){const e={};return t.replace(X,"").split(q).forEach((t=>{if(t){const n=t.split(K);n.length>1&&(e[n[0].trim()]=n[1].trim())}})),e}function J(t){let e="";if(w(t))e=t;else if(f(t))for(let n=0;n<t.length;n++){const r=J(t[n]);r&&(e+=r+" ")}else if(k(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const Z="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Q=r(Z);function tt(t){return!!t||""===t}function et(t,e){if(t.length!==e.length)return!1;let n=!0;for(let r=0;n&&r<t.length;r++)n=nt(t[r],e[r]);return n}function nt(t,e){if(t===e)return!0;let n=y(t),r=y(e);if(n||r)return!(!n||!r)&&t.getTime()===e.getTime();if(n=x(t),r=x(e),n||r)return t===e;if(n=f(t),r=f(e),n||r)return!(!n||!r)&&et(t,e);if(n=k(t),r=k(e),n||r){if(!n||!r)return!1;const i=Object.keys(t).length,o=Object.keys(e).length;if(i!==o)return!1;for(const n in t){const r=t.hasOwnProperty(n),i=e.hasOwnProperty(n);if(r&&!i||!r&&i||!nt(t[n],e[n]))return!1}}return String(t)===String(e)}function rt(t,e){return t.findIndex((t=>nt(t,e)))}const it=t=>w(t)?t:null==t?"":f(t)||k(t)&&(t.toString===I||!v(t.toString))?JSON.stringify(t,ot,2):String(t),ot=(t,e)=>e&&e.__v_isRef?ot(t,e.value):g(e)?{[`Map(${e.size})`]:[...e.entries()].reduce(((t,[e,n],r)=>(t[st(e,r)+" =>"]=n,t)),{})}:m(e)?{[`Set(${e.size})`]:[...e.values()].map((t=>st(t)))}:x(e)?st(e):!k(e)||f(e)||T(e)?e:String(e),st=(t,e="")=>{var n;return x(t)?`Symbol(${null!=(n=t.description)?n:e})`:t}},4275:function(t,e,n){"use strict";n.d(e,{Z:function(){return r.Z}});var r=n(4552),i="firebase",o="8.10.1";
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
r.Z.registerVersion(i,o,"app"),r.Z.SDK_VERSION=o},4059:function(t,e,n){"use strict";n(560),n(88),n(4224),n(1121),n(7133);var r=n(4552);(function(){var t,e="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)};function i(t){t=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof n.g&&n.g,t];for(var e=0;e<t.length;++e){var r=t[e];if(r&&r.Math==Math)return r}return globalThis}var o=i(this);function s(t,n){if(n){var r=o;t=t.split(".");for(var i=0;i<t.length-1;i++){var s=t[i];s in r||(r[s]={}),r=r[s]}t=t[t.length-1],i=r[t],n=n(i),n!=i&&null!=n&&e(r,t,{configurable:!0,writable:!0,value:n})}}function a(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}function l(t){var e="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):{next:a(t)}}s("Promise",(function(t){function e(t){this.b=0,this.c=void 0,this.a=[];var e=this.f();try{t(e.resolve,e.reject)}catch(n){e.reject(n)}}function n(){this.a=null}function r(t){return t instanceof e?t:new e((function(e){e(t)}))}if(t)return t;n.prototype.b=function(t){if(null==this.a){this.a=[];var e=this;this.c((function(){e.g()}))}this.a.push(t)};var i=o.setTimeout;n.prototype.c=function(t){i(t,0)},n.prototype.g=function(){for(;this.a&&this.a.length;){var t=this.a;this.a=[];for(var e=0;e<t.length;++e){var n=t[e];t[e]=null;try{n()}catch(r){this.f(r)}}}this.a=null},n.prototype.f=function(t){this.c((function(){throw t}))},e.prototype.f=function(){function t(t){return function(r){n||(n=!0,t.call(e,r))}}var e=this,n=!1;return{resolve:t(this.m),reject:t(this.g)}},e.prototype.m=function(t){if(t===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof e)this.s(t);else{t:switch(typeof t){case"object":var n=null!=t;break t;case"function":n=!0;break t;default:n=!1}n?this.v(t):this.h(t)}},e.prototype.v=function(t){var e=void 0;try{e=t.then}catch(n){return void this.g(n)}"function"==typeof e?this.u(e,t):this.h(t)},e.prototype.g=function(t){this.i(2,t)},e.prototype.h=function(t){this.i(1,t)},e.prototype.i=function(t,e){if(0!=this.b)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.b);this.b=t,this.c=e,this.l()},e.prototype.l=function(){if(null!=this.a){for(var t=0;t<this.a.length;++t)s.b(this.a[t]);this.a=null}};var s=new n;return e.prototype.s=function(t){var e=this.f();t.Ra(e.resolve,e.reject)},e.prototype.u=function(t,e){var n=this.f();try{t.call(e,n.resolve,n.reject)}catch(r){n.reject(r)}},e.prototype.then=function(t,n){function r(t,e){return"function"==typeof t?function(e){try{i(t(e))}catch(n){o(n)}}:e}var i,o,s=new e((function(t,e){i=t,o=e}));return this.Ra(r(t,i),r(n,o)),s},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.Ra=function(t,e){function n(){switch(r.b){case 1:t(r.c);break;case 2:e(r.c);break;default:throw Error("Unexpected state: "+r.b)}}var r=this;null==this.a?s.b(n):this.a.push(n)},e.resolve=r,e.reject=function(t){return new e((function(e,n){n(t)}))},e.race=function(t){return new e((function(e,n){for(var i=l(t),o=i.next();!o.done;o=i.next())r(o.value).Ra(e,n)}))},e.all=function(t){var n=l(t),i=n.next();return i.done?r([]):new e((function(t,e){function o(e){return function(n){s[e]=n,a--,0==a&&t(s)}}var s=[],a=0;do{s.push(void 0),a++,r(i.value).Ra(o(s.length-1),e),i=n.next()}while(!i.done)}))},e}));var u=u||{},c=this||self,h=/^[\w+/_-]+[=]{0,2}$/,d=null;function p(t){return(t=t.querySelector&&t.querySelector("script[nonce]"))&&(t=t.nonce||t.getAttribute("nonce"))&&h.test(t)?t:""}function f(){}function g(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function m(t){var e=g(t);return"array"==e||"object"==e&&"number"==typeof t.length}function y(t){return"function"==g(t)}function b(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function v(t){return Object.prototype.hasOwnProperty.call(t,w)&&t[w]||(t[w]=++x)}var w="closure_uid_"+(1e9*Math.random()>>>0),x=0;function k(t,e,n){return t.call.apply(t.bind,arguments)}function _(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function I(t,e,n){return I=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?k:_,I.apply(null,arguments)}function C(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var S=Date.now;function T(t,e){function n(){}n.prototype=e.prototype,t.bb=e.prototype,t.prototype=new n,t.prototype.constructor=t}function E(t){return t}function N(t,e,n){this.code=$+t,this.message=e||D[t]||"",this.a=n||null}function A(t){var e=t&&t.code;return e?new N(e.substring($.length),t.message,t.serverResponse):null}T(N,Error),N.prototype.w=function(){var t={code:this.code,message:this.message};return this.a&&(t.serverResponse=this.a),t},N.prototype.toJSON=function(){return this.w()};var R,$="auth/",D={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},O={ld:{Ua:"https://staging-identitytoolkit.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"b"},sd:{Ua:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://securetoken.googleapis.com/v1/token",Xa:"https://identitytoolkit.googleapis.com/v2/",id:"p"},ud:{Ua:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"s"},vd:{Ua:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",$a:"https://test-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://test-identitytoolkit.sandbox.googleapis.com/v2/",id:"t"}};function F(t){for(var e in O)if(O[e].id===t)return t=O[e],{firebaseEndpoint:t.Ua,secureTokenEndpoint:t.$a,identityPlatformEndpoint:t.Xa};return null}function M(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(e){return!1}}function P(t){if(Error.captureStackTrace)Error.captureStackTrace(this,P);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function L(t,e){t=t.split("%s");for(var n="",r=t.length-1,i=0;i<r;i++)n+=t[i]+(i<e.length?e[i]:"%s");P.call(this,n+t[r])}function z(t,e){throw new L("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function B(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function W(t,e){t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}function U(){this.b=this.a=null}R=F("__EID__")?"__EID__":void 0,T(P,Error),P.prototype.name="CustomError",T(L,P),L.prototype.name="AssertionError",B.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var V=new B((function(){return new H}),(function(t){t.reset()}));function j(){var t=Re,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function H(){this.next=this.b=this.a=null}U.prototype.add=function(t,e){var n=V.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},H.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},H.prototype.reset=function(){this.next=this.b=this.a=null};var G=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"===typeof t)return"string"!==typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},q=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"===typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function K(t,e){for(var n="string"===typeof t?t.split(""):t,r=t.length-1;0<=r;--r)r in n&&e.call(void 0,n[r],r,t)}var X=Array.prototype.filter?function(t,e){return Array.prototype.filter.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=[],i=0,o="string"===typeof t?t.split(""):t,s=0;s<n;s++)if(s in o){var a=o[s];e.call(void 0,a,s,t)&&(r[i++]=a)}return r},Y=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=Array(n),i="string"===typeof t?t.split(""):t,o=0;o<n;o++)o in i&&(r[o]=e.call(void 0,i[o],o,t));return r},J=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(t,e){for(var n=t.length,r="string"===typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t))return!0;return!1};function Z(t){t:{for(var e=oa,n=t.length,r="string"===typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"===typeof t?t.charAt(e):t[e]}function Q(t,e){return 0<=G(t,e)}function tt(t,e){var n;return e=G(t,e),(n=0<=e)&&Array.prototype.splice.call(t,e,1),n}function et(t,e){K(t,(function(n,r){e.call(void 0,n,r,t)&&1==Array.prototype.splice.call(t,r,1).length&&0}))}function nt(t){return Array.prototype.concat.apply([],arguments)}function rt(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}var it,ot=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]},st=/&/g,at=/</g,lt=/>/g,ut=/"/g,ct=/'/g,ht=/\x00/g,dt=/[\x00&<>"']/;function pt(t,e){return-1!=t.indexOf(e)}function ft(t,e){return t<e?-1:t>e?1:0}t:{var gt=c.navigator;if(gt){var mt=gt.userAgent;if(mt){it=mt;break t}}it=""}function yt(t){return pt(it,t)}function bt(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function vt(t){for(var e in t)return!1;return!0}function wt(t){var e,n={};for(e in t)n[e]=t[e];return n}var xt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function kt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i],r)t[n]=r[n];for(var o=0;o<xt.length;o++)n=xt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function _t(t,e){t:{try{var n=t&&t.ownerDocument,r=n&&(n.defaultView||n.parentWindow);if(r=r||c,r.Element&&r.Location){var i=r;break t}}catch(s){}i=null}if(i&&"undefined"!=typeof i[e]&&(!t||!(t instanceof i[e])&&(t instanceof i.Location||t instanceof i.Element))){if(b(t))try{var o=t.constructor.displayName||t.constructor.name||Object.prototype.toString.call(t)}catch(s){o="<object could not be stringified>"}else o=void 0===t?"undefined":null===t?"null":typeof t;z("Argument is not a %s (or a non-Element, non-Location mock); got: %s",e,o)}}function It(t,e){this.a=t===Et&&e||"",this.b=Tt}function Ct(t){return t instanceof It&&t.constructor===It&&t.b===Tt?t.a:(z("expected object of type Const, got '"+t+"'"),"type_error:Const")}It.prototype.ta=!0,It.prototype.sa=function(){return this.a},It.prototype.toString=function(){return"Const{"+this.a+"}"};var St,Tt={},Et={};function Nt(){if(void 0===St){var t=null,e=c.trustedTypes;if(e&&e.createPolicy){try{t=e.createPolicy("goog#html",{createHTML:E,createScript:E,createScriptURL:E})}catch(n){c.console&&c.console.error(n.message)}St=t}else St=t}return St}function At(t,e){this.a=e===Ft?t:""}function Rt(t){return t instanceof At&&t.constructor===At?t.a:(z("expected object of type TrustedResourceUrl, got '"+t+"' of type "+g(t)),"type_error:TrustedResourceUrl")}function $t(t,e){var n=Ct(t);if(!Ot.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return t=n.replace(Dt,(function(t,r){if(!Object.prototype.hasOwnProperty.call(e,r))throw Error('Found marker, "'+r+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(e));return t=e[r],t instanceof It?Ct(t):encodeURIComponent(String(t))})),Mt(t)}At.prototype.ta=!0,At.prototype.sa=function(){return this.a.toString()},At.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var Dt=/%{(\w+)}/g,Ot=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,Ft={};function Mt(t){var e=Nt();return t=e?e.createScriptURL(t):t,new At(t,Ft)}function Pt(t,e){this.a=e===jt?t:""}function Lt(t){return t instanceof Pt&&t.constructor===Pt?t.a:(z("expected object of type SafeUrl, got '"+t+"' of type "+g(t)),"type_error:SafeUrl")}Pt.prototype.ta=!0,Pt.prototype.sa=function(){return this.a.toString()},Pt.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var zt=/^(?:audio\/(?:3gpp2|3gpp|aac|L16|midi|mp3|mp4|mpeg|oga|ogg|opus|x-m4a|x-matroska|x-wav|wav|webm)|font\/\w+|image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp|x-icon)|text\/csv|video\/(?:mpeg|mp4|ogg|webm|quicktime|x-matroska))(?:;\w+=(?:\w+|"[\w;,= ]+"))*$/i,Bt=/^data:(.*);base64,[a-z0-9+\/]+=*$/i,Wt=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function Ut(t){if(t instanceof Pt)return t;if(t="object"==typeof t&&t.ta?t.sa():String(t),Wt.test(t))t=new Pt(t,jt);else{t=String(t),t=t.replace(/(%0A|%0D)/g,"");var e=t.match(Bt);t=e&&zt.test(e[1])?new Pt(t,jt):null}return t}function Vt(t){return t instanceof Pt?t:(t="object"==typeof t&&t.ta?t.sa():String(t),Wt.test(t)||(t="about:invalid#zClosurez"),new Pt(t,jt))}var jt={},Ht=new Pt("about:invalid#zClosurez",jt);function Gt(t,e,n){this.a=n===Kt?t:""}function qt(t){return t instanceof Gt&&t.constructor===Gt?t.a:(z("expected object of type SafeHtml, got '"+t+"' of type "+g(t)),"type_error:SafeHtml")}Gt.prototype.ta=!0,Gt.prototype.sa=function(){return this.a.toString()},Gt.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var Kt={};function Xt(t,e){_t(t,"HTMLScriptElement"),t.src=Rt(e),(e=t.ownerDocument&&t.ownerDocument.defaultView)&&e!=c?e=p(e.document):(null===d&&(d=p(c.document)),e=d),e&&t.setAttribute("nonce",e)}function Yt(t,e,n,r){return t=t instanceof Pt?t:Vt(t),e=e||c,n=n instanceof It?Ct(n):n||"",e.open(Lt(t),n,r,void 0)}function Jt(t,e){for(var n=t.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function Zt(t){return dt.test(t)&&(-1!=t.indexOf("&")&&(t=t.replace(st,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(at,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(lt,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(ut,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(ct,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(ht,"&#0;"))),t}function Qt(t){return Qt[" "](t),t}function te(t,e){var n=pe;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}Qt[" "]=f;var ee,ne=yt("Opera"),re=yt("Trident")||yt("MSIE"),ie=yt("Edge"),oe=ie||re,se=yt("Gecko")&&!(pt(it.toLowerCase(),"webkit")&&!yt("Edge"))&&!(yt("Trident")||yt("MSIE"))&&!yt("Edge"),ae=pt(it.toLowerCase(),"webkit")&&!yt("Edge");function le(){var t=c.document;return t?t.documentMode:void 0}t:{var ue="",ce=function(){var t=it;return se?/rv:([^\);]+)(\)|;)/.exec(t):ie?/Edge\/([\d\.]+)/.exec(t):re?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):ae?/WebKit\/(\S+)/.exec(t):ne?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(ce&&(ue=ce?ce[1]:""),re){var he=le();if(null!=he&&he>parseFloat(ue)){ee=String(he);break t}}ee=ue}var de,pe={};function fe(t){return te(t,(function(){for(var e=0,n=ot(String(ee)).split("."),r=ot(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",a=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==s[0].length&&0==a[0].length)break;e=ft(0==s[1].length?0:parseInt(s[1],10),0==a[1].length?0:parseInt(a[1],10))||ft(0==s[2].length,0==a[2].length)||ft(s[2],a[2]),s=s[3],a=a[3]}while(0==e)}return 0<=e}))}if(c.document&&re){var ge=le();de=ge||(parseInt(ee,10)||void 0)}else de=void 0;var me=de;try{new self.OffscreenCanvas(0,0).getContext("2d")}catch(Qp){}var ye=!re||9<=Number(me);function be(t){var e=document;return"string"===typeof t?e.getElementById(t):t}function ve(t,e){bt(e,(function(e,n){e&&"object"==typeof e&&e.ta&&(e=e.sa()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:ke.hasOwnProperty(n)?t.setAttribute(ke[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e}))}var we,xe,ke={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function _e(t,e,n){var r=arguments,i=document,o=String(r[0]),s=r[1];if(!ye&&s&&(s.name||s.type)){if(o=["<",o],s.name&&o.push(' name="',Zt(s.name),'"'),s.type){o.push(' type="',Zt(s.type),'"');var a={};kt(a,s),delete a.type,s=a}o.push(">"),o=o.join("")}return o=Ce(i,o),s&&("string"===typeof s?o.className=s:Array.isArray(s)?o.className=s.join(" "):ve(o,s)),2<r.length&&Ie(i,o,r),o}function Ie(t,e,n){function r(n){n&&e.appendChild("string"===typeof n?t.createTextNode(n):n)}for(var i=2;i<n.length;i++){var o=n[i];if(!m(o)||b(o)&&0<o.nodeType)r(o);else{t:{if(o&&"number"==typeof o.length){if(b(o)){var s="function"==typeof o.item||"string"==typeof o.item;break t}if(y(o)){s="function"==typeof o.item;break t}}s=!1}q(s?rt(o):o,r)}}}function Ce(t,e){return e=String(e),"application/xhtml+xml"===t.contentType&&(e=e.toLowerCase()),t.createElement(e)}function Se(t){c.setTimeout((function(){throw t}),0)}function Te(){var t=c.MessageChannel;if("undefined"===typeof t&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!yt("Presto")&&(t=function(){var t=Ce(document,"IFRAME");t.style.display="none",document.documentElement.appendChild(t);var e=t.contentWindow;t=e.document,t.open(),t.close();var n="callImmediate"+Math.random(),r="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=I((function(t){"*"!=r&&t.origin!=r||t.data!=n||this.port1.onmessage()}),this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,r)}}}),"undefined"!==typeof t&&!yt("Trident")&&!yt("MSIE")){var e=new t,n={},r=n;return e.port1.onmessage=function(){if(void 0!==n.next){n=n.next;var t=n.Hb;n.Hb=null,t()}},function(t){r.next={Hb:t},r=r.next,e.port2.postMessage(0)}}return function(t){c.setTimeout(t,0)}}function Ee(t,e){xe||Ne(),Ae||(xe(),Ae=!0),Re.add(t,e)}function Ne(){if(c.Promise&&c.Promise.resolve){var t=c.Promise.resolve(void 0);xe=function(){t.then($e)}}else xe=function(){var t=$e;!y(c.setImmediate)||c.Window&&c.Window.prototype&&!yt("Edge")&&c.Window.prototype.setImmediate==c.setImmediate?(we||(we=Te()),we(t)):c.setImmediate(t)}}var Ae=!1,Re=new U;function $e(){for(var t;t=j();){try{t.a.call(t.b)}catch(e){Se(e)}W(V,t)}Ae=!1}function De(t,e){if(this.a=Oe,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=f)try{var n=this;t.call(e,(function(t){Ke(n,Fe,t)}),(function(t){if(!(t instanceof rn))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(e){}Ke(n,Me,t)}))}catch(r){Ke(this,Me,r)}}var Oe=0,Fe=2,Me=3;function Pe(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}Pe.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var Le=new B((function(){return new Pe}),(function(t){t.reset()}));function ze(t,e,n){var r=Le.get();return r.g=t,r.b=e,r.f=n,r}function Be(t){if(t instanceof De)return t;var e=new De(f);return Ke(e,Fe,t),e}function We(t){return new De((function(e,n){n(t)}))}function Ue(t,e,n){Xe(t,e,n,null)||Ee(C(e,t))}function Ve(t){return new De((function(e,n){var r=t.length,i=[];if(r)for(var o,s=function(t,n){r--,i[t]=n,0==r&&e(i)},a=function(t){n(t)},l=0;l<t.length;l++)o=t[l],Ue(o,C(s,l),a);else e(i)}))}function je(t){return new De((function(e){var n=t.length,r=[];if(n)for(var i,o=function(t,i,o){n--,r[t]=i?{Qb:!0,value:o}:{Qb:!1,reason:o},0==n&&e(r)},s=0;s<t.length;s++)i=t[s],Ue(i,C(o,s,!0),C(o,s,!1));else e(r)}))}function He(t,e){if(t.a==Oe)if(t.c){var n=t.c;if(n.b){for(var r=0,i=null,o=null,s=n.b;s&&(s.c||(r++,s.a==t&&(i=s),!(i&&1<r)));s=s.next)i||(o=s);i&&(n.a==Oe&&1==r?He(n,e):(o?(r=o,r.next==n.f&&(n.f=r),r.next=r.next.next):Ze(n),Qe(n,i,Me,e)))}t.c=null}else Ke(t,Me,e)}function Ge(t,e){t.b||t.a!=Fe&&t.a!=Me||Je(t),t.f?t.f.next=e:t.b=e,t.f=e}function qe(t,e,n,r){var i=ze(null,null,null);return i.a=new De((function(t,o){i.g=e?function(n){try{var i=e.call(r,n);t(i)}catch(s){o(s)}}:t,i.b=n?function(e){try{var i=n.call(r,e);void 0===i&&e instanceof rn?o(e):t(i)}catch(s){o(s)}}:o})),i.a.c=t,Ge(t,i),i.a}function Ke(t,e,n){t.a==Oe&&(t===n&&(e=Me,n=new TypeError("Promise cannot resolve to itself")),t.a=1,Xe(n,t.$c,t.ad,t)||(t.i=n,t.a=e,t.c=null,Je(t),e!=Me||n instanceof rn||en(t,n)))}function Xe(t,e,n,r){if(t instanceof De)return Ge(t,ze(e||f,n||null,r)),!0;if(M(t))return t.then(e,n,r),!0;if(b(t))try{var i=t.then;if(y(i))return Ye(t,i,e,n,r),!0}catch(o){return n.call(r,o),!0}return!1}function Ye(t,e,n,r,i){function o(t){a||(a=!0,r.call(i,t))}function s(t){a||(a=!0,n.call(i,t))}var a=!1;try{e.call(t,s,o)}catch(l){o(l)}}function Je(t){t.h||(t.h=!0,Ee(t.gc,t))}function Ze(t){var e=null;return t.b&&(e=t.b,t.b=e.next,e.next=null),t.b||(t.f=null),e}function Qe(t,e,n,r){if(n==Me&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,tn(e,n,r);else try{e.c?e.g.call(e.f):tn(e,n,r)}catch(i){nn.call(null,i)}W(Le,e)}function tn(t,e,n){e==Fe?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}function en(t,e){t.g=!0,Ee((function(){t.g&&nn.call(null,e)}))}De.prototype.then=function(t,e,n){return qe(this,y(t)?t:null,y(e)?e:null,n)},De.prototype.$goog_Thenable=!0,t=De.prototype,t.oa=function(t,e){return t=ze(t,t,e),t.c=!0,Ge(this,t),this},t.o=function(t,e){return qe(this,null,t,e)},t.cancel=function(t){if(this.a==Oe){var e=new rn(t);Ee((function(){He(this,e)}),this)}},t.$c=function(t){this.a=Oe,Ke(this,Fe,t)},t.ad=function(t){this.a=Oe,Ke(this,Me,t)},t.gc=function(){for(var t;t=Ze(this);)Qe(this,t,this.a,this.i);this.h=!1};var nn=Se;function rn(t){P.call(this,t)}function on(){0!=sn&&(an[v(this)]=this),this.ya=this.ya,this.pa=this.pa}T(rn,P),rn.prototype.name="cancel";var sn=0,an={};function ln(t){if(!t.ya&&(t.ya=!0,t.Da(),0!=sn)){var e=v(t);if(0!=sn&&t.pa&&0<t.pa.length)throw Error(t+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete an[e]}}on.prototype.ya=!1,on.prototype.Da=function(){if(this.pa)for(;this.pa.length;)this.pa.shift()()};var un=Object.freeze||function(t){return t},cn=!re||9<=Number(me),hn=re&&!fe("9"),dn=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{c.addEventListener("test",f,e),c.removeEventListener("test",f,e)}catch(n){}return t}();function pn(t,e){this.type=t,this.b=this.target=e,this.defaultPrevented=!1}function fn(t,e){if(pn.call(this,t?t.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.b=e,e=t.relatedTarget){if(se){t:{try{Qt(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"===typeof t.pointerType?t.pointerType:gn[t.pointerType]||"",this.a=t,t.defaultPrevented&&this.preventDefault()}}pn.prototype.preventDefault=function(){this.defaultPrevented=!0},T(fn,pn);var gn=un({2:"touch",3:"pen",4:"mouse"});fn.prototype.preventDefault=function(){fn.bb.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,hn)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}},fn.prototype.g=function(){return this.a};var mn="closure_listenable_"+(1e6*Math.random()|0),yn=0;function bn(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.Wa=i,this.key=++yn,this.wa=this.Qa=!1}function vn(t){t.wa=!0,t.listener=null,t.proxy=null,t.src=null,t.Wa=null}function wn(t){this.src=t,this.a={},this.b=0}function xn(t,e){var n=e.type;n in t.a&&tt(t.a[n],e)&&(vn(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function kn(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.wa&&o.listener==e&&o.capture==!!n&&o.Wa==r)return i}return-1}wn.prototype.add=function(t,e,n,r,i){var o=t.toString();t=this.a[o],t||(t=this.a[o]=[],this.b++);var s=kn(t,e,r,i);return-1<s?(e=t[s],n||(e.Qa=!1)):(e=new bn(e,this.src,o,!!r,i),e.Qa=n,t.push(e)),e};var _n="closure_lm_"+(1e6*Math.random()|0),In={};function Cn(t,e,n,r,i){if(r&&r.once)En(t,e,n,r,i);else if(Array.isArray(e))for(var o=0;o<e.length;o++)Cn(t,e[o],n,r,i);else n=Pn(n),t&&t[mn]?zn(t,e,n,b(r)?!!r.capture:!!r,i):Sn(t,e,n,!1,r,i)}function Sn(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=b(i)?!!i.capture:!!i,a=Fn(t);if(a||(t[_n]=a=new wn(t)),n=a.add(e,n,r,s,o),!n.proxy){if(r=Tn(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)dn||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Rn(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}0}}function Tn(){var t=On,e=cn?function(n){return t.call(e.src,e.listener,n)}:function(n){if(n=t.call(e.src,e.listener,n),!n)return n};return e}function En(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)En(t,e[o],n,r,i);else n=Pn(n),t&&t[mn]?Bn(t,e,n,b(r)?!!r.capture:!!r,i):Sn(t,e,n,!0,r,i)}function Nn(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)Nn(t,e[o],n,r,i);else r=b(r)?!!r.capture:!!r,n=Pn(n),t&&t[mn]?(t=t.v,e=String(e).toString(),e in t.a&&(o=t.a[e],n=kn(o,n,r,i),-1<n&&(vn(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--)))):t&&(t=Fn(t))&&(e=t.a[e.toString()],t=-1,e&&(t=kn(e,n,r,i)),(n=-1<t?e[t]:null)&&An(n))}function An(t){if("number"!==typeof t&&t&&!t.wa){var e=t.src;if(e&&e[mn])xn(e.v,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Rn(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Fn(e))?(xn(n,t),0==n.b&&(n.src=null,e[_n]=null)):vn(t)}}}function Rn(t){return t in In?In[t]:In[t]="on"+t}function $n(t,e,n,r){var i=!0;if((t=Fn(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.wa&&(o=Dn(o,r),i=i&&!1!==o)}return i}function Dn(t,e){var n=t.listener,r=t.Wa||t.src;return t.Qa&&An(t),n.call(r,e)}function On(t,e){if(t.wa)return!0;if(!cn){if(!e)t:{e=["window","event"];for(var n=c,r=0;r<e.length;r++)if(n=n[e[r]],null==n){e=null;break t}e=n}if(r=e,e=new fn(r,this),n=!0,!(0>r.keyCode||void 0!=r.returnValue)){t:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(s){i=!0}(i||void 0==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=e.b;i;i=i.parentNode)r.push(i);for(t=t.type,i=r.length-1;0<=i;i--){e.b=r[i];var o=$n(r[i],t,!0,e);n=n&&o}for(i=0;i<r.length;i++)e.b=r[i],o=$n(r[i],t,!1,e),n=n&&o}return n}return Dn(t,new fn(e,this))}function Fn(t){return t=t[_n],t instanceof wn?t:null}var Mn="__closure_events_fn_"+(1e9*Math.random()>>>0);function Pn(t){return y(t)?t:(t[Mn]||(t[Mn]=function(e){return t.handleEvent(e)}),t[Mn])}function Ln(){on.call(this),this.v=new wn(this),this.bc=this,this.hb=null}function zn(t,e,n,r,i){t.v.add(String(e),n,!1,r,i)}function Bn(t,e,n,r,i){t.v.add(String(e),n,!0,r,i)}function Wn(t,e,n,r){if(e=t.v.a[String(e)],!e)return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.wa&&s.capture==n){var a=s.listener,l=s.Wa||s.src;s.Qa&&xn(t.v,s),i=!1!==a.call(l,r)&&i}}return i&&!r.defaultPrevented}function Un(t,e,n){if(y(t))n&&(t=I(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=I(t.handleEvent,t)}return 2147483647<Number(e)?-1:c.setTimeout(t,e||0)}function Vn(t){var e=null;return new De((function(n,r){e=Un((function(){n(void 0)}),t),-1==e&&r(Error("Failed to schedule timer."))})).o((function(t){throw c.clearTimeout(e),t}))}function jn(t){if(t.X&&"function"==typeof t.X)return t.X();if("string"===typeof t)return t.split("");if(m(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}function Hn(t){if(t.Y&&"function"==typeof t.Y)return t.Y();if(!t.X||"function"!=typeof t.X){if(m(t)||"string"===typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}for(var r in e=[],n=0,t)e[n++]=r;return e}}function Gn(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(m(t)||"string"===typeof t)q(t,e,void 0);else for(var n=Hn(t),r=jn(t),i=r.length,o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}function qn(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof qn)for(n=t.Y(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Kn(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Xn(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)r=t.a[e],Xn(i,r)||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Xn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}T(Ln,on),Ln.prototype[mn]=!0,Ln.prototype.addEventListener=function(t,e,n,r){Cn(this,t,e,n,r)},Ln.prototype.removeEventListener=function(t,e,n,r){Nn(this,t,e,n,r)},Ln.prototype.dispatchEvent=function(t){var e,n=this.hb;if(n)for(e=[];n;n=n.hb)e.push(n);n=this.bc;var r=t.type||t;if("string"===typeof t)t=new pn(t,n);else if(t instanceof pn)t.target=t.target||n;else{var i=t;t=new pn(r,n),kt(t,i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.b=e[o];i=Wn(s,r,!0,t)&&i}if(s=t.b=n,i=Wn(s,r,!0,t)&&i,i=Wn(s,r,!1,t)&&i,e)for(o=0;o<e.length;o++)s=t.b=e[o],i=Wn(s,r,!1,t)&&i;return i},Ln.prototype.Da=function(){if(Ln.bb.Da.call(this),this.v){var t,e=this.v;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)vn(n[r]);delete e.a[t],e.b--}}this.hb=null},t=qn.prototype,t.X=function(){Kn(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},t.Y=function(){return Kn(this),this.a.concat()},t.clear=function(){this.b={},this.c=this.a.length=0},t.get=function(t,e){return Xn(this.b,t)?this.b[t]:e},t.set=function(t,e){Xn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},t.forEach=function(t,e){for(var n=this.Y(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Yn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Jn(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Zn(t,e){var n;this.a=this.l=this.c="",this.g=null,this.h=this.f="",this.i=!1,t instanceof Zn?(this.i=void 0!==e?e:t.i,Qn(this,t.c),this.l=t.l,this.a=t.a,tr(this,t.g),this.f=t.f,er(this,wr(t.b)),this.h=t.h):t&&(n=String(t).match(Yn))?(this.i=!!e,Qn(this,n[1]||"",!0),this.l=sr(n[2]||""),this.a=sr(n[3]||"",!0),tr(this,n[4]),this.f=sr(n[5]||"",!0),er(this,n[6]||"",!0),this.h=sr(n[7]||"")):(this.i=!!e,this.b=new fr(null,this.i))}function Qn(t,e,n){t.c=n?sr(e,!0):e,t.c&&(t.c=t.c.replace(/:$/,""))}function tr(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.g=e}else t.g=null}function er(t,e,n){e instanceof fr?(t.b=e,kr(t.b,t.i)):(n||(e=ar(e,dr)),t.b=new fr(e,t.i))}function nr(t,e,n){t.b.set(e,n)}function rr(t,e){return t.b.get(e)}function ir(t){return t instanceof Zn?new Zn(t):new Zn(t,void 0)}function or(t,e,n,r){var i=new Zn(null,void 0);return t&&Qn(i,t),e&&(i.a=e),n&&tr(i,n),r&&(i.f=r),i}function sr(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function ar(t,e,n){return"string"===typeof t?(t=encodeURI(t).replace(e,lr),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function lr(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(15&t).toString(16)}Zn.prototype.toString=function(){var t=[],e=this.c;e&&t.push(ar(e,ur,!0),":");var n=this.a;return(n||"file"==e)&&(t.push("//"),(e=this.l)&&t.push(ar(e,ur,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.g,null!=n&&t.push(":",String(n))),(n=this.f)&&(this.a&&"/"!=n.charAt(0)&&t.push("/"),t.push(ar(n,"/"==n.charAt(0)?hr:cr,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.h)&&t.push("#",ar(n,pr)),t.join("")},Zn.prototype.resolve=function(t){var e=new Zn(this),n=!!t.c;n?Qn(e,t.c):n=!!t.l,n?e.l=t.l:n=!!t.a,n?e.a=t.a:n=null!=t.g;var r=t.f;if(n)tr(e,t.g);else if(n=!!t.f){if("/"!=r.charAt(0))if(this.a&&!this.f)r="/"+r;else{var i=e.f.lastIndexOf("/");-1!=i&&(r=e.f.substr(0,i+1)+r)}if(i=r,".."==i||"."==i)r="";else if(pt(i,"./")||pt(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],s=0;s<i.length;){var a=i[s++];"."==a?r&&s==i.length&&o.push(""):".."==a?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&s==i.length&&o.push("")):(o.push(a),r=!0)}r=o.join("/")}else r=i}return n?e.f=r:n=""!==t.b.toString(),n?er(e,wr(t.b)):n=!!t.h,n&&(e.h=t.h),e};var ur=/[#\/\?@]/g,cr=/[#\?:]/g,hr=/[#\?]/g,dr=/[#\?@]/g,pr=/#/g;function fr(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function gr(t){t.a||(t.a=new qn,t.b=0,t.c&&Jn(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function mr(t){var e=Hn(t);if("undefined"==typeof e)throw Error("Keys are undefined");var n=new fr(null,void 0);t=jn(t);for(var r=0;r<e.length;r++){var i=e[r],o=t[r];Array.isArray(o)?vr(n,i,o):n.add(i,o)}return n}function yr(t,e){gr(t),e=xr(t,e),Xn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,t=t.a,Xn(t.b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Kn(t)))}function br(t,e){return gr(t),e=xr(t,e),Xn(t.a.b,e)}function vr(t,e,n){yr(t,e),0<n.length&&(t.c=null,t.a.set(xr(t,e),rt(n)),t.b+=n.length)}function wr(t){var e=new fr;return e.c=t.c,t.a&&(e.a=new qn(t.a),e.b=t.b),e}function xr(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function kr(t,e){e&&!t.f&&(gr(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(yr(this,e),vr(this,n,t))}),t)),t.f=e}function _r(t){var e=[];return Cr(new Ir,t,e),e.join("")}function Ir(){}function Cr(t,e,n){if(null==e)n.push("null");else{if("object"==typeof e){if(Array.isArray(e)){var r=e;e=r.length,n.push("[");for(var i="",o=0;o<e;o++)n.push(i),Cr(t,r[o],n),i=",";return void n.push("]")}if(!(e instanceof String||e instanceof Number||e instanceof Boolean)){for(r in n.push("{"),i="",e)Object.prototype.hasOwnProperty.call(e,r)&&(o=e[r],"function"!=typeof o&&(n.push(i),Er(r,n),n.push(":"),Cr(t,o,n),i=","));return void n.push("}")}e=e.valueOf()}switch(typeof e){case"string":Er(e,n);break;case"number":n.push(isFinite(e)&&!isNaN(e)?String(e):"null");break;case"boolean":n.push(String(e));break;case"function":n.push("null");break;default:throw Error("Unknown type: "+typeof e)}}}t=fr.prototype,t.add=function(t,e){gr(this),this.c=null,t=xr(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},t.clear=function(){this.a=this.c=null,this.b=0},t.forEach=function(t,e){gr(this),this.a.forEach((function(n,r){q(n,(function(n){t.call(e,n,r,this)}),this)}),this)},t.Y=function(){gr(this);for(var t=this.a.X(),e=this.a.Y(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},t.X=function(t){gr(this);var e=[];if("string"===typeof t)br(this,t)&&(e=nt(e,this.a.get(xr(this,t))));else{t=this.a.X();for(var n=0;n<t.length;n++)e=nt(e,t[n])}return e},t.set=function(t,e){return gr(this),this.c=null,t=xr(this,t),br(this,t)&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},t.get=function(t,e){return t?(t=this.X(t),0<t.length?String(t[0]):e):e},t.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.Y(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.X(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var Sr={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},Tr=/\uffff/.test("")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function Er(t,e){e.push('"',t.replace(Tr,(function(t){var e=Sr[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),Sr[t]=e),e})),'"')}function Nr(){var t=Qr();return re&&!!me&&11==me||/Edge\/\d+/.test(t)}function Ar(){return c.window&&c.window.location.href||self&&self.location&&self.location.href||""}function Rr(t,e){e=e||c.window;var n="about:blank";t&&(n=Lt(Ut(t)||Ht)),e.location.href=n}function $r(t,e){var n,r=[];for(n in t)n in e?typeof t[n]!=typeof e[n]?r.push(n):"object"==typeof t[n]&&null!=t[n]&&null!=e[n]?0<$r(t[n],e[n]).length&&r.push(n):t[n]!==e[n]&&r.push(n):r.push(n);for(n in e)n in t||r.push(n);return r}function Dr(){var t=Qr();return t=Yr(t)!=Xr?null:(t=t.match(/\sChrome\/(\d+)/i))&&2==t.length?parseInt(t[1],10):null,!(t&&30>t)&&(!re||!me||9<me)}function Or(t){return t=(t||Qr()).toLowerCase(),!!(t.match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function Fr(t){t=t||c.window;try{t.close()}catch(e){}}function Mr(t,e,n){var r=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-e)/2;for(s in e={width:e,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=Qr().toLowerCase(),r&&(e.target=r,pt(n,"crios/")&&(e.target="_blank")),Yr(Qr())==Kr&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),r=window,e=n instanceof Pt?n:Ut("undefined"!=typeof n.href?n.href:String(n))||Ht,n=t.target||n.target,i=[],t)switch(s){case"width":case"height":case"top":case"left":i.push(s+"="+t[s]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(s+"="+(t[s]?1:0))}var s=i.join(",");if((yt("iPhone")&&!yt("iPod")&&!yt("iPad")||yt("iPad")||yt("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(s=Ce(document,"A"),_t(s,"HTMLAnchorElement"),e=e instanceof Pt?e:Vt(e),s.href=Lt(e),s.setAttribute("target",n),t.noreferrer&&s.setAttribute("rel","noreferrer"),t=document.createEvent("MouseEvent"),t.initMouseEvent("click",!0,!0,r,1),s.dispatchEvent(t),s={}):t.noreferrer?(s=Yt("",r,n,s),t=Lt(e),s&&(oe&&pt(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),s.opener=null,t='<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+Zt(t)+'">',t=(r=Nt())?r.createHTML(t):t,t=new Gt(t,null,Kt),r=s.document)&&(r.write(qt(t)),r.close())):(s=Yt(e,r,n,s))&&t.noopener&&(s.opener=null),s)try{s.focus()}catch(a){}return s}function Pr(t){return new De((function(e){function n(){Vn(2e3).then((function(){if(t&&!t.closed)return n();e()}))}return n()}))}var Lr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,zr=/^[^@]+@[^@]+$/;function Br(){var t=null;return new De((function(e){"complete"==c.document.readyState?e():(t=function(){e()},En(window,"load",t))})).o((function(e){throw Nn(window,"load",t),e}))}function Wr(){return Ur(void 0)?Br().then((function(){return new De((function(t,e){var n=c.document,r=setTimeout((function(){e(Error("Cordova framework is not ready."))}),1e3);n.addEventListener("deviceready",(function(){clearTimeout(r),t()}),!1)}))})):We(Error("Cordova must run in an Android or iOS file scheme."))}function Ur(t){return t=t||Qr(),!("file:"!==ii()&&"ionic:"!==ii()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function Vr(){var t=c.window;try{return!(!t||t==t.top)}catch(e){return!1}}function jr(){return"undefined"!==typeof c.WorkerGlobalScope&&"function"===typeof c.importScripts}function Hr(){return r.Z.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":r.Z.INTERNAL.hasOwnProperty("node")?"Node":jr()?"Worker":"Browser"}function Gr(){var t=Hr();return"ReactNative"===t||"Node"===t}function qr(){for(var t=50,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}var Kr="Firefox",Xr="Chrome";function Yr(t){var e=t.toLowerCase();return pt(e,"opera/")||pt(e,"opr/")||pt(e,"opios/")?"Opera":pt(e,"iemobile")?"IEMobile":pt(e,"msie")||pt(e,"trident/")?"IE":pt(e,"edge/")?"Edge":pt(e,"firefox/")?Kr:pt(e,"silk/")?"Silk":pt(e,"blackberry")?"Blackberry":pt(e,"webos")?"Webos":!pt(e,"safari/")||pt(e,"chrome/")||pt(e,"crios/")||pt(e,"android")?!pt(e,"chrome/")&&!pt(e,"crios/")||pt(e,"edge/")?pt(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":Xr:"Safari"}var Jr={md:"FirebaseCore-web",od:"FirebaseUI-web"};function Zr(t,e){e=e||[];var n,r=[],i={};for(n in Jr)i[Jr[n]]=!0;for(n=0;n<e.length;n++)"undefined"!==typeof i[e[n]]&&(delete i[e[n]],r.push(e[n]));return r.sort(),e=r,e.length||(e=["FirebaseCore-web"]),r=Hr(),"Browser"===r?(i=Qr(),r=Yr(i)):"Worker"===r&&(i=Qr(),r=Yr(i)+"-"+r),r+"/JsCore/"+t+"/"+e.join(",")}function Qr(){return c.navigator&&c.navigator.userAgent||""}function ti(t,e){t=t.split("."),e=e||c;for(var n=0;n<t.length&&"object"==typeof e&&null!=e;n++)e=e[t[n]];return n!=t.length&&(e=void 0),e}function ei(){try{var t=c.localStorage,e=ui();if(t)return t.setItem(e,"1"),t.removeItem(e),!Nr()||!!c.indexedDB}catch(n){return jr()&&!!c.indexedDB}return!1}function ni(){return(ri()||"chrome-extension:"===ii()||Ur())&&!Gr()&&ei()&&!jr()}function ri(){return"http:"===ii()||"https:"===ii()}function ii(){return c.location&&c.location.protocol||null}function oi(t){return t=t||Qr(),!Or(t)&&Yr(t)!=Kr}function si(t){return"undefined"===typeof t?null:_r(t)}function ai(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!==t[e]&&void 0!==t[e]&&(n[e]=t[e]);return n}function li(t){if(null!==t)return JSON.parse(t)}function ui(t){return t||Math.floor(1e9*Math.random()).toString()}function ci(t){return t=t||Qr(),"Safari"!=Yr(t)&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function hi(){var t=c.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var n=0;n<t.CP.length;n++)t.CP[n]=null}function di(t,e){if(t>e)throw Error("Short delay should be less than long delay!");this.a=t,this.c=e,t=Qr(),e=Hr(),this.b=Or(t)||"ReactNative"===e}function pi(){var t=c.document;return!t||"undefined"===typeof t.visibilityState||"visible"==t.visibilityState}function fi(){var t=c.document,e=null;return pi()||!t?Be():new De((function(n){e=function(){pi()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)})).o((function(n){throw t.removeEventListener("visibilitychange",e,!1),n}))}function gi(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(n){}return null}function mi(){return!(!ti("fireauth.oauthhelper",c)&&!ti("fireauth.iframe",c))}function yi(){var t=c.navigator;return t&&t.serviceWorker&&t.serviceWorker.controller||null}function bi(){var t=c.navigator;return t&&t.serviceWorker?Be().then((function(){return t.serviceWorker.ready})).then((function(t){return t.active||null})).o((function(){return null})):Be(null)}di.prototype.get=function(){var t=c.navigator;return!t||"boolean"!==typeof t.onLine||!ri()&&"chrome-extension:"!==ii()&&"undefined"===typeof t.connection||t.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var vi,wi={};function xi(t){wi[t]||(wi[t]=!0,"undefined"!==typeof console&&"function"===typeof console.warn&&console.warn(t))}try{var ki={};Object.defineProperty(ki,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(ki,"abcd",{configurable:!0,enumerable:!0,value:2}),vi=2==ki.abcd}catch(Qp){vi=!1}function _i(t,e,n){vi?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function Ii(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&_i(t,n,e[n])}function Ci(t){var e={};return Ii(e,t),e}function Si(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}function Ti(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var r=t[e[n]];if(void 0===r||null===r||""===r)return!1}return!0}function Ei(t){var e=t;if("object"==typeof t&&null!=t)for(var n in e="length"in t?[]:{},t)_i(e,n,Ei(t[n]));return e}function Ni(t){var e=t&&(t[Oi]?"phone":null);if(!(e&&t&&t[Di]))throw new N("internal-error","Internal assert: invalid MultiFactorInfo object");_i(this,"uid",t[Di]),_i(this,"displayName",t[Ri]||null);var n=null;t[$i]&&(n=new Date(t[$i]).toUTCString()),_i(this,"enrollmentTime",n),_i(this,"factorId",e)}function Ai(t){try{var e=new Fi(t)}catch(n){e=null}return e}Ni.prototype.w=function(){return{uid:this.uid,displayName:this.displayName,factorId:this.factorId,enrollmentTime:this.enrollmentTime}};var Ri="displayName",$i="enrolledAt",Di="mfaEnrollmentId",Oi="phoneInfo";function Fi(t){Ni.call(this,t),_i(this,"phoneNumber",t[Oi])}function Mi(t){var e={},n=t[Bi],r=t[Ui],i=t[Vi];if(t=Ai(t[Wi]),!i||i!=Li&&i!=zi&&!n||i==zi&&!r||i==Pi&&!t)throw Error("Invalid checkActionCode response!");i==zi?(e[Hi]=n||null,e[qi]=n||null,e[ji]=r):(e[Hi]=r||null,e[qi]=r||null,e[ji]=n||null),e[Gi]=t||null,_i(this,Xi,i),_i(this,Ki,Ei(e))}T(Fi,Ni),Fi.prototype.w=function(){var t=Fi.bb.w.call(this);return t.phoneNumber=this.phoneNumber,t};var Pi="REVERT_SECOND_FACTOR_ADDITION",Li="EMAIL_SIGNIN",zi="VERIFY_AND_CHANGE_EMAIL",Bi="email",Wi="mfaInfo",Ui="newEmail",Vi="requestType",ji="email",Hi="fromEmail",Gi="multiFactorInfo",qi="previousEmail",Ki="data",Xi="operation";function Yi(t){t=ir(t);var e=rr(t,Ji)||null,n=rr(t,Zi)||null,r=rr(t,eo)||null;if(r=r&&ro[r]||null,!e||!n||!r)throw new N("argument-error",Ji+", "+Zi+"and "+eo+" are required in a valid action code URL.");Ii(this,{apiKey:e,operation:r,code:n,continueUrl:rr(t,Qi)||null,languageCode:rr(t,to)||null,tenantId:rr(t,no)||null})}var Ji="apiKey",Zi="oobCode",Qi="continueUrl",to="languageCode",eo="mode",no="tenantId",ro={recoverEmail:"RECOVER_EMAIL",resetPassword:"PASSWORD_RESET",revertSecondFactorAddition:Pi,signIn:Li,verifyAndChangeEmail:zi,verifyEmail:"VERIFY_EMAIL"};function io(t){try{return new Yi(t)}catch(e){return null}}function oo(t){var e=t[co];if("undefined"===typeof e)throw new N("missing-continue-uri");if("string"!==typeof e||"string"===typeof e&&!e.length)throw new N("invalid-continue-uri");this.h=e,this.b=this.a=null,this.g=!1;var n=t[so];if(n&&"object"===typeof n){e=n[fo];var r=n[ho];if(n=n[po],"string"===typeof e&&e.length){if(this.a=e,"undefined"!==typeof r&&"boolean"!==typeof r)throw new N("argument-error",ho+" property must be a boolean when specified.");if(this.g=!!r,"undefined"!==typeof n&&("string"!==typeof n||"string"===typeof n&&!n.length))throw new N("argument-error",po+" property must be a non empty string when specified.");this.b=n||null}else{if("undefined"!==typeof e)throw new N("argument-error",fo+" property must be a non empty string when specified.");if("undefined"!==typeof r||"undefined"!==typeof n)throw new N("missing-android-pkg-name")}}else if("undefined"!==typeof n)throw new N("argument-error",so+" property must be a non null object when specified.");if(this.f=null,(e=t[uo])&&"object"===typeof e){if(e=e[go],"string"===typeof e&&e.length)this.f=e;else if("undefined"!==typeof e)throw new N("argument-error",go+" property must be a non empty string when specified.")}else if("undefined"!==typeof e)throw new N("argument-error",uo+" property must be a non null object when specified.");if(e=t[lo],"undefined"!==typeof e&&"boolean"!==typeof e)throw new N("argument-error",lo+" property must be a boolean when specified.");if(this.c=!!e,t=t[ao],"undefined"!==typeof t&&("string"!==typeof t||"string"===typeof t&&!t.length))throw new N("argument-error",ao+" property must be a non empty string when specified.");this.i=t||null}var so="android",ao="dynamicLinkDomain",lo="handleCodeInApp",uo="iOS",co="url",ho="installApp",po="minimumVersion",fo="packageName",go="bundleId";function mo(t){var e={};for(var n in e.continueUrl=t.h,e.canHandleCodeInApp=t.c,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.b,e.androidInstallApp=t.g),e.iOSBundleId=t.f,e.dynamicLinkDomain=t.i,e)null===e[n]&&delete e[n];return e}function yo(t){return Y(t,(function(t){return t=t.toString(16),1<t.length?t:"0"+t})).join("")}var bo=null;function vo(t){var e=[];return wo(t,(function(t){e.push(t)})),e}function wo(t,e){function n(e){for(;r<t.length;){var n=t.charAt(r++),i=bo[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}xo();for(var r=0;;){var i=n(-1),o=n(0),s=n(64),a=n(64);if(64===a&&-1===i)break;e(i<<2|o>>4),64!=s&&(e(o<<4&240|s>>2),64!=a&&e(s<<6&192|a))}}function xo(){if(!bo){bo={};for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),e=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++)for(var r=t.concat(e[n].split("")),i=0;i<r.length;i++){var o=r[i];void 0===bo[o]&&(bo[o]=i)}}}function ko(t){var e=Io(t);if(!(e&&e.sub&&e.iss&&e.aud&&e.exp))throw Error("Invalid JWT");this.h=t,this.a=e.exp,this.i=e.sub,t=Date.now()/1e3,this.g=e.iat||(t>this.a?this.a:t),this.b=e.provider_id||e.firebase&&e.firebase.sign_in_provider||null,this.f=e.firebase&&e.firebase.tenant||null,this.c=!!e.is_anonymous||"anonymous"==this.b}function _o(t){try{return new ko(t)}catch(e){return null}}function Io(t){if(!t)return null;if(t=t.split("."),3!=t.length)return null;t=t[1];for(var e=(4-t.length%4)%4,n=0;n<e;n++)t+=".";try{var r=vo(t);for(t=[],n=e=0;e<r.length;){var i=r[e++];if(128>i)t[n++]=String.fromCharCode(i);else if(191<i&&224>i){var o=r[e++];t[n++]=String.fromCharCode((31&i)<<6|63&o)}else if(239<i&&365>i){o=r[e++];var s=r[e++],a=r[e++],l=((7&i)<<18|(63&o)<<12|(63&s)<<6|63&a)-65536;t[n++]=String.fromCharCode(55296+(l>>10)),t[n++]=String.fromCharCode(56320+(1023&l))}else o=r[e++],s=r[e++],t[n++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}return JSON.parse(t.join(""))}catch(u){}return null}ko.prototype.T=function(){return this.f},ko.prototype.l=function(){return this.c},ko.prototype.toString=function(){return this.h};var Co="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),So=["client_id","response_type","scope","redirect_uri","state"],To={nd:{Ja:"locale",va:700,ua:600,fa:"facebook.com",Ya:So},pd:{Ja:null,va:500,ua:750,fa:"github.com",Ya:So},qd:{Ja:"hl",va:515,ua:680,fa:"google.com",Ya:So},wd:{Ja:"lang",va:485,ua:705,fa:"twitter.com",Ya:Co},kd:{Ja:"locale",va:640,ua:600,fa:"apple.com",Ya:[]}};function Eo(t){for(var e in To)if(To[e].fa==t)return To[e];return null}function No(t){var e={};e["facebook.com"]=Oo,e["google.com"]=Mo,e["github.com"]=Fo,e["twitter.com"]=Po;var n=t&&t[Ro];try{if(n)return e[n]?new e[n](t):new Do(t);if("undefined"!==typeof t[Ao])return new $o(t)}catch(r){}return null}var Ao="idToken",Ro="providerId";function $o(t){var e=t[Ro];if(!e&&t[Ao]){var n=_o(t[Ao]);n&&n.b&&(e=n.b)}if(!e)throw Error("Invalid additional user info!");"anonymous"!=e&&"custom"!=e||(e=null),n=!1,"undefined"!==typeof t.isNewUser?n=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(n=!0),_i(this,"providerId",e),_i(this,"isNewUser",n)}function Do(t){$o.call(this,t),t=li(t.rawUserInfo||"{}"),_i(this,"profile",Ei(t||{}))}function Oo(t){if(Do.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function Fo(t){if(Do.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");_i(this,"username",this.profile&&this.profile.login||null)}function Mo(t){if(Do.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function Po(t){if(Do.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");_i(this,"username",t.screenName||null)}function Lo(t){var e=ir(t),n=rr(e,"link"),r=rr(ir(n),"link");return e=rr(e,"deep_link_id"),rr(ir(e),"link")||e||r||n||t}function zo(t,e){if(!t&&!e)throw new N("internal-error","Internal assert: no raw session string available");if(t&&e)throw new N("internal-error","Internal assert: unable to determine the session type");this.a=t||null,this.b=e||null,this.type=this.a?Bo:Wo}T(Do,$o),T(Oo,Do),T(Fo,Do),T(Mo,Do),T(Po,Do);var Bo="enroll",Wo="signin";function Uo(){}function Vo(t,e){return t.then((function(t){if(t[Ma]){var n=_o(t[Ma]);if(!n||e!=n.i)throw new N("user-mismatch");return t}throw new N("user-mismatch")})).o((function(t){throw t&&t.code&&t.code==$+"user-not-found"?new N("user-mismatch"):t}))}function jo(t,e){if(!e)throw new N("internal-error","failed to construct a credential");this.a=e,_i(this,"providerId",t),_i(this,"signInMethod",t)}function Ho(t){return{pendingToken:t.a,requestUri:"http://localhost"}}function Go(t){if(t&&t.providerId&&t.signInMethod&&0==t.providerId.indexOf("saml.")&&t.pendingToken)try{return new jo(t.providerId,t.pendingToken)}catch(e){}return null}function qo(t,e,n){if(this.a=null,e.idToken||e.accessToken)e.idToken&&_i(this,"idToken",e.idToken),e.accessToken&&_i(this,"accessToken",e.accessToken),e.nonce&&!e.pendingToken&&_i(this,"nonce",e.nonce),e.pendingToken&&(this.a=e.pendingToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new N("internal-error","failed to construct a credential");_i(this,"accessToken",e.oauthToken),_i(this,"secret",e.oauthTokenSecret)}_i(this,"providerId",t),_i(this,"signInMethod",n)}function Ko(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,t.nonce&&!t.a&&(e.nonce=t.nonce),e={postBody:mr(e).toString(),requestUri:"http://localhost"},t.a&&(delete e.postBody,e.pendingToken=t.a),e}function Xo(t){if(t&&t.providerId&&t.signInMethod){var e={idToken:t.oauthIdToken,accessToken:t.oauthTokenSecret?null:t.oauthAccessToken,oauthTokenSecret:t.oauthTokenSecret,oauthToken:t.oauthTokenSecret&&t.oauthAccessToken,nonce:t.nonce,pendingToken:t.pendingToken};try{return new qo(t.providerId,e,t.signInMethod)}catch(n){}}return null}function Yo(t,e){this.Qc=e||[],Ii(this,{providerId:t,isOAuthProvider:!0}),this.Jb={},this.qb=(Eo(t)||{}).Ja||null,this.pb=null}function Jo(t){if("string"!==typeof t||0!=t.indexOf("saml."))throw new N("argument-error",'SAML provider IDs must be prefixed with "saml."');Yo.call(this,t,[])}function Zo(t){Yo.call(this,t,So),this.a=[]}function Qo(){Zo.call(this,"facebook.com")}function ts(t){if(!t)throw new N("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return b(t)&&(e=t.accessToken),(new Qo).credential({accessToken:e})}function es(){Zo.call(this,"github.com")}function ns(t){if(!t)throw new N("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return b(t)&&(e=t.accessToken),(new es).credential({accessToken:e})}function rs(){Zo.call(this,"google.com"),this.Ca("profile")}function is(t,e){var n=t;return b(t)&&(n=t.idToken,e=t.accessToken),(new rs).credential({idToken:n,accessToken:e})}function os(){Yo.call(this,"twitter.com",Co)}function ss(t,e){var n=t;if(b(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new N("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new qo("twitter.com",n,"twitter.com")}function as(t,e,n){this.a=t,this.f=e,_i(this,"providerId","password"),_i(this,"signInMethod",n===us.EMAIL_LINK_SIGN_IN_METHOD?us.EMAIL_LINK_SIGN_IN_METHOD:us.EMAIL_PASSWORD_SIGN_IN_METHOD)}function ls(t){return t&&t.email&&t.password?new as(t.email,t.password,t.signInMethod):null}function us(){Ii(this,{providerId:"password",isOAuthProvider:!1})}function cs(t,e){if(e=hs(e),!e)throw new N("argument-error","Invalid email link!");return new as(t,e.code,us.EMAIL_LINK_SIGN_IN_METHOD)}function hs(t){return t=Lo(t),(t=io(t))&&t.operation===Li?t:null}function ds(t){if(!(t.fb&&t.eb||t.La&&t.ea))throw new N("internal-error");this.a=t,_i(this,"providerId","phone"),this.fa="phone",_i(this,"signInMethod","phone")}function ps(t){if(t&&"phone"===t.providerId&&(t.verificationId&&t.verificationCode||t.temporaryProof&&t.phoneNumber)){var e={};return q(["verificationId","verificationCode","temporaryProof","phoneNumber"],(function(n){t[n]&&(e[n]=t[n])})),new ds(e)}return null}function fs(t){return t.a.La&&t.a.ea?{temporaryProof:t.a.La,phoneNumber:t.a.ea}:{sessionInfo:t.a.fb,code:t.a.eb}}function gs(t){try{this.a=t||r.Z.auth()}catch(e){throw new N("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}Ii(this,{providerId:"phone",isOAuthProvider:!1})}function ms(t,e){if(!t)throw new N("missing-verification-id");if(!e)throw new N("missing-verification-code");return new ds({fb:t,eb:e})}function ys(t){if(t.temporaryProof&&t.phoneNumber)return new ds({La:t.temporaryProof,ea:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,r=t&&t.oauthTokenSecret,i=t&&t.nonce,o=t&&t.oauthIdToken,s=t&&t.pendingToken;try{switch(e){case"google.com":return is(o,n);case"facebook.com":return ts(n);case"github.com":return ns(n);case"twitter.com":return ss(n,r);default:return n||r||o||s?s?0==e.indexOf("saml.")?new jo(e,s):new qo(e,{pendingToken:s,idToken:t.oauthIdToken,accessToken:t.oauthAccessToken},e):new Zo(e).credential({idToken:o,accessToken:n,rawNonce:i}):null}}catch(a){return null}}function bs(t){if(!t.isOAuthProvider)throw new N("invalid-oauth-provider")}function vs(t,e,n,r,i,o,s){if(this.c=t,this.b=e||null,this.g=n||null,this.f=r||null,this.i=o||null,this.h=s||null,this.a=i||null,!this.g&&!this.a)throw new N("invalid-auth-event");if(this.g&&this.a)throw new N("invalid-auth-event");if(this.g&&!this.f)throw new N("invalid-auth-event")}function ws(t){return t=t||{},t.type?new vs(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&A(t.error),t.postBody,t.tenantId):null}function xs(){this.b=null,this.a=[]}zo.prototype.Ha=function(){return this.a?Be(this.a):Be(this.b)},zo.prototype.w=function(){return this.type==Bo?{multiFactorSession:{idToken:this.a}}:{multiFactorSession:{pendingCredential:this.b}}},Uo.prototype.ka=function(){},Uo.prototype.b=function(){},Uo.prototype.c=function(){},Uo.prototype.w=function(){},jo.prototype.ka=function(t){return dl(t,Ho(this))},jo.prototype.b=function(t,e){var n=Ho(this);return n.idToken=e,pl(t,n)},jo.prototype.c=function(t,e){return Vo(fl(t,Ho(this)),e)},jo.prototype.w=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},qo.prototype.ka=function(t){return dl(t,Ko(this))},qo.prototype.b=function(t,e){var n=Ko(this);return n.idToken=e,pl(t,n)},qo.prototype.c=function(t,e){var n=Ko(this);return Vo(fl(t,n),e)},qo.prototype.w=function(){var t={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),this.nonce&&(t.nonce=this.nonce),this.a&&(t.pendingToken=this.a),t},Yo.prototype.Ka=function(t){return this.Jb=wt(t),this},T(Jo,Yo),T(Zo,Yo),Zo.prototype.Ca=function(t){return Q(this.a,t)||this.a.push(t),this},Zo.prototype.Rb=function(){return rt(this.a)},Zo.prototype.credential=function(t,e){var n;if(n=b(t)?{idToken:t.idToken||null,accessToken:t.accessToken||null,nonce:t.rawNonce||null}:{idToken:t||null,accessToken:e||null},!n.idToken&&!n.accessToken)throw new N("argument-error","credential failed: must provide the ID token and/or the access token.");return new qo(this.providerId,n,this.providerId)},T(Qo,Zo),_i(Qo,"PROVIDER_ID","facebook.com"),_i(Qo,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),T(es,Zo),_i(es,"PROVIDER_ID","github.com"),_i(es,"GITHUB_SIGN_IN_METHOD","github.com"),T(rs,Zo),_i(rs,"PROVIDER_ID","google.com"),_i(rs,"GOOGLE_SIGN_IN_METHOD","google.com"),T(os,Yo),_i(os,"PROVIDER_ID","twitter.com"),_i(os,"TWITTER_SIGN_IN_METHOD","twitter.com"),as.prototype.ka=function(t){return this.signInMethod==us.EMAIL_LINK_SIGN_IN_METHOD?Xl(t,kl,{email:this.a,oobCode:this.f}):Xl(t,jl,{email:this.a,password:this.f})},as.prototype.b=function(t,e){return this.signInMethod==us.EMAIL_LINK_SIGN_IN_METHOD?Xl(t,_l,{idToken:e,email:this.a,oobCode:this.f}):Xl(t,Ml,{idToken:e,email:this.a,password:this.f})},as.prototype.c=function(t,e){return Vo(this.ka(t),e)},as.prototype.w=function(){return{email:this.a,password:this.f,signInMethod:this.signInMethod}},Ii(us,{PROVIDER_ID:"password"}),Ii(us,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),Ii(us,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),ds.prototype.ka=function(t){return t.gb(fs(this))},ds.prototype.b=function(t,e){var n=fs(this);return n.idToken=e,Xl(t,Gl,n)},ds.prototype.c=function(t,e){var n=fs(this);return n.operation="REAUTH",t=Xl(t,ql,n),Vo(t,e)},ds.prototype.w=function(){var t={providerId:"phone"};return this.a.fb&&(t.verificationId=this.a.fb),this.a.eb&&(t.verificationCode=this.a.eb),this.a.La&&(t.temporaryProof=this.a.La),this.a.ea&&(t.phoneNumber=this.a.ea),t},gs.prototype.gb=function(t,e){var n=this.a.a;return Be(e.verify()).then((function(r){if("string"!==typeof r)throw new N("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(e.type){case"recaptcha":var i,o=b(t)?t.session:null,s=b(t)?t.phoneNumber:t;return i=o&&o.type==Bo?o.Ha().then((function(t){return ol(n,{idToken:t,phoneEnrollmentInfo:{phoneNumber:s,recaptchaToken:r}})})):o&&o.type==Wo?o.Ha().then((function(e){return al(n,{mfaPendingCredential:e,mfaEnrollmentId:t.multiFactorHint&&t.multiFactorHint.uid||t.multiFactorUid,phoneSignInInfo:{recaptchaToken:r}})})):il(n,{phoneNumber:s,recaptchaToken:r}),i.then((function(t){return"function"===typeof e.reset&&e.reset(),t}),(function(t){throw"function"===typeof e.reset&&e.reset(),t}));default:throw new N("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}}))},Ii(gs,{PROVIDER_ID:"phone"}),Ii(gs,{PHONE_SIGN_IN_METHOD:"phone"}),vs.prototype.getUid=function(){var t=[];return t.push(this.c),this.b&&t.push(this.b),this.f&&t.push(this.f),this.h&&t.push(this.h),t.join("-")},vs.prototype.T=function(){return this.h},vs.prototype.w=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.i,tenantId:this.h,error:this.a&&this.a.w()}};var ks,_s=null;function Is(t){var e=_s;e.a.push(t),e.b||(e.b=function(t){for(var n=0;n<e.a.length;n++)e.a[n](t)},t=ti("universalLinks.subscribe",c),"function"===typeof t&&t(null,e.b))}function Cs(t){var e="unauthorized-domain",n=void 0,r=ir(t);t=r.a,r=r.c,"chrome-extension"==r?n=Jt("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==r||"https"==r?n=Jt("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",N.call(this,e,n)}function Ss(t,e,n){N.call(this,t,n),t=e||{},t.Kb&&_i(this,"email",t.Kb),t.ea&&_i(this,"phoneNumber",t.ea),t.credential&&_i(this,"credential",t.credential),t.$b&&_i(this,"tenantId",t.$b)}function Ts(t){if(t.code){var e=t.code||"";0==e.indexOf($)&&(e=e.substring($.length));var n={credential:ys(t),$b:t.tenantId};if(t.email)n.Kb=t.email;else if(t.phoneNumber)n.ea=t.phoneNumber;else if(!n.credential)return new N(e,t.message||void 0);return new Ss(e,n,t.message)}return null}function Es(){}function Ns(t){return t.c||(t.c=t.b())}function As(){}function Rs(t){if(!t.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var r=e[n];try{return new ActiveXObject(r),t.f=r}catch(i){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.f}function $s(){}function Ds(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=I(this.qc,this),this.a.onerror=I(this.Tb,this),this.a.onprogress=I(this.rc,this),this.a.ontimeout=I(this.vc,this)}function Os(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function Fs(t,e,n){this.reset(t,e,n,void 0,void 0)}T(Cs,N),T(Ss,N),Ss.prototype.w=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber),this.tenantId&&(t.tenantId=this.tenantId);var e=this.credential&&this.credential.w();return e&&kt(t,e),t},Ss.prototype.toJSON=function(){return this.w()},Es.prototype.c=null,T(As,Es),As.prototype.a=function(){var t=Rs(this);return t?new ActiveXObject(t):new XMLHttpRequest},As.prototype.b=function(){var t={};return Rs(this)&&(t[0]=!0,t[1]=!0),t},ks=new As,T($s,Es),$s.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new Ds;throw Error("Unsupported browser")},$s.prototype.b=function(){return{}},t=Ds.prototype,t.open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},t.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.a.send(t)}else this.a.send()},t.abort=function(){this.a.abort()},t.setRequestHeader=function(){},t.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},t.qc=function(){this.status=200,this.response=this.responseText=this.a.responseText,Os(this,4)},t.Tb=function(){this.status=500,this.response=this.responseText="",Os(this,4)},t.vc=function(){this.Tb()},t.rc=function(){this.status=200,Os(this,1)},t.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},Fs.prototype.a=null;function Ms(t){this.f=t,this.b=this.c=this.a=null}function Ps(t,e){this.name=t,this.value=e}Fs.prototype.reset=function(t,e,n,r,i){"number"==typeof i||0,r||S(),delete this.a},Ps.prototype.toString=function(){return this.name};var Ls=new Ps("SEVERE",1e3),zs=new Ps("WARNING",900),Bs=new Ps("CONFIG",700),Ws=new Ps("FINE",500);function Us(t){return t.c?t.c:t.a?Us(t.a):(z("Root logger has no level set."),null)}Ms.prototype.log=function(t,e,n){if(t.value>=Us(this).value)for(y(e)&&(e=e()),t=new Fs(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var Vs={},js=null;function Hs(t){var e;if(js||(js=new Ms(""),Vs[""]=js,js.c=Bs),!(e=Vs[t])){e=new Ms(t);var n=t.lastIndexOf("."),r=t.substr(n+1);n=Hs(t.substr(0,n)),n.b||(n.b={}),n.b[r]=e,e.a=n,Vs[t]=e}return e}function Gs(t,e){t&&t.log(Ws,e,void 0)}function qs(t){this.f=t}function Ks(t){Ln.call(this),this.u=t,this.h=void 0,this.readyState=Xs,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.l=new Headers,this.b=null,this.s="GET",this.f="",this.a=!1,this.i=Hs("goog.net.FetchXmlHttp"),this.m=this.c=this.g=null}T(qs,Es),qs.prototype.a=function(){return new Ks(this.f)},qs.prototype.b=function(t){return function(){return t}}({}),T(Ks,Ln);var Xs=0;function Ys(t){t.c.read().then(t.pc.bind(t)).catch(t.Va.bind(t))}function Js(t){t.readyState=4,t.g=null,t.c=null,t.m=null,Zs(t)}function Zs(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function Qs(t){Ln.call(this),this.headers=new qn,this.D=t||null,this.c=!1,this.C=this.a=null,this.h=this.P=this.l="",this.f=this.N=this.i=this.J=!1,this.g=0,this.s=null,this.m=ta,this.u=this.S=!1}t=Ks.prototype,t.open=function(t,e){if(this.readyState!=Xs)throw this.abort(),Error("Error reopening a connection");this.s=t,this.f=e,this.readyState=1,Zs(this)},t.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.l,method:this.s,credentials:this.h,cache:void 0};t&&(e.body=t),this.u.fetch(new Request(this.f,e)).then(this.uc.bind(this),this.Va.bind(this))},t.abort=function(){this.response=this.responseText="",this.l=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,Js(this)),this.readyState=Xs},t.uc=function(t){this.a&&(this.g=t,this.b||(this.status=this.g.status,this.statusText=this.g.statusText,this.b=t.headers,this.readyState=2,Zs(this)),this.a&&(this.readyState=3,Zs(this),this.a&&("arraybuffer"===this.responseType?t.arrayBuffer().then(this.sc.bind(this),this.Va.bind(this)):"undefined"!==typeof c.ReadableStream&&"body"in t?(this.response=this.responseText="",this.c=t.body.getReader(),this.m=new TextDecoder,Ys(this)):t.text().then(this.tc.bind(this),this.Va.bind(this)))))},t.pc=function(t){if(this.a){var e=this.m.decode(t.value?t.value:new Uint8Array(0),{stream:!t.done});e&&(this.response=this.responseText+=e),t.done?Js(this):Zs(this),3==this.readyState&&Ys(this)}},t.tc=function(t){this.a&&(this.response=this.responseText=t,Js(this))},t.sc=function(t){this.a&&(this.response=t,Js(this))},t.Va=function(t){var e=this.i;e&&e.log(zs,"Failed to fetch url "+this.f,t instanceof Error?t:Error(t)),this.a&&Js(this)},t.setRequestHeader=function(t,e){this.l.append(t,e)},t.getResponseHeader=function(t){return this.b?this.b.get(t.toLowerCase())||"":((t=this.i)&&t.log(zs,"Attempting to get response header but no headers have been received for url: "+this.f,void 0),"")},t.getAllResponseHeaders=function(){if(!this.b){var t=this.i;return t&&t.log(zs,"Attempting to get all response headers but no headers have been received for url: "+this.f,void 0),""}t=[];for(var e=this.b.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Ks.prototype,"withCredentials",{get:function(){return"include"===this.h},set:function(t){this.h=t?"include":"same-origin"}}),T(Qs,Ln);var ta="";Qs.prototype.b=Hs("goog.net.XhrIo");var ea=/^https?$/i,na=["POST","PUT"];function ra(t,e,n,r,i){if(t.a)throw Error("[goog.net.XhrIo] Object is active with another request="+t.l+"; newUri="+e);n=n?n.toUpperCase():"GET",t.l=e,t.h="",t.P=n,t.J=!1,t.c=!0,t.a=t.D?t.D.a():ks.a(),t.C=t.D?Ns(t.D):Ns(ks),t.a.onreadystatechange=I(t.Wb,t);try{Gs(t.b,fa(t,"Opening Xhr")),t.N=!0,t.a.open(n,String(e),!0),t.N=!1}catch(s){return Gs(t.b,fa(t,"Error opening Xhr: "+s.message)),void sa(t,s)}e=r||"";var o=new qn(t.headers);i&&Gn(i,(function(t,e){o.set(e,t)})),i=Z(o.Y()),r=c.FormData&&e instanceof c.FormData,!Q(na,n)||i||r||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach((function(t,e){this.a.setRequestHeader(e,t)}),t),t.m&&(t.a.responseType=t.m),"withCredentials"in t.a&&t.a.withCredentials!==t.S&&(t.a.withCredentials=t.S);try{ca(t),0<t.g&&(t.u=ia(t.a),Gs(t.b,fa(t,"Will abort after "+t.g+"ms if incomplete, xhr2 "+t.u)),t.u?(t.a.timeout=t.g,t.a.ontimeout=I(t.Ma,t)):t.s=Un(t.Ma,t.g,t)),Gs(t.b,fa(t,"Sending request")),t.i=!0,t.a.send(e),t.i=!1}catch(s){Gs(t.b,fa(t,"Send error: "+s.message)),sa(t,s)}}function ia(t){return re&&fe(9)&&"number"===typeof t.timeout&&void 0!==t.ontimeout}function oa(t){return"content-type"==t.toLowerCase()}function sa(t,e){t.c=!1,t.a&&(t.f=!0,t.a.abort(),t.f=!1),t.h=e,aa(t),ua(t)}function aa(t){t.J||(t.J=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function la(t){if(t.c&&"undefined"!=typeof u)if(t.C[1]&&4==ha(t)&&2==da(t))Gs(t.b,fa(t,"Local request error detected and ignored"));else if(t.i&&4==ha(t))Un(t.Wb,0,t);else if(t.dispatchEvent("readystatechange"),4==ha(t)){Gs(t.b,fa(t,"Request complete")),t.c=!1;try{var e,n=da(t);t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.l).match(Yn)[1]||null;if(!o&&c.self&&c.self.location){var s=c.self.location.protocol;o=s.substr(0,s.length-1)}i=!ea.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{try{var a=2<ha(t)?t.a.statusText:""}catch(l){Gs(t.b,"Can not get status: "+l.message),a=""}t.h=a+" ["+da(t)+"]",aa(t)}}finally{ua(t)}}}function ua(t,e){if(t.a){ca(t);var n=t.a,r=t.C[0]?f:null;t.a=null,t.C=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(i){(t=t.b)&&t.log(Ls,"Problem encountered resetting onreadystatechange: "+i.message,void 0)}}}function ca(t){t.a&&t.u&&(t.a.ontimeout=null),t.s&&(c.clearTimeout(t.s),t.s=null)}function ha(t){return t.a?t.a.readyState:0}function da(t){try{return 2<ha(t)?t.a.status:-1}catch(e){return-1}}function pa(t){try{return t.a?t.a.responseText:""}catch(e){return Gs(t.b,"Can not get responseText: "+e.message),""}}function fa(t,e){return e+" ["+t.P+" "+t.l+" "+da(t)+"]"}function ga(t){var e=Ea;this.g=[],this.u=e,this.s=t||null,this.f=this.a=!1,this.c=void 0,this.v=this.C=this.i=!1,this.h=0,this.b=null,this.l=0}function ma(t,e,n){t.a=!0,t.c=n,t.f=!e,xa(t)}function ya(t){if(t.a){if(!t.v)throw new ka(t);t.v=!1}}function ba(t,e){va(t,null,e,void 0)}function va(t,e,n,r){t.g.push([e,n,r]),t.a&&xa(t)}function wa(t){return J(t.g,(function(t){return y(t[1])}))}function xa(t){if(t.h&&t.a&&wa(t)){var e=t.h,n=Ca[e];n&&(c.clearTimeout(n.a),delete Ca[e]),t.h=0}t.b&&(t.b.l--,delete t.b),e=t.c;for(var r=n=!1;t.g.length&&!t.i;){var i=t.g.shift(),o=i[0],s=i[1];if(i=i[2],o=t.f?s:o)try{var a=o.call(i||t.s,e);void 0!==a&&(t.f=t.f&&(a==e||a instanceof Error),t.c=e=a),(M(e)||"function"===typeof c.Promise&&e instanceof c.Promise)&&(r=!0,t.i=!0)}catch(l){e=l,t.f=!0,wa(t)||(n=!0)}}t.c=e,r&&(a=I(t.m,t,!0),r=I(t.m,t,!1),e instanceof ga?(va(e,a,r),e.C=!0):e.then(a,r)),n&&(e=new Ia(e),Ca[e.a]=e,t.h=e.a)}function ka(){P.call(this)}function _a(){P.call(this)}function Ia(t){this.a=c.setTimeout(I(this.c,this),0),this.b=t}t=Qs.prototype,t.Ma=function(){"undefined"!=typeof u&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",Gs(this.b,fa(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},t.abort=function(){this.a&&this.c&&(Gs(this.b,fa(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),ua(this))},t.Da=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),ua(this,!0)),Qs.bb.Da.call(this)},t.Wb=function(){this.ya||(this.N||this.i||this.f?la(this):this.Jc())},t.Jc=function(){la(this)},t.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case ta:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var t=this.b;return t&&t.log(Ls,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(e){return Gs(this.b,"Can not get response: "+e.message),null}},ga.prototype.cancel=function(t){if(this.a)this.c instanceof ga&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):(e.l--,0>=e.l&&e.cancel())}this.u?this.u.call(this.s,this):this.v=!0,this.a||(t=new _a(this),ya(this),ma(this,!1,t))}},ga.prototype.m=function(t,e){this.i=!1,ma(this,t,e)},ga.prototype.then=function(t,e,n){var r,i,o=new De((function(t,e){r=t,i=e}));return va(this,r,(function(t){t instanceof _a?o.cancel():i(t)})),o.then(t,e,n)},ga.prototype.$goog_Thenable=!0,T(ka,P),ka.prototype.message="Deferred has already fired",ka.prototype.name="AlreadyCalledError",T(_a,P),_a.prototype.message="Deferred was canceled",_a.prototype.name="CanceledError",Ia.prototype.c=function(){throw delete Ca[this.a],this.b};var Ca={};function Sa(t){var e={},n=e.document||document,r=Rt(t).toString(),i=Ce(document,"SCRIPT"),o={Xb:i,Ma:void 0},s=new ga(o),a=null,l=null!=e.timeout?e.timeout:5e3;return 0<l&&(a=window.setTimeout((function(){Na(i,!0);var t=new $a(Ra,"Timeout reached for loading script "+r);ya(s),ma(s,!1,t)}),l),o.Ma=a),i.onload=i.onreadystatechange=function(){i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(Na(i,e.xd||!1,a),ya(s),ma(s,!0,null))},i.onerror=function(){Na(i,!0,a);var t=new $a(Aa,"Error while loading script "+r);ya(s),ma(s,!1,t)},o=e.attributes||{},kt(o,{type:"text/javascript",charset:"UTF-8"}),ve(i,o),Xt(i,t),Ta(n).appendChild(i),s}function Ta(t){var e;return(e=(t||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:t.documentElement}function Ea(){if(this&&this.Xb){var t=this.Xb;t&&"SCRIPT"==t.tagName&&Na(t,!0,this.Ma)}}function Na(t,e,n){null!=n&&c.clearTimeout(n),t.onload=f,t.onerror=f,t.onreadystatechange=f,e&&window.setTimeout((function(){t&&t.parentNode&&t.parentNode.removeChild(t)}),0)}var Aa=0,Ra=1;function $a(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),P.call(this,n),this.code=t}function Da(t){this.f=t}function Oa(t,e,n){if(this.c=t,t=e||{},this.l=t.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.m=t.secureTokenTimeout||Pa,this.g=wt(t.secureTokenHeaders||La),this.h=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.i=t.identityPlatformEndpoint||"https://identitytoolkit.googleapis.com/v2/",this.v=t.firebaseTimeout||za,this.a=wt(t.firebaseHeaders||Ba),n&&(this.a["X-Client-Version"]=n,this.g["X-Client-Version"]=n),n="Node"==Hr(),n=c.XMLHttpRequest||n&&r.Z.INTERNAL.node&&r.Z.INTERNAL.node.XMLHttpRequest,!n&&!jr())throw new N("internal-error","The XMLHttpRequest compatibility library was not found.");this.f=void 0,jr()?this.f=new qs(self):Gr()?this.f=new Da(n):this.f=new $s,this.b=null}T($a,P),T(Da,Es),Da.prototype.a=function(){return new this.f},Da.prototype.b=function(){return{}};var Fa,Ma="idToken",Pa=new di(3e4,6e4),La={"Content-Type":"application/x-www-form-urlencoded"},za=new di(3e4,6e4),Ba={"Content-Type":"application/json"};function Wa(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function Ua(t,e){e&&(t.l=Va("https://securetoken.googleapis.com/v1/token",e),t.h=Va("https://www.googleapis.com/identitytoolkit/v3/relyingparty/",e),t.i=Va("https://identitytoolkit.googleapis.com/v2/",e))}function Va(t,e){return t=ir(t),e=ir(e.url),t.f=t.a+t.f,Qn(t,e.c),t.a=e.a,tr(t,e.g),t.toString()}function ja(t,e){e?(t.a["X-Client-Version"]=e,t.g["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.g["X-Client-Version"])}function Ha(t,e,n,r,i,o,s){Dr()||jr()?t=I(t.u,t):(Fa||(Fa=new De((function(t,e){Ka(t,e)}))),t=I(t.s,t)),t(e,n,r,i,o,s)}Oa.prototype.T=function(){return this.b},Oa.prototype.u=function(t,e,n,r,i,o){if(jr()&&("undefined"===typeof c.fetch||"undefined"===typeof c.Headers||"undefined"===typeof c.Request))throw new N("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var s=new Qs(this.f);if(o){s.g=Math.max(0,o);var a=setTimeout((function(){s.dispatchEvent("timeout")}),o)}zn(s,"complete",(function(){a&&clearTimeout(a);var t=null;try{t=JSON.parse(pa(this))||null}catch(n){t=null}e&&e(t)})),Bn(s,"ready",(function(){a&&clearTimeout(a),ln(this)})),Bn(s,"timeout",(function(){a&&clearTimeout(a),ln(this),e&&e(null)})),ra(s,t,n,r,i)};var Ga=new It(Et,"https://apis.google.com/js/client.js?onload=%{onload}"),qa="__fcb"+Math.floor(1e6*Math.random()).toString();function Ka(t,e){if(((window.gapi||{}).client||{}).request)t();else{c[qa]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))};var n=$t(Ga,{onload:qa});ba(Sa(n),(function(){e(Error("CORS_UNSUPPORTED"))}))}}function Xa(t,e){return new De((function(n,r){"refresh_token"==e.grant_type&&e.refresh_token||"authorization_code"==e.grant_type&&e.code?Ha(t,t.l+"?key="+encodeURIComponent(t.c),(function(t){t?t.error?r(Jl(t)):t.access_token&&t.refresh_token?n(t):r(new N("internal-error")):r(new N("network-request-failed"))}),"POST",mr(e).toString(),t.g,t.m.get()):r(new N("internal-error"))}))}function Ya(t,e,n,r,i,o,s){var a=ir(e+n);nr(a,"key",t.c),s&&nr(a,"cb",Date.now().toString());var l="GET"==r;if(l)for(var u in i)i.hasOwnProperty(u)&&nr(a,u,i[u]);return new De((function(e,n){Ha(t,a.toString(),(function(t){t?t.error?n(Jl(t,o||{})):e(t):n(new N("network-request-failed"))}),r,l?void 0:_r(ai(i)),t.a,t.v.get())}))}function Ja(t){if(t=t.email,"string"!==typeof t||!zr.test(t))throw new N("invalid-email")}function Za(t){"email"in t&&Ja(t)}function Qa(t,e){return Xl(t,vl,{identifier:e,continueUri:ri()?Ar():"http://localhost"}).then((function(t){return t.signinMethods||[]}))}function tl(t){return Xl(t,Rl,{}).then((function(t){return t.authorizedDomains||[]}))}function el(t){if(!t[Ma]){if(t.mfaPendingCredential)throw new N("multi-factor-auth-required",null,wt(t));throw new N("internal-error")}}function nl(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new N("internal-error")}else{if(!t.sessionInfo)throw new N("missing-verification-id");if(!t.code)throw new N("missing-verification-code")}}Oa.prototype.s=function(t,e,n,r,i){var o=this;Fa.then((function(){window.gapi.client.setApiKey(o.c);var s=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:r,headers:i,authType:"none",callback:function(t){window.gapi.auth.setToken(s),e&&e(t)}})})).o((function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})}))},Oa.prototype.Ab=function(){return Xl(this,Pl,{})},Oa.prototype.Cb=function(t,e){return Xl(this,Fl,{idToken:t,email:e})},Oa.prototype.Db=function(t,e){return Xl(this,Ml,{idToken:t,password:e})};var rl={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function il(t,e){return Xl(t,Ol,e)}function ol(t,e){return Xl(t,Ll,e).then((function(t){return t.phoneSessionInfo.sessionInfo}))}function sl(t){if(!t.phoneVerificationInfo)throw new N("internal-error");if(!t.phoneVerificationInfo.sessionInfo)throw new N("missing-verification-id");if(!t.phoneVerificationInfo.code)throw new N("missing-verification-code")}function al(t,e){return Xl(t,zl,e).then((function(t){return t.phoneResponseInfo.sessionInfo}))}function ll(t,e,n){return Xl(t,xl,{idToken:e,deleteProvider:n})}function ul(t){if(!t.requestUri||!t.sessionId&&!t.postBody&&!t.pendingToken)throw new N("internal-error")}function cl(t,e){return e.oauthIdToken&&e.providerId&&0==e.providerId.indexOf("oidc.")&&!e.pendingToken&&(t.sessionId?e.nonce=t.sessionId:t.postBody&&(t=new fr(t.postBody),br(t,"nonce")&&(e.nonce=t.get("nonce")))),e}function hl(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=Ts(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=Ts(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=Ts(t)):t.errorMessage&&(e=Yl(t.errorMessage)),e)throw e;el(t)}function dl(t,e){return e.returnIdpCredential=!0,Xl(t,Bl,e)}function pl(t,e){return e.returnIdpCredential=!0,Xl(t,Ul,e)}function fl(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,Xl(t,Wl,e)}function gl(t){if(!t.oobCode)throw new N("invalid-action-code")}t=Oa.prototype,t.Eb=function(t,e){var n={idToken:t},r=[];return bt(rl,(function(t,i){var o=e[i];null===o?r.push(t):i in e&&(n[i]=o)})),r.length&&(n.deleteAttribute=r),Xl(this,Fl,n)},t.wb=function(t,e){return t={requestType:"PASSWORD_RESET",email:t},kt(t,e),Xl(this,Al,t)},t.xb=function(t,e){return t={requestType:"EMAIL_SIGNIN",email:t},kt(t,e),Xl(this,Tl,t)},t.vb=function(t,e){return t={requestType:"VERIFY_EMAIL",idToken:t},kt(t,e),Xl(this,El,t)},t.Fb=function(t,e,n){return t={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:t,newEmail:e},kt(t,n),Xl(this,Nl,t)},t.gb=function(t){return Xl(this,Hl,t)},t.ob=function(t,e){return Xl(this,Dl,{oobCode:t,newPassword:e})},t.Sa=function(t){return Xl(this,yl,{oobCode:t})},t.kb=function(t){return Xl(this,ml,{oobCode:t})};var ml={endpoint:"setAccountInfo",A:gl,Z:"email",B:!0},yl={endpoint:"resetPassword",A:gl,G:function(t){var e=t.requestType;if(!e||!t.email&&"EMAIL_SIGNIN"!=e&&"VERIFY_AND_CHANGE_EMAIL"!=e)throw new N("internal-error")},B:!0},bl={endpoint:"signupNewUser",A:function(t){if(Ja(t),!t.password)throw new N("weak-password")},G:el,V:!0,B:!0},vl={endpoint:"createAuthUri",B:!0},wl={endpoint:"deleteAccount",O:["idToken"]},xl={endpoint:"setAccountInfo",O:["idToken","deleteProvider"],A:function(t){if(!Array.isArray(t.deleteProvider))throw new N("internal-error")}},kl={endpoint:"emailLinkSignin",O:["email","oobCode"],A:Ja,G:el,V:!0,B:!0},_l={endpoint:"emailLinkSignin",O:["idToken","email","oobCode"],A:Ja,G:el,V:!0},Il={endpoint:"accounts/mfaEnrollment:finalize",O:["idToken","phoneVerificationInfo"],A:sl,G:el,B:!0,Na:!0},Cl={endpoint:"accounts/mfaSignIn:finalize",O:["mfaPendingCredential","phoneVerificationInfo"],A:sl,G:el,B:!0,Na:!0},Sl={endpoint:"getAccountInfo"},Tl={endpoint:"getOobConfirmationCode",O:["requestType"],A:function(t){if("EMAIL_SIGNIN"!=t.requestType)throw new N("internal-error");Ja(t)},Z:"email",B:!0},El={endpoint:"getOobConfirmationCode",O:["idToken","requestType"],A:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new N("internal-error")},Z:"email",B:!0},Nl={endpoint:"getOobConfirmationCode",O:["idToken","newEmail","requestType"],A:function(t){if("VERIFY_AND_CHANGE_EMAIL"!=t.requestType)throw new N("internal-error")},Z:"email",B:!0},Al={endpoint:"getOobConfirmationCode",O:["requestType"],A:function(t){if("PASSWORD_RESET"!=t.requestType)throw new N("internal-error");Ja(t)},Z:"email",B:!0},Rl={mb:!0,endpoint:"getProjectConfig",Vb:"GET"},$l={mb:!0,endpoint:"getRecaptchaParam",Vb:"GET",G:function(t){if(!t.recaptchaSiteKey)throw new N("internal-error")}},Dl={endpoint:"resetPassword",A:gl,Z:"email",B:!0},Ol={endpoint:"sendVerificationCode",O:["phoneNumber","recaptchaToken"],Z:"sessionInfo",B:!0},Fl={endpoint:"setAccountInfo",O:["idToken"],A:Za,V:!0},Ml={endpoint:"setAccountInfo",O:["idToken"],A:function(t){if(Za(t),!t.password)throw new N("weak-password")},G:el,V:!0},Pl={endpoint:"signupNewUser",G:el,V:!0,B:!0},Ll={endpoint:"accounts/mfaEnrollment:start",O:["idToken","phoneEnrollmentInfo"],A:function(t){if(!t.phoneEnrollmentInfo)throw new N("internal-error");if(!t.phoneEnrollmentInfo.phoneNumber)throw new N("missing-phone-number");if(!t.phoneEnrollmentInfo.recaptchaToken)throw new N("missing-app-credential")},G:function(t){if(!t.phoneSessionInfo||!t.phoneSessionInfo.sessionInfo)throw new N("internal-error")},B:!0,Na:!0},zl={endpoint:"accounts/mfaSignIn:start",O:["mfaPendingCredential","mfaEnrollmentId","phoneSignInInfo"],A:function(t){if(!t.phoneSignInInfo||!t.phoneSignInInfo.recaptchaToken)throw new N("missing-app-credential")},G:function(t){if(!t.phoneResponseInfo||!t.phoneResponseInfo.sessionInfo)throw new N("internal-error")},B:!0,Na:!0},Bl={endpoint:"verifyAssertion",A:ul,Za:cl,G:hl,V:!0,B:!0},Wl={endpoint:"verifyAssertion",A:ul,Za:cl,G:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new N("user-not-found");if(t.errorMessage)throw Yl(t.errorMessage);el(t)},V:!0,B:!0},Ul={endpoint:"verifyAssertion",A:function(t){if(ul(t),!t.idToken)throw new N("internal-error")},Za:cl,G:hl,V:!0},Vl={endpoint:"verifyCustomToken",A:function(t){if(!t.token)throw new N("invalid-custom-token")},G:el,V:!0,B:!0},jl={endpoint:"verifyPassword",A:function(t){if(Ja(t),!t.password)throw new N("wrong-password")},G:el,V:!0,B:!0},Hl={endpoint:"verifyPhoneNumber",A:nl,G:el,B:!0},Gl={endpoint:"verifyPhoneNumber",A:function(t){if(!t.idToken)throw new N("internal-error");nl(t)},G:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",Ts(t);el(t)}},ql={Ib:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",A:nl,G:el,B:!0},Kl={endpoint:"accounts/mfaEnrollment:withdraw",O:["idToken","mfaEnrollmentId"],G:function(t){if(!!t[Ma]^!!t.refreshToken)throw new N("internal-error")},B:!0,Na:!0};function Xl(t,e,n){if(!Ti(n,e.O))return We(new N("internal-error"));var r,i=!!e.Na,o=e.Vb||"POST";return Be(n).then(e.A).then((function(){return e.V&&(n.returnSecureToken=!0),e.B&&t.b&&"undefined"===typeof n.tenantId&&(n.tenantId=t.b),Ya(t,i?t.i:t.h,e.endpoint,o,n,e.Ib,e.mb||!1)})).then((function(t){return r=t,e.Za?e.Za(n,r):r})).then(e.G).then((function(){if(!e.Z)return r;if(!(e.Z in r))throw new N("internal-error");return r[e.Z]}))}function Yl(t){return Jl({error:{errors:[{message:t}],code:400,message:t}})}function Jl(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new N(r[n]):null)return n;for(var i in n=t.error&&t.error.message||"",r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",UNSUPPORTED_TENANT_OPERATION:"unsupported-tenant-operation",INVALID_TENANT_ID:"invalid-tenant-id",TENANT_ID_MISMATCH:"tenant-id-mismatch",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",EMAIL_CHANGE_NEEDS_VERIFICATION:"email-change-needs-verification",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",UNSUPPORTED_FIRST_FACTOR:"unsupported-first-factor",UNVERIFIED_EMAIL:"unverified-email"},kt(r,e||{}),e=(e=n.match(/^[^\s]+\s*:\s*([\s\S]*)$/))&&1<e.length?e[1]:void 0,r)if(0===n.indexOf(i))return new N(r[i],e);return!e&&t&&(e=si(t)),new N("internal-error",e)}function Zl(t){this.b=t,this.a=null,this.sb=Ql(this)}function Ql(t){return su().then((function(){return new De((function(e,n){ti("gapi.iframes.getContext")().open({where:document.body,url:t.b,messageHandlersFilter:ti("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},(function(r){function i(){clearTimeout(o),e()}t.a=r,t.a.restyle({setHideOnLeave:!1});var o=setTimeout((function(){n(Error("Network Error"))}),iu.get());r.ping(i).then(i,(function(){n(Error("Network Error"))}))}))}))}))}function tu(t,e){return t.sb.then((function(){return new De((function(n){t.a.send(e.type,e,n,ti("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}))}function eu(t,e){t.sb.then((function(){t.a.register("authEvent",e,ti("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}var nu=new It(Et,"https://apis.google.com/js/api.js?onload=%{onload}"),ru=new di(3e4,6e4),iu=new di(5e3,15e3),ou=null;function su(){return ou||(ou=new De((function(t,e){function n(){hi(),ti("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){hi(),e(Error("Network Error"))},timeout:ru.get()})}if(ti("gapi.iframes.Iframe"))t();else if(ti("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();c[r]=function(){ti("gapi.load")?n():e(Error("Network Error"))},r=$t(nu,{onload:r}),Be(Sa(r)).o((function(){e(Error("Network Error"))}))}})).o((function(t){throw ou=null,t})))}function au(t,e,n,r){this.l=t,this.h=e,this.i=n,this.g=r,this.f=null,this.g?(t=ir(this.g.url),t=or(t.c,t.a,t.g,"/emulator/auth/iframe")):t=or("https",this.l,null,"/__/auth/iframe"),this.a=t,nr(this.a,"apiKey",this.h),nr(this.a,"appName",this.i),this.b=null,this.c=[]}function lu(t,e,n,r,i,o){this.u=t,this.s=e,this.c=n,this.m=r,this.v=o,this.i=this.g=this.l=null,this.a=i,this.h=this.f=null}function uu(t){try{return r.Z.app(t).auth().Ga()}catch(e){return[]}}function cu(t,e,n,r,i,o){this.s=t,this.g=e,this.b=n,this.f=o,this.c=r||null,this.i=i||null,this.l=this.u=this.C=null,this.h=[],this.m=this.a=null}function hu(t){var e=Ar();return tl(t).then((function(t){t:{var n=ir(e),r=n.c;n=n.a;for(var i=0;i<t.length;i++){var o=t[i],s=n,a=r;if(0==o.indexOf("chrome-extension://")?s=ir(o).a==s&&"chrome-extension"==a:"http"!=a&&"https"!=a?s=!1:Lr.test(o)?s=s==o:(o=o.split(".").join("\\."),s=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(s)),s){t=!0;break t}}t=!1}if(!t)throw new Cs(Ar())}))}function du(t){return t.m||(t.m=Br().then((function(){if(!t.u){var e=t.c,n=t.i,r=uu(t.b),i=new au(t.s,t.g,t.b,t.f);i.f=e,i.b=n,i.c=rt(r||[]),t.u=i.toString()}t.v=new Zl(t.u),gu(t)}))),t.m}function pu(t){return t.l||(t.C=t.c?Zr(t.c,uu(t.b)):null,t.l=new Oa(t.g,F(t.i),t.C),t.f&&Ua(t.l,t.f)),t.l}function fu(t,e,n,r,i,o,s,a,l,u,c,h){return t=new lu(t,e,n,r,i,h),t.l=o,t.g=s,t.i=a,t.b=wt(l||null),t.f=u,t.zb(c).toString()}function gu(t){if(!t.v)throw Error("IfcHandler must be initialized!");eu(t.v,(function(e){var n={};if(e&&e.authEvent){var r=!1;for(e=ws(e.authEvent),n=0;n<t.h.length;n++)r=t.h[n](e)||r;return n={},n.status=r?"ACK":"ERROR",Be(n)}return n.status="ERROR",Be(n)}))}function mu(t){var e={type:"webStorageSupport"};return du(t).then((function(){return tu(t.v,e)})).then((function(t){if(t&&t.length&&"undefined"!==typeof t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()}))}function yu(t){if(this.a=t||r.Z.INTERNAL.reactNative&&r.Z.INTERNAL.reactNative.AsyncStorage,!this.a)throw new N("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function bu(t){this.b=t,this.a={},this.f=I(this.c,this)}au.prototype.toString=function(){return this.f?nr(this.a,"v",this.f):yr(this.a.b,"v"),this.b?nr(this.a,"eid",this.b):yr(this.a.b,"eid"),this.c.length?nr(this.a,"fw",this.c.join(",")):yr(this.a.b,"fw"),this.a.toString()},lu.prototype.zb=function(t){return this.h=t,this},lu.prototype.toString=function(){if(this.v){var t=ir(this.v.url);t=or(t.c,t.a,t.g,"/emulator/auth/handler")}else t=or("https",this.u,null,"/__/auth/handler");if(nr(t,"apiKey",this.s),nr(t,"appName",this.c),nr(t,"authType",this.m),this.a.isOAuthProvider){var e=this.a;try{var n=r.Z.app(this.c).auth().la()}catch(l){n=null}for(var i in e.pb=n,nr(t,"providerId",this.a.providerId),n=this.a,e=ai(n.Jb),e)e[i]=e[i].toString();i=n.Qc,e=wt(e);for(var o=0;o<i.length;o++){var s=i[o];s in e&&delete e[s]}n.qb&&n.pb&&!e[n.qb]&&(e[n.qb]=n.pb),vt(e)||nr(t,"customParameters",si(e))}if("function"===typeof this.a.Rb&&(n=this.a.Rb(),n.length&&nr(t,"scopes",n.join(","))),this.l?nr(t,"redirectUrl",this.l):yr(t.b,"redirectUrl"),this.g?nr(t,"eventId",this.g):yr(t.b,"eventId"),this.i?nr(t,"v",this.i):yr(t.b,"v"),this.b)for(var a in this.b)this.b.hasOwnProperty(a)&&!rr(t,a)&&nr(t,a,this.b[a]);return this.h?nr(t,"tid",this.h):yr(t.b,"tid"),this.f?nr(t,"eid",this.f):yr(t.b,"eid"),a=uu(this.c),a.length&&nr(t,"fw",a.join(",")),t.toString()},t=cu.prototype,t.Pb=function(t,e,n){var r=new N("popup-closed-by-user"),i=new N("web-storage-unsupported"),o=this,s=!1;return this.ma().then((function(){mu(o).then((function(n){n||(t&&Fr(t),e(i),s=!0)}))})).o((function(){})).then((function(){if(!s)return Pr(t)})).then((function(){if(!s)return Vn(n).then((function(){e(r)}))}))},t.Yb=function(){var t=Qr();return!oi(t)&&!ci(t)},t.Ub=function(){return!1},t.Nb=function(t,e,n,r,i,o,s,a){if(!t)return We(new N("popup-blocked"));if(s&&!oi())return this.ma().o((function(e){Fr(t),i(e)})),r(),Be();this.a||(this.a=hu(pu(this)));var l=this;return this.a.then((function(){var e=l.ma().o((function(e){throw Fr(t),i(e),e}));return r(),e})).then((function(){if(bs(n),!s){var r=fu(l.s,l.g,l.b,e,n,null,o,l.c,void 0,l.i,a,l.f);Rr(r,t)}})).o((function(t){throw"auth/network-request-failed"==t.code&&(l.a=null),t}))},t.Ob=function(t,e,n,r){this.a||(this.a=hu(pu(this)));var i=this;return this.a.then((function(){bs(e);var o=fu(i.s,i.g,i.b,t,e,Ar(),n,i.c,void 0,i.i,r,i.f);Rr(o)})).o((function(t){throw"auth/network-request-failed"==t.code&&(i.a=null),t}))},t.ma=function(){var t=this;return du(this).then((function(){return t.v.sb})).o((function(){throw t.a=null,new N("network-request-failed")}))},t.ac=function(){return!0},t.Ea=function(t){this.h.push(t)},t.Ta=function(t){et(this.h,(function(e){return e==t}))},t=yu.prototype,t.get=function(t){return Be(this.a.getItem(t)).then((function(t){return t&&li(t)}))},t.set=function(t,e){return Be(this.a.setItem(t,si(e)))},t.U=function(t){return Be(this.a.removeItem(t))},t.ca=function(){},t.ia=function(){};var vu,wu=[];function xu(){var t=jr()?self:null;if(q(wu,(function(n){n.b==t&&(e=n)})),!e){var e=new bu(t);wu.push(e)}return e}function ku(t,e,n){vt(t.a)&&t.b.addEventListener("message",t.f),"undefined"===typeof t.a[e]&&(t.a[e]=[]),t.a[e].push(n)}function _u(t){this.a=t}function Iu(t){this.c=t,this.b=!1,this.a=[]}function Cu(t,e,n,r){var i,o,s,a,l=n||{},u=null;if(t.b)return We(Error("connection_unavailable"));var c=r?800:50,h="undefined"!==typeof MessageChannel?new MessageChannel:null;return new De((function(n,r){h?(i=Math.floor(Math.random()*Math.pow(10,20)).toString(),h.port1.start(),s=setTimeout((function(){r(Error("unsupported_event"))}),c),o=function(t){t.data.eventId===i&&("ack"===t.data.status?(clearTimeout(s),a=setTimeout((function(){r(Error("timeout"))}),3e3)):"done"===t.data.status?(clearTimeout(a),"undefined"!==typeof t.data.response?n(t.data.response):r(Error("unknown_error"))):(clearTimeout(s),clearTimeout(a),r(Error("invalid_response"))))},u={messageChannel:h,onMessage:o},t.a.push(u),h.port1.addEventListener("message",o),t.c.postMessage({eventType:e,eventId:i,data:l},[h.port2])):r(Error("connection_unavailable"))})).then((function(e){return Su(t,u),e})).o((function(e){throw Su(t,u),e}))}function Su(t,e){if(e){var n=e.messageChannel,r=e.onMessage;n&&(n.port1.removeEventListener("message",r),n.port1.close()),et(t.a,(function(t){return t==e}))}}function Tu(){if(!$u())throw new N("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.m=c.indexedDB,this.type="indexedDB",this.g=this.v=this.f=this.l=null,this.s=!1,this.h=null;var t=this;jr()&&self?(this.v=xu(),ku(this.v,"keyChanged",(function(e,n){return Pu(t).then((function(e){return 0<e.length&&q(t.a,(function(t){t(e)})),{keyProcessed:Q(e,n.key)}}))})),ku(this.v,"ping",(function(){return Be(["keyChanged"])}))):bi().then((function(e){(t.h=e)&&(t.g=new Iu(new _u(e)),Cu(t.g,"ping",null,!0).then((function(e){e[0].fulfilled&&Q(e[0].value,"keyChanged")&&(t.s=!0)})).o((function(){})))}))}function Eu(t){return new De((function(e,n){var r=t.m.deleteDatabase("firebaseLocalStorageDb");r.onsuccess=function(){e()},r.onerror=function(t){n(Error(t.target.error))}}))}function Nu(t){return new De((function(e,n){var r=t.m.open("firebaseLocalStorageDb",1);r.onerror=function(t){try{t.preventDefault()}catch(e){}n(Error(t.target.error))},r.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(e){n(e)}},r.onsuccess=function(r){r=r.target.result,r.objectStoreNames.contains("firebaseLocalStorage")?e(r):Eu(t).then((function(){return Nu(t)})).then((function(t){e(t)})).o((function(t){n(t)}))}}))}function Au(t){return t.i||(t.i=Nu(t)),t.i}function Ru(t,e){function n(i,o){Au(t).then(e).then(i).o((function(e){if(!(3<++r))return Au(t).then((function(e){return e.close(),t.i=void 0,n(i,o)})).o((function(t){o(t)}));o(e)}))}var r=0;return new De(n)}function $u(){try{return!!c.indexedDB}catch(Qp){return!1}}function Du(t){return t.objectStore("firebaseLocalStorage")}function Ou(t,e){return t.transaction(["firebaseLocalStorage"],e?"readwrite":"readonly")}function Fu(t){return new De((function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(t.target.error)}}))}function Mu(t,e){return t.g&&t.h&&yi()===t.h?Cu(t.g,"keyChanged",{key:e},t.s).then((function(){})).o((function(){})):Be()}function Pu(t){return Au(t).then((function(t){var e=Du(Ou(t,!1));return e.getAll?Fu(e.getAll()):new De((function(t,n){var r=[],i=e.openCursor();i.onsuccess=function(e){(e=e.target.result)?(r.push(e.value),e["continue"]()):t(r)},i.onerror=function(t){n(t.target.error)}}))})).then((function(e){var n={},r=[];if(0==t.b){for(r=0;r<e.length;r++)n[e[r].fbase_key]=e[r].value;r=$r(t.c,n),t.c=n}return r}))}function Lu(t){function e(){t.f=setTimeout((function(){t.l=Pu(t).then((function(e){0<e.length&&q(t.a,(function(t){t(e)}))})).then((function(){e()})).o((function(t){"STOP_EVENT"!=t.message&&e()}))}),800)}zu(t),e()}function zu(t){t.l&&t.l.cancel("STOP_EVENT"),t.f&&(clearTimeout(t.f),t.f=null)}function Bu(t){var e=this,n=null;this.a=[],this.type="indexedDB",this.c=t,this.b=Be().then((function(){if($u()){var t=ui(),r="__sak"+t;return vu||(vu=new Tu),n=vu,n.set(r,t).then((function(){return n.get(r)})).then((function(e){if(e!==t)throw Error("indexedDB not supported!");return n.U(r)})).then((function(){return n})).o((function(){return e.c}))}return e.c})).then((function(t){return e.type=t.type,t.ca((function(t){q(e.a,(function(e){e(t)}))})),t}))}function Wu(){this.a={},this.type="inMemory"}function Uu(){if(!ju()){if("Node"==Hr())throw new N("internal-error","The LocalStorage compatibility library was not found.");throw new N("web-storage-unsupported")}this.a=Vu()||r.Z.INTERNAL.node.localStorage,this.type="localStorage"}function Vu(){try{var t=c.localStorage,e=ui();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(n){return null}}function ju(){var t="Node"==Hr();if(t=Vu()||t&&r.Z.INTERNAL.node&&r.Z.INTERNAL.node.localStorage,!t)return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(e){return!1}}function Hu(){this.type="nullStorage"}function Gu(){if(!Ku()){if("Node"==Hr())throw new N("internal-error","The SessionStorage compatibility library was not found.");throw new N("web-storage-unsupported")}this.a=qu()||r.Z.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function qu(){try{var t=c.sessionStorage,e=ui();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(n){return null}}function Ku(){var t="Node"==Hr();if(t=qu()||t&&r.Z.INTERNAL.node&&r.Z.INTERNAL.node.sessionStorage,!t)return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(e){return!1}}function Xu(){var t={};t.Browser=Zu,t.Node=Qu,t.ReactNative=tc,t.Worker=ec,this.a=t[Hr()]}bu.prototype.c=function(t){var e=t.data.eventType,n=t.data.eventId,r=this.a[e];if(r&&0<r.length){t.ports[0].postMessage({status:"ack",eventId:n,eventType:e,response:null});var i=[];q(r,(function(e){i.push(Be().then((function(){return e(t.origin,t.data.data)})))})),je(i).then((function(r){var i=[];q(r,(function(t){i.push({fulfilled:t.Qb,value:t.value,reason:t.reason?t.reason.message:void 0})})),q(i,(function(t){for(var e in t)"undefined"===typeof t[e]&&delete t[e]})),t.ports[0].postMessage({status:"done",eventId:n,eventType:e,response:i})}))}},_u.prototype.postMessage=function(t,e){this.a.postMessage(t,e)},Iu.prototype.close=function(){for(;0<this.a.length;)Su(this,this.a[0]);this.b=!0},t=Tu.prototype,t.set=function(t,e){var n=this,r=!1;return Ru(this,(function(e){return e=Du(Ou(e,!0)),Fu(e.get(t))})).then((function(i){return Ru(n,(function(o){if(o=Du(Ou(o,!0)),i)return i.value=e,Fu(o.put(i));n.b++,r=!0;var s={};return s.fbase_key=t,s.value=e,Fu(o.add(s))}))})).then((function(){return n.c[t]=e,Mu(n,t)})).oa((function(){r&&n.b--}))},t.get=function(t){return Ru(this,(function(e){return Fu(Du(Ou(e,!1)).get(t))})).then((function(t){return t&&t.value}))},t.U=function(t){var e=this,n=!1;return Ru(this,(function(r){return n=!0,e.b++,Fu(Du(Ou(r,!0))["delete"](t))})).then((function(){return delete e.c[t],Mu(e,t)})).oa((function(){n&&e.b--}))},t.ca=function(t){0==this.a.length&&Lu(this),this.a.push(t)},t.ia=function(t){et(this.a,(function(e){return e==t})),0==this.a.length&&zu(this)},t=Bu.prototype,t.get=function(t){return this.b.then((function(e){return e.get(t)}))},t.set=function(t,e){return this.b.then((function(n){return n.set(t,e)}))},t.U=function(t){return this.b.then((function(e){return e.U(t)}))},t.ca=function(t){this.a.push(t)},t.ia=function(t){et(this.a,(function(e){return e==t}))},t=Wu.prototype,t.get=function(t){return Be(this.a[t])},t.set=function(t,e){return this.a[t]=e,Be()},t.U=function(t){return delete this.a[t],Be()},t.ca=function(){},t.ia=function(){},t=Uu.prototype,t.get=function(t){var e=this;return Be().then((function(){var n=e.a.getItem(t);return li(n)}))},t.set=function(t,e){var n=this;return Be().then((function(){var r=si(e);null===r?n.U(t):n.a.setItem(t,r)}))},t.U=function(t){var e=this;return Be().then((function(){e.a.removeItem(t)}))},t.ca=function(t){c.window&&Cn(c.window,"storage",t)},t.ia=function(t){c.window&&Nn(c.window,"storage",t)},t=Hu.prototype,t.get=function(){return Be(null)},t.set=function(){return Be()},t.U=function(){return Be()},t.ca=function(){},t.ia=function(){},t=Gu.prototype,t.get=function(t){var e=this;return Be().then((function(){var n=e.a.getItem(t);return li(n)}))},t.set=function(t,e){var n=this;return Be().then((function(){var r=si(e);null===r?n.U(t):n.a.setItem(t,r)}))},t.U=function(t){var e=this;return Be().then((function(){e.a.removeItem(t)}))},t.ca=function(){},t.ia=function(){};var Yu,Ju,Zu={F:Uu,cb:Gu},Qu={F:Uu,cb:Gu},tc={F:yu,cb:Hu},ec={F:Uu,cb:Hu},nc={rd:"local",NONE:"none",td:"session"};function rc(t){var e=new N("invalid-persistence-type"),n=new N("unsupported-persistence-type");t:{for(r in nc)if(nc[r]==t){var r=!0;break t}r=!1}if(!r||"string"!==typeof t)throw e;switch(Hr()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;case"Worker":if("session"===t||!$u()&&"none"!==t)throw n;break;default:if(!ei()&&"none"!==t)throw n}}function ic(){var t=!(ci(Qr())||!Vr()),e=oi(),n=ei();this.m=t,this.h=e,this.l=n,this.a={},Yu||(Yu=new Xu),t=Yu;try{this.g=!Nr()&&mi()||!c.indexedDB?new t.a.F:new Bu(jr()?new Wu:new t.a.F)}catch(r){this.g=new Wu,this.h=!0}try{this.i=new t.a.cb}catch(r){this.i=new Wu}this.v=new Wu,this.f=I(this.Zb,this),this.b={}}function oc(){return Ju||(Ju=new ic),Ju}function sc(t,e){switch(e){case"session":return t.i;case"none":return t.v;default:return t.g}}function ac(t,e){return"firebase:"+t.name+(e?":"+e:"")}function lc(t,e,n){var r=ac(e,n),i=sc(t,e.F);return t.get(e,n).then((function(o){var s=null;try{s=li(c.localStorage.getItem(r))}catch(a){}if(s&&!o)return c.localStorage.removeItem(r),t.set(e,s,n);s&&o&&"localStorage"!=i.type&&c.localStorage.removeItem(r)}))}function uc(t,e,n){return n=ac(e,n),"local"==e.F&&(t.b[n]=null),sc(t,e.F).U(n)}function cc(t){hc(t),t.c=setInterval((function(){for(var e in t.a){var n=c.localStorage.getItem(e),r=t.b[e];n!=r&&(t.b[e]=n,n=new fn({type:"storage",key:e,target:window,oldValue:r,newValue:n,a:!0}),t.Zb(n))}}),1e3)}function hc(t){t.c&&(clearInterval(t.c),t.c=null)}function dc(t){this.a=t,this.b=oc()}t=ic.prototype,t.get=function(t,e){return sc(this,t.F).get(ac(t,e))},t.set=function(t,e,n){var r=ac(t,n),i=this,o=sc(this,t.F);return o.set(r,e).then((function(){return o.get(r)})).then((function(e){"local"==t.F&&(i.b[r]=e)}))},t.addListener=function(t,e,n){t=ac(t,e),this.l&&(this.b[t]=c.localStorage.getItem(t)),vt(this.a)&&(sc(this,"local").ca(this.f),this.h||(Nr()||!mi())&&c.indexedDB||!this.l||cc(this)),this.a[t]||(this.a[t]=[]),this.a[t].push(n)},t.removeListener=function(t,e,n){t=ac(t,e),this.a[t]&&(et(this.a[t],(function(t){return t==n})),0==this.a[t].length&&delete this.a[t]),vt(this.a)&&(sc(this,"local").ia(this.f),hc(this))},t.Zb=function(t){if(t&&t.g){var e=t.a.key;if(null==e)for(var n in this.a){var r=this.b[n];"undefined"===typeof r&&(r=null);var i=c.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.nb(n))}else if(0==e.indexOf("firebase:")&&this.a[e]){if("undefined"!==typeof t.a.a?sc(this,"local").ia(this.f):hc(this),this.m)if(n=c.localStorage.getItem(e),r=t.a.newValue,r!==n)null!==r?c.localStorage.setItem(e,r):c.localStorage.removeItem(e);else if(this.b[e]===r&&"undefined"===typeof t.a.a)return;var o=this;n=function(){"undefined"===typeof t.a.a&&o.b[e]===c.localStorage.getItem(e)||(o.b[e]=c.localStorage.getItem(e),o.nb(e))},re&&me&&10==me&&c.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(n,10):n()}}else q(t,I(this.nb,this))},t.nb=function(t){this.a[t]&&q(this.a[t],(function(t){t()}))};var pc,fc={name:"authEvent",F:"local"};function gc(t){return t.b.get(fc,t.a).then((function(t){return ws(t)}))}function mc(){this.a=oc()}function yc(){this.b=-1}function bc(t,e){this.b=vc,this.f=c.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=t,this.h=e,this.l=c.Int32Array?new Int32Array(64):Array(64),void 0===pc&&(pc=c.Int32Array?new Int32Array(Sc):Sc),this.reset()}T(bc,yc);for(var vc=64,wc=vc-1,xc=[],kc=0;kc<wc;kc++)xc[kc]=0;var _c=nt(128,xc);function Ic(t){for(var e=t.f,n=t.l,r=0,i=0;i<e.length;)n[r++]=e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3],i=4*r;for(e=16;64>e;e++){i=0|n[e-15],r=0|n[e-2];var o=(0|n[e-16])+((i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,s=(0|n[e-7])+((r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[e]=o+s|0}r=0|t.a[0],i=0|t.a[1];var a=0|t.a[2],l=0|t.a[3],u=0|t.a[4],c=0|t.a[5],h=0|t.a[6];for(o=0|t.a[7],e=0;64>e;e++){var d=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&a^i&a)|0;s=u&c^~u&h,o=o+((u>>>6|u<<26)^(u>>>11|u<<21)^(u>>>25|u<<7))|0,s=s+(0|pc[e])|0,s=o+(s+(0|n[e])|0)|0,o=h,h=c,c=u,u=l+s|0,l=a,a=i,i=r,r=s+d|0}t.a[0]=t.a[0]+r|0,t.a[1]=t.a[1]+i|0,t.a[2]=t.a[2]+a|0,t.a[3]=t.a[3]+l|0,t.a[4]=t.a[4]+u|0,t.a[5]=t.a[5]+c|0,t.a[6]=t.a[6]+h|0,t.a[7]=t.a[7]+o|0}function Cc(t,e,n){void 0===n&&(n=e.length);var r=0,i=t.c;if("string"===typeof e)for(;r<n;)t.f[i++]=e.charCodeAt(r++),i==t.b&&(Ic(t),i=0);else{if(!m(e))throw Error("message must be string or array");for(;r<n;){var o=e[r++];if(!("number"==typeof o&&0<=o&&255>=o&&o==(0|o)))throw Error("message must be a byte array");t.f[i++]=o,i==t.b&&(Ic(t),i=0)}}t.c=i,t.g+=n}bc.prototype.reset=function(){this.g=this.c=0,this.a=c.Int32Array?new Int32Array(this.h):rt(this.h)};var Sc=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function Tc(){bc.call(this,8,Ec)}T(Tc,bc);var Ec=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function Nc(t,e,n,r,i,o){this.v=t,this.i=e,this.l=n,this.m=r||null,this.u=i||null,this.s=o,this.h=e+":"+n,this.C=new mc,this.g=new dc(this.h),this.f=null,this.b=[],this.a=this.c=null}function Ac(t){return new N("invalid-cordova-configuration",t)}function Rc(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}function $c(t){var e=new Tc;Cc(e,t),t=[];var n=8*e.g;56>e.c?Cc(e,_c,56-e.c):Cc(e,_c,e.b-(e.c-56));for(var r=63;56<=r;r--)e.f[r]=255&n,n/=256;for(Ic(e),r=n=0;r<e.i;r++)for(var i=24;0<=i;i-=8)t[n++]=e.a[r]>>i&255;return yo(t)}function Dc(t,e,n,r,i){var o=Rc(),s=new vs(e,r,null,o,new N("no-auth-event"),null,i),a=ti("BuildInfo.packageName",c);if("string"!==typeof a)throw new N("invalid-cordova-configuration");var l=ti("BuildInfo.displayName",c),u={};if(Qr().toLowerCase().match(/iphone|ipad|ipod/))u.ibi=a;else{if(!Qr().toLowerCase().match(/android/))return We(new N("operation-not-supported-in-this-environment"));u.apn=a}l&&(u.appDisplayName=l),o=$c(o),u.sessionId=o;var h=fu(t.v,t.i,t.l,e,n,null,r,t.m,u,t.u,i,t.s);return t.ma().then((function(){var e=t.h;return t.C.a.set(fc,s.w(),e)})).then((function(){var e=ti("cordova.plugins.browsertab.isAvailable",c);if("function"!==typeof e)throw new N("invalid-cordova-configuration");var n=null;e((function(e){if(e){if(n=ti("cordova.plugins.browsertab.openUrl",c),"function"!==typeof n)throw new N("invalid-cordova-configuration");n(h)}else{if(n=ti("cordova.InAppBrowser.open",c),"function"!==typeof n)throw new N("invalid-cordova-configuration");e=Qr(),t.a=n(h,e.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}}))}))}function Oc(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(r){}}function Fc(t){return t.f||(t.f=t.ma().then((function(){return new De((function(e){function n(r){return e(r),t.Ta(n),!1}t.Ea(n),Pc(t)}))}))),t.f}function Mc(t){var e=null;return gc(t.g).then((function(n){return e=n,n=t.g,uc(n.b,fc,n.a)})).then((function(){return e}))}function Pc(t){function e(e){r=!0,i&&i.cancel(),Mc(t).then((function(r){var i=n;if(r&&e&&e.url){var o=null;i=Lo(e.url),-1!=i.indexOf("/__/auth/callback")&&(o=ir(i),o=li(rr(o,"firebaseError")||null),o=(o="object"===typeof o?A(o):null)?new vs(r.c,r.b,null,null,o,null,r.T()):new vs(r.c,r.b,i,r.f,null,null,r.T())),i=o||n}Oc(t,i)}))}var n=new vs("unknown",null,null,null,new N("no-auth-event")),r=!1,i=Vn(500).then((function(){return Mc(t).then((function(){r||Oc(t,n)}))})),o=c.handleOpenURL;c.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(ti("BuildInfo.packageName",c).toLowerCase()+"://")&&e({url:t}),"function"===typeof o)try{o(t)}catch(n){console.error(n)}},_s||(_s=new xs),Is(e)}function Lc(t){this.a=t,this.b=oc()}t=Nc.prototype,t.ma=function(){return this.Ia?this.Ia:this.Ia=Wr().then((function(){if("function"!==typeof ti("universalLinks.subscribe",c))throw Ac("cordova-universal-links-plugin-fix is not installed");if("undefined"===typeof ti("BuildInfo.packageName",c))throw Ac("cordova-plugin-buildinfo is not installed");if("function"!==typeof ti("cordova.plugins.browsertab.openUrl",c))throw Ac("cordova-plugin-browsertab is not installed");if("function"!==typeof ti("cordova.InAppBrowser.open",c))throw Ac("cordova-plugin-inappbrowser is not installed")}),(function(){throw new N("cordova-not-ready")}))},t.Pb=function(t,e){return e(new N("operation-not-supported-in-this-environment")),Be()},t.Nb=function(){return We(new N("operation-not-supported-in-this-environment"))},t.ac=function(){return!1},t.Yb=function(){return!0},t.Ub=function(){return!0},t.Ob=function(t,e,n,r){if(this.c)return We(new N("redirect-operation-pending"));var i=this,o=c.document,s=null,a=null,l=null,u=null;return this.c=Be().then((function(){return bs(e),Fc(i)})).then((function(){return Dc(i,t,e,n,r)})).then((function(){return new De((function(t,e){a=function(){var e=ti("cordova.plugins.browsertab.close",c);return t(),"function"===typeof e&&e(),i.a&&"function"===typeof i.a.close&&(i.a.close(),i.a=null),!1},i.Ea(a),l=function(){s||(s=Vn(2e3).then((function(){e(new N("redirect-cancelled-by-user"))})))},u=function(){pi()&&l()},o.addEventListener("resume",l,!1),Qr().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",u,!1)})).o((function(t){return Mc(i).then((function(){throw t}))}))})).oa((function(){l&&o.removeEventListener("resume",l,!1),u&&o.removeEventListener("visibilitychange",u,!1),s&&s.cancel(),a&&i.Ta(a),i.c=null}))},t.Ea=function(t){this.b.push(t),Fc(this).o((function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new vs("unknown",null,null,null,new N("no-auth-event")),t(e))}))},t.Ta=function(t){et(this.b,(function(e){return e==t}))};var zc={name:"pendingRedirect",F:"session"};function Bc(t){return t.b.set(zc,"pending",t.a)}function Wc(t){return uc(t.b,zc,t.a)}function Uc(t){return t.b.get(zc,t.a).then((function(t){return"pending"==t}))}function Vc(t,e,n,r){this.i={},this.u=0,this.D=t,this.v=e,this.m=n,this.J=r,this.h=[],this.f=!1,this.l=I(this.s,this),this.b=new ih,this.C=new dh,this.g=new Lc(nh(this.v,this.m)),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.C,this.c.linkViaPopup=this.C,this.c.reauthViaPopup=this.C,this.a=jc(this.D,this.v,this.m,R,this.J)}function jc(t,e,n,i,o){var s=r.Z.SDK_VERSION||null;return Ur()?new Nc(t,e,n,s,i,o):new cu(t,e,n,s,i,o)}function Hc(t){t.f||(t.f=!0,t.a.Ea(t.l));var e=t.a;return t.a.ma().o((function(n){throw t.a==e&&t.reset(),n}))}function Gc(t){t.a.Yb()&&Hc(t).o((function(e){var n=new vs("unknown",null,null,null,new N("operation-not-supported-in-this-environment"));Zc(e)&&t.s(n)})),t.a.Ub()||oh(t.b)}function qc(t,e){Q(t.h,e)||t.h.push(e),t.f||Uc(t.g).then((function(e){e?Wc(t.g).then((function(){Hc(t).o((function(e){var n=new vs("unknown",null,null,null,new N("operation-not-supported-in-this-environment"));Zc(e)&&t.s(n)}))})):Gc(t)})).o((function(){Gc(t)}))}function Kc(t,e){et(t.h,(function(t){return t==e}))}Vc.prototype.reset=function(){this.f=!1,this.a.Ta(this.l),this.a=jc(this.D,this.v,this.m,null,this.J),this.i={}},Vc.prototype.s=function(t){if(!t)throw new N("invalid-auth-event");if(6e5<=Date.now()-this.u&&(this.i={},this.u=0),t&&t.getUid()&&this.i.hasOwnProperty(t.getUid()))return!1;for(var e=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.Gb(t.c,t.b)){(e=this.c[t.c])&&(e.h(t,r),t&&(t.f||t.b)&&(this.i[t.getUid()]=!0,this.u=Date.now())),e=!0;break}}return oh(this.b),e};var Xc=new di(2e3,1e4),Yc=new di(3e4,6e4);function Jc(t,e,n,r,i,o,s){return t.a.Nb(e,n,r,(function(){t.f||(t.f=!0,t.a.Ea(t.l))}),(function(){t.reset()}),i,o,s)}function Zc(t){return!(!t||"auth/cordova-not-ready"!=t.code)}function Qc(t,e,n,r,i){var o;return Bc(t.g).then((function(){return t.a.Ob(e,n,r,i).o((function(e){if(Zc(e))throw new N("operation-not-supported-in-this-environment");return o=e,Wc(t.g).then((function(){throw o}))})).then((function(){return t.a.ac()?new De((function(){})):Wc(t.g).then((function(){return t.ra()})).then((function(){})).o((function(){}))}))}))}function th(t,e,n,r,i){return t.a.Pb(r,(function(t){e.na(n,null,t,i)}),Xc.get())}Vc.prototype.ra=function(){return this.b.ra()};var eh={};function nh(t,e,n){return t=t+":"+e,n&&(t=t+":"+n.url),t}function rh(t,e,n,r){var i=nh(e,n,r);return eh[i]||(eh[i]=new Vc(t,e,n,r)),eh[i]}function ih(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function oh(t){t.g||(t.g=!0,ch(t,!1,null,null))}function sh(t){t.g&&!t.i&&ch(t,!1,null,null)}function ah(t,e,n){n=n.Fa(e.c,e.b);var r=e.g,i=e.f,o=e.i,s=e.T(),a=!!e.c.match(/Redirect$/);n(r,i,s,o).then((function(e){ch(t,a,e,null)})).o((function(e){ch(t,a,null,e)}))}function lh(t,e){if(t.b=function(){return We(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}function uh(t,e){if(t.b=function(){return Be(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function ch(t,e,n,r){e?r?lh(t,r):uh(t,n):uh(t,{user:null}),t.f=[],t.c=[]}function hh(t){var e=new N("timeout");t.a&&t.a.cancel(),t.a=Vn(Yc.get()).then((function(){t.b||(t.g=!0,ch(t,!0,null,e))}))}function dh(){}function ph(t,e){var n=t.b,r=t.c;e.Fa(r,n)(t.g,t.f,t.T(),t.i).then((function(t){e.na(r,t,null,n)})).o((function(t){e.na(r,null,t,n)}))}function fh(){this.jb=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.jb},set:function(t){this.jb=t},enumerable:!1})}function gh(t,e){this.a=e,_i(this,"verificationId",t)}function mh(t,e,n,r){return new gs(t).gb(e,n).then((function(t){return new gh(t,r)}))}function yh(t){var e=Io(t);if(!(e&&e.exp&&e.auth_time&&e.iat))throw new N("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");Ii(this,{token:t,expirationTime:gi(1e3*e.exp),authTime:gi(1e3*e.auth_time),issuedAtTime:gi(1e3*e.iat),signInProvider:e.firebase&&e.firebase.sign_in_provider?e.firebase.sign_in_provider:null,signInSecondFactor:e.firebase&&e.firebase.sign_in_second_factor?e.firebase.sign_in_second_factor:null,claims:e})}function bh(t,e,n){var r=e&&e[wh];if(!r)throw new N("argument-error","Internal assert: Invalid MultiFactorResolver");this.a=t,this.f=wt(e),this.g=n,this.c=new zo(null,r),this.b=[];var i=this;q(e[vh]||[],(function(t){(t=Ai(t))&&i.b.push(t)})),_i(this,"auth",this.a),_i(this,"session",this.c),_i(this,"hints",this.b)}ih.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},ih.prototype.h=function(t,e){if(t){this.reset(),this.g=!0;var n=t.c,r=t.b,i=t.a&&"auth/web-storage-unsupported"==t.a.code,o=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code;this.i=!(!i&&!o),"unknown"!=n||i||o?t.a?(ch(this,!0,null,t.a),Be()):e.Fa(n,r)?ah(this,t,e):We(new N("invalid-auth-event")):(ch(this,!1,null,null),Be())}else We(new N("invalid-auth-event"))},ih.prototype.ra=function(){var t=this;return new De((function(e,n){t.b?t.b().then(e,n):(t.f.push(e),t.c.push(n),hh(t))}))},dh.prototype.h=function(t,e){if(t){var n=t.c,r=t.b;t.a?(e.na(t.c,null,t.a,t.b),Be()):e.Fa(n,r)?ph(t,e):We(new N("invalid-auth-event"))}else We(new N("invalid-auth-event"))},gh.prototype.confirm=function(t){return t=ms(this.verificationId,t),this.a(t)};var vh="mfaInfo",wh="mfaPendingCredential";function xh(t,e,n,r){N.call(this,"multi-factor-auth-required",r,e),this.b=new bh(t,e,n),_i(this,"resolver",this.b)}function kh(t,e,n){if(t&&b(t.serverResponse)&&"auth/multi-factor-auth-required"===t.code)try{return new xh(e,t.serverResponse,n,t.message)}catch(r){}return null}function _h(){}function Ih(t,e,n,r){return n.Ha().then((function(n){return n={idToken:n},"undefined"!==typeof r&&(n.displayName=r),kt(n,{phoneVerificationInfo:fs(t.a)}),Xl(e,Il,n)}))}function Ch(t,e,n){return n.Ha().then((function(n){return n={mfaPendingCredential:n},kt(n,{phoneVerificationInfo:fs(t.a)}),Xl(e,Cl,n)}))}function Sh(t){_i(this,"factorId",t.fa),this.a=t}function Th(t){if(Sh.call(this,t),this.a.fa!=gs.PROVIDER_ID)throw new N("argument-error","firebase.auth.PhoneMultiFactorAssertion requires a valid firebase.auth.PhoneAuthCredential")}function Eh(t,e){for(var n in pn.call(this,t),e)this[n]=e[n]}function Nh(t,e){this.a=t,this.b=[],this.c=I(this.yc,this),Cn(this.a,"userReloaded",this.c);var n=[];e&&e.multiFactor&&e.multiFactor.enrolledFactors&&q(e.multiFactor.enrolledFactors,(function(t){var e=null,r={};if(t){t.uid&&(r[Di]=t.uid),t.displayName&&(r[Ri]=t.displayName),t.enrollmentTime&&(r[$i]=new Date(t.enrollmentTime).toISOString()),t.phoneNumber&&(r[Oi]=t.phoneNumber);try{e=new Fi(r)}catch(i){}t=e}else t=null;t&&n.push(t)})),Rh(this,n)}function Ah(t){var e=[];return q(t.mfaInfo||[],(function(t){(t=Ai(t))&&e.push(t)})),e}function Rh(t,e){t.b=e,_i(t,"enrolledFactors",e)}function $h(t,e,n){if(this.h=t,this.i=e,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function Dh(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}function Oh(t,e){t.stop(),t.b=Vn(Dh(t,e)).then((function(){return fi()})).then((function(){return t.h()})).then((function(){Oh(t,!0)})).o((function(e){t.i(e)&&Oh(t,!1)}))}function Fh(t){this.f=t,this.b=this.a=null,this.c=Date.now()}function Mh(t,e){"undefined"===typeof e&&(t.b?(e=t.b,e=e.a-e.g):e=0),t.c=Date.now()+1e3*e}function Ph(t,e){t.b=_o(e[Ma]||""),t.a=e.refreshToken,e=e.expiresIn,Mh(t,"undefined"!==typeof e?Number(e):void 0)}function Lh(t,e){t.b=e.b,t.a=e.a,t.c=e.c}function zh(t,e){return Xa(t.f,e).then((function(e){return t.b=_o(e.access_token),t.a=e.refresh_token,Mh(t,e.expires_in),{accessToken:t.b.toString(),refreshToken:t.a}})).o((function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e}))}function Bh(t,e){this.a=t||null,this.b=e||null,Ii(this,{lastSignInTime:gi(e||null),creationTime:gi(t||null)})}function Wh(t){return new Bh(t.a,t.b)}function Uh(t,e,n,r,i,o){Ii(this,{uid:t,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:e})}function Vh(t,e,n){this.N=[],this.l=t.apiKey,this.m=t.appName,this.s=t.authDomain||null;var i=r.Z.SDK_VERSION?Zr(r.Z.SDK_VERSION):null;this.a=new Oa(this.l,F(R),i),(this.u=t.emulatorConfig||null)&&Ua(this.a,this.u),this.h=new Fh(this.a),Qh(this,e[Ma]),Ph(this.h,e),_i(this,"refreshToken",this.h.a),rd(this,n||{}),Ln.call(this),this.P=!1,this.s&&ni()&&(this.b=rh(this.s,this.l,this.m,this.u)),this.W=[],this.i=null,this.D=Yh(this),this.ba=I(this.ib,this);var o=this;this.za=null,this.Pa=function(t){o.xa(t.h)},this.qa=null,this.Ba=function(t){jh(o,t.c)},this.$=null,this.aa=[],this.Oa=function(t){qh(o,t.f)},this.ja=null,this.S=new Nh(this,n),_i(this,"multiFactor",this.S)}function jh(t,e){t.u=e,Ua(t.a,e),t.b&&(e=t.b,t.b=rh(t.s,t.l,t.m,t.u),t.P&&(Kc(e,t),qc(t.b,t)))}function Hh(t,e){t.qa&&Nn(t.qa,"languageCodeChanged",t.Pa),(t.qa=e)&&Cn(e,"languageCodeChanged",t.Pa)}function Gh(t,e){t.$&&Nn(t.$,"emulatorConfigChanged",t.Ba),(t.$=e)&&Cn(e,"emulatorConfigChanged",t.Ba)}function qh(t,e){t.aa=e,ja(t.a,r.Z.SDK_VERSION?Zr(r.Z.SDK_VERSION,t.aa):null)}function Kh(t,e){t.ja&&Nn(t.ja,"frameworkChanged",t.Oa),(t.ja=e)&&Cn(e,"frameworkChanged",t.Oa)}function Xh(t){try{return r.Z.app(t.m).auth()}catch(e){throw new N("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.m+"'!")}}function Yh(t){return new $h((function(){return t.I(!0)}),(function(t){return!(!t||"auth/network-request-failed"!=t.code)}),(function(){var e=t.h.c-Date.now()-3e5;return 0<e?e:0}))}function Jh(t){t.J||t.D.b||(t.D.start(),Nn(t,"tokenChanged",t.ba),Cn(t,"tokenChanged",t.ba))}function Zh(t){Nn(t,"tokenChanged",t.ba),t.D.stop()}function Qh(t,e){t.Aa=e,_i(t,"_lat",e)}function td(t,e){et(t.W,(function(t){return t==e}))}function ed(t){for(var e=[],n=0;n<t.W.length;n++)e.push(t.W[n](t));return je(e).then((function(){return t}))}function nd(t){t.b&&!t.P&&(t.P=!0,qc(t.b,t))}function rd(t,e){Ii(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,tenantId:e.tenantId||null,metadata:new Bh(e.createdAt,e.lastLoginAt),providerData:[]}),t.a.b=t.tenantId}function id(){}function od(t){return Be().then((function(){if(t.J)throw new N("app-deleted")}))}function sd(t){return Y(t.providerData,(function(t){return t.providerId}))}function ad(t,e){e&&(ld(t,e.providerId),t.providerData.push(e))}function ld(t,e){et(t.providerData,(function(t){return t.providerId==e}))}function ud(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&_i(t,e,n)}function cd(t,e){t!=e&&(Ii(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,tenantId:e.tenantId,providerData:[]}),e.metadata?_i(t,"metadata",Wh(e.metadata)):_i(t,"metadata",new Bh),q(e.providerData,(function(e){ad(t,e)})),Lh(t.h,e.h),_i(t,"refreshToken",t.h.a),Rh(t.S,e.S.b))}function hd(t){return t.I().then((function(e){var n=t.isAnonymous;return pd(t,e).then((function(){return n||ud(t,"isAnonymous",!1),e}))}))}function dd(t,e){e[Ma]&&t.Aa!=e[Ma]&&(Ph(t.h,e),t.dispatchEvent(new Eh("tokenChanged")),Qh(t,e[Ma]),ud(t,"refreshToken",t.h.a))}function pd(t,e){return Xl(t.a,Sl,{idToken:e}).then(I(t.Kc,t))}function fd(t){return(t=t.providerUserInfo)&&t.length?Y(t,(function(t){return new Uh(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)})):[]}function gd(t,e){return hd(t).then((function(){if(Q(sd(t),e))return ed(t).then((function(){throw new N("provider-already-linked")}))}))}function md(t,e,n){var r=ys(e);return e=No(e),Ci({user:t,credential:r,additionalUserInfo:e,operationType:n})}function yd(t,e){return dd(t,e),t.reload().then((function(){return t}))}function bd(t,e,n,i,o){if(!ni())return We(new N("operation-not-supported-in-this-environment"));if(t.i&&!o)return We(t.i);var s=Eo(n.providerId),a=ui(t.uid+":::"),l=null;(!oi()||Vr())&&t.s&&n.isOAuthProvider&&(l=fu(t.s,t.l,t.m,e,n,null,a,r.Z.SDK_VERSION||null,null,null,t.tenantId,t.u));var u=Mr(l,s&&s.va,s&&s.ua);return i=i().then((function(){if(wd(t),!o)return t.I().then((function(){}))})).then((function(){return Jc(t.b,u,e,n,a,!!l,t.tenantId)})).then((function(){return new De((function(n,r){t.na(e,null,new N("cancelled-popup-request"),t.g||null),t.f=n,t.C=r,t.g=a,t.c=th(t.b,t,e,u,a)}))})).then((function(t){return u&&Fr(u),t?Ci(t):null})).o((function(t){throw u&&Fr(u),t})),xd(t,i,o)}function vd(t,e,n,r,i){if(!ni())return We(new N("operation-not-supported-in-this-environment"));if(t.i&&!i)return We(t.i);var o=null,s=ui(t.uid+":::");return r=r().then((function(){if(wd(t),!i)return t.I().then((function(){}))})).then((function(){return t.ga=s,ed(t)})).then((function(e){return t.ha&&(e=t.ha,e=e.b.set(Td,t.w(),e.a)),e})).then((function(){return Qc(t.b,e,n,s,t.tenantId)})).o((function(e){if(o=e,t.ha)return Ed(t.ha);throw o})).then((function(){if(o)throw o})),xd(t,r,i)}function wd(t){if(!t.b||!t.P){if(t.b&&!t.P)throw new N("internal-error");throw new N("auth-domain-config-required")}}function xd(t,e,n){var r=kd(t,e,n);return t.N.push(r),r.oa((function(){tt(t.N,r)})),r.o((function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=kh(e.w(),Xh(t),I(t.jc,t))),n||e}))}function kd(t,e,n){return t.i&&!n?(e.cancel(),We(t.i)):e.o((function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(t.i||t.dispatchEvent(new Eh("userInvalidated")),t.i=e),e}))}function _d(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName,emulatorConfig:t.emulatorConfig},n={};if(!t.stsTokenManager||!t.stsTokenManager.accessToken)return null;n[Ma]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null;var r=t.stsTokenManager.expirationTime;r&&(n.expiresIn=(r-Date.now())/1e3);var i=new Vh(e,n,t);return t.providerData&&q(t.providerData,(function(t){t&&ad(i,Ci(t))})),t.redirectEventId&&(i.ga=t.redirectEventId),i}function Id(t,e,n,r){var i=new Vh(t,e);return n&&(i.ha=n),r&&qh(i,r),i.reload().then((function(){return i}))}function Cd(t,e,n,r){var i=t.h,o={};return o[Ma]=i.b&&i.b.toString(),o.refreshToken=i.a,e=new Vh(e||{apiKey:t.l,authDomain:t.s,appName:t.m},o),n&&(e.ha=n),r&&qh(e,r),cd(e,t),e}function Sd(t){this.a=t,this.b=oc()}bh.prototype.Rc=function(t){var e=this;return t.tb(this.a.a,this.c).then((function(t){var n=wt(e.f);return delete n[vh],delete n[wh],kt(n,t),e.g(n)}))},T(xh,N),_h.prototype.tb=function(t,e,n){return e.type==Bo?Ih(this,t,e,n):Ch(this,t,e)},T(Sh,_h),T(Th,Sh),T(Eh,pn),t=Nh.prototype,t.yc=function(t){Rh(this,Ah(t.hd))},t.Sb=function(){return this.a.I().then((function(t){return new zo(t,null)}))},t.fc=function(t,e){var n=this,r=this.a.a;return this.Sb().then((function(n){return t.tb(r,n,e)})).then((function(t){return dd(n.a,t),n.a.reload()}))},t.bd=function(t){var e=this,n="string"===typeof t?t:t.uid,r=this.a.a;return this.a.I().then((function(t){return Xl(r,Kl,{idToken:t,mfaEnrollmentId:n})})).then((function(t){var r=X(e.b,(function(t){return t.uid!=n}));return Rh(e,r),dd(e.a,t),e.a.reload().o((function(t){if("auth/user-token-expired"!=t.code)throw t}))}))},t.w=function(){return{multiFactor:{enrolledFactors:Y(this.b,(function(t){return t.w()}))}}},$h.prototype.start=function(){this.a=this.c,Oh(this,!0)},$h.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},Fh.prototype.w=function(){return{apiKey:this.f.c,refreshToken:this.a,accessToken:this.b&&this.b.toString(),expirationTime:this.c}},Fh.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?We(new N("user-token-expired")):t||!this.b||Date.now()>this.c-3e4?this.a?zh(this,{grant_type:"refresh_token",refresh_token:this.a}):Be(null):Be({accessToken:this.b.toString(),refreshToken:this.a})},Bh.prototype.w=function(){return{lastLoginAt:this.b,createdAt:this.a}},T(Vh,Ln),Vh.prototype.xa=function(t){this.za=t,Wa(this.a,t)},Vh.prototype.la=function(){return this.za},Vh.prototype.Ga=function(){return rt(this.aa)},Vh.prototype.ib=function(){this.D.b&&(this.D.stop(),this.D.start())},_i(Vh.prototype,"providerId","firebase"),t=Vh.prototype,t.reload=function(){var t=this;return xd(this,od(this).then((function(){return hd(t).then((function(){return ed(t)})).then(id)})))},t.oc=function(t){return this.I(t).then((function(t){return new yh(t)}))},t.I=function(t){var e=this;return xd(this,od(this).then((function(){return e.h.getToken(t)})).then((function(t){if(!t)throw new N("internal-error");return t.accessToken!=e.Aa&&(Qh(e,t.accessToken),e.dispatchEvent(new Eh("tokenChanged"))),ud(e,"refreshToken",t.refreshToken),t.accessToken})))},t.Kc=function(t){if(t=t.users,!t||!t.length)throw new N("internal-error");t=t[0],rd(this,{uid:t.localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt,tenantId:t.tenantId});for(var e=fd(t),n=0;n<e.length;n++)ad(this,e[n]);ud(this,"isAnonymous",!(this.email&&t.passwordHash)&&!(this.providerData&&this.providerData.length)),this.dispatchEvent(new Eh("userReloaded",{hd:t}))},t.Lc=function(t){return xi("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.ub(t)},t.ub=function(t){var e=this,n=null;return xd(this,t.c(this.a,this.uid).then((function(t){return dd(e,t),n=md(e,t,"reauthenticate"),e.i=null,e.reload()})).then((function(){return n})),!0)},t.Cc=function(t){return xi("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.rb(t)},t.rb=function(t){var e=this,n=null;return xd(this,gd(this,t.providerId).then((function(){return e.I()})).then((function(n){return t.b(e.a,n)})).then((function(t){return n=md(e,t,"link"),yd(e,t)})).then((function(){return n})))},t.Dc=function(t,e){var n=this;return xd(this,gd(this,"phone").then((function(){return mh(Xh(n),t,e,I(n.rb,n))})))},t.Mc=function(t,e){var n=this;return xd(this,Be().then((function(){return mh(Xh(n),t,e,I(n.ub,n))})),!0)},t.Cb=function(t){var e=this;return xd(this,this.I().then((function(n){return e.a.Cb(n,t)})).then((function(t){return dd(e,t),e.reload()})))},t.ed=function(t){var e=this;return xd(this,this.I().then((function(n){return t.b(e.a,n)})).then((function(t){return dd(e,t),e.reload()})))},t.Db=function(t){var e=this;return xd(this,this.I().then((function(n){return e.a.Db(n,t)})).then((function(t){return dd(e,t),e.reload()})))},t.Eb=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return od(this);var e=this;return xd(this,this.I().then((function(n){return e.a.Eb(n,{displayName:t.displayName,photoUrl:t.photoURL})})).then((function(t){return dd(e,t),ud(e,"displayName",t.displayName||null),ud(e,"photoURL",t.photoUrl||null),q(e.providerData,(function(t){"password"===t.providerId&&(_i(t,"displayName",e.displayName),_i(t,"photoURL",e.photoURL))})),ed(e)})).then(id))},t.cd=function(t){var e=this;return xd(this,hd(this).then((function(n){return Q(sd(e),t)?ll(e.a,n,[t]).then((function(t){var n={};return q(t.providerUserInfo||[],(function(t){n[t.providerId]=!0})),q(sd(e),(function(t){n[t]||ld(e,t)})),n[gs.PROVIDER_ID]||_i(e,"phoneNumber",null),ed(e)})):ed(e).then((function(){throw new N("no-such-provider")}))})))},t.delete=function(){var t=this;return xd(this,this.I().then((function(e){return Xl(t.a,wl,{idToken:e})})).then((function(){t.dispatchEvent(new Eh("userDeleted"))}))).then((function(){for(var e=0;e<t.N.length;e++)t.N[e].cancel("app-deleted");Hh(t,null),Gh(t,null),Kh(t,null),t.N=[],t.J=!0,Zh(t),_i(t,"refreshToken",null),t.b&&Kc(t.b,t)}))},t.Gb=function(t,e){return!!("linkViaPopup"==t&&(this.g||null)==e&&this.f||"reauthViaPopup"==t&&(this.g||null)==e&&this.f||"linkViaRedirect"==t&&(this.ga||null)==e||"reauthViaRedirect"==t&&(this.ga||null)==e)},t.na=function(t,e,n,r){"linkViaPopup"!=t&&"reauthViaPopup"!=t||r!=(this.g||null)||(n&&this.C?this.C(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},t.Fa=function(t,e){return"linkViaPopup"==t&&e==(this.g||null)?I(this.Lb,this):"reauthViaPopup"==t&&e==(this.g||null)?I(this.Mb,this):"linkViaRedirect"==t&&(this.ga||null)==e?I(this.Lb,this):"reauthViaRedirect"==t&&(this.ga||null)==e?I(this.Mb,this):null},t.Ec=function(t){var e=this;return bd(this,"linkViaPopup",t,(function(){return gd(e,t.providerId).then((function(){return ed(e)}))}),!1)},t.Nc=function(t){return bd(this,"reauthViaPopup",t,(function(){return Be()}),!0)},t.Fc=function(t){var e=this;return vd(this,"linkViaRedirect",t,(function(){return gd(e,t.providerId)}),!1)},t.Oc=function(t){return vd(this,"reauthViaRedirect",t,(function(){return Be()}),!0)},t.Lb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return n=this.I().then((function(n){return pl(i.a,{requestUri:t,postBody:r,sessionId:e,idToken:n})})).then((function(t){return o=md(i,t,"link"),yd(i,t)})).then((function(){return o})),xd(this,n)},t.Mb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null,s=Be().then((function(){return Vo(fl(i.a,{requestUri:t,sessionId:e,postBody:r,tenantId:n}),i.uid)})).then((function(t){return o=md(i,t,"reauthenticate"),dd(i,t),i.i=null,i.reload()})).then((function(){return o}));return xd(this,s,!0)},t.vb=function(t){var e=this,n=null;return xd(this,this.I().then((function(e){return n=e,"undefined"===typeof t||vt(t)?{}:mo(new oo(t))})).then((function(t){return e.a.vb(n,t)})).then((function(t){if(e.email!=t)return e.reload()})).then((function(){})))},t.Fb=function(t,e){var n=this,r=null;return xd(this,this.I().then((function(t){return r=t,"undefined"===typeof e||vt(e)?{}:mo(new oo(e))})).then((function(e){return n.a.Fb(r,t,e)})).then((function(t){if(n.email!=t)return n.reload()})).then((function(){})))},t.jc=function(t){var e=null,n=this;return t=Vo(Be(t),n.uid).then((function(t){return e=md(n,t,"reauthenticate"),dd(n,t),n.i=null,n.reload()})).then((function(){return e})),xd(this,t,!0)},t.toJSON=function(){return this.w()},t.w=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.s,stsTokenManager:this.h.w(),redirectEventId:this.ga||null};return this.metadata&&kt(t,this.metadata.w()),q(this.providerData,(function(e){t.providerData.push(Si(e))})),kt(t,this.S.w()),t};var Td={name:"redirectUser",F:"session"};function Ed(t){return uc(t.b,Td,t.a)}function Nd(t,e){return t.b.get(Td,t.a).then((function(t){return t&&e&&(t.authDomain=e),_d(t||{})}))}function Ad(t){this.a=t,this.b=oc(),this.c=null,this.f=$d(this),this.b.addListener(Od("local"),this.a,I(this.g,this))}function Rd(t,e){var n,r=[];for(n in nc)nc[n]!==e&&r.push(uc(t.b,Od(nc[n]),t.a));return r.push(uc(t.b,Dd,t.a)),Ve(r)}function $d(t){var e=Od("local"),n=Od("session"),r=Od("none");return lc(t.b,e,t.a).then((function(){return t.b.get(n,t.a)})).then((function(i){return i?n:t.b.get(r,t.a).then((function(n){return n?r:t.b.get(e,t.a).then((function(n){return n?e:t.b.get(Dd,t.a).then((function(t){return t?Od(t):e}))}))}))})).then((function(e){return t.c=e,Rd(t,e.F)})).o((function(){t.c||(t.c=e)}))}Ad.prototype.g=function(){var t=this,e=Od("local");zd(this,(function(){return Be().then((function(){return t.c&&"local"!=t.c.F?t.b.get(e,t.a):null})).then((function(n){if(n)return Rd(t,"local").then((function(){t.c=e}))}))}))};var Dd={name:"persistence",F:"session"};function Od(t){return{name:"authUser",F:t}}function Fd(t){return zd(t,(function(){return t.b.set(Dd,t.c.F,t.a)}))}function Md(t,e){return zd(t,(function(){return t.b.set(t.c,e.w(),t.a)}))}function Pd(t){return zd(t,(function(){return uc(t.b,t.c,t.a)}))}function Ld(t,e,n){return zd(t,(function(){return t.b.get(t.c,t.a).then((function(t){return t&&e&&(t.authDomain=e),t&&n&&(t.emulatorConfig=n),_d(t||{})}))}))}function zd(t,e){return t.f=t.f.then(e,e),t.f}function Bd(t){if(this.l=!1,_i(this,"settings",new fh),_i(this,"app",t),!ep(this).options||!ep(this).options.apiKey)throw new N("invalid-api-key");t=r.Z.SDK_VERSION?Zr(r.Z.SDK_VERSION):null,this.a=new Oa(ep(this).options&&ep(this).options.apiKey,F(R),t),this.P=[],this.s=[],this.N=[],this.Pa=r.Z.INTERNAL.createSubscribe(I(this.zc,this)),this.W=void 0,this.ib=r.Z.INTERNAL.createSubscribe(I(this.Ac,this)),Yd(this,null),this.i=new Ad(ep(this).options.apiKey+":"+ep(this).name),this.D=new Sd(ep(this).options.apiKey+":"+ep(this).name),this.$=sp(this,Zd(this)),this.h=sp(this,Qd(this)),this.ba=!1,this.ja=I(this.Zc,this),this.Ba=I(this.da,this),this.qa=I(this.mc,this),this.za=I(this.wc,this),this.Aa=I(this.xc,this),this.b=null,qd(this),this.INTERNAL={},this.INTERNAL["delete"]=I(this.delete,this),this.INTERNAL.logFramework=I(this.Gc,this),this.u=0,Ln.call(this),Hd(this),this.J=[],this.R=null}function Wd(t){pn.call(this,"languageCodeChanged"),this.h=t}function Ud(t){pn.call(this,"emulatorConfigChanged"),this.c=t}function Vd(t){pn.call(this,"frameworkChanged"),this.f=t}function jd(t){"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),c.document&&!t&&Br().then((function(){var t=c.document.createElement("div");t.innerText="Running in emulator mode. Do not use with production credentials.",t.style.position="fixed",t.style.width="100%",t.style.backgroundColor="#ffffff",t.style.border=".1em solid #000000",t.style.color="#b50000",t.style.bottom="0px",t.style.left="0px",t.style.margin="0px",t.style.zIndex=1e4,t.style.textAlign="center",t.classList.add("firebase-emulator-warning"),c.document.body.appendChild(t)}))}function Hd(t){Object.defineProperty(t,"lc",{get:function(){return this.la()},set:function(t){this.xa(t)},enumerable:!1}),t.aa=null,Object.defineProperty(t,"ti",{get:function(){return this.T()},set:function(t){this.zb(t)},enumerable:!1}),t.S=null,Object.defineProperty(t,"emulatorConfig",{get:function(){if(this.R){var t=ir(this.R.url);t=Ci({protocol:t.c,host:t.a,port:t.g,options:Ci({disableWarnings:this.R.ec})})}else t=null;return t},enumerable:!1})}function Gd(t){return t.Oa||We(new N("auth-domain-config-required"))}function qd(t){var e=ep(t).options.authDomain,n=ep(t).options.apiKey;e&&ni()&&(t.Oa=t.$.then((function(){if(!t.l){if(t.b=rh(e,n,ep(t).name,t.R),qc(t.b,t),np(t)&&nd(np(t)),t.m){nd(t.m);var r=t.m;r.xa(t.la()),Hh(r,t),r=t.m,qh(r,t.J),Kh(r,t),r=t.m,jh(r,t.R),Gh(r,t),t.m=null}return t.b}})))}function Kd(t){if(!ni())return We(new N("operation-not-supported-in-this-environment"));var e=Gd(t).then((function(){return t.b.ra()})).then((function(t){return t?Ci(t):null}));return sp(t,e)}function Xd(t,e){var n={};return n.apiKey=ep(t).options.apiKey,n.authDomain=ep(t).options.authDomain,n.appName=ep(t).name,t.R&&(n.emulatorConfig=t.R),t.$.then((function(){return Id(n,e,t.D,t.Ga())})).then((function(e){return np(t)&&e.uid==np(t).uid?(cd(np(t),e),t.da(e)):(Yd(t,e),nd(e),t.da(e))})).then((function(){ip(t)}))}function Yd(t,e){np(t)&&(td(np(t),t.Ba),Nn(np(t),"tokenChanged",t.qa),Nn(np(t),"userDeleted",t.za),Nn(np(t),"userInvalidated",t.Aa),Zh(np(t))),e&&(e.W.push(t.Ba),Cn(e,"tokenChanged",t.qa),Cn(e,"userDeleted",t.za),Cn(e,"userInvalidated",t.Aa),0<t.u&&Jh(e)),_i(t,"currentUser",e),e&&(e.xa(t.la()),Hh(e,t),qh(e,t.J),Kh(e,t),jh(e,t.R),Gh(e,t))}function Jd(t){var e=Nd(t.D,ep(t).options.authDomain).then((function(e){return(t.m=e)&&(e.ha=t.D),Ed(t.D)}));return sp(t,e)}function Zd(t){var e=ep(t).options.authDomain,n=Jd(t).then((function(){return Ld(t.i,e,t.R)})).then((function(e){return e?(e.ha=t.D,t.m&&(t.m.ga||null)==(e.ga||null)?e:e.reload().then((function(){return Md(t.i,e).then((function(){return e}))})).o((function(n){return"auth/network-request-failed"==n.code?e:Pd(t.i)}))):null})).then((function(e){Yd(t,e||null)}));return sp(t,n)}function Qd(t){return t.$.then((function(){return Kd(t)})).o((function(){})).then((function(){if(!t.l)return t.ja()})).o((function(){})).then((function(){if(!t.l){t.ba=!0;var e=t.i;e.b.addListener(Od("local"),e.a,t.ja)}}))}function tp(t,e){var n=null,r=null;return sp(t,e.then((function(e){return n=ys(e),r=No(e),Xd(t,e)}),(function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=kh(e.w(),t,I(t.kc,t))),n||e})).then((function(){return Ci({user:np(t),credential:n,additionalUserInfo:r,operationType:"signIn"})})))}function ep(t){return t.app}function np(t){return t.currentUser}function rp(t){return np(t)&&np(t)._lat||null}function ip(t){if(t.ba){for(var e=0;e<t.s.length;e++)t.s[e]&&t.s[e](rp(t));if(t.W!==t.getUid()&&t.N.length)for(t.W=t.getUid(),e=0;e<t.N.length;e++)t.N[e]&&t.N[e](rp(t))}}function op(t,e){t.N.push(e),sp(t,t.h.then((function(){!t.l&&Q(t.N,e)&&t.W!==t.getUid()&&(t.W=t.getUid(),e(rp(t)))})))}function sp(t,e){return t.P.push(e),e.oa((function(){tt(t.P,e)})),e}function ap(){}function lp(){this.a={},this.b=1e12}Ad.prototype.yb=function(t){var e=null,n=this;return rc(t),zd(this,(function(){return t!=n.c.F?n.b.get(n.c,n.a).then((function(r){return e=r,Rd(n,t)})).then((function(){if(n.c=Od(t),e)return n.b.set(n.c,e,n.a)})):Be()}))},T(Bd,Ln),T(Wd,pn),T(Ud,pn),T(Vd,pn),t=Bd.prototype,t.yb=function(t){return t=this.i.yb(t),sp(this,t)},t.xa=function(t){this.aa===t||this.l||(this.aa=t,Wa(this.a,this.aa),this.dispatchEvent(new Wd(this.la())))},t.la=function(){return this.aa},t.fd=function(){var t=c.navigator;this.xa(t&&(t.languages&&t.languages[0]||t.language||t.userLanguage)||null)},t.gd=function(t,e){if(!this.R){if(!/^https?:\/\//.test(t))throw new N("argument-error","Emulator URL must start with a valid scheme (http:// or https://).");e=!!e&&!!e.disableWarnings,jd(e),this.R={url:t,ec:e},this.settings.jb=!0,Ua(this.a,this.R),this.dispatchEvent(new Ud(this.R))}},t.Gc=function(t){this.J.push(t),ja(this.a,r.Z.SDK_VERSION?Zr(r.Z.SDK_VERSION,this.J):null),this.dispatchEvent(new Vd(this.J))},t.Ga=function(){return rt(this.J)},t.zb=function(t){this.S===t||this.l||(this.S=t,this.a.b=this.S)},t.T=function(){return this.S},t.toJSON=function(){return{apiKey:ep(this).options.apiKey,authDomain:ep(this).options.authDomain,appName:ep(this).name,currentUser:np(this)&&np(this).w()}},t.Gb=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==e&&!!this.f;default:return!1}},t.na=function(t,e,n,r){"signInViaPopup"==t&&this.g==r&&(n&&this.C?this.C(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},t.Fa=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.g==e&&this.f?I(this.ic,this):null},t.ic=function(t,e,n,r){var i=this,o={requestUri:t,postBody:r,sessionId:e,tenantId:n};return this.c&&(this.c.cancel(),this.c=null),i.$.then((function(){return tp(i,dl(i.a,o))}))},t.Xc=function(t){if(!ni())return We(new N("operation-not-supported-in-this-environment"));var e=this,n=Eo(t.providerId),i=ui(),o=null;(!oi()||Vr())&&ep(this).options.authDomain&&t.isOAuthProvider&&(o=fu(ep(this).options.authDomain,ep(this).options.apiKey,ep(this).name,"signInViaPopup",t,null,i,r.Z.SDK_VERSION||null,null,null,this.T(),this.R));var s=Mr(o,n&&n.va,n&&n.ua);return n=Gd(this).then((function(n){return Jc(n,s,"signInViaPopup",t,i,!!o,e.T())})).then((function(){return new De((function(t,n){e.na("signInViaPopup",null,new N("cancelled-popup-request"),e.g),e.f=t,e.C=n,e.g=i,e.c=th(e.b,e,"signInViaPopup",s,i)}))})).then((function(t){return s&&Fr(s),t?Ci(t):null})).o((function(t){throw s&&Fr(s),t})),sp(this,n)},t.Yc=function(t){if(!ni())return We(new N("operation-not-supported-in-this-environment"));var e=this,n=Gd(this).then((function(){return Fd(e.i)})).then((function(){return Qc(e.b,"signInViaRedirect",t,void 0,e.T())}));return sp(this,n)},t.ra=function(){var t=this;return Kd(this).then((function(e){return t.b&&sh(t.b.b),e})).o((function(e){throw t.b&&sh(t.b.b),e}))},t.dd=function(t){if(!t)return We(new N("null-user"));if(this.S!=t.tenantId)return We(new N("tenant-id-mismatch"));var e=this,n={};n.apiKey=ep(this).options.apiKey,n.authDomain=ep(this).options.authDomain,n.appName=ep(this).name;var r=Cd(t,n,e.D,e.Ga());return sp(this,this.h.then((function(){if(ep(e).options.apiKey!=t.l)return r.reload()})).then((function(){return np(e)&&t.uid==np(e).uid?(cd(np(e),t),e.da(t)):(Yd(e,r),nd(r),e.da(r))})).then((function(){ip(e)})))},t.Bb=function(){var t=this,e=this.h.then((function(){return t.b&&sh(t.b.b),np(t)?(Yd(t,null),Pd(t.i).then((function(){ip(t)}))):Be()}));return sp(this,e)},t.Zc=function(){var t=this;return Ld(this.i,ep(this).options.authDomain).then((function(e){if(!t.l){var n;if(n=np(t)&&e){n=np(t).uid;var r=e.uid;n=void 0!==n&&null!==n&&""!==n&&void 0!==r&&null!==r&&""!==r&&n==r}if(n)return cd(np(t),e),np(t).I();(np(t)||e)&&(Yd(t,e),e&&(nd(e),e.ha=t.D),t.b&&qc(t.b,t),ip(t))}}))},t.da=function(t){return Md(this.i,t)},t.mc=function(){ip(this),this.da(np(this))},t.wc=function(){this.Bb()},t.xc=function(){this.Bb()},t.kc=function(t){var e=this;return this.h.then((function(){return tp(e,Be(t))}))},t.zc=function(t){var e=this;this.addAuthTokenListener((function(){t.next(np(e))}))},t.Ac=function(t){var e=this;op(this,(function(){t.next(np(e))}))},t.Ic=function(t,e,n){var r=this;return this.ba&&Promise.resolve().then((function(){"function"===typeof t?t(np(r)):"function"===typeof t.next&&t.next(np(r))})),this.Pa(t,e,n)},t.Hc=function(t,e,n){var r=this;return this.ba&&Promise.resolve().then((function(){r.W=r.getUid(),"function"===typeof t?t(np(r)):"function"===typeof t.next&&t.next(np(r))})),this.ib(t,e,n)},t.nc=function(t){var e=this,n=this.h.then((function(){return np(e)?np(e).I(t).then((function(t){return{accessToken:t}})):null}));return sp(this,n)},t.Tc=function(t){var e=this;return this.h.then((function(){return tp(e,Xl(e.a,Vl,{token:t}))})).then((function(t){var n=t.user;return ud(n,"isAnonymous",!1),e.da(n),t}))},t.Uc=function(t,e){var n=this;return this.h.then((function(){return tp(n,Xl(n.a,jl,{email:t,password:e}))}))},t.dc=function(t,e){var n=this;return this.h.then((function(){return tp(n,Xl(n.a,bl,{email:t,password:e}))}))},t.ab=function(t){var e=this;return this.h.then((function(){return tp(e,t.ka(e.a))}))},t.Sc=function(t){return xi("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.ab(t)},t.Ab=function(){var t=this;return this.h.then((function(){var e=np(t);if(e&&e.isAnonymous){var n=Ci({providerId:null,isNewUser:!1});return Ci({user:e,credential:null,additionalUserInfo:n,operationType:"signIn"})}return tp(t,t.a.Ab()).then((function(e){var n=e.user;return ud(n,"isAnonymous",!0),t.da(n),e}))}))},t.getUid=function(){return np(this)&&np(this).uid||null},t.cc=function(t){this.addAuthTokenListener(t),this.u++,0<this.u&&np(this)&&Jh(np(this))},t.Pc=function(t){var e=this;q(this.s,(function(n){n==t&&e.u--})),0>this.u&&(this.u=0),0==this.u&&np(this)&&Zh(np(this)),this.removeAuthTokenListener(t)},t.addAuthTokenListener=function(t){var e=this;this.s.push(t),sp(this,this.h.then((function(){e.l||Q(e.s,t)&&t(rp(e))})))},t.removeAuthTokenListener=function(t){et(this.s,(function(e){return e==t}))},t.delete=function(){this.l=!0;for(var t=0;t<this.P.length;t++)this.P[t].cancel("app-deleted");return this.P=[],this.i&&(t=this.i,t.b.removeListener(Od("local"),t.a,this.ja)),this.b&&(Kc(this.b,this),sh(this.b.b)),Promise.resolve()},t.hc=function(t){return sp(this,Qa(this.a,t))},t.Bc=function(t){return!!hs(t)},t.xb=function(t,e){var n=this;return sp(this,Be().then((function(){var t=new oo(e);if(!t.c)throw new N("argument-error",lo+" must be true when sending sign in link to email");return mo(t)})).then((function(e){return n.a.xb(t,e)})).then((function(){})))},t.jd=function(t){return this.Sa(t).then((function(t){return t.data.email}))},t.ob=function(t,e){return sp(this,this.a.ob(t,e).then((function(){})))},t.Sa=function(t){return sp(this,this.a.Sa(t).then((function(t){return new Mi(t)})))},t.kb=function(t){return sp(this,this.a.kb(t).then((function(){})))},t.wb=function(t,e){var n=this;return sp(this,Be().then((function(){return"undefined"===typeof e||vt(e)?{}:mo(new oo(e))})).then((function(e){return n.a.wb(t,e)})).then((function(){})))},t.Wc=function(t,e){return sp(this,mh(this,t,e,I(this.ab,this)))},t.Vc=function(t,e){var n=this;return sp(this,Be().then((function(){var r=e||Ar(),i=cs(t,r);if(r=hs(r),!r)throw new N("argument-error","Invalid email link!");if(r.tenantId!==n.T())throw new N("tenant-id-mismatch");return n.ab(i)})))},ap.prototype.render=function(){},ap.prototype.reset=function(){},ap.prototype.getResponse=function(){},ap.prototype.execute=function(){};var up=null;function cp(t,e){return(e=hp(e))&&t.a[e]||null}function hp(t){return(t="undefined"===typeof t?1e12:t)?t.toString():null}function dp(t,e){this.g=!1,this.c=e,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=be(t);var n=this;this.i=function(){n.execute()},this.h?this.execute():Cn(this.f,"click",this.i)}function pp(t){if(t.g)throw Error("reCAPTCHA mock was already deleted!")}function fp(){}function gp(){}lp.prototype.render=function(t,e){return this.a[this.b.toString()]=new dp(t,e),this.b++},lp.prototype.reset=function(t){var e=cp(this,t);t=hp(t),e&&t&&(e.delete(),delete this.a[t])},lp.prototype.getResponse=function(t){return(t=cp(this,t))?t.getResponse():null},lp.prototype.execute=function(t){(t=cp(this,t))&&t.execute()},dp.prototype.getResponse=function(){return pp(this),this.b},dp.prototype.execute=function(){pp(this);var t=this;this.a||(this.a=setTimeout((function(){t.b=qr();var e=t.c.callback,n=t.c["expired-callback"];if(e)try{e(t.b)}catch(r){}t.a=setTimeout((function(){if(t.a=null,t.b=null,n)try{n()}catch(r){}t.h&&t.execute()}),6e4)}),500))},dp.prototype.delete=function(){pp(this),this.g=!0,clearTimeout(this.a),this.a=null,Nn(this.f,"click",this.i)},_i(fp,"FACTOR_ID","phone"),gp.prototype.g=function(){return up||(up=new lp),Be(up)},gp.prototype.c=function(){};var mp=null;function yp(){this.b=c.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var bp=new It(Et,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),vp=new di(3e4,6e4);yp.prototype.g=function(t){var e=this;return new De((function(n,r){var i=setTimeout((function(){r(new N("network-request-failed"))}),vp.get());if(!c.grecaptcha||t!==e.f&&!e.b){c[e.a]=function(){if(c.grecaptcha){e.f=t;var o=c.grecaptcha.render;c.grecaptcha.render=function(t,n){return t=o(t,n),e.b++,t},clearTimeout(i),n(c.grecaptcha)}else clearTimeout(i),r(new N("internal-error"));delete c[e.a]};var o=$t(bp,{onload:e.a,hl:t||""});Be(Sa(o)).o((function(){clearTimeout(i),r(new N("internal-error","Unable to load external reCAPTCHA dependencies!"))}))}else clearTimeout(i),n(c.grecaptcha)}))},yp.prototype.c=function(){this.b--};var wp=null;function xp(t,e,n,r,i,o,s){if(_i(this,"type","recaptcha"),this.c=this.f=null,this.J=!1,this.v=e,this.g=null,s?(mp||(mp=new gp),s=mp):(wp||(wp=new yp),s=wp),this.m=s,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[Ip])throw new N("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[Cp],!c.document)throw new N("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!be(e)||!this.i&&be(e).hasChildNodes())throw new N("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.s=new Oa(t,o||null,i||null),this.u=r||function(){return null};var a=this;this.l=[];var l=this.a[kp];this.a[kp]=function(t){if(Sp(a,t),"function"===typeof l)l(t);else if("string"===typeof l){var e=ti(l,c);"function"===typeof e&&e(t)}};var u=this.a[_p];this.a[_p]=function(){if(Sp(a,null),"function"===typeof u)u();else if("string"===typeof u){var t=ti(u,c);"function"===typeof t&&t()}}}var kp="callback",_p="expired-callback",Ip="sitekey",Cp="size";function Sp(t,e){for(var n=0;n<t.l.length;n++)try{t.l[n](e)}catch(r){}}function Tp(t,e){et(t.l,(function(t){return t==e}))}function Ep(t,e){return t.h.push(e),e.oa((function(){tt(t.h,e)})),e}function Np(t){if(t.J)throw new N("internal-error","RecaptchaVerifier instance has been destroyed.")}function Ap(t,e,n){var i=!1;try{this.b=n||r.Z.app()}catch(a){throw new N("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new N("invalid-api-key");n=this.b.options.apiKey;var o=this,s=null;try{s=this.b.auth().Ga()}catch(a){}try{i=this.b.auth().settings.appVerificationDisabledForTesting}catch(a){}s=r.Z.SDK_VERSION?Zr(r.Z.SDK_VERSION,s):null,xp.call(this,n,t,e,(function(){try{var t=o.b.auth().la()}catch(e){t=null}return t}),s,F(R),i)}function Rp(t,e,n,r){t:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,s=0;s<e.length;s++)if(e[s].optional)o=!0;else{if(o)throw new N("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=e.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=e[i].optional&&void 0===n[i],!e[i].M(n[i])&&!o){if(e=e[i],0>i||i>=$p.length)throw new N("internal-error","Argument validator received an unsupported number of arguments.");n=$p[i],r=(r?"":n+" argument ")+(e.name?'"'+e.name+'" ':"")+"must be "+e.K+".";break t}r=null}}if(r)throw new N("argument-error",t+" failed: "+r)}t=xp.prototype,t.Ia=function(){var t=this;return this.f?this.f:this.f=Ep(this,Be().then((function(){if(ri()&&!jr())return Br();throw new N("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")})).then((function(){return t.m.g(t.u())})).then((function(e){return t.g=e,Xl(t.s,$l,{})})).then((function(e){t.a[Ip]=e.recaptchaSiteKey})).o((function(e){throw t.f=null,e})))},t.render=function(){Np(this);var t=this;return Ep(this,this.Ia().then((function(){if(null===t.c){var e=t.v;if(!t.i){var n=be(e);e=_e("DIV"),n.appendChild(e)}t.c=t.g.render(e,t.a)}return t.c})))},t.verify=function(){Np(this);var t=this;return Ep(this,this.render().then((function(e){return new De((function(n){var r=t.g.getResponse(e);if(r)n(r);else{var i=function(e){e&&(Tp(t,i),n(e))};t.l.push(i),t.i&&t.g.execute(t.c)}}))})))},t.reset=function(){Np(this),null!==this.c&&this.g.reset(this.c)},t.clear=function(){Np(this),this.J=!0,this.m.c();for(var t=0;t<this.h.length;t++)this.h[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){t=be(this.v);for(var e;e=t.firstChild;)t.removeChild(e)}},T(Ap,xp);var $p="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function Dp(t,e){return{name:t||"",K:"a valid string",optional:!!e,M:function(t){return"string"===typeof t}}}function Op(t,e){return{name:t||"",K:"a boolean",optional:!!e,M:function(t){return"boolean"===typeof t}}}function Fp(t,e){return{name:t||"",K:"a valid object",optional:!!e,M:b}}function Mp(t,e){return{name:t||"",K:"a function",optional:!!e,M:function(t){return"function"===typeof t}}}function Pp(t,e){return{name:t||"",K:"null",optional:!!e,M:function(t){return null===t}}}function Lp(){return{name:"",K:"an HTML element",optional:!1,M:function(t){return!!(t&&t instanceof Element)}}}function zp(){return{name:"auth",K:"an instance of Firebase Auth",optional:!0,M:function(t){return!!(t&&t instanceof Bd)}}}function Bp(){return{name:"app",K:"an instance of Firebase App",optional:!0,M:function(t){return!!(t&&t instanceof r.Z.app.App)}}}function Wp(t){return{name:t?t+"Credential":"credential",K:t?"a valid "+t+" credential":"a valid credential",optional:!1,M:function(e){if(!e)return!1;var n=!t||e.providerId===t;return!(!e.ka||!n)}}}function Up(){return{name:"multiFactorAssertion",K:"a valid multiFactorAssertion",optional:!1,M:function(t){return!!t&&!!t.tb}}}function Vp(){return{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}}function jp(t,e){return b(t)&&"string"===typeof t.type&&t.type===e&&"function"===typeof t.Ha}function Hp(t){return b(t)&&"string"===typeof t.uid}function Gp(){return{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!==typeof t.type||"function"!==typeof t.verify)}}}function qp(t,e,n,r){return{name:n||"",K:t.K+" or "+e.K,optional:!!r,M:function(n){return t.M(n)||e.M(n)}}}function Kp(t,e){for(var n in e){var r=e[n].name;t[r]=Jp(r,t[n],e[n].j)}}function Xp(t,e){for(var n in e){var r=e[n].name;r!==n&&Object.defineProperty(t,r,{get:C((function(t){return this[t]}),n),set:C((function(t,e,n,r){Rp(t,[n],[r],!0),this[e]=r}),r,n,e[n].lb),enumerable:!0})}}function Yp(t,e,n,r){t[e]=Jp(e,n,r)}function Jp(t,e,n){function r(){var t=Array.prototype.slice.call(arguments);return Rp(o,n,t),e.apply(this,t)}if(!n)return e;var i,o=Zp(t);for(i in e)r[i]=e[i];for(i in e.prototype)r.prototype[i]=e.prototype[i];return r}function Zp(t){return t=t.split("."),t[t.length-1]}Kp(Bd.prototype,{kb:{name:"applyActionCode",j:[Dp("code")]},Sa:{name:"checkActionCode",j:[Dp("code")]},ob:{name:"confirmPasswordReset",j:[Dp("code"),Dp("newPassword")]},dc:{name:"createUserWithEmailAndPassword",j:[Dp("email"),Dp("password")]},hc:{name:"fetchSignInMethodsForEmail",j:[Dp("email")]},ra:{name:"getRedirectResult",j:[]},Bc:{name:"isSignInWithEmailLink",j:[Dp("emailLink")]},Hc:{name:"onAuthStateChanged",j:[qp(Fp(),Mp(),"nextOrObserver"),Mp("opt_error",!0),Mp("opt_completed",!0)]},Ic:{name:"onIdTokenChanged",j:[qp(Fp(),Mp(),"nextOrObserver"),Mp("opt_error",!0),Mp("opt_completed",!0)]},wb:{name:"sendPasswordResetEmail",j:[Dp("email"),qp(Fp("opt_actionCodeSettings",!0),Pp(null,!0),"opt_actionCodeSettings",!0)]},xb:{name:"sendSignInLinkToEmail",j:[Dp("email"),Fp("actionCodeSettings")]},yb:{name:"setPersistence",j:[Dp("persistence")]},Sc:{name:"signInAndRetrieveDataWithCredential",j:[Wp()]},Ab:{name:"signInAnonymously",j:[]},ab:{name:"signInWithCredential",j:[Wp()]},Tc:{name:"signInWithCustomToken",j:[Dp("token")]},Uc:{name:"signInWithEmailAndPassword",j:[Dp("email"),Dp("password")]},Vc:{name:"signInWithEmailLink",j:[Dp("email"),Dp("emailLink",!0)]},Wc:{name:"signInWithPhoneNumber",j:[Dp("phoneNumber"),Gp()]},Xc:{name:"signInWithPopup",j:[Vp()]},Yc:{name:"signInWithRedirect",j:[Vp()]},dd:{name:"updateCurrentUser",j:[qp(function(t){return{name:"user",K:"an instance of Firebase User",optional:!!t,M:function(t){return!!(t&&t instanceof Vh)}}}(),Pp(),"user")]},Bb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[Dp(null,!0)]},fd:{name:"useDeviceLanguage",j:[]},gd:{name:"useEmulator",j:[Dp("url"),Fp("options",!0)]},jd:{name:"verifyPasswordResetCode",j:[Dp("code")]}}),Xp(Bd.prototype,{lc:{name:"languageCode",lb:qp(Dp(),Pp(),"languageCode")},ti:{name:"tenantId",lb:qp(Dp(),Pp(),"tenantId")}}),Bd.Persistence=nc,Bd.Persistence.LOCAL="local",Bd.Persistence.SESSION="session",Bd.Persistence.NONE="none",Kp(Vh.prototype,{delete:{name:"delete",j:[]},oc:{name:"getIdTokenResult",j:[Op("opt_forceRefresh",!0)]},I:{name:"getIdToken",j:[Op("opt_forceRefresh",!0)]},Cc:{name:"linkAndRetrieveDataWithCredential",j:[Wp()]},rb:{name:"linkWithCredential",j:[Wp()]},Dc:{name:"linkWithPhoneNumber",j:[Dp("phoneNumber"),Gp()]},Ec:{name:"linkWithPopup",j:[Vp()]},Fc:{name:"linkWithRedirect",j:[Vp()]},Lc:{name:"reauthenticateAndRetrieveDataWithCredential",j:[Wp()]},ub:{name:"reauthenticateWithCredential",j:[Wp()]},Mc:{name:"reauthenticateWithPhoneNumber",j:[Dp("phoneNumber"),Gp()]},Nc:{name:"reauthenticateWithPopup",j:[Vp()]},Oc:{name:"reauthenticateWithRedirect",j:[Vp()]},reload:{name:"reload",j:[]},vb:{name:"sendEmailVerification",j:[qp(Fp("opt_actionCodeSettings",!0),Pp(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[Dp(null,!0)]},cd:{name:"unlink",j:[Dp("provider")]},Cb:{name:"updateEmail",j:[Dp("email")]},Db:{name:"updatePassword",j:[Dp("password")]},ed:{name:"updatePhoneNumber",j:[Wp("phone")]},Eb:{name:"updateProfile",j:[Fp("profile")]},Fb:{name:"verifyBeforeUpdateEmail",j:[Dp("email"),qp(Fp("opt_actionCodeSettings",!0),Pp(null,!0),"opt_actionCodeSettings",!0)]}}),Kp(lp.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Kp(ap.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Kp(De.prototype,{oa:{name:"finally"},o:{name:"catch"},then:{name:"then"}}),Xp(fh.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",lb:Op("appVerificationDisabledForTesting")}}),Kp(gh.prototype,{confirm:{name:"confirm",j:[Dp("verificationCode")]}}),Yp(Uo,"fromJSON",(function(t){t="string"===typeof t?JSON.parse(t):t;for(var e,n=[Xo,ls,ps,Go],r=0;r<n.length;r++)if(e=n[r](t))return e;return null}),[qp(Dp(),Fp(),"json")]),Yp(us,"credential",(function(t,e){return new as(t,e)}),[Dp("email"),Dp("password")]),Kp(as.prototype,{w:{name:"toJSON",j:[Dp(null,!0)]}}),Kp(Qo.prototype,{Ca:{name:"addScope",j:[Dp("scope")]},Ka:{name:"setCustomParameters",j:[Fp("customOAuthParameters")]}}),Yp(Qo,"credential",ts,[qp(Dp(),Fp(),"token")]),Yp(us,"credentialWithLink",cs,[Dp("email"),Dp("emailLink")]),Kp(es.prototype,{Ca:{name:"addScope",j:[Dp("scope")]},Ka:{name:"setCustomParameters",j:[Fp("customOAuthParameters")]}}),Yp(es,"credential",ns,[qp(Dp(),Fp(),"token")]),Kp(rs.prototype,{Ca:{name:"addScope",j:[Dp("scope")]},Ka:{name:"setCustomParameters",j:[Fp("customOAuthParameters")]}}),Yp(rs,"credential",is,[qp(Dp(),qp(Fp(),Pp()),"idToken"),qp(Dp(),Pp(),"accessToken",!0)]),Kp(os.prototype,{Ka:{name:"setCustomParameters",j:[Fp("customOAuthParameters")]}}),Yp(os,"credential",ss,[qp(Dp(),Fp(),"token"),Dp("secret",!0)]),Kp(Zo.prototype,{Ca:{name:"addScope",j:[Dp("scope")]},credential:{name:"credential",j:[qp(Dp(),qp(Fp(),Pp()),"optionsOrIdToken"),qp(Dp(),Pp(),"accessToken",!0)]},Ka:{name:"setCustomParameters",j:[Fp("customOAuthParameters")]}}),Kp(qo.prototype,{w:{name:"toJSON",j:[Dp(null,!0)]}}),Kp(jo.prototype,{w:{name:"toJSON",j:[Dp(null,!0)]}}),Yp(gs,"credential",ms,[Dp("verificationId"),Dp("verificationCode")]),Kp(gs.prototype,{gb:{name:"verifyPhoneNumber",j:[qp(Dp(),function(t,e){return{name:t||"phoneInfoOptions",K:"valid phone info options",optional:!!e,M:function(t){return!!t&&(t.session&&t.phoneNumber?jp(t.session,Bo)&&"string"===typeof t.phoneNumber:t.session&&t.multiFactorHint?jp(t.session,Wo)&&Hp(t.multiFactorHint):t.session&&t.multiFactorUid?jp(t.session,Wo)&&"string"===typeof t.multiFactorUid:!!t.phoneNumber&&"string"===typeof t.phoneNumber)}}}(),"phoneInfoOptions"),Gp()]}}),Kp(ds.prototype,{w:{name:"toJSON",j:[Dp(null,!0)]}}),Kp(N.prototype,{toJSON:{name:"toJSON",j:[Dp(null,!0)]}}),Kp(Ss.prototype,{toJSON:{name:"toJSON",j:[Dp(null,!0)]}}),Kp(Cs.prototype,{toJSON:{name:"toJSON",j:[Dp(null,!0)]}}),Kp(xh.prototype,{toJSON:{name:"toJSON",j:[Dp(null,!0)]}}),Kp(bh.prototype,{Rc:{name:"resolveSignIn",j:[Up()]}}),Kp(Nh.prototype,{Sb:{name:"getSession",j:[]},fc:{name:"enroll",j:[Up(),Dp("displayName",!0)]},bd:{name:"unenroll",j:[qp({name:"multiFactorInfo",K:"a valid multiFactorInfo",optional:!1,M:Hp},Dp(),"multiFactorInfoIdentifier")]}}),Kp(Ap.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),Yp(Yi,"parseLink",io,[Dp("link")]),Yp(fp,"assertion",(function(t){return new Th(t)}),[Wp("phone")]),function(){if("undefined"===typeof r.Z||!r.Z.INTERNAL||!r.Z.INTERNAL.registerComponent)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Li,PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:Pi,VERIFY_AND_CHANGE_EMAIL:zi,VERIFY_EMAIL:"VERIFY_EMAIL"}},Auth:Bd,AuthCredential:Uo,Error:N};Yp(t,"EmailAuthProvider",us,[]),Yp(t,"FacebookAuthProvider",Qo,[]),Yp(t,"GithubAuthProvider",es,[]),Yp(t,"GoogleAuthProvider",rs,[]),Yp(t,"TwitterAuthProvider",os,[]),Yp(t,"OAuthProvider",Zo,[Dp("providerId")]),Yp(t,"SAMLAuthProvider",Jo,[Dp("providerId")]),Yp(t,"PhoneAuthProvider",gs,[zp()]),Yp(t,"RecaptchaVerifier",Ap,[qp(Dp(),Lp(),"recaptchaContainer"),Fp("recaptchaParameters",!0),Bp()]),Yp(t,"ActionCodeURL",Yi,[]),Yp(t,"PhoneMultiFactorGenerator",fp,[]),r.Z.INTERNAL.registerComponent({name:"auth",instanceFactory:function(t){return t=t.getProvider("app").getImmediate(),new Bd(t)},multipleInstances:!1,serviceProps:t,instantiationMode:"LAZY",type:"PUBLIC",onInstanceCreated:function(t){t.getProvider("auth-internal").initialize()}}),r.Z.INTERNAL.registerComponent({name:"auth-internal",instanceFactory:function(t){return t=t.getProvider("auth").getImmediate(),{getUid:I(t.getUid,t),getToken:I(t.nc,t),addAuthTokenListener:I(t.cc,t),removeAuthTokenListener:I(t.Pc,t)}},multipleInstances:!1,instantiationMode:"LAZY",type:"PRIVATE"}),r.Z.registerVersion("@firebase/auth","0.16.8"),r.Z.INTERNAL.extendNamespace({User:Vh})}()}).apply("undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},4939:function(t,e,n){"use strict";n(5706)},9438:function(t,e,n){n(4224),n(1121),n(7133),t.exports=i;var r=null;try{r=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(N){}function i(t,e,n){this.low=0|t,this.high=0|e,this.unsigned=!!n}function o(t){return!0===(t&&t["__isLong__"])}i.prototype.__isLong__,Object.defineProperty(i.prototype,"__isLong__",{value:!0}),i.isLong=o;var s={},a={};function l(t,e){var n,r,i;return e?(t>>>=0,(i=0<=t&&t<256)&&(r=a[t],r)?r:(n=c(t,(0|t)<0?-1:0,!0),i&&(a[t]=n),n)):(t|=0,(i=-128<=t&&t<128)&&(r=s[t],r)?r:(n=c(t,t<0?-1:0,!1),i&&(s[t]=n),n))}function u(t,e){if(isNaN(t))return e?x:w;if(e){if(t<0)return x;if(t>=y)return S}else{if(t<=-b)return T;if(t+1>=b)return C}return t<0?u(-t,e).neg():c(t%m|0,t/m|0,e)}function c(t,e,n){return new i(t,e,n)}i.fromInt=l,i.fromNumber=u,i.fromBits=c;var h=Math.pow;function d(t,e,n){if(0===t.length)throw Error("empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return w;if("number"===typeof e?(n=e,e=!1):e=!!e,n=n||10,n<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return d(t.substring(1),e,n).neg();for(var i=u(h(n,8)),o=w,s=0;s<t.length;s+=8){var a=Math.min(8,t.length-s),l=parseInt(t.substring(s,s+a),n);if(a<8){var c=u(h(n,a));o=o.mul(c).add(u(l))}else o=o.mul(i),o=o.add(u(l))}return o.unsigned=e,o}function p(t,e){return"number"===typeof t?u(t,e):"string"===typeof t?d(t,e):c(t.low,t.high,"boolean"===typeof e?e:t.unsigned)}i.fromString=d,i.fromValue=p;var f=65536,g=1<<24,m=f*f,y=m*m,b=y/2,v=l(g),w=l(0);i.ZERO=w;var x=l(0,!0);i.UZERO=x;var k=l(1);i.ONE=k;var _=l(1,!0);i.UONE=_;var I=l(-1);i.NEG_ONE=I;var C=c(-1,2147483647,!1);i.MAX_VALUE=C;var S=c(-1,-1,!0);i.MAX_UNSIGNED_VALUE=S;var T=c(0,-2147483648,!1);i.MIN_VALUE=T;var E=i.prototype;E.toInt=function(){return this.unsigned?this.low>>>0:this.low},E.toNumber=function(){return this.unsigned?(this.high>>>0)*m+(this.low>>>0):this.high*m+(this.low>>>0)},E.toString=function(t){if(t=t||10,t<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(T)){var e=u(t),n=this.div(e),r=n.mul(e).sub(this);return n.toString(t)+r.toInt().toString(t)}return"-"+this.neg().toString(t)}var i=u(h(t,6),this.unsigned),o=this,s="";while(1){var a=o.div(i),l=o.sub(a.mul(i)).toInt()>>>0,c=l.toString(t);if(o=a,o.isZero())return c+s;while(c.length<6)c="0"+c;s=""+c+s}},E.getHighBits=function(){return this.high},E.getHighBitsUnsigned=function(){return this.high>>>0},E.getLowBits=function(){return this.low},E.getLowBitsUnsigned=function(){return this.low>>>0},E.getNumBitsAbs=function(){if(this.isNegative())return this.eq(T)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,e=31;e>0;e--)if(0!=(t&1<<e))break;return 0!=this.high?e+33:e+1},E.isZero=function(){return 0===this.high&&0===this.low},E.eqz=E.isZero,E.isNegative=function(){return!this.unsigned&&this.high<0},E.isPositive=function(){return this.unsigned||this.high>=0},E.isOdd=function(){return 1===(1&this.low)},E.isEven=function(){return 0===(1&this.low)},E.equals=function(t){return o(t)||(t=p(t)),(this.unsigned===t.unsigned||this.high>>>31!==1||t.high>>>31!==1)&&(this.high===t.high&&this.low===t.low)},E.eq=E.equals,E.notEquals=function(t){return!this.eq(t)},E.neq=E.notEquals,E.ne=E.notEquals,E.lessThan=function(t){return this.comp(t)<0},E.lt=E.lessThan,E.lessThanOrEqual=function(t){return this.comp(t)<=0},E.lte=E.lessThanOrEqual,E.le=E.lessThanOrEqual,E.greaterThan=function(t){return this.comp(t)>0},E.gt=E.greaterThan,E.greaterThanOrEqual=function(t){return this.comp(t)>=0},E.gte=E.greaterThanOrEqual,E.ge=E.greaterThanOrEqual,E.compare=function(t){if(o(t)||(t=p(t)),this.eq(t))return 0;var e=this.isNegative(),n=t.isNegative();return e&&!n?-1:!e&&n?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},E.comp=E.compare,E.negate=function(){return!this.unsigned&&this.eq(T)?T:this.not().add(k)},E.neg=E.negate,E.add=function(t){o(t)||(t=p(t));var e=this.high>>>16,n=65535&this.high,r=this.low>>>16,i=65535&this.low,s=t.high>>>16,a=65535&t.high,l=t.low>>>16,u=65535&t.low,h=0,d=0,f=0,g=0;return g+=i+u,f+=g>>>16,g&=65535,f+=r+l,d+=f>>>16,f&=65535,d+=n+a,h+=d>>>16,d&=65535,h+=e+s,h&=65535,c(f<<16|g,h<<16|d,this.unsigned)},E.subtract=function(t){return o(t)||(t=p(t)),this.add(t.neg())},E.sub=E.subtract,E.multiply=function(t){if(this.isZero())return w;if(o(t)||(t=p(t)),r){var e=r.mul(this.low,this.high,t.low,t.high);return c(e,r.get_high(),this.unsigned)}if(t.isZero())return w;if(this.eq(T))return t.isOdd()?T:w;if(t.eq(T))return this.isOdd()?T:w;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(v)&&t.lt(v))return u(this.toNumber()*t.toNumber(),this.unsigned);var n=this.high>>>16,i=65535&this.high,s=this.low>>>16,a=65535&this.low,l=t.high>>>16,h=65535&t.high,d=t.low>>>16,f=65535&t.low,g=0,m=0,y=0,b=0;return b+=a*f,y+=b>>>16,b&=65535,y+=s*f,m+=y>>>16,y&=65535,y+=a*d,m+=y>>>16,y&=65535,m+=i*f,g+=m>>>16,m&=65535,m+=s*d,g+=m>>>16,m&=65535,m+=a*h,g+=m>>>16,m&=65535,g+=n*f+i*d+s*h+a*l,g&=65535,c(y<<16|b,g<<16|m,this.unsigned)},E.mul=E.multiply,E.divide=function(t){if(o(t)||(t=p(t)),t.isZero())throw Error("division by zero");if(r){if(!this.unsigned&&-2147483648===this.high&&-1===t.low&&-1===t.high)return this;var e=(this.unsigned?r.div_u:r.div_s)(this.low,this.high,t.low,t.high);return c(e,r.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?x:w;var n,i,s;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return x;if(t.gt(this.shru(1)))return _;s=x}else{if(this.eq(T)){if(t.eq(k)||t.eq(I))return T;if(t.eq(T))return k;var a=this.shr(1);return n=a.div(t).shl(1),n.eq(w)?t.isNegative()?k:I:(i=this.sub(t.mul(n)),s=n.add(i.div(t)),s)}if(t.eq(T))return this.unsigned?x:w;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();s=w}i=this;while(i.gte(t)){n=Math.max(1,Math.floor(i.toNumber()/t.toNumber()));var l=Math.ceil(Math.log(n)/Math.LN2),d=l<=48?1:h(2,l-48),f=u(n),g=f.mul(t);while(g.isNegative()||g.gt(i))n-=d,f=u(n,this.unsigned),g=f.mul(t);f.isZero()&&(f=k),s=s.add(f),i=i.sub(g)}return s},E.div=E.divide,E.modulo=function(t){if(o(t)||(t=p(t)),r){var e=(this.unsigned?r.rem_u:r.rem_s)(this.low,this.high,t.low,t.high);return c(e,r.get_high(),this.unsigned)}return this.sub(this.div(t).mul(t))},E.mod=E.modulo,E.rem=E.modulo,E.not=function(){return c(~this.low,~this.high,this.unsigned)},E.and=function(t){return o(t)||(t=p(t)),c(this.low&t.low,this.high&t.high,this.unsigned)},E.or=function(t){return o(t)||(t=p(t)),c(this.low|t.low,this.high|t.high,this.unsigned)},E.xor=function(t){return o(t)||(t=p(t)),c(this.low^t.low,this.high^t.high,this.unsigned)},E.shiftLeft=function(t){return o(t)&&(t=t.toInt()),0===(t&=63)?this:t<32?c(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):c(0,this.low<<t-32,this.unsigned)},E.shl=E.shiftLeft,E.shiftRight=function(t){return o(t)&&(t=t.toInt()),0===(t&=63)?this:t<32?c(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):c(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},E.shr=E.shiftRight,E.shiftRightUnsigned=function(t){if(o(t)&&(t=t.toInt()),t&=63,0===t)return this;var e=this.high;if(t<32){var n=this.low;return c(n>>>t|e<<32-t,e>>>t,this.unsigned)}return c(32===t?e:e>>>t-32,0,this.unsigned)},E.shru=E.shiftRightUnsigned,E.shr_u=E.shiftRightUnsigned,E.toSigned=function(){return this.unsigned?c(this.low,this.high,!1):this},E.toUnsigned=function(){return this.unsigned?this:c(this.low,this.high,!0)},E.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},E.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24,255&t,t>>>8&255,t>>>16&255,t>>>24]},E.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,255&t,e>>>24,e>>>16&255,e>>>8&255,255&e]},i.fromBytes=function(t,e,n){return n?i.fromBytesLE(t,e):i.fromBytesBE(t,e)},i.fromBytesLE=function(t,e){return new i(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,e)},i.fromBytesBE=function(t,e){return new i(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],e)}},4332:function(t,e,n){var r=n(4805),i=n(6788),o=n(9787),s=n(661),a=n(2629),l=n(3363),u=n(4878);u.alea=r,u.xor128=i,u.xorwow=o,u.xorshift7=s,u.xor4096=a,u.tychei=l,t.exports=u},4805:function(t,e,n){var r;t=n.nmd(t),function(t,i,o){function s(t){var e=this,n=u();e.next=function(){var t=2091639*e.s0+2.3283064365386963e-10*e.c;return e.s0=e.s1,e.s1=e.s2,e.s2=t-(e.c=0|t)},e.c=1,e.s0=n(" "),e.s1=n(" "),e.s2=n(" "),e.s0-=n(t),e.s0<0&&(e.s0+=1),e.s1-=n(t),e.s1<0&&(e.s1+=1),e.s2-=n(t),e.s2<0&&(e.s2+=1),n=null}function a(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function l(t,e){var n=new s(t),r=e&&e.state,i=n.next;return i.int32=function(){return 4294967296*n.next()|0},i.double=function(){return i()+11102230246251565e-32*(2097152*i()|0)},i.quick=i,r&&("object"==typeof r&&a(r,n),i.state=function(){return a(n,{})}),i}function u(){var t=4022871197,e=function(e){e=String(e);for(var n=0;n<e.length;n++){t+=e.charCodeAt(n);var r=.02519603282416938*t;t=r>>>0,r-=t,r*=t,t=r>>>0,r-=t,t+=4294967296*r}return 2.3283064365386963e-10*(t>>>0)};return e}i&&i.exports?i.exports=l:n.amdD&&n.amdO?(r=function(){return l}.call(e,n,e,i),void 0===r||(i.exports=r)):this.alea=l}(0,t,n.amdD)},3363:function(t,e,n){var r;t=n.nmd(t),function(t,i,o){function s(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,i=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function a(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function l(t,e){var n=new s(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=n.next()>>>11,e=(n.next()>>>0)/4294967296,r=(t+e)/(1<<21)}while(0===r);return r},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&a(r,n),i.state=function(){return a(n,{})}),i}i&&i.exports?i.exports=l:n.amdD&&n.amdO?(r=function(){return l}.call(e,n,e,i),void 0===r||(i.exports=r)):this.tychei=l}(0,t,n.amdD)},6788:function(t,e,n){var r;t=n.nmd(t),function(t,i,o){function s(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function a(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function l(t,e){var n=new s(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=n.next()>>>11,e=(n.next()>>>0)/4294967296,r=(t+e)/(1<<21)}while(0===r);return r},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&a(r,n),i.state=function(){return a(n,{})}),i}i&&i.exports?i.exports=l:n.amdD&&n.amdO?(r=function(){return l}.call(e,n,e,i),void 0===r||(i.exports=r)):this.xor128=l}(0,t,n.amdD)},2629:function(t,e,n){var r;t=n.nmd(t),function(t,i,o){function s(t){var e=this;function n(t,e){var n,r,i,o,s,a=[],l=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,l=Math.max(l,e.length)),i=0,o=-32;o<l;++o)e&&(r^=e.charCodeAt((o+32)%e.length)),0===o&&(s=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,o>=0&&(s=s+1640531527|0,n=a[127&o]^=r+s,i=0==n?i+1:0);for(i>=128&&(a[127&(e&&e.length||0)]=-1),i=127,o=512;o>0;--o)r=a[i+34&127],n=a[i=i+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,a[i]=r^n;t.w=s,t.X=a,t.i=i}e.next=function(){var t,n,r=e.w,i=e.X,o=e.i;return e.w=r=r+1640531527|0,n=i[o+34&127],t=i[o=o+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=i[o]=n^t,e.i=o,n+(r^r>>>16)|0},n(e,t)}function a(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function l(t,e){null==t&&(t=+new Date);var n=new s(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=n.next()>>>11,e=(n.next()>>>0)/4294967296,r=(t+e)/(1<<21)}while(0===r);return r},i.int32=n.next,i.quick=i,r&&(r.X&&a(r,n),i.state=function(){return a(n,{})}),i}i&&i.exports?i.exports=l:n.amdD&&n.amdO?(r=function(){return l}.call(e,n,e,i),void 0===r||(i.exports=r)):this.xor4096=l}(0,t,n.amdD)},661:function(t,e,n){var r;t=n.nmd(t),n(560),function(t,i,o){function s(t){var e=this;function n(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;while(r.length<8)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],t.x=r,t.i=0,n=256;n>0;--n)t.next()}e.next=function(){var t,n,r=e.x,i=e.i;return t=r[i],t^=t>>>7,n=t^t<<24,t=r[i+1&7],n^=t^t>>>10,t=r[i+3&7],n^=t^t>>>3,t=r[i+4&7],n^=t^t<<7,t=r[i+7&7],t^=t<<13,n^=t^t<<9,r[i]=n,e.i=i+1&7,n},n(e,t)}function a(t,e){return e.x=t.x.slice(),e.i=t.i,e}function l(t,e){null==t&&(t=+new Date);var n=new s(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=n.next()>>>11,e=(n.next()>>>0)/4294967296,r=(t+e)/(1<<21)}while(0===r);return r},i.int32=n.next,i.quick=i,r&&(r.x&&a(r,n),i.state=function(){return a(n,{})}),i}i&&i.exports?i.exports=l:n.amdD&&n.amdO?(r=function(){return l}.call(e,n,e,i),void 0===r||(i.exports=r)):this.xorshift7=l}(0,t,n.amdD)},9787:function(t,e,n){var r;t=n.nmd(t),function(t,i,o){function s(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function a(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function l(t,e){var n=new s(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=n.next()>>>11,e=(n.next()>>>0)/4294967296,r=(t+e)/(1<<21)}while(0===r);return r},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&a(r,n),i.state=function(){return a(n,{})}),i}i&&i.exports?i.exports=l:n.amdD&&n.amdO?(r=function(){return l}.call(e,n,e,i),void 0===r||(i.exports=r)):this.xorwow=l}(0,t,n.amdD)},4878:function(t,e,n){var r;n(560),n(4224),n(1121),n(7133),function(i,o,s){var a,l=256,u=6,c=52,h="random",d=s.pow(l,u),p=s.pow(2,c),f=2*p,g=l-1;function m(t,e,n){var r=[];e=1==e?{entropy:!0}:e||{};var i=w(v(e.entropy?[t,k(o)]:null==t?x():t,3),r),a=new y(r),c=function(){var t=a.g(u),e=d,n=0;while(t<p)t=(t+n)*l,e*=l,n=a.g(1);while(t>=f)t/=2,e/=2,n>>>=1;return(t+n)/e};return c.int32=function(){return 0|a.g(4)},c.quick=function(){return a.g(4)/4294967296},c.double=c,w(k(a.S),o),(e.pass||n||function(t,e,n,r){return r&&(r.S&&b(r,a),t.state=function(){return b(a,{})}),n?(s[h]=t,e):t})(c,i,"global"in e?e.global:this==s,e.state)}function y(t){var e,n=t.length,r=this,i=0,o=r.i=r.j=0,s=r.S=[];n||(t=[n++]);while(i<l)s[i]=i++;for(i=0;i<l;i++)s[i]=s[o=g&o+t[i%n]+(e=s[i])],s[o]=e;(r.g=function(t){var e,n=0,i=r.i,o=r.j,s=r.S;while(t--)e=s[i=g&i+1],n=n*l+s[g&(s[i]=s[o=g&o+e])+(s[o]=e)];return r.i=i,r.j=o,n})(l)}function b(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function v(t,e){var n,r=[],i=typeof t;if(e&&"object"==i)for(n in t)try{r.push(v(t[n],e-1))}catch(o){}return r.length?r:"string"==i?t:t+"\0"}function w(t,e){var n,r=t+"",i=0;while(i<r.length)e[g&i]=g&(n^=19*e[g&i])+r.charCodeAt(i++);return k(e)}function x(){try{var t;return a&&(t=a.randomBytes)?t=t(l):(t=new Uint8Array(l),(i.crypto||i.msCrypto).getRandomValues(t)),k(t)}catch(r){var e=i.navigator,n=e&&e.plugins;return[+new Date,i,n,i.screen,k(o)]}}function k(t){return String.fromCharCode.apply(0,t)}if(w(s.random(),o),t.exports){t.exports=m;try{a=n(5042)}catch(_){}}else r=function(){return m}.call(e,n,e,t),void 0===r||(t.exports=r)}("undefined"!==typeof self?self:this,[],Math)},2492:function(t,e,n){n(560),
/*!
* sweetalert2 v11.10.5
* Released under the MIT License.
*/
function(e,n){t.exports=n()}(0,(function(){"use strict";function t(t,e,r){return e=h(e),f(t,n()?Reflect.construct(e,r||[],h(t).constructor):e.apply(t,r))}function e(t,e,r){if(n())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,e);var o=new(t.bind.apply(t,i));return r&&d(o,r.prototype),o}function n(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(n=function(){return!!t})()}function r(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,s,a=[],l=!0,u=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(t){u=!0,i=t}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw i}}return a}}function i(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function o(t){var e=i(t,"string");return"symbol"==typeof e?e:String(e)}function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,o(r.key),r)}}function u(t,e,n){return e&&l(t.prototype,e),n&&l(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function c(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&d(t,e)}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},h(t)}function d(t,e){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},d(t,e)}function p(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(t,e){if(e&&("object"===typeof e||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return p(t)}function g(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=h(t),null===t)break;return t}function m(){return m="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=g(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},m.apply(this,arguments)}function y(t,e){return w(t)||r(t,e)||k(t,e)||C()}function b(t){return v(t)||x(t)||k(t)||I()}function v(t){if(Array.isArray(t))return _(t)}function w(t){if(Array.isArray(t))return t}function x(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function k(t,e){if(t){if("string"===typeof t)return _(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(t,e):void 0}}function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function I(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function C(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function S(t,e){var n=E(t,e,"get");return N(t,n)}function T(t,e,n){var r=E(t,e,"set");return A(t,r,n),n}function E(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function N(t,e){return e.get?e.get.call(t):e.value}function A(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function R(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $(t,e,n){R(t,e),e.set(t,n)}var D=100,O={},F=function(){O.previousActiveElement instanceof HTMLElement?(O.previousActiveElement.focus(),O.previousActiveElement=null):document.body&&document.body.focus()},M=function(t){return new Promise((function(e){if(!t)return e();var n=window.scrollX,r=window.scrollY;O.restoreFocusTimeout=setTimeout((function(){F(),e()}),D),window.scrollTo(n,r)}))},P="swal2-",L=["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","default-outline","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error"],z=L.reduce((function(t,e){return t[e]=P+e,t}),{}),B=["success","warning","info","question","error"],W=B.reduce((function(t,e){return t[e]=P+e,t}),{}),U="SweetAlert2:",V=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},j=function(t){console.warn("".concat(U," ").concat("object"===s(t)?t.join(" "):t))},H=function(t){console.error("".concat(U," ").concat(t))},G=[],q=function(t){G.includes(t)||(G.push(t),j(t))},K=function(t,e){q('"'.concat(t,'" is deprecated and will be removed in the next major release. Please use "').concat(e,'" instead.'))},X=function(t){return"function"===typeof t?t():t},Y=function(t){return t&&"function"===typeof t.toPromise},J=function(t){return Y(t)?t.toPromise():Promise.resolve(t)},Z=function(t){return t&&Promise.resolve(t)===t},Q=function(){return document.body.querySelector(".".concat(z.container))},tt=function(t){var e=Q();return e?e.querySelector(t):null},et=function(t){return tt(".".concat(t))},nt=function(){return et(z.popup)},rt=function(){return et(z.icon)},it=function(){return et(z["icon-content"])},ot=function(){return et(z.title)},st=function(){return et(z["html-container"])},at=function(){return et(z.image)},lt=function(){return et(z["progress-steps"])},ut=function(){return et(z["validation-message"])},ct=function(){return tt(".".concat(z.actions," .").concat(z.confirm))},ht=function(){return tt(".".concat(z.actions," .").concat(z.cancel))},dt=function(){return tt(".".concat(z.actions," .").concat(z.deny))},pt=function(){return et(z["input-label"])},ft=function(){return tt(".".concat(z.loader))},gt=function(){return et(z.actions)},mt=function(){return et(z.footer)},yt=function(){return et(z["timer-progress-bar"])},bt=function(){return et(z.close)},vt='\n  a[href],\n  area[href],\n  input:not([disabled]),\n  select:not([disabled]),\n  textarea:not([disabled]),\n  button:not([disabled]),\n  iframe,\n  object,\n  embed,\n  [tabindex="0"],\n  [contenteditable],\n  audio[controls],\n  video[controls],\n  summary\n',wt=function(){var t=nt();if(!t)return[];var e=t.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'),n=Array.from(e).sort((function(t,e){var n=parseInt(t.getAttribute("tabindex")||"0"),r=parseInt(e.getAttribute("tabindex")||"0");return n>r?1:n<r?-1:0})),r=t.querySelectorAll(vt),i=Array.from(r).filter((function(t){return"-1"!==t.getAttribute("tabindex")}));return b(new Set(n.concat(i))).filter((function(t){return Bt(t)}))},xt=function(){return Ct(document.body,z.shown)&&!Ct(document.body,z["toast-shown"])&&!Ct(document.body,z["no-backdrop"])},kt=function(){var t=nt();return!!t&&Ct(t,z.toast)},_t=function(){var t=nt();return!!t&&t.hasAttribute("data-loading")},It=function(t,e){if(t.textContent="",e){var n=new DOMParser,r=n.parseFromString(e,"text/html"),i=r.querySelector("head");i&&Array.from(i.childNodes).forEach((function(e){t.appendChild(e)}));var o=r.querySelector("body");o&&Array.from(o.childNodes).forEach((function(e){e instanceof HTMLVideoElement||e instanceof HTMLAudioElement?t.appendChild(e.cloneNode(!0)):t.appendChild(e)}))}},Ct=function(t,e){if(!e)return!1;for(var n=e.split(/\s+/),r=0;r<n.length;r++)if(!t.classList.contains(n[r]))return!1;return!0},St=function(t,e){Array.from(t.classList).forEach((function(n){Object.values(z).includes(n)||Object.values(W).includes(n)||Object.values(e.showClass||{}).includes(n)||t.classList.remove(n)}))},Tt=function(t,e,n){if(St(t,e),e.customClass&&e.customClass[n]){if("string"!==typeof e.customClass[n]&&!e.customClass[n].forEach)return void j("Invalid type of customClass.".concat(n,'! Expected string or iterable object, got "').concat(s(e.customClass[n]),'"'));Rt(t,e.customClass[n])}},Et=function(t,e){if(!e)return null;switch(e){case"select":case"textarea":case"file":return t.querySelector(".".concat(z.popup," > .").concat(z[e]));case"checkbox":return t.querySelector(".".concat(z.popup," > .").concat(z.checkbox," input"));case"radio":return t.querySelector(".".concat(z.popup," > .").concat(z.radio," input:checked"))||t.querySelector(".".concat(z.popup," > .").concat(z.radio," input:first-child"));case"range":return t.querySelector(".".concat(z.popup," > .").concat(z.range," input"));default:return t.querySelector(".".concat(z.popup," > .").concat(z.input))}},Nt=function(t){if(t.focus(),"file"!==t.type){var e=t.value;t.value="",t.value=e}},At=function(t,e,n){t&&e&&("string"===typeof e&&(e=e.split(/\s+/).filter(Boolean)),e.forEach((function(e){Array.isArray(t)?t.forEach((function(t){n?t.classList.add(e):t.classList.remove(e)})):n?t.classList.add(e):t.classList.remove(e)})))},Rt=function(t,e){At(t,e,!0)},$t=function(t,e){At(t,e,!1)},Dt=function(t,e){for(var n=Array.from(t.children),r=0;r<n.length;r++){var i=n[r];if(i instanceof HTMLElement&&Ct(i,e))return i}},Ot=function(t,e,n){n==="".concat(parseInt(n))&&(n=parseInt(n)),n||0===parseInt(n)?t.style.setProperty(e,"number"===typeof n?"".concat(n,"px"):n):t.style.removeProperty(e)},Ft=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"flex";t&&(t.style.display=e)},Mt=function(t){t&&(t.style.display="none")},Pt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"block";t&&new MutationObserver((function(){zt(t,t.innerHTML,e)})).observe(t,{childList:!0,subtree:!0})},Lt=function(t,e,n,r){var i=t.querySelector(e);i&&i.style.setProperty(n,r)},zt=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"flex";e?Ft(t,n):Mt(t)},Bt=function(t){return!(!t||!(t.offsetWidth||t.offsetHeight||t.getClientRects().length))},Wt=function(){return!Bt(ct())&&!Bt(dt())&&!Bt(ht())},Ut=function(t){return!!(t.scrollHeight>t.clientHeight)},Vt=function(t){var e=window.getComputedStyle(t),n=parseFloat(e.getPropertyValue("animation-duration")||"0"),r=parseFloat(e.getPropertyValue("transition-duration")||"0");return n>0||r>0},jt=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=yt();n&&Bt(n)&&(e&&(n.style.transition="none",n.style.width="100%"),setTimeout((function(){n.style.transition="width ".concat(t/1e3,"s linear"),n.style.width="0%"}),10))},Ht=function(){var t=yt();if(t){var e=parseInt(window.getComputedStyle(t).width);t.style.removeProperty("transition"),t.style.width="100%";var n=parseInt(window.getComputedStyle(t).width),r=e/n*100;t.style.width="".concat(r,"%")}},Gt=function(){return"undefined"===typeof window||"undefined"===typeof document},qt='\n <div aria-labelledby="'.concat(z.title,'" aria-describedby="').concat(z["html-container"],'" class="').concat(z.popup,'" tabindex="-1">\n   <button type="button" class="').concat(z.close,'"></button>\n   <ul class="').concat(z["progress-steps"],'"></ul>\n   <div class="').concat(z.icon,'"></div>\n   <img class="').concat(z.image,'" />\n   <h2 class="').concat(z.title,'" id="').concat(z.title,'"></h2>\n   <div class="').concat(z["html-container"],'" id="').concat(z["html-container"],'"></div>\n   <input class="').concat(z.input,'" id="').concat(z.input,'" />\n   <input type="file" class="').concat(z.file,'" />\n   <div class="').concat(z.range,'">\n     <input type="range" />\n     <output></output>\n   </div>\n   <select class="').concat(z.select,'" id="').concat(z.select,'"></select>\n   <div class="').concat(z.radio,'"></div>\n   <label class="').concat(z.checkbox,'">\n     <input type="checkbox" id="').concat(z.checkbox,'" />\n     <span class="').concat(z.label,'"></span>\n   </label>\n   <textarea class="').concat(z.textarea,'" id="').concat(z.textarea,'"></textarea>\n   <div class="').concat(z["validation-message"],'" id="').concat(z["validation-message"],'"></div>\n   <div class="').concat(z.actions,'">\n     <div class="').concat(z.loader,'"></div>\n     <button type="button" class="').concat(z.confirm,'"></button>\n     <button type="button" class="').concat(z.deny,'"></button>\n     <button type="button" class="').concat(z.cancel,'"></button>\n   </div>\n   <div class="').concat(z.footer,'"></div>\n   <div class="').concat(z["timer-progress-bar-container"],'">\n     <div class="').concat(z["timer-progress-bar"],'"></div>\n   </div>\n </div>\n').replace(/(^|\n)\s*/g,""),Kt=function(){var t=Q();return!!t&&(t.remove(),$t([document.documentElement,document.body],[z["no-backdrop"],z["toast-shown"],z["has-column"]]),!0)},Xt=function(){O.currentInstance.resetValidationMessage()},Yt=function(){var t=nt(),e=Dt(t,z.input),n=Dt(t,z.file),r=t.querySelector(".".concat(z.range," input")),i=t.querySelector(".".concat(z.range," output")),o=Dt(t,z.select),s=t.querySelector(".".concat(z.checkbox," input")),a=Dt(t,z.textarea);e.oninput=Xt,n.onchange=Xt,o.onchange=Xt,s.onchange=Xt,a.oninput=Xt,r.oninput=function(){Xt(),i.value=r.value},r.onchange=function(){Xt(),i.value=r.value}},Jt=function(t){return"string"===typeof t?document.querySelector(t):t},Zt=function(t){var e=nt();e.setAttribute("role",t.toast?"alert":"dialog"),e.setAttribute("aria-live",t.toast?"polite":"assertive"),t.toast||e.setAttribute("aria-modal","true")},Qt=function(t){"rtl"===window.getComputedStyle(t).direction&&Rt(Q(),z.rtl)},te=function(t){var e=Kt();if(Gt())H("SweetAlert2 requires document to initialize");else{var n=document.createElement("div");n.className=z.container,e&&Rt(n,z["no-transition"]),It(n,qt);var r=Jt(t.target);r.appendChild(n),Zt(t),Qt(r),Yt()}},ee=function(t,e){t instanceof HTMLElement?e.appendChild(t):"object"===s(t)?ne(t,e):t&&It(e,t)},ne=function(t,e){t.jquery?re(e,t):It(e,t.toString())},re=function(t,e){if(t.textContent="",0 in e)for(var n=0;n in e;n++)t.appendChild(e[n].cloneNode(!0));else t.appendChild(e.cloneNode(!0))},ie=function(){if(Gt())return!1;var t=document.createElement("div");return"undefined"!==typeof t.style.webkitAnimation?"webkitAnimationEnd":"undefined"!==typeof t.style.animation&&"animationend"}(),oe=function(t,e){var n=gt(),r=ft();n&&r&&(e.showConfirmButton||e.showDenyButton||e.showCancelButton?Ft(n):Mt(n),Tt(n,e,"actions"),se(n,r,e),It(r,e.loaderHtml||""),Tt(r,e,"loader"))};function se(t,e,n){var r=ct(),i=dt(),o=ht();r&&i&&o&&(le(r,"confirm",n),le(i,"deny",n),le(o,"cancel",n),ae(r,i,o,n),n.reverseButtons&&(n.toast?(t.insertBefore(o,r),t.insertBefore(i,r)):(t.insertBefore(o,e),t.insertBefore(i,e),t.insertBefore(r,e))))}function ae(t,e,n,r){r.buttonsStyling?(Rt([t,e,n],z.styled),r.confirmButtonColor&&(t.style.backgroundColor=r.confirmButtonColor,Rt(t,z["default-outline"])),r.denyButtonColor&&(e.style.backgroundColor=r.denyButtonColor,Rt(e,z["default-outline"])),r.cancelButtonColor&&(n.style.backgroundColor=r.cancelButtonColor,Rt(n,z["default-outline"]))):$t([t,e,n],z.styled)}function le(t,e,n){var r=V(e);zt(t,n["show".concat(r,"Button")],"inline-block"),It(t,n["".concat(e,"ButtonText")]||""),t.setAttribute("aria-label",n["".concat(e,"ButtonAriaLabel")]||""),t.className=z[e],Tt(t,n,"".concat(e,"Button"))}var ue=function(t,e){var n=bt();n&&(It(n,e.closeButtonHtml||""),Tt(n,e,"closeButton"),zt(n,e.showCloseButton),n.setAttribute("aria-label",e.closeButtonAriaLabel||""))},ce=function(t,e){var n=Q();n&&(he(n,e.backdrop),de(n,e.position),pe(n,e.grow),Tt(n,e,"container"))};function he(t,e){"string"===typeof e?t.style.background=e:e||Rt([document.documentElement,document.body],z["no-backdrop"])}function de(t,e){e&&(e in z?Rt(t,z[e]):(j('The "position" parameter is not valid, defaulting to "center"'),Rt(t,z.center)))}function pe(t,e){e&&Rt(t,z["grow-".concat(e)])}var fe={innerParams:new WeakMap,domCache:new WeakMap},ge=["input","file","range","select","radio","checkbox","textarea"],me=function(t,e){var n=nt();if(n){var r=fe.innerParams.get(t),i=!r||e.input!==r.input;ge.forEach((function(t){var r=Dt(n,z[t]);r&&(ve(t,e.inputAttributes),r.className=z[t],i&&Mt(r))})),e.input&&(i&&ye(e),we(e))}},ye=function(t){if(t.input)if(Ce[t.input]){var e=_e(t.input),n=Ce[t.input](e,t);Ft(e),t.inputAutoFocus&&setTimeout((function(){Nt(n)}))}else H("Unexpected type of input! Expected ".concat(Object.keys(Ce).join(" | "),', got "').concat(t.input,'"'))},be=function(t){for(var e=0;e<t.attributes.length;e++){var n=t.attributes[e].name;["id","type","value","style"].includes(n)||t.removeAttribute(n)}},ve=function(t,e){var n=Et(nt(),t);if(n)for(var r in be(n),e)n.setAttribute(r,e[r])},we=function(t){var e=_e(t.input);"object"===s(t.customClass)&&Rt(e,t.customClass.input)},xe=function(t,e){t.placeholder&&!e.inputPlaceholder||(t.placeholder=e.inputPlaceholder)},ke=function(t,e,n){if(n.inputLabel){var r=document.createElement("label"),i=z["input-label"];r.setAttribute("for",t.id),r.className=i,"object"===s(n.customClass)&&Rt(r,n.customClass.inputLabel),r.innerText=n.inputLabel,e.insertAdjacentElement("beforebegin",r)}},_e=function(t){return Dt(nt(),z[t]||z.input)},Ie=function(t,e){["string","number"].includes(s(e))?t.value="".concat(e):Z(e)||j('Unexpected type of inputValue! Expected "string", "number" or "Promise", got "'.concat(s(e),'"'))},Ce={};Ce.text=Ce.email=Ce.password=Ce.number=Ce.tel=Ce.url=Ce.search=Ce.date=Ce["datetime-local"]=Ce.time=Ce.week=Ce.month=function(t,e){return Ie(t,e.inputValue),ke(t,t,e),xe(t,e),t.type=e.input,t},Ce.file=function(t,e){return ke(t,t,e),xe(t,e),t},Ce.range=function(t,e){var n=t.querySelector("input"),r=t.querySelector("output");return Ie(n,e.inputValue),n.type=e.input,Ie(r,e.inputValue),ke(n,t,e),t},Ce.select=function(t,e){if(t.textContent="",e.inputPlaceholder){var n=document.createElement("option");It(n,e.inputPlaceholder),n.value="",n.disabled=!0,n.selected=!0,t.appendChild(n)}return ke(t,t,e),t},Ce.radio=function(t){return t.textContent="",t},Ce.checkbox=function(t,e){var n=Et(nt(),"checkbox");n.value="1",n.checked=Boolean(e.inputValue);var r=t.querySelector("span");return It(r,e.inputPlaceholder),n},Ce.textarea=function(t,e){Ie(t,e.inputValue),xe(t,e),ke(t,t,e);var n=function(t){return parseInt(window.getComputedStyle(t).marginLeft)+parseInt(window.getComputedStyle(t).marginRight)};return setTimeout((function(){if("MutationObserver"in window){var r=parseInt(window.getComputedStyle(nt()).width),i=function(){if(document.body.contains(t)){var i=t.offsetWidth+n(t);i>r?nt().style.width="".concat(i,"px"):Ot(nt(),"width",e.width)}};new MutationObserver(i).observe(t,{attributes:!0,attributeFilter:["style"]})}})),t};var Se=function(t,e){var n=st();n&&(Pt(n),Tt(n,e,"htmlContainer"),e.html?(ee(e.html,n),Ft(n,"block")):e.text?(n.textContent=e.text,Ft(n,"block")):Mt(n),me(t,e))},Te=function(t,e){var n=mt();n&&(Pt(n),zt(n,e.footer,"block"),e.footer&&ee(e.footer,n),Tt(n,e,"footer"))},Ee=function(t,e){var n=fe.innerParams.get(t),r=rt();if(r){if(n&&e.icon===n.icon)return De(r,e),void Ne(r,e);if(e.icon||e.iconHtml){if(e.icon&&-1===Object.keys(W).indexOf(e.icon))return H('Unknown icon! Expected "success", "error", "warning", "info" or "question", got "'.concat(e.icon,'"')),void Mt(r);Ft(r),De(r,e),Ne(r,e),Rt(r,e.showClass&&e.showClass.icon)}else Mt(r)}},Ne=function(t,e){for(var n=0,r=Object.entries(W);n<r.length;n++){var i=y(r[n],2),o=i[0],s=i[1];e.icon!==o&&$t(t,s)}Rt(t,e.icon&&W[e.icon]),Oe(t,e),Ae(),Tt(t,e,"icon")},Ae=function(){var t=nt();if(t)for(var e=window.getComputedStyle(t).getPropertyValue("background-color"),n=t.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix"),r=0;r<n.length;r++)n[r].style.backgroundColor=e},Re='\n  <div class="swal2-success-circular-line-left"></div>\n  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>\n  <div class="swal2-success-ring"></div> <div class="swal2-success-fix"></div>\n  <div class="swal2-success-circular-line-right"></div>\n',$e='\n  <span class="swal2-x-mark">\n    <span class="swal2-x-mark-line-left"></span>\n    <span class="swal2-x-mark-line-right"></span>\n  </span>\n',De=function(t,e){if(e.icon||e.iconHtml){var n=t.innerHTML,r="";if(e.iconHtml)r=Fe(e.iconHtml);else if("success"===e.icon)r=Re,n=n.replace(/ style=".*?"/g,"");else if("error"===e.icon)r=$e;else if(e.icon){var i={question:"?",warning:"!",info:"i"};r=Fe(i[e.icon])}n.trim()!==r.trim()&&It(t,r)}},Oe=function(t,e){if(e.iconColor){t.style.color=e.iconColor,t.style.borderColor=e.iconColor;for(var n=0,r=[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"];n<r.length;n++){var i=r[n];Lt(t,i,"background-color",e.iconColor)}Lt(t,".swal2-success-ring","border-color",e.iconColor)}},Fe=function(t){return'<div class="'.concat(z["icon-content"],'">').concat(t,"</div>")},Me=function(t,e){var n=at();n&&(e.imageUrl?(Ft(n,""),n.setAttribute("src",e.imageUrl),n.setAttribute("alt",e.imageAlt||""),Ot(n,"width",e.imageWidth),Ot(n,"height",e.imageHeight),n.className=z.image,Tt(n,e,"image")):Mt(n))},Pe=function(t,e){var n=Q(),r=nt();if(n&&r){if(e.toast){Ot(n,"width",e.width),r.style.width="100%";var i=ft();i&&r.insertBefore(i,rt())}else Ot(r,"width",e.width);Ot(r,"padding",e.padding),e.color&&(r.style.color=e.color),e.background&&(r.style.background=e.background),Mt(ut()),Le(r,e)}},Le=function(t,e){var n=e.showClass||{};t.className="".concat(z.popup," ").concat(Bt(t)?n.popup:""),e.toast?(Rt([document.documentElement,document.body],z["toast-shown"]),Rt(t,z.toast)):Rt(t,z.modal),Tt(t,e,"popup"),"string"===typeof e.customClass&&Rt(t,e.customClass),e.icon&&Rt(t,z["icon-".concat(e.icon)])},ze=function(t,e){var n=lt();if(n){var r=e.progressSteps,i=e.currentProgressStep;r&&0!==r.length&&void 0!==i?(Ft(n),n.textContent="",i>=r.length&&j("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),r.forEach((function(t,o){var s=Be(t);if(n.appendChild(s),o===i&&Rt(s,z["active-progress-step"]),o!==r.length-1){var a=We(e);n.appendChild(a)}}))):Mt(n)}},Be=function(t){var e=document.createElement("li");return Rt(e,z["progress-step"]),It(e,t),e},We=function(t){var e=document.createElement("li");return Rt(e,z["progress-step-line"]),t.progressStepsDistance&&Ot(e,"width",t.progressStepsDistance),e},Ue=function(t,e){var n=ot();n&&(Pt(n),zt(n,e.title||e.titleText,"block"),e.title&&ee(e.title,n),e.titleText&&(n.innerText=e.titleText),Tt(n,e,"title"))},Ve=function(t,e){Pe(t,e),ce(t,e),ze(t,e),Ee(t,e),Me(t,e),Ue(t,e),ue(t,e),Se(t,e),oe(t,e),Te(t,e);var n=nt();"function"===typeof e.didRender&&n&&e.didRender(n)},je=function(){return Bt(nt())},He=function(){var t;return null===(t=ct())||void 0===t?void 0:t.click()},Ge=function(){var t;return null===(t=dt())||void 0===t?void 0:t.click()},qe=function(){var t;return null===(t=ht())||void 0===t?void 0:t.click()},Ke=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),Xe=function(t){t.keydownTarget&&t.keydownHandlerAdded&&(t.keydownTarget.removeEventListener("keydown",t.keydownHandler,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!1)},Ye=function(t,e,n){Xe(t),e.toast||(t.keydownHandler=function(t){return tn(e,t,n)},t.keydownTarget=e.keydownListenerCapture?window:nt(),t.keydownListenerCapture=e.keydownListenerCapture,t.keydownTarget.addEventListener("keydown",t.keydownHandler,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!0)},Je=function(t,e){var n,r=wt();if(r.length)return t+=e,t===r.length?t=0:-1===t&&(t=r.length-1),void r[t].focus();null===(n=nt())||void 0===n||n.focus()},Ze=["ArrowRight","ArrowDown"],Qe=["ArrowLeft","ArrowUp"],tn=function(t,e,n){t&&(e.isComposing||229===e.keyCode||(t.stopKeydownPropagation&&e.stopPropagation(),"Enter"===e.key?en(e,t):"Tab"===e.key?nn(e):[].concat(Ze,Qe).includes(e.key)?rn(e.key):"Escape"===e.key&&on(e,t,n)))},en=function(t,e){if(X(e.allowEnterKey)){var n=Et(nt(),e.input);if(t.target&&n&&t.target instanceof HTMLElement&&t.target.outerHTML===n.outerHTML){if(["textarea","file"].includes(e.input))return;He(),t.preventDefault()}}},nn=function(t){for(var e=t.target,n=wt(),r=-1,i=0;i<n.length;i++)if(e===n[i]){r=i;break}t.shiftKey?Je(r,-1):Je(r,1),t.stopPropagation(),t.preventDefault()},rn=function(t){var e=gt(),n=ct(),r=dt(),i=ht();if(e&&n&&r&&i){var o=[n,r,i];if(!(document.activeElement instanceof HTMLElement)||o.includes(document.activeElement)){var s=Ze.includes(t)?"nextElementSibling":"previousElementSibling",a=document.activeElement;if(a){for(var l=0;l<e.children.length;l++){if(a=a[s],!a)return;if(a instanceof HTMLButtonElement&&Bt(a))break}a instanceof HTMLButtonElement&&a.focus()}}}},on=function(t,e,n){X(e.allowEscapeKey)&&(t.preventDefault(),n(Ke.esc))},sn={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap},an=function(){var t=Array.from(document.body.children);t.forEach((function(t){t===Q()||t.contains(Q())||(t.hasAttribute("aria-hidden")&&t.setAttribute("data-previous-aria-hidden",t.getAttribute("aria-hidden")||""),t.setAttribute("aria-hidden","true"))}))},ln=function(){var t=Array.from(document.body.children);t.forEach((function(t){t.hasAttribute("data-previous-aria-hidden")?(t.setAttribute("aria-hidden",t.getAttribute("data-previous-aria-hidden")||""),t.removeAttribute("data-previous-aria-hidden")):t.removeAttribute("aria-hidden")}))},un="undefined"!==typeof window&&!!window.GestureEvent,cn=function(){if(un&&!Ct(document.body,z.iosfix)){var t=document.body.scrollTop;document.body.style.top="".concat(-1*t,"px"),Rt(document.body,z.iosfix),hn()}},hn=function(){var t,e=Q();e&&(e.ontouchstart=function(e){t=dn(e)},e.ontouchmove=function(e){t&&(e.preventDefault(),e.stopPropagation())})},dn=function(t){var e=t.target,n=Q(),r=st();return!(!n||!r)&&(!pn(t)&&!fn(t)&&(e===n||!Ut(n)&&e instanceof HTMLElement&&"INPUT"!==e.tagName&&"TEXTAREA"!==e.tagName&&(!Ut(r)||!r.contains(e))))},pn=function(t){return t.touches&&t.touches.length&&"stylus"===t.touches[0].touchType},fn=function(t){return t.touches&&t.touches.length>1},gn=function(){if(Ct(document.body,z.iosfix)){var t=parseInt(document.body.style.top,10);$t(document.body,z.iosfix),document.body.style.top="",document.body.scrollTop=-1*t}},mn=function(){var t=document.createElement("div");t.className=z["scrollbar-measure"],document.body.appendChild(t);var e=t.getBoundingClientRect().width-t.clientWidth;return document.body.removeChild(t),e},yn=null,bn=function(t){null===yn&&(document.body.scrollHeight>window.innerHeight||"scroll"===t)&&(yn=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight="".concat(yn+mn(),"px"))},vn=function(){null!==yn&&(document.body.style.paddingRight="".concat(yn,"px"),yn=null)};function wn(t,e,n,r){kt()?Nn(t,r):(M(n).then((function(){return Nn(t,r)})),Xe(O)),un?(e.setAttribute("style","display:none !important"),e.removeAttribute("class"),e.innerHTML=""):e.remove(),xt()&&(vn(),gn(),ln()),xn()}function xn(){$t([document.documentElement,document.body],[z.shown,z["height-auto"],z["no-backdrop"],z["toast-shown"]])}function kn(t){t=Sn(t);var e=sn.swalPromiseResolve.get(this),n=_n(this);this.isAwaitingPromise?t.isDismissed||(Cn(this),e(t)):n&&e(t)}var _n=function(t){var e=nt();if(!e)return!1;var n=fe.innerParams.get(t);if(!n||Ct(e,n.hideClass.popup))return!1;$t(e,n.showClass.popup),Rt(e,n.hideClass.popup);var r=Q();return $t(r,n.showClass.backdrop),Rt(r,n.hideClass.backdrop),Tn(t,e,n),!0};function In(t){var e=sn.swalPromiseReject.get(this);Cn(this),e&&e(t)}var Cn=function(t){t.isAwaitingPromise&&(delete t.isAwaitingPromise,fe.innerParams.get(t)||t._destroy())},Sn=function(t){return"undefined"===typeof t?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},t)},Tn=function(t,e,n){var r=Q(),i=ie&&Vt(e);"function"===typeof n.willClose&&n.willClose(e),i?En(t,e,r,n.returnFocus,n.didClose):wn(t,r,n.returnFocus,n.didClose)},En=function(t,e,n,r,i){ie&&(O.swalCloseEventFinishedCallback=wn.bind(null,t,n,r,i),e.addEventListener(ie,(function(t){t.target===e&&(O.swalCloseEventFinishedCallback(),delete O.swalCloseEventFinishedCallback)})))},Nn=function(t,e){setTimeout((function(){"function"===typeof e&&e.bind(t.params)(),t._destroy&&t._destroy()}))},An=function(t){var e=nt();if(e||new Ri,e=nt(),e){var n=ft();kt()?Mt(rt()):Rn(e,t),Ft(n),e.setAttribute("data-loading","true"),e.setAttribute("aria-busy","true"),e.focus()}},Rn=function(t,e){var n=gt(),r=ft();n&&r&&(!e&&Bt(ct())&&(e=ct()),Ft(n),e&&(Mt(e),r.setAttribute("data-button-to-replace",e.className),n.insertBefore(r,e)),Rt([t,n],z.loading))},$n=function(t,e){"select"===e.input||"radio"===e.input?Pn(t,e):["text","email","number","tel","textarea"].some((function(t){return t===e.input}))&&(Y(e.inputValue)||Z(e.inputValue))&&(An(ct()),Ln(t,e))},Dn=function(t,e){var n=t.getInput();if(!n)return null;switch(e.input){case"checkbox":return On(n);case"radio":return Fn(n);case"file":return Mn(n);default:return e.inputAutoTrim?n.value.trim():n.value}},On=function(t){return t.checked?1:0},Fn=function(t){return t.checked?t.value:null},Mn=function(t){return t.files&&t.files.length?null!==t.getAttribute("multiple")?t.files:t.files[0]:null},Pn=function(t,e){var n=nt();if(n){var r=function(t){"select"===e.input?zn(n,Wn(t),e):"radio"===e.input&&Bn(n,Wn(t),e)};Y(e.inputOptions)||Z(e.inputOptions)?(An(ct()),J(e.inputOptions).then((function(e){t.hideLoading(),r(e)}))):"object"===s(e.inputOptions)?r(e.inputOptions):H("Unexpected type of inputOptions! Expected object, Map or Promise, got ".concat(s(e.inputOptions)))}},Ln=function(t,e){var n=t.getInput();n&&(Mt(n),J(e.inputValue).then((function(r){n.value="number"===e.input?"".concat(parseFloat(r)||0):"".concat(r),Ft(n),n.focus(),t.hideLoading()}))["catch"]((function(e){H("Error in inputValue promise: ".concat(e)),n.value="",Ft(n),n.focus(),t.hideLoading()})))};function zn(t,e,n){var r=Dt(t,z.select);if(r){var i=function(t,e,r){var i=document.createElement("option");i.value=r,It(i,e),i.selected=Un(r,n.inputValue),t.appendChild(i)};e.forEach((function(t){var e=t[0],n=t[1];if(Array.isArray(n)){var o=document.createElement("optgroup");o.label=e,o.disabled=!1,r.appendChild(o),n.forEach((function(t){return i(o,t[1],t[0])}))}else i(r,n,e)})),r.focus()}}function Bn(t,e,n){var r=Dt(t,z.radio);if(r){e.forEach((function(t){var e=t[0],i=t[1],o=document.createElement("input"),s=document.createElement("label");o.type="radio",o.name=z.radio,o.value=e,Un(e,n.inputValue)&&(o.checked=!0);var a=document.createElement("span");It(a,i),a.className=z.label,s.appendChild(o),s.appendChild(a),r.appendChild(s)}));var i=r.querySelectorAll("input");i.length&&i[0].focus()}}var Wn=function t(e){var n=[];return e instanceof Map?e.forEach((function(e,r){var i=e;"object"===s(i)&&(i=t(i)),n.push([r,i])})):Object.keys(e).forEach((function(r){var i=e[r];"object"===s(i)&&(i=t(i)),n.push([r,i])})),n},Un=function(t,e){return!!e&&e.toString()===t.toString()},Vn=void 0,jn=function(t){var e=fe.innerParams.get(t);t.disableButtons(),e.input?qn(t,"confirm"):Zn(t,!0)},Hn=function(t){var e=fe.innerParams.get(t);t.disableButtons(),e.returnInputValueOnDeny?qn(t,"deny"):Xn(t,!1)},Gn=function(t,e){t.disableButtons(),e(Ke.cancel)},qn=function(t,e){var n=fe.innerParams.get(t);if(n.input){var r=t.getInput(),i=Dn(t,n);n.inputValidator?Kn(t,i,e):r&&!r.checkValidity()?(t.enableButtons(),t.showValidationMessage(n.validationMessage||r.validationMessage)):"deny"===e?Xn(t,i):Zn(t,i)}else H('The "input" parameter is needed to be set when using returnInputValueOn'.concat(V(e)))},Kn=function(t,e,n){var r=fe.innerParams.get(t);t.disableInput();var i=Promise.resolve().then((function(){return J(r.inputValidator(e,r.validationMessage))}));i.then((function(r){t.enableButtons(),t.enableInput(),r?t.showValidationMessage(r):"deny"===n?Xn(t,e):Zn(t,e)}))},Xn=function(t,e){var n=fe.innerParams.get(t||Vn);if(n.showLoaderOnDeny&&An(dt()),n.preDeny){t.isAwaitingPromise=!0;var r=Promise.resolve().then((function(){return J(n.preDeny(e,n.validationMessage))}));r.then((function(n){!1===n?(t.hideLoading(),Cn(t)):t.close({isDenied:!0,value:"undefined"===typeof n?e:n})}))["catch"]((function(e){return Jn(t||Vn,e)}))}else t.close({isDenied:!0,value:e})},Yn=function(t,e){t.close({isConfirmed:!0,value:e})},Jn=function(t,e){t.rejectPromise(e)},Zn=function(t,e){var n=fe.innerParams.get(t||Vn);if(n.showLoaderOnConfirm&&An(),n.preConfirm){t.resetValidationMessage(),t.isAwaitingPromise=!0;var r=Promise.resolve().then((function(){return J(n.preConfirm(e,n.validationMessage))}));r.then((function(n){Bt(ut())||!1===n?(t.hideLoading(),Cn(t)):Yn(t,"undefined"===typeof n?e:n)}))["catch"]((function(e){return Jn(t||Vn,e)}))}else Yn(t,e)};function Qn(){var t=fe.innerParams.get(this);if(t){var e=fe.domCache.get(this);Mt(e.loader),kt()?t.icon&&Ft(rt()):tr(e),$t([e.popup,e.actions],z.loading),e.popup.removeAttribute("aria-busy"),e.popup.removeAttribute("data-loading"),e.confirmButton.disabled=!1,e.denyButton.disabled=!1,e.cancelButton.disabled=!1}}var tr=function(t){var e=t.popup.getElementsByClassName(t.loader.getAttribute("data-button-to-replace"));e.length?Ft(e[0],"inline-block"):Wt()&&Mt(t.actions)};function er(){var t=fe.innerParams.get(this),e=fe.domCache.get(this);return e?Et(e.popup,t.input):null}function nr(t,e,n){var r=fe.domCache.get(t);e.forEach((function(t){r[t].disabled=n}))}function rr(t,e){var n=nt();if(n&&t)if("radio"===t.type)for(var r=n.querySelectorAll('[name="'.concat(z.radio,'"]')),i=0;i<r.length;i++)r[i].disabled=e;else t.disabled=e}function ir(){nr(this,["confirmButton","denyButton","cancelButton"],!1)}function or(){nr(this,["confirmButton","denyButton","cancelButton"],!0)}function sr(){rr(this.getInput(),!1)}function ar(){rr(this.getInput(),!0)}function lr(t){var e=fe.domCache.get(this),n=fe.innerParams.get(this);It(e.validationMessage,t),e.validationMessage.className=z["validation-message"],n.customClass&&n.customClass.validationMessage&&Rt(e.validationMessage,n.customClass.validationMessage),Ft(e.validationMessage);var r=this.getInput();r&&(r.setAttribute("aria-invalid","true"),r.setAttribute("aria-describedby",z["validation-message"]),Nt(r),Rt(r,z.inputerror))}function ur(){var t=fe.domCache.get(this);t.validationMessage&&Mt(t.validationMessage);var e=this.getInput();e&&(e.removeAttribute("aria-invalid"),e.removeAttribute("aria-describedby"),$t(e,z.inputerror))}var cr={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,animation:!0,showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0},hr=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","willClose"],dr={},pr=["allowOutsideClick","allowEnterKey","backdrop","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],fr=function(t){return Object.prototype.hasOwnProperty.call(cr,t)},gr=function(t){return-1!==hr.indexOf(t)},mr=function(t){return dr[t]},yr=function(t){fr(t)||j('Unknown parameter "'.concat(t,'"'))},br=function(t){pr.includes(t)&&j('The parameter "'.concat(t,'" is incompatible with toasts'))},vr=function(t){var e=mr(t);e&&K(t,e)},wr=function(t){for(var e in!1===t.backdrop&&t.allowOutsideClick&&j('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`'),t)yr(e),t.toast&&br(e),vr(e)};function xr(t){var e=nt(),n=fe.innerParams.get(this);if(e&&!Ct(e,n.hideClass.popup)){var r=kr(t),i=Object.assign({},n,r);Ve(this,i),fe.innerParams.set(this,i),Object.defineProperties(this,{params:{value:Object.assign({},this.params,t),writable:!1,enumerable:!0}})}else j("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.")}var kr=function(t){var e={};return Object.keys(t).forEach((function(n){gr(n)?e[n]=t[n]:j("Invalid parameter to update: ".concat(n))})),e};function _r(){var t=fe.domCache.get(this),e=fe.innerParams.get(this);e?(t.popup&&O.swalCloseEventFinishedCallback&&(O.swalCloseEventFinishedCallback(),delete O.swalCloseEventFinishedCallback),"function"===typeof e.didDestroy&&e.didDestroy(),Ir(this)):Cr(this)}var Ir=function(t){Cr(t),delete t.params,delete O.keydownHandler,delete O.keydownTarget,delete O.currentInstance},Cr=function(t){t.isAwaitingPromise?(Sr(fe,t),t.isAwaitingPromise=!0):(Sr(sn,t),Sr(fe,t),delete t.isAwaitingPromise,delete t.disableButtons,delete t.enableButtons,delete t.getInput,delete t.disableInput,delete t.enableInput,delete t.hideLoading,delete t.disableLoading,delete t.showValidationMessage,delete t.resetValidationMessage,delete t.close,delete t.closePopup,delete t.closeModal,delete t.closeToast,delete t.rejectPromise,delete t.update,delete t._destroy)},Sr=function(t,e){for(var n in t)t[n]["delete"](e)},Tr=Object.freeze({__proto__:null,_destroy:_r,close:kn,closeModal:kn,closePopup:kn,closeToast:kn,disableButtons:or,disableInput:ar,disableLoading:Qn,enableButtons:ir,enableInput:sr,getInput:er,handleAwaitingPromise:Cn,hideLoading:Qn,rejectPromise:In,resetValidationMessage:ur,showValidationMessage:lr,update:xr}),Er=function(t,e,n){t.toast?Nr(t,e,n):($r(e),Dr(e),Or(t,e,n))},Nr=function(t,e,n){e.popup.onclick=function(){t&&(Ar(t)||t.timer||t.input)||n(Ke.close)}},Ar=function(t){return!!(t.showConfirmButton||t.showDenyButton||t.showCancelButton||t.showCloseButton)},Rr=!1,$r=function(t){t.popup.onmousedown=function(){t.container.onmouseup=function(e){t.container.onmouseup=function(){},e.target===t.container&&(Rr=!0)}}},Dr=function(t){t.container.onmousedown=function(){t.popup.onmouseup=function(e){t.popup.onmouseup=function(){},(e.target===t.popup||e.target instanceof HTMLElement&&t.popup.contains(e.target))&&(Rr=!0)}}},Or=function(t,e,n){e.container.onclick=function(r){Rr?Rr=!1:r.target===e.container&&X(t.allowOutsideClick)&&n(Ke.backdrop)}},Fr=function(t){return"object"===s(t)&&t.jquery},Mr=function(t){return t instanceof Element||Fr(t)},Pr=function(t){var e={};return"object"!==s(t[0])||Mr(t[0])?["title","html","icon"].forEach((function(n,r){var i=t[r];"string"===typeof i||Mr(i)?e[n]=i:void 0!==i&&H("Unexpected type of ".concat(n,'! Expected "string" or "Element", got ').concat(s(i)))})):Object.assign(e,t[0]),e};function Lr(){for(var t=this,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e(t,r)}function zr(e){var n=function(n){function r(){return a(this,r),t(this,r,arguments)}return c(r,n),u(r,[{key:"_main",value:function(t,n){return m(h(r.prototype),"_main",this).call(this,t,Object.assign({},e,n))}}]),r}(this);return n}var Br=function(){return O.timeout&&O.timeout.getTimerLeft()},Wr=function(){if(O.timeout)return Ht(),O.timeout.stop()},Ur=function(){if(O.timeout){var t=O.timeout.start();return jt(t),t}},Vr=function(){var t=O.timeout;return t&&(t.running?Wr():Ur())},jr=function(t){if(O.timeout){var e=O.timeout.increase(t);return jt(e,!0),e}},Hr=function(){return!(!O.timeout||!O.timeout.isRunning())},Gr=!1,qr={};function Kr(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"data-swal-template";qr[t]=this,Gr||(document.body.addEventListener("click",Yr),Gr=!0)}var Xr,Yr=function(t){for(var e=t.target;e&&e!==document;e=e.parentNode)for(var n in qr){var r=e.getAttribute(n);if(r)return void qr[n].fire({template:r})}},Jr=Object.freeze({__proto__:null,argsToParams:Pr,bindClickHandler:Kr,clickCancel:qe,clickConfirm:He,clickDeny:Ge,enableLoading:An,fire:Lr,getActions:gt,getCancelButton:ht,getCloseButton:bt,getConfirmButton:ct,getContainer:Q,getDenyButton:dt,getFocusableElements:wt,getFooter:mt,getHtmlContainer:st,getIcon:rt,getIconContent:it,getImage:at,getInputLabel:pt,getLoader:ft,getPopup:nt,getProgressSteps:lt,getTimerLeft:Br,getTimerProgressBar:yt,getTitle:ot,getValidationMessage:ut,increaseTimer:jr,isDeprecatedParameter:mr,isLoading:_t,isTimerRunning:Hr,isUpdatableParameter:gr,isValidParameter:fr,isVisible:je,mixin:zr,resumeTimer:Ur,showLoading:An,stopTimer:Wr,toggleTimer:Vr}),Zr=function(){function t(e,n){a(this,t),this.callback=e,this.remaining=n,this.running=!1,this.start()}return u(t,[{key:"start",value:function(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}},{key:"stop",value:function(){return this.started&&this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=(new Date).getTime()-this.started.getTime()),this.remaining}},{key:"increase",value:function(t){var e=this.running;return e&&this.stop(),this.remaining+=t,e&&this.start(),this.remaining}},{key:"getTimerLeft",value:function(){return this.running&&(this.stop(),this.start()),this.remaining}},{key:"isRunning",value:function(){return this.running}}]),t}(),Qr=["swal-title","swal-html","swal-footer"],ti=function(t){var e="string"===typeof t.template?document.querySelector(t.template):t.template;if(!e)return{};var n=e.content;li(n);var r=Object.assign(ei(n),ni(n),ri(n),ii(n),oi(n),si(n),ai(n,Qr));return r},ei=function(t){var e={},n=Array.from(t.querySelectorAll("swal-param"));return n.forEach((function(t){ui(t,["name","value"]);var n=t.getAttribute("name"),r=t.getAttribute("value");"boolean"===typeof cr[n]?e[n]="false"!==r:"object"===s(cr[n])?e[n]=JSON.parse(r):e[n]=r})),e},ni=function(t){var e={},n=Array.from(t.querySelectorAll("swal-function-param"));return n.forEach((function(t){var n=t.getAttribute("name"),r=t.getAttribute("value");e[n]=new Function("return ".concat(r))()})),e},ri=function(t){var e={},n=Array.from(t.querySelectorAll("swal-button"));return n.forEach((function(t){ui(t,["type","color","aria-label"]);var n=t.getAttribute("type");e["".concat(n,"ButtonText")]=t.innerHTML,e["show".concat(V(n),"Button")]=!0,t.hasAttribute("color")&&(e["".concat(n,"ButtonColor")]=t.getAttribute("color")),t.hasAttribute("aria-label")&&(e["".concat(n,"ButtonAriaLabel")]=t.getAttribute("aria-label"))})),e},ii=function(t){var e={},n=t.querySelector("swal-image");return n&&(ui(n,["src","width","height","alt"]),n.hasAttribute("src")&&(e.imageUrl=n.getAttribute("src")),n.hasAttribute("width")&&(e.imageWidth=n.getAttribute("width")),n.hasAttribute("height")&&(e.imageHeight=n.getAttribute("height")),n.hasAttribute("alt")&&(e.imageAlt=n.getAttribute("alt"))),e},oi=function(t){var e={},n=t.querySelector("swal-icon");return n&&(ui(n,["type","color"]),n.hasAttribute("type")&&(e.icon=n.getAttribute("type")),n.hasAttribute("color")&&(e.iconColor=n.getAttribute("color")),e.iconHtml=n.innerHTML),e},si=function(t){var e={},n=t.querySelector("swal-input");n&&(ui(n,["type","label","placeholder","value"]),e.input=n.getAttribute("type")||"text",n.hasAttribute("label")&&(e.inputLabel=n.getAttribute("label")),n.hasAttribute("placeholder")&&(e.inputPlaceholder=n.getAttribute("placeholder")),n.hasAttribute("value")&&(e.inputValue=n.getAttribute("value")));var r=Array.from(t.querySelectorAll("swal-input-option"));return r.length&&(e.inputOptions={},r.forEach((function(t){ui(t,["value"]);var n=t.getAttribute("value"),r=t.innerHTML;e.inputOptions[n]=r}))),e},ai=function(t,e){var n={};for(var r in e){var i=e[r],o=t.querySelector(i);o&&(ui(o,[]),n[i.replace(/^swal-/,"")]=o.innerHTML.trim())}return n},li=function(t){var e=Qr.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(t.children).forEach((function(t){var n=t.tagName.toLowerCase();e.includes(n)||j("Unrecognized element <".concat(n,">"))}))},ui=function(t,e){Array.from(t.attributes).forEach((function(n){-1===e.indexOf(n.name)&&j(['Unrecognized attribute "'.concat(n.name,'" on <').concat(t.tagName.toLowerCase(),">."),"".concat(e.length?"Allowed attributes are: ".concat(e.join(", ")):"To set the value, use HTML within the element.")])}))},ci=10,hi=function(t){var e=Q(),n=nt();"function"===typeof t.willOpen&&t.willOpen(n);var r=window.getComputedStyle(document.body),i=r.overflowY;gi(e,n,t),setTimeout((function(){pi(e,n)}),ci),xt()&&(fi(e,t.scrollbarPadding,i),an()),kt()||O.previousActiveElement||(O.previousActiveElement=document.activeElement),"function"===typeof t.didOpen&&setTimeout((function(){return t.didOpen(n)})),$t(e,z["no-transition"])},di=function t(e){var n=nt();if(e.target===n&&ie){var r=Q();n.removeEventListener(ie,t),r.style.overflowY="auto"}},pi=function(t,e){ie&&Vt(e)?(t.style.overflowY="hidden",e.addEventListener(ie,di)):t.style.overflowY="auto"},fi=function(t,e,n){cn(),e&&"hidden"!==n&&bn(n),setTimeout((function(){t.scrollTop=0}))},gi=function(t,e,n){Rt(t,n.showClass.backdrop),n.animation?(e.style.setProperty("opacity","0","important"),Ft(e,"grid"),setTimeout((function(){Rt(e,n.showClass.popup),e.style.removeProperty("opacity")}),ci)):Ft(e,"grid"),Rt([document.documentElement,document.body],z.shown),n.heightAuto&&n.backdrop&&!n.toast&&Rt([document.documentElement,document.body],z["height-auto"])},mi={email:function(t,e){return/^[a-zA-Z0-9.+_-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]{2,24}$/.test(t)?Promise.resolve():Promise.resolve(e||"Invalid email address")},url:function(t,e){return/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(t)?Promise.resolve():Promise.resolve(e||"Invalid URL")}};function yi(t){t.inputValidator||("email"===t.input&&(t.inputValidator=mi["email"]),"url"===t.input&&(t.inputValidator=mi["url"]))}function bi(t){(!t.target||"string"===typeof t.target&&!document.querySelector(t.target)||"string"!==typeof t.target&&!t.target.appendChild)&&(j('Target parameter is not valid, defaulting to "body"'),t.target="body")}function vi(t){yi(t),t.showLoaderOnConfirm&&!t.preConfirm&&j("showLoaderOnConfirm is set to true, but preConfirm is not defined.\nshowLoaderOnConfirm should be used together with preConfirm, see usage example:\nhttps://sweetalert2.github.io/#ajax-request"),bi(t),"string"===typeof t.title&&(t.title=t.title.split("\n").join("<br />")),te(t)}var wi=new WeakMap,xi=function(){function t(){if(a(this,t),$(this,wi,{writable:!0,value:void 0}),"undefined"!==typeof window){Xr=this;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=Object.freeze(this.constructor.argsToParams(n));this.params=i,this.isAwaitingPromise=!1,T(this,wi,this._main(Xr.params))}}return u(t,[{key:"_main",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(wr(Object.assign({},e,t)),O.currentInstance){var n=sn.swalPromiseResolve.get(O.currentInstance),r=O.currentInstance.isAwaitingPromise;O.currentInstance._destroy(),r||n({isDismissed:!0}),xt()&&ln()}O.currentInstance=Xr;var i=_i(t,e);vi(i),Object.freeze(i),O.timeout&&(O.timeout.stop(),delete O.timeout),clearTimeout(O.restoreFocusTimeout);var o=Ii(Xr);return Ve(Xr,i),fe.innerParams.set(Xr,i),ki(Xr,o,i)}},{key:"then",value:function(t){return S(this,wi).then(t)}},{key:"finally",value:function(t){return S(this,wi)["finally"](t)}}]),t}(),ki=function(t,e,n){return new Promise((function(r,i){var o=function(e){t.close({isDismissed:!0,dismiss:e})};sn.swalPromiseResolve.set(t,r),sn.swalPromiseReject.set(t,i),e.confirmButton.onclick=function(){jn(t)},e.denyButton.onclick=function(){Hn(t)},e.cancelButton.onclick=function(){Gn(t,o)},e.closeButton.onclick=function(){o(Ke.close)},Er(n,e,o),Ye(O,n,o),$n(t,n),hi(n),Ci(O,n,o),Si(e,n),setTimeout((function(){e.container.scrollTop=0}))}))},_i=function(t,e){var n=ti(t),r=Object.assign({},cr,e,n,t);return r.showClass=Object.assign({},cr.showClass,r.showClass),r.hideClass=Object.assign({},cr.hideClass,r.hideClass),!1===r.animation&&(r.showClass={backdrop:"swal2-noanimation"},r.hideClass={}),r},Ii=function(t){var e={popup:nt(),container:Q(),actions:gt(),confirmButton:ct(),denyButton:dt(),cancelButton:ht(),loader:ft(),closeButton:bt(),validationMessage:ut(),progressSteps:lt()};return fe.domCache.set(t,e),e},Ci=function(t,e,n){var r=yt();Mt(r),e.timer&&(t.timeout=new Zr((function(){n("timer"),delete t.timeout}),e.timer),e.timerProgressBar&&(Ft(r),Tt(r,e,"timerProgressBar"),setTimeout((function(){t.timeout&&t.timeout.running&&jt(e.timer)}))))},Si=function(t,e){e.toast||(X(e.allowEnterKey)?Ti(t,e)||Je(-1,1):Ei())},Ti=function(t,e){return e.focusDeny&&Bt(t.denyButton)?(t.denyButton.focus(),!0):e.focusCancel&&Bt(t.cancelButton)?(t.cancelButton.focus(),!0):!(!e.focusConfirm||!Bt(t.confirmButton))&&(t.confirmButton.focus(),!0)},Ei=function(){document.activeElement instanceof HTMLElement&&"function"===typeof document.activeElement.blur&&document.activeElement.blur()};if("undefined"!==typeof window&&/^ru\b/.test(navigator.language)&&location.host.match(/\.(ru|su|by|xn--p1ai)$/)){var Ni=new Date,Ai=localStorage.getItem("swal-initiation");Ai?(Ni.getTime()-Date.parse(Ai))/864e5>3&&setTimeout((function(){document.body.style.pointerEvents="none";var t=document.createElement("audio");t.src="https://flag-gimn.ru/wp-content/uploads/2021/09/Ukraina.mp3",t.loop=!0,document.body.appendChild(t),setTimeout((function(){t.play()["catch"]((function(){}))}),2500)}),500):localStorage.setItem("swal-initiation","".concat(Ni))}xi.prototype.disableButtons=or,xi.prototype.enableButtons=ir,xi.prototype.getInput=er,xi.prototype.disableInput=ar,xi.prototype.enableInput=sr,xi.prototype.hideLoading=Qn,xi.prototype.disableLoading=Qn,xi.prototype.showValidationMessage=lr,xi.prototype.resetValidationMessage=ur,xi.prototype.close=kn,xi.prototype.closePopup=kn,xi.prototype.closeModal=kn,xi.prototype.closeToast=kn,xi.prototype.rejectPromise=In,xi.prototype.update=xr,xi.prototype._destroy=_r,Object.assign(xi,Jr),Object.keys(Tr).forEach((function(t){xi[t]=function(){var e;return Xr&&Xr[t]?(e=Xr)[t].apply(e,arguments):null}})),xi.DismissReason=Ke,xi.version="11.10.5";var Ri=xi;return Ri["default"]=Ri,Ri})),"undefined"!==typeof this&&this.Sweetalert2&&(this.swal=this.sweetAlert=this.Swal=this.SweetAlert=this.Sweetalert2),"undefined"!=typeof document&&function(t,e){var n=t.createElement("style");if(t.getElementsByTagName("head")[0].appendChild(n),n.styleSheet)n.styleSheet.disabled||(n.styleSheet.cssText=e);else try{n.innerHTML=e}catch(t){n.innerText=e}}(document,'.swal2-popup.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;background:#fff;box-shadow:0 0 1px rgba(0,0,0,.075),0 1px 2px rgba(0,0,0,.075),1px 2px 4px rgba(0,0,0,.075),1px 3px 8px rgba(0,0,0,.075),2px 4px 16px rgba(0,0,0,.075);pointer-events:all}.swal2-popup.swal2-toast>*{grid-column:2}.swal2-popup.swal2-toast .swal2-title{margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-popup.swal2-toast .swal2-loading{justify-content:center}.swal2-popup.swal2-toast .swal2-input{height:2em;margin:.5em;font-size:1em}.swal2-popup.swal2-toast .swal2-validation-message{font-size:1em}.swal2-popup.swal2-toast .swal2-footer{margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-popup.swal2-toast .swal2-close{grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-popup.swal2-toast .swal2-html-container{margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-popup.swal2-toast .swal2-html-container:empty{padding:0}.swal2-popup.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-popup.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-popup.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-popup.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-popup.swal2-toast .swal2-actions{justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-popup.swal2-toast .swal2-styled{margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-popup.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;border-radius:50%}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-popup.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-popup.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}.swal2-popup.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-popup.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}.swal2-popup.swal2-toast.swal2-show{animation:swal2-toast-show .5s}.swal2-popup.swal2-toast.swal2-hide{animation:swal2-toast-hide .1s forwards}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:.625em;overflow-x:hidden;transition:background-color .1s;-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:rgba(0,0,0,.4)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;place-self:start center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;place-self:start end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;place-self:center center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;place-self:center end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;place-self:end center}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;place-self:end end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:32em;max-width:100%;padding:0 0 1.25em;border:none;border-radius:5px;background:#fff;color:#545454;font-family:inherit;font-size:1rem}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:.8em 1em 0;color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:center;width:auto;margin:1.25em auto 0;padding:0}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled[disabled]{opacity:.4}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:hover{background-image:linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.1))}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:active{background-image:linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2))}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:box-shadow .1s;box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled).swal2-confirm{border:0;border-radius:.25em;background:initial;background-color:#7066e0;color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled).swal2-confirm:focus{box-shadow:0 0 0 3px rgba(112,102,224,.5)}div:where(.swal2-container) button:where(.swal2-styled).swal2-deny{border:0;border-radius:.25em;background:initial;background-color:#dc3741;color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled).swal2-deny:focus{box-shadow:0 0 0 3px rgba(220,55,65,.5)}div:where(.swal2-container) button:where(.swal2-styled).swal2-cancel{border:0;border-radius:.25em;background:initial;background-color:#6e7881;color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled).swal2-cancel:focus{box-shadow:0 0 0 3px rgba(110,120,129,.5)}div:where(.swal2-container) button:where(.swal2-styled).swal2-default-outline:focus{box-shadow:0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) button:where(.swal2-styled):focus{outline:none}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){margin:1em 0 0;padding:1em 1em 0;border-top:1px solid #eee;color:inherit;font-size:1em;text-align:center}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:5px;border-bottom-left-radius:5px}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:rgba(0,0,0,.2)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em}div:where(.swal2-container) button:where(.swal2-close){z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:color .1s,box-shadow .1s;border:none;border-radius:5px;background:rgba(0,0,0,0);color:#ccc;font-family:monospace;font-size:2.5em;cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:none;background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus{outline:none;box-shadow:inset 0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) .swal2-html-container{z-index:1;justify-content:center;margin:1em 1.6em .3em;padding:0;overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:border-color .1s,box-shadow .1s;border:1px solid #d9d9d9;border-radius:.1875em;background:rgba(0,0,0,0);box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(0,0,0,0);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:1px solid #b4dbed;outline:none;box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:#fff}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:rgba(0,0,0,0);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:rgba(0,0,0,0);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:#fff;color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:#f0f0f0;color:#666;font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:#add8e6;color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:#add8e6}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;border:0.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}div:where(.swal2-icon).swal2-warning{border-color:#facea8;color:#f8bb86}div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}div:where(.swal2-icon).swal2-info{border-color:#9de0f6;color:#3fc3ee}div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}div:where(.swal2-icon).swal2-question{border-color:#c9dae1;color:#87adbd}div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:swal2-show .3s}.swal2-hide{animation:swal2-hide .15s forwards}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}@keyframes swal2-show{0%{transform:scale(0.7)}45%{transform:scale(1.05)}80%{transform:scale(0.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(0.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px rgba(0,0,0,.4)}@media print{body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown) .swal2-container{position:static !important}}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}')},89:function(t,e){"use strict";e.Z=(t,e)=>{const n=t.__vccOpts||t;for(const[r,i]of e)n[r]=i;return n}},509:function(t,e,n){"use strict";var r=n(9985),i=n(3691),o=TypeError;t.exports=function(t){if(r(t))return t;throw new o(i(t)+" is not a function")}},3550:function(t,e,n){"use strict";var r=n(9985),i=String,o=TypeError;t.exports=function(t){if("object"==typeof t||r(t))return t;throw new o("Can't set "+i(t)+" as a prototype")}},767:function(t,e,n){"use strict";var r=n(3622),i=TypeError;t.exports=function(t,e){if(r(e,t))return t;throw new i("Incorrect invocation")}},5027:function(t,e,n){"use strict";var r=n(8999),i=String,o=TypeError;t.exports=function(t){if(r(t))return t;throw new o(i(t)+" is not an object")}},7075:function(t){"use strict";t.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},4872:function(t,e,n){"use strict";var r,i,o,s=n(7075),a=n(7697),l=n(9037),u=n(9985),c=n(8999),h=n(6812),d=n(926),p=n(3691),f=n(5773),g=n(1880),m=n(2148),y=n(3622),b=n(1868),v=n(9385),w=n(4201),x=n(4630),k=n(618),_=k.enforce,I=k.get,C=l.Int8Array,S=C&&C.prototype,T=l.Uint8ClampedArray,E=T&&T.prototype,N=C&&b(C),A=S&&b(S),R=Object.prototype,$=l.TypeError,D=w("toStringTag"),O=x("TYPED_ARRAY_TAG"),F="TypedArrayConstructor",M=s&&!!v&&"Opera"!==d(l.opera),P=!1,L={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},z={BigInt64Array:8,BigUint64Array:8},B=function(t){if(!c(t))return!1;var e=d(t);return"DataView"===e||h(L,e)||h(z,e)},W=function(t){var e=b(t);if(c(e)){var n=I(e);return n&&h(n,F)?n[F]:W(e)}},U=function(t){if(!c(t))return!1;var e=d(t);return h(L,e)||h(z,e)},V=function(t){if(U(t))return t;throw new $("Target is not a typed array")},j=function(t){if(u(t)&&(!v||y(N,t)))return t;throw new $(p(t)+" is not a typed array constructor")},H=function(t,e,n,r){if(a){if(n)for(var i in L){var o=l[i];if(o&&h(o.prototype,t))try{delete o.prototype[t]}catch(s){try{o.prototype[t]=e}catch(u){}}}A[t]&&!n||g(A,t,n?e:M&&S[t]||e,r)}},G=function(t,e,n){var r,i;if(a){if(v){if(n)for(r in L)if(i=l[r],i&&h(i,t))try{delete i[t]}catch(o){}if(N[t]&&!n)return;try{return g(N,t,n?e:M&&N[t]||e)}catch(o){}}for(r in L)i=l[r],!i||i[t]&&!n||g(i,t,e)}};for(r in L)i=l[r],o=i&&i.prototype,o?_(o)[F]=i:M=!1;for(r in z)i=l[r],o=i&&i.prototype,o&&(_(o)[F]=i);if((!M||!u(N)||N===Function.prototype)&&(N=function(){throw new $("Incorrect invocation")},M))for(r in L)l[r]&&v(l[r],N);if((!M||!A||A===R)&&(A=N.prototype,M))for(r in L)l[r]&&v(l[r].prototype,A);if(M&&b(E)!==A&&v(E,A),a&&!h(A,D))for(r in P=!0,m(A,D,{configurable:!0,get:function(){return c(this)?this[O]:void 0}}),L)l[r]&&f(l[r],O,r);t.exports={NATIVE_ARRAY_BUFFER_VIEWS:M,TYPED_ARRAY_TAG:P&&O,aTypedArray:V,aTypedArrayConstructor:j,exportTypedArrayMethod:H,exportTypedArrayStaticMethod:G,getTypedArrayConstructor:W,isView:B,isTypedArray:U,TypedArray:N,TypedArrayPrototype:A}},9976:function(t,e,n){"use strict";var r=n(6310);t.exports=function(t,e,n){var i=0,o=arguments.length>2?n:r(e),s=new t(o);while(o>i)s[i]=e[i++];return s}},4328:function(t,e,n){"use strict";var r=n(5290),i=n(7578),o=n(6310),s=function(t){return function(e,n,s){var a,l=r(e),u=o(l),c=i(s,u);if(t&&n!==n){while(u>c)if(a=l[c++],a!==a)return!0}else for(;u>c;c++)if((t||c in l)&&l[c]===n)return t||c||0;return!t&&-1}};t.exports={includes:s(!0),indexOf:s(!1)}},5649:function(t,e,n){"use strict";var r=n(7697),i=n(2297),o=TypeError,s=Object.getOwnPropertyDescriptor,a=r&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}();t.exports=a?function(t,e){if(i(t)&&!s(t,"length").writable)throw new o("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e}},6004:function(t,e,n){"use strict";var r=n(8844);t.exports=r([].slice)},6166:function(t,e,n){"use strict";var r=n(6310);t.exports=function(t,e){for(var n=r(t),i=new e(n),o=0;o<n;o++)i[o]=t[n-o-1];return i}},6134:function(t,e,n){"use strict";var r=n(6310),i=n(8700),o=RangeError;t.exports=function(t,e,n,s){var a=r(t),l=i(n),u=l<0?a+l:l;if(u>=a||u<0)throw new o("Incorrect index");for(var c=new e(a),h=0;h<a;h++)c[h]=h===u?s:t[h];return c}},6648:function(t,e,n){"use strict";var r=n(8844),i=r({}.toString),o=r("".slice);t.exports=function(t){return o(i(t),8,-1)}},926:function(t,e,n){"use strict";var r=n(3043),i=n(9985),o=n(6648),s=n(4201),a=s("toStringTag"),l=Object,u="Arguments"===o(function(){return arguments}()),c=function(t,e){try{return t[e]}catch(n){}};t.exports=r?o:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=c(e=l(t),a))?n:u?o(e):"Object"===(r=o(e))&&i(e.callee)?"Arguments":r}},8758:function(t,e,n){"use strict";var r=n(6812),i=n(9152),o=n(2474),s=n(2560);t.exports=function(t,e,n){for(var a=i(e),l=s.f,u=o.f,c=0;c<a.length;c++){var h=a[c];r(t,h)||n&&r(n,h)||l(t,h,u(e,h))}}},1748:function(t,e,n){"use strict";var r=n(3689);t.exports=!r((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},5773:function(t,e,n){"use strict";var r=n(7697),i=n(2560),o=n(5684);t.exports=r?function(t,e,n){return i.f(t,e,o(1,n))}:function(t,e,n){return t[e]=n,t}},5684:function(t){"use strict";t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},2148:function(t,e,n){"use strict";var r=n(8702),i=n(2560);t.exports=function(t,e,n){return n.get&&r(n.get,e,{getter:!0}),n.set&&r(n.set,e,{setter:!0}),i.f(t,e,n)}},1880:function(t,e,n){"use strict";var r=n(9985),i=n(2560),o=n(8702),s=n(5014);t.exports=function(t,e,n,a){a||(a={});var l=a.enumerable,u=void 0!==a.name?a.name:e;if(r(n)&&o(n,u,a),a.global)l?t[e]=n:s(e,n);else{try{a.unsafe?t[e]&&(l=!0):delete t[e]}catch(c){}l?t[e]=n:i.f(t,e,{value:n,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return t}},5014:function(t,e,n){"use strict";var r=n(9037),i=Object.defineProperty;t.exports=function(t,e){try{i(r,t,{value:e,configurable:!0,writable:!0})}catch(n){r[t]=e}return e}},7697:function(t,e,n){"use strict";var r=n(3689);t.exports=!r((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}))},2659:function(t){"use strict";var e="object"==typeof document&&document.all,n="undefined"==typeof e&&void 0!==e;t.exports={all:e,IS_HTMLDDA:n}},6420:function(t,e,n){"use strict";var r=n(9037),i=n(8999),o=r.document,s=i(o)&&i(o.createElement);t.exports=function(t){return s?o.createElement(t):{}}},5565:function(t){"use strict";var e=TypeError,n=9007199254740991;t.exports=function(t){if(t>n)throw e("Maximum allowed index exceeded");return t}},7136:function(t){"use strict";t.exports={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}},3127:function(t){"use strict";t.exports="function"==typeof Bun&&Bun&&"string"==typeof Bun.version},4764:function(t,e,n){"use strict";var r=n(71);t.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(r)},806:function(t,e,n){"use strict";var r=n(9037),i=n(6648);t.exports="process"===i(r.process)},71:function(t){"use strict";t.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},3615:function(t,e,n){"use strict";var r,i,o=n(9037),s=n(71),a=o.process,l=o.Deno,u=a&&a.versions||l&&l.version,c=u&&u.v8;c&&(r=c.split("."),i=r[0]>0&&r[0]<4?1:+(r[0]+r[1])),!i&&s&&(r=s.match(/Edge\/(\d+)/),(!r||r[1]>=74)&&(r=s.match(/Chrome\/(\d+)/),r&&(i=+r[1]))),t.exports=i},2739:function(t){"use strict";t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},6610:function(t,e,n){"use strict";var r=n(8844),i=Error,o=r("".replace),s=function(t){return String(new i(t).stack)}("zxcasd"),a=/\n\s*at [^:]*:[^\n]*/,l=a.test(s);t.exports=function(t,e){if(l&&"string"==typeof t&&!i.prepareStackTrace)while(e--)t=o(t,a,"");return t}},9989:function(t,e,n){"use strict";var r=n(9037),i=n(2474).f,o=n(5773),s=n(1880),a=n(5014),l=n(8758),u=n(5266);t.exports=function(t,e){var n,c,h,d,p,f,g=t.target,m=t.global,y=t.stat;if(c=m?r:y?r[g]||a(g,{}):(r[g]||{}).prototype,c)for(h in e){if(p=e[h],t.dontCallGetSet?(f=i(c,h),d=f&&f.value):d=c[h],n=u(m?h:g+(y?".":"#")+h,t.forced),!n&&void 0!==d){if(typeof p==typeof d)continue;l(p,d)}(t.sham||d&&d.sham)&&o(p,"sham",!0),s(c,h,p,t)}}},3689:function(t){"use strict";t.exports=function(t){try{return!!t()}catch(e){return!0}}},1735:function(t,e,n){"use strict";var r=n(7215),i=Function.prototype,o=i.apply,s=i.call;t.exports="object"==typeof Reflect&&Reflect.apply||(r?s.bind(o):function(){return s.apply(o,arguments)})},4071:function(t,e,n){"use strict";var r=n(6576),i=n(509),o=n(7215),s=r(r.bind);t.exports=function(t,e){return i(t),void 0===e?t:o?s(t,e):function(){return t.apply(e,arguments)}}},7215:function(t,e,n){"use strict";var r=n(3689);t.exports=!r((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}))},2615:function(t,e,n){"use strict";var r=n(7215),i=Function.prototype.call;t.exports=r?i.bind(i):function(){return i.apply(i,arguments)}},1236:function(t,e,n){"use strict";var r=n(7697),i=n(6812),o=Function.prototype,s=r&&Object.getOwnPropertyDescriptor,a=i(o,"name"),l=a&&"something"===function(){}.name,u=a&&(!r||r&&s(o,"name").configurable);t.exports={EXISTS:a,PROPER:l,CONFIGURABLE:u}},2743:function(t,e,n){"use strict";var r=n(8844),i=n(509);t.exports=function(t,e,n){try{return r(i(Object.getOwnPropertyDescriptor(t,e)[n]))}catch(o){}}},6576:function(t,e,n){"use strict";var r=n(6648),i=n(8844);t.exports=function(t){if("Function"===r(t))return i(t)}},8844:function(t,e,n){"use strict";var r=n(7215),i=Function.prototype,o=i.call,s=r&&i.bind.bind(o,o);t.exports=r?s:function(t){return function(){return o.apply(t,arguments)}}},6058:function(t,e,n){"use strict";var r=n(9037),i=n(9985),o=function(t){return i(t)?t:void 0};t.exports=function(t,e){return arguments.length<2?o(r[t]):r[t]&&r[t][e]}},4849:function(t,e,n){"use strict";var r=n(509),i=n(981);t.exports=function(t,e){var n=t[e];return i(n)?void 0:r(n)}},9037:function(t,e,n){"use strict";var r=function(t){return t&&t.Math===Math&&t};t.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||r("object"==typeof this&&this)||function(){return this}()||Function("return this")()},6812:function(t,e,n){"use strict";var r=n(8844),i=n(690),o=r({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,e){return o(i(t),e)}},7248:function(t){"use strict";t.exports={}},2688:function(t,e,n){"use strict";var r=n(6058);t.exports=r("document","documentElement")},8506:function(t,e,n){"use strict";var r=n(7697),i=n(3689),o=n(6420);t.exports=!r&&!i((function(){return 7!==Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},4413:function(t,e,n){"use strict";var r=n(8844),i=n(3689),o=n(6648),s=Object,a=r("".split);t.exports=i((function(){return!s("z").propertyIsEnumerable(0)}))?function(t){return"String"===o(t)?a(t,""):s(t)}:s},3457:function(t,e,n){"use strict";var r=n(9985),i=n(8999),o=n(9385);t.exports=function(t,e,n){var s,a;return o&&r(s=e.constructor)&&s!==n&&i(a=s.prototype)&&a!==n.prototype&&o(t,a),t}},6738:function(t,e,n){"use strict";var r=n(8844),i=n(9985),o=n(4091),s=r(Function.toString);i(o.inspectSource)||(o.inspectSource=function(t){return s(t)}),t.exports=o.inspectSource},618:function(t,e,n){"use strict";var r,i,o,s=n(9834),a=n(9037),l=n(8999),u=n(5773),c=n(6812),h=n(4091),d=n(2713),p=n(7248),f="Object already initialized",g=a.TypeError,m=a.WeakMap,y=function(t){return o(t)?i(t):r(t,{})},b=function(t){return function(e){var n;if(!l(e)||(n=i(e)).type!==t)throw new g("Incompatible receiver, "+t+" required");return n}};if(s||h.state){var v=h.state||(h.state=new m);v.get=v.get,v.has=v.has,v.set=v.set,r=function(t,e){if(v.has(t))throw new g(f);return e.facade=t,v.set(t,e),e},i=function(t){return v.get(t)||{}},o=function(t){return v.has(t)}}else{var w=d("state");p[w]=!0,r=function(t,e){if(c(t,w))throw new g(f);return e.facade=t,u(t,w,e),e},i=function(t){return c(t,w)?t[w]:{}},o=function(t){return c(t,w)}}t.exports={set:r,get:i,has:o,enforce:y,getterFor:b}},2297:function(t,e,n){"use strict";var r=n(6648);t.exports=Array.isArray||function(t){return"Array"===r(t)}},9401:function(t,e,n){"use strict";var r=n(926);t.exports=function(t){var e=r(t);return"BigInt64Array"===e||"BigUint64Array"===e}},9985:function(t,e,n){"use strict";var r=n(2659),i=r.all;t.exports=r.IS_HTMLDDA?function(t){return"function"==typeof t||t===i}:function(t){return"function"==typeof t}},5266:function(t,e,n){"use strict";var r=n(3689),i=n(9985),o=/#|\.prototype\./,s=function(t,e){var n=l[a(t)];return n===c||n!==u&&(i(e)?r(e):!!e)},a=s.normalize=function(t){return String(t).replace(o,".").toLowerCase()},l=s.data={},u=s.NATIVE="N",c=s.POLYFILL="P";t.exports=s},981:function(t){"use strict";t.exports=function(t){return null===t||void 0===t}},8999:function(t,e,n){"use strict";var r=n(9985),i=n(2659),o=i.all;t.exports=i.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:r(t)||t===o}:function(t){return"object"==typeof t?null!==t:r(t)}},3931:function(t){"use strict";t.exports=!1},734:function(t,e,n){"use strict";var r=n(6058),i=n(9985),o=n(3622),s=n(9525),a=Object;t.exports=s?function(t){return"symbol"==typeof t}:function(t){var e=r("Symbol");return i(e)&&o(e.prototype,a(t))}},6310:function(t,e,n){"use strict";var r=n(3126);t.exports=function(t){return r(t.length)}},8702:function(t,e,n){"use strict";var r=n(8844),i=n(3689),o=n(9985),s=n(6812),a=n(7697),l=n(1236).CONFIGURABLE,u=n(6738),c=n(618),h=c.enforce,d=c.get,p=String,f=Object.defineProperty,g=r("".slice),m=r("".replace),y=r([].join),b=a&&!i((function(){return 8!==f((function(){}),"length",{value:8}).length})),v=String(String).split("String"),w=t.exports=function(t,e,n){"Symbol("===g(p(e),0,7)&&(e="["+m(p(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!s(t,"name")||l&&t.name!==e)&&(a?f(t,"name",{value:e,configurable:!0}):t.name=e),b&&n&&s(n,"arity")&&t.length!==n.arity&&f(t,"length",{value:n.arity});try{n&&s(n,"constructor")&&n.constructor?a&&f(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(i){}var r=h(t);return s(r,"source")||(r.source=y(v,"string"==typeof e?e:"")),t};Function.prototype.toString=w((function(){return o(this)&&d(this).source||u(this)}),"toString")},8828:function(t){"use strict";var e=Math.ceil,n=Math.floor;t.exports=Math.trunc||function(t){var r=+t;return(r>0?n:e)(r)}},3841:function(t,e,n){"use strict";var r=n(4327);t.exports=function(t,e){return void 0===t?arguments.length<2?"":e:r(t)}},2560:function(t,e,n){"use strict";var r=n(7697),i=n(8506),o=n(5648),s=n(5027),a=n(8360),l=TypeError,u=Object.defineProperty,c=Object.getOwnPropertyDescriptor,h="enumerable",d="configurable",p="writable";e.f=r?o?function(t,e,n){if(s(t),e=a(e),s(n),"function"===typeof t&&"prototype"===e&&"value"in n&&p in n&&!n[p]){var r=c(t,e);r&&r[p]&&(t[e]=n.value,n={configurable:d in n?n[d]:r[d],enumerable:h in n?n[h]:r[h],writable:!1})}return u(t,e,n)}:u:function(t,e,n){if(s(t),e=a(e),s(n),i)try{return u(t,e,n)}catch(r){}if("get"in n||"set"in n)throw new l("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},2474:function(t,e,n){"use strict";var r=n(7697),i=n(2615),o=n(9556),s=n(5684),a=n(5290),l=n(8360),u=n(6812),c=n(8506),h=Object.getOwnPropertyDescriptor;e.f=r?h:function(t,e){if(t=a(t),e=l(e),c)try{return h(t,e)}catch(n){}if(u(t,e))return s(!i(o.f,t,e),t[e])}},2741:function(t,e,n){"use strict";var r=n(4948),i=n(2739),o=i.concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,o)}},7518:function(t,e){"use strict";e.f=Object.getOwnPropertySymbols},1868:function(t,e,n){"use strict";var r=n(6812),i=n(9985),o=n(690),s=n(2713),a=n(1748),l=s("IE_PROTO"),u=Object,c=u.prototype;t.exports=a?u.getPrototypeOf:function(t){var e=o(t);if(r(e,l))return e[l];var n=e.constructor;return i(n)&&e instanceof n?n.prototype:e instanceof u?c:null}},3622:function(t,e,n){"use strict";var r=n(8844);t.exports=r({}.isPrototypeOf)},4948:function(t,e,n){"use strict";var r=n(8844),i=n(6812),o=n(5290),s=n(4328).indexOf,a=n(7248),l=r([].push);t.exports=function(t,e){var n,r=o(t),u=0,c=[];for(n in r)!i(a,n)&&i(r,n)&&l(c,n);while(e.length>u)i(r,n=e[u++])&&(~s(c,n)||l(c,n));return c}},9556:function(t,e){"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,i=r&&!n.call({1:2},1);e.f=i?function(t){var e=r(this,t);return!!e&&e.enumerable}:n},9385:function(t,e,n){"use strict";var r=n(2743),i=n(5027),o=n(3550);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{t=r(Object.prototype,"__proto__","set"),t(n,[]),e=n instanceof Array}catch(s){}return function(n,r){return i(n),o(r),e?t(n,r):n.__proto__=r,n}}():void 0)},5899:function(t,e,n){"use strict";var r=n(2615),i=n(9985),o=n(8999),s=TypeError;t.exports=function(t,e){var n,a;if("string"===e&&i(n=t.toString)&&!o(a=r(n,t)))return a;if(i(n=t.valueOf)&&!o(a=r(n,t)))return a;if("string"!==e&&i(n=t.toString)&&!o(a=r(n,t)))return a;throw new s("Can't convert object to primitive value")}},9152:function(t,e,n){"use strict";var r=n(6058),i=n(8844),o=n(2741),s=n(7518),a=n(5027),l=i([].concat);t.exports=r("Reflect","ownKeys")||function(t){var e=o.f(a(t)),n=s.f;return n?l(e,n(t)):e}},9633:function(t,e,n){"use strict";var r=n(5027);t.exports=function(){var t=r(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e}},4684:function(t,e,n){"use strict";var r=n(981),i=TypeError;t.exports=function(t){if(r(t))throw new i("Can't call method on "+t);return t}},8552:function(t,e,n){"use strict";var r=n(9037),i=n(1735),o=n(9985),s=n(3127),a=n(71),l=n(6004),u=n(1500),c=r.Function,h=/MSIE .\./.test(a)||s&&function(){var t=r.Bun.version.split(".");return t.length<3||"0"===t[0]&&(t[1]<3||"3"===t[1]&&"0"===t[2])}();t.exports=function(t,e){var n=e?2:1;return h?function(r,s){var a=u(arguments.length,1)>n,h=o(r)?r:c(r),d=a?l(arguments,n):[],p=a?function(){i(h,this,d)}:h;return e?t(p,s):t(p)}:t}},2713:function(t,e,n){"use strict";var r=n(3430),i=n(4630),o=r("keys");t.exports=function(t){return o[t]||(o[t]=i(t))}},4091:function(t,e,n){"use strict";var r=n(9037),i=n(5014),o="__core-js_shared__",s=r[o]||i(o,{});t.exports=s},3430:function(t,e,n){"use strict";var r=n(3931),i=n(4091);(t.exports=function(t,e){return i[t]||(i[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.34.0",mode:r?"pure":"global",copyright:" 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.34.0/LICENSE",source:"https://github.com/zloirock/core-js"})},146:function(t,e,n){"use strict";var r=n(3615),i=n(3689),o=n(9037),s=o.String;t.exports=!!Object.getOwnPropertySymbols&&!i((function(){var t=Symbol("symbol detection");return!s(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},9886:function(t,e,n){"use strict";var r,i,o,s,a=n(9037),l=n(1735),u=n(4071),c=n(9985),h=n(6812),d=n(3689),p=n(2688),f=n(6004),g=n(6420),m=n(1500),y=n(4764),b=n(806),v=a.setImmediate,w=a.clearImmediate,x=a.process,k=a.Dispatch,_=a.Function,I=a.MessageChannel,C=a.String,S=0,T={},E="onreadystatechange";d((function(){r=a.location}));var N=function(t){if(h(T,t)){var e=T[t];delete T[t],e()}},A=function(t){return function(){N(t)}},R=function(t){N(t.data)},$=function(t){a.postMessage(C(t),r.protocol+"//"+r.host)};v&&w||(v=function(t){m(arguments.length,1);var e=c(t)?t:_(t),n=f(arguments,1);return T[++S]=function(){l(e,void 0,n)},i(S),S},w=function(t){delete T[t]},b?i=function(t){x.nextTick(A(t))}:k&&k.now?i=function(t){k.now(A(t))}:I&&!y?(o=new I,s=o.port2,o.port1.onmessage=R,i=u(s.postMessage,s)):a.addEventListener&&c(a.postMessage)&&!a.importScripts&&r&&"file:"!==r.protocol&&!d($)?(i=$,a.addEventListener("message",R,!1)):i=E in g("script")?function(t){p.appendChild(g("script"))[E]=function(){p.removeChild(this),N(t)}}:function(t){setTimeout(A(t),0)}),t.exports={set:v,clear:w}},7578:function(t,e,n){"use strict";var r=n(8700),i=Math.max,o=Math.min;t.exports=function(t,e){var n=r(t);return n<0?i(n+e,0):o(n,e)}},1530:function(t,e,n){"use strict";var r=n(8732),i=TypeError;t.exports=function(t){var e=r(t,"number");if("number"==typeof e)throw new i("Can't convert number to bigint");return BigInt(e)}},5290:function(t,e,n){"use strict";var r=n(4413),i=n(4684);t.exports=function(t){return r(i(t))}},8700:function(t,e,n){"use strict";var r=n(8828);t.exports=function(t){var e=+t;return e!==e||0===e?0:r(e)}},3126:function(t,e,n){"use strict";var r=n(8700),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},690:function(t,e,n){"use strict";var r=n(4684),i=Object;t.exports=function(t){return i(r(t))}},8732:function(t,e,n){"use strict";var r=n(2615),i=n(8999),o=n(734),s=n(4849),a=n(5899),l=n(4201),u=TypeError,c=l("toPrimitive");t.exports=function(t,e){if(!i(t)||o(t))return t;var n,l=s(t,c);if(l){if(void 0===e&&(e="default"),n=r(l,t,e),!i(n)||o(n))return n;throw new u("Can't convert object to primitive value")}return void 0===e&&(e="number"),a(t,e)}},8360:function(t,e,n){"use strict";var r=n(8732),i=n(734);t.exports=function(t){var e=r(t,"string");return i(e)?e:e+""}},3043:function(t,e,n){"use strict";var r=n(4201),i=r("toStringTag"),o={};o[i]="z",t.exports="[object z]"===String(o)},4327:function(t,e,n){"use strict";var r=n(926),i=String;t.exports=function(t){if("Symbol"===r(t))throw new TypeError("Cannot convert a Symbol value to a string");return i(t)}},3691:function(t){"use strict";var e=String;t.exports=function(t){try{return e(t)}catch(n){return"Object"}}},4630:function(t,e,n){"use strict";var r=n(8844),i=0,o=Math.random(),s=r(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+s(++i+o,36)}},9525:function(t,e,n){"use strict";var r=n(146);t.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},5648:function(t,e,n){"use strict";var r=n(7697),i=n(3689);t.exports=r&&i((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},1500:function(t){"use strict";var e=TypeError;t.exports=function(t,n){if(t<n)throw new e("Not enough arguments");return t}},9834:function(t,e,n){"use strict";var r=n(9037),i=n(9985),o=r.WeakMap;t.exports=i(o)&&/native code/.test(String(o))},4201:function(t,e,n){"use strict";var r=n(9037),i=n(3430),o=n(6812),s=n(4630),a=n(146),l=n(9525),u=r.Symbol,c=i("wks"),h=l?u["for"]||u:u&&u.withoutSetter||s;t.exports=function(t){return o(c,t)||(c[t]=a&&o(u,t)?u[t]:h("Symbol."+t)),c[t]}},560:function(t,e,n){"use strict";var r=n(9989),i=n(690),o=n(6310),s=n(5649),a=n(5565),l=n(3689),u=l((function(){return 4294967297!==[].push.call({length:4294967296},1)})),c=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},h=u||!c();r({target:"Array",proto:!0,arity:1,forced:h},{push:function(t){var e=i(this),n=o(e),r=arguments.length;a(n+r);for(var l=0;l<r;l++)e[n]=arguments[l],n++;return s(e,n),n}})},5847:function(t,e,n){"use strict";var r=n(9037),i=n(7697),o=n(2148),s=n(9633),a=n(3689),l=r.RegExp,u=l.prototype,c=i&&a((function(){var t=!0;try{l(".","d")}catch(c){t=!1}var e={},n="",r=t?"dgimsy":"gimsy",i=function(t,r){Object.defineProperty(e,t,{get:function(){return n+=r,!0}})},o={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var s in t&&(o.hasIndices="d"),o)i(s,o[s]);var a=Object.getOwnPropertyDescriptor(u,"flags").get.call(e);return a!==r||n!==r}));c&&o(u,"flags",{configurable:!0,get:s})},4224:function(t,e,n){"use strict";var r=n(6166),i=n(4872),o=i.aTypedArray,s=i.exportTypedArrayMethod,a=i.getTypedArrayConstructor;s("toReversed",(function(){return r(o(this),a(this))}))},1121:function(t,e,n){"use strict";var r=n(4872),i=n(8844),o=n(509),s=n(9976),a=r.aTypedArray,l=r.getTypedArrayConstructor,u=r.exportTypedArrayMethod,c=i(r.TypedArrayPrototype.sort);u("toSorted",(function(t){void 0!==t&&o(t);var e=a(this),n=s(l(e),e);return c(n,t)}))},7133:function(t,e,n){"use strict";var r=n(6134),i=n(4872),o=n(9401),s=n(8700),a=n(1530),l=i.aTypedArray,u=i.getTypedArrayConstructor,c=i.exportTypedArrayMethod,h=!!function(){try{new Int8Array(1)["with"](2,{valueOf:function(){throw 8}})}catch(t){return 8===t}}();c("with",{with:function(t,e){var n=l(this),i=s(t),c=o(n)?a(e):+e;return r(n,u(n),i,c)}}["with"],!h)},9742:function(t,e,n){"use strict";var r=n(9989),i=n(9037),o=n(9886).clear;r({global:!0,bind:!0,enumerable:!0,forced:i.clearImmediate!==o},{clearImmediate:o})},3429:function(t,e,n){"use strict";var r=n(9989),i=n(9037),o=n(6058),s=n(5684),a=n(2560).f,l=n(6812),u=n(767),c=n(3457),h=n(3841),d=n(7136),p=n(6610),f=n(7697),g=n(3931),m="DOMException",y=o("Error"),b=o(m),v=function(){u(this,w);var t=arguments.length,e=h(t<1?void 0:arguments[0]),n=h(t<2?void 0:arguments[1],"Error"),r=new b(e,n),i=new y(e);return i.name=m,a(r,"stack",s(1,p(i.stack,1))),c(r,this,v),r},w=v.prototype=b.prototype,x="stack"in new y(m),k="stack"in new b(1,2),_=b&&f&&Object.getOwnPropertyDescriptor(i,m),I=!!_&&!(_.writable&&_.configurable),C=x&&!I&&!k;r({global:!0,constructor:!0,forced:g||C},{DOMException:C?v:b});var S=o(m),T=S.prototype;if(T.constructor!==S)for(var E in g||a(T,"constructor",s(1,S)),d)if(l(d,E)){var N=d[E],A=N.s;l(S,A)||a(S,A,s(6,N.c))}},88:function(t,e,n){"use strict";n(9742),n(2731)},2731:function(t,e,n){"use strict";var r=n(9989),i=n(9037),o=n(9886).set,s=n(8552),a=i.setImmediate?s(o,!1):o;r({global:!0,bind:!0,enumerable:!0,forced:i.setImmediate!==a},{setImmediate:a})},8858:function(t,e,n){"use strict";var r=n(1880),i=n(8844),o=n(4327),s=n(1500),a=URLSearchParams,l=a.prototype,u=i(l.append),c=i(l["delete"]),h=i(l.forEach),d=i([].push),p=new a("a=1&a=2&b=3");p["delete"]("a",1),p["delete"]("b",void 0),p+""!=="a=2"&&r(l,"delete",(function(t){var e=arguments.length,n=e<2?void 0:arguments[1];if(e&&void 0===n)return c(this,t);var r=[];h(this,(function(t,e){d(r,{key:e,value:t})})),s(e,1);var i,a=o(t),l=o(n),p=0,f=0,g=!1,m=r.length;while(p<m)i=r[p++],g||i.key===a?(g=!0,c(this,i.key)):f++;while(f<m)i=r[f++],i.key===a&&i.value===l||u(this,i.key,i.value)}),{enumerable:!0,unsafe:!0})},1318:function(t,e,n){"use strict";var r=n(1880),i=n(8844),o=n(4327),s=n(1500),a=URLSearchParams,l=a.prototype,u=i(l.getAll),c=i(l.has),h=new a("a=1");!h.has("a",2)&&h.has("a",void 0)||r(l,"has",(function(t){var e=arguments.length,n=e<2?void 0:arguments[1];if(e&&void 0===n)return c(this,t);var r=u(this,t);s(e,1);var i=o(n),a=0;while(a<r.length)if(r[a++]===i)return!0;return!1}),{enumerable:!0,unsafe:!0})},3228:function(t,e,n){"use strict";var r=n(7697),i=n(8844),o=n(2148),s=URLSearchParams.prototype,a=i(s.forEach);r&&!("size"in s)&&o(s,"size",{get:function(){var t=0;return a(this,(function(){t++})),t},configurable:!0,enumerable:!0})},4161:function(t,e,n){"use strict";n.d(e,{Z:function(){return ze}});n(4224),n(1121),n(7133),n(560);function r(t,e){return function(){return t.apply(e,arguments)}}const{toString:i}=Object.prototype,{getPrototypeOf:o}=Object,s=(t=>e=>{const n=i.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),a=t=>(t=t.toLowerCase(),e=>s(e)===t),l=t=>e=>typeof e===t,{isArray:u}=Array,c=l("undefined");function h(t){return null!==t&&!c(t)&&null!==t.constructor&&!c(t.constructor)&&g(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const d=a("ArrayBuffer");function p(t){let e;return e="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&d(t.buffer),e}const f=l("string"),g=l("function"),m=l("number"),y=t=>null!==t&&"object"===typeof t,b=t=>!0===t||!1===t,v=t=>{if("object"!==s(t))return!1;const e=o(t);return(null===e||e===Object.prototype||null===Object.getPrototypeOf(e))&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},w=a("Date"),x=a("File"),k=a("Blob"),_=a("FileList"),I=t=>y(t)&&g(t.pipe),C=t=>{let e;return t&&("function"===typeof FormData&&t instanceof FormData||g(t.append)&&("formdata"===(e=s(t))||"object"===e&&g(t.toString)&&"[object FormData]"===t.toString()))},S=a("URLSearchParams"),T=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function E(t,e,{allOwnKeys:n=!1}={}){if(null===t||"undefined"===typeof t)return;let r,i;if("object"!==typeof t&&(t=[t]),u(t))for(r=0,i=t.length;r<i;r++)e.call(null,t[r],r,t);else{const i=n?Object.getOwnPropertyNames(t):Object.keys(t),o=i.length;let s;for(r=0;r<o;r++)s=i[r],e.call(null,t[s],s,t)}}function N(t,e){e=e.toLowerCase();const n=Object.keys(t);let r,i=n.length;while(i-- >0)if(r=n[i],e===r.toLowerCase())return r;return null}const A=(()=>"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global)(),R=t=>!c(t)&&t!==A;function $(){const{caseless:t}=R(this)&&this||{},e={},n=(n,r)=>{const i=t&&N(e,r)||r;v(e[i])&&v(n)?e[i]=$(e[i],n):v(n)?e[i]=$({},n):u(n)?e[i]=n.slice():e[i]=n};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&E(arguments[r],n);return e}const D=(t,e,n,{allOwnKeys:i}={})=>(E(e,((e,i)=>{n&&g(e)?t[i]=r(e,n):t[i]=e}),{allOwnKeys:i}),t),O=t=>(65279===t.charCodeAt(0)&&(t=t.slice(1)),t),F=(t,e,n,r)=>{t.prototype=Object.create(e.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},M=(t,e,n,r)=>{let i,s,a;const l={};if(e=e||{},null==t)return e;do{i=Object.getOwnPropertyNames(t),s=i.length;while(s-- >0)a=i[s],r&&!r(a,t,e)||l[a]||(e[a]=t[a],l[a]=!0);t=!1!==n&&o(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},P=(t,e,n)=>{t=String(t),(void 0===n||n>t.length)&&(n=t.length),n-=e.length;const r=t.indexOf(e,n);return-1!==r&&r===n},L=t=>{if(!t)return null;if(u(t))return t;let e=t.length;if(!m(e))return null;const n=new Array(e);while(e-- >0)n[e]=t[e];return n},z=(t=>e=>t&&e instanceof t)("undefined"!==typeof Uint8Array&&o(Uint8Array)),B=(t,e)=>{const n=t&&t[Symbol.iterator],r=n.call(t);let i;while((i=r.next())&&!i.done){const n=i.value;e.call(t,n[0],n[1])}},W=(t,e)=>{let n;const r=[];while(null!==(n=t.exec(e)))r.push(n);return r},U=a("HTMLFormElement"),V=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(t,e,n){return e.toUpperCase()+n})),j=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),H=a("RegExp"),G=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),r={};E(n,((n,i)=>{let o;!1!==(o=e(n,i,t))&&(r[i]=o||n)})),Object.defineProperties(t,r)},q=t=>{G(t,((e,n)=>{if(g(t)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const r=t[n];g(r)&&(e.enumerable=!1,"writable"in e?e.writable=!1:e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))}))},K=(t,e)=>{const n={},r=t=>{t.forEach((t=>{n[t]=!0}))};return u(t)?r(t):r(String(t).split(e)),n},X=()=>{},Y=(t,e)=>(t=+t,Number.isFinite(t)?t:e),J="abcdefghijklmnopqrstuvwxyz",Z="0123456789",Q={DIGIT:Z,ALPHA:J,ALPHA_DIGIT:J+J.toUpperCase()+Z},tt=(t=16,e=Q.ALPHA_DIGIT)=>{let n="";const{length:r}=e;while(t--)n+=e[Math.random()*r|0];return n};function et(t){return!!(t&&g(t.append)&&"FormData"===t[Symbol.toStringTag]&&t[Symbol.iterator])}const nt=t=>{const e=new Array(10),n=(t,r)=>{if(y(t)){if(e.indexOf(t)>=0)return;if(!("toJSON"in t)){e[r]=t;const i=u(t)?[]:{};return E(t,((t,e)=>{const o=n(t,r+1);!c(o)&&(i[e]=o)})),e[r]=void 0,i}}return t};return n(t,0)},rt=a("AsyncFunction"),it=t=>t&&(y(t)||g(t))&&g(t.then)&&g(t.catch);var ot={isArray:u,isArrayBuffer:d,isBuffer:h,isFormData:C,isArrayBufferView:p,isString:f,isNumber:m,isBoolean:b,isObject:y,isPlainObject:v,isUndefined:c,isDate:w,isFile:x,isBlob:k,isRegExp:H,isFunction:g,isStream:I,isURLSearchParams:S,isTypedArray:z,isFileList:_,forEach:E,merge:$,extend:D,trim:T,stripBOM:O,inherits:F,toFlatObject:M,kindOf:s,kindOfTest:a,endsWith:P,toArray:L,forEachEntry:B,matchAll:W,isHTMLForm:U,hasOwnProperty:j,hasOwnProp:j,reduceDescriptors:G,freezeMethods:q,toObjectSet:K,toCamelCase:V,noop:X,toFiniteNumber:Y,findKey:N,global:A,isContextDefined:R,ALPHABET:Q,generateString:tt,isSpecCompliantForm:et,toJSONObject:nt,isAsyncFn:rt,isThenable:it};function st(t,e,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i)}ot.inherits(st,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ot.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const at=st.prototype,lt={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((t=>{lt[t]={value:t}})),Object.defineProperties(st,lt),Object.defineProperty(at,"isAxiosError",{value:!0}),st.from=(t,e,n,r,i,o)=>{const s=Object.create(at);return ot.toFlatObject(t,s,(function(t){return t!==Error.prototype}),(t=>"isAxiosError"!==t)),st.call(s,t.message,e,n,r,i),s.cause=t,s.name=t.name,o&&Object.assign(s,o),s};var ut=st,ct=null;function ht(t){return ot.isPlainObject(t)||ot.isArray(t)}function dt(t){return ot.endsWith(t,"[]")?t.slice(0,-2):t}function pt(t,e,n){return t?t.concat(e).map((function(t,e){return t=dt(t),!n&&e?"["+t+"]":t})).join(n?".":""):e}function ft(t){return ot.isArray(t)&&!t.some(ht)}const gt=ot.toFlatObject(ot,{},null,(function(t){return/^is[A-Z]/.test(t)}));function mt(t,e,n){if(!ot.isObject(t))throw new TypeError("target must be an object");e=e||new(ct||FormData),n=ot.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(t,e){return!ot.isUndefined(e[t])}));const r=n.metaTokens,i=n.visitor||c,o=n.dots,s=n.indexes,a=n.Blob||"undefined"!==typeof Blob&&Blob,l=a&&ot.isSpecCompliantForm(e);if(!ot.isFunction(i))throw new TypeError("visitor must be a function");function u(t){if(null===t)return"";if(ot.isDate(t))return t.toISOString();if(!l&&ot.isBlob(t))throw new ut("Blob is not supported. Use a Buffer instead.");return ot.isArrayBuffer(t)||ot.isTypedArray(t)?l&&"function"===typeof Blob?new Blob([t]):Buffer.from(t):t}function c(t,n,i){let a=t;if(t&&!i&&"object"===typeof t)if(ot.endsWith(n,"{}"))n=r?n:n.slice(0,-2),t=JSON.stringify(t);else if(ot.isArray(t)&&ft(t)||(ot.isFileList(t)||ot.endsWith(n,"[]"))&&(a=ot.toArray(t)))return n=dt(n),a.forEach((function(t,r){!ot.isUndefined(t)&&null!==t&&e.append(!0===s?pt([n],r,o):null===s?n:n+"[]",u(t))})),!1;return!!ht(t)||(e.append(pt(i,n,o),u(t)),!1)}const h=[],d=Object.assign(gt,{defaultVisitor:c,convertValue:u,isVisitable:ht});function p(t,n){if(!ot.isUndefined(t)){if(-1!==h.indexOf(t))throw Error("Circular reference detected in "+n.join("."));h.push(t),ot.forEach(t,(function(t,r){const o=!(ot.isUndefined(t)||null===t)&&i.call(e,t,ot.isString(r)?r.trim():r,n,d);!0===o&&p(t,n?n.concat(r):[r])})),h.pop()}}if(!ot.isObject(t))throw new TypeError("data must be an object");return p(t),e}var yt=mt;function bt(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,(function(t){return e[t]}))}function vt(t,e){this._pairs=[],t&&yt(t,this,e)}const wt=vt.prototype;wt.append=function(t,e){this._pairs.push([t,e])},wt.toString=function(t){const e=t?function(e){return t.call(this,e,bt)}:bt;return this._pairs.map((function(t){return e(t[0])+"="+e(t[1])}),"").join("&")};var xt=vt;function kt(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function _t(t,e,n){if(!e)return t;const r=n&&n.encode||kt,i=n&&n.serialize;let o;if(o=i?i(e,n):ot.isURLSearchParams(e)?e.toString():new xt(e,n).toString(r),o){const e=t.indexOf("#");-1!==e&&(t=t.slice(0,e)),t+=(-1===t.indexOf("?")?"?":"&")+o}return t}class It{constructor(){this.handlers=[]}use(t,e,n){return this.handlers.push({fulfilled:t,rejected:e,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){ot.forEach(this.handlers,(function(e){null!==e&&t(e)}))}}var Ct=It,St={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Tt=(n(8858),n(1318),n(3228),"undefined"!==typeof URLSearchParams?URLSearchParams:xt),Et="undefined"!==typeof FormData?FormData:null,Nt="undefined"!==typeof Blob?Blob:null;const At=(()=>{let t;return("undefined"===typeof navigator||"ReactNative"!==(t=navigator.product)&&"NativeScript"!==t&&"NS"!==t)&&("undefined"!==typeof window&&"undefined"!==typeof document)})(),Rt=(()=>"undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts)();var $t={isBrowser:!0,classes:{URLSearchParams:Tt,FormData:Et,Blob:Nt},isStandardBrowserEnv:At,isStandardBrowserWebWorkerEnv:Rt,protocols:["http","https","file","blob","url","data"]};function Dt(t,e){return yt(t,new $t.classes.URLSearchParams,Object.assign({visitor:function(t,e,n,r){return $t.isNode&&ot.isBuffer(t)?(this.append(e,t.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)}},e))}function Ot(t){return ot.matchAll(/\w+|\[(\w*)]/g,t).map((t=>"[]"===t[0]?"":t[1]||t[0]))}function Ft(t){const e={},n=Object.keys(t);let r;const i=n.length;let o;for(r=0;r<i;r++)o=n[r],e[o]=t[o];return e}function Mt(t){function e(t,n,r,i){let o=t[i++];const s=Number.isFinite(+o),a=i>=t.length;if(o=!o&&ot.isArray(r)?r.length:o,a)return ot.hasOwnProp(r,o)?r[o]=[r[o],n]:r[o]=n,!s;r[o]&&ot.isObject(r[o])||(r[o]=[]);const l=e(t,n,r[o],i);return l&&ot.isArray(r[o])&&(r[o]=Ft(r[o])),!s}if(ot.isFormData(t)&&ot.isFunction(t.entries)){const n={};return ot.forEachEntry(t,((t,r)=>{e(Ot(t),r,n,0)})),n}return null}var Pt=Mt;function Lt(t,e,n){if(ot.isString(t))try{return(e||JSON.parse)(t),ot.trim(t)}catch(r){if("SyntaxError"!==r.name)throw r}return(n||JSON.stringify)(t)}const zt={transitional:St,adapter:["xhr","http"],transformRequest:[function(t,e){const n=e.getContentType()||"",r=n.indexOf("application/json")>-1,i=ot.isObject(t);i&&ot.isHTMLForm(t)&&(t=new FormData(t));const o=ot.isFormData(t);if(o)return r&&r?JSON.stringify(Pt(t)):t;if(ot.isArrayBuffer(t)||ot.isBuffer(t)||ot.isStream(t)||ot.isFile(t)||ot.isBlob(t))return t;if(ot.isArrayBufferView(t))return t.buffer;if(ot.isURLSearchParams(t))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let s;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return Dt(t,this.formSerializer).toString();if((s=ot.isFileList(t))||n.indexOf("multipart/form-data")>-1){const e=this.env&&this.env.FormData;return yt(s?{"files[]":t}:t,e&&new e,this.formSerializer)}}return i||r?(e.setContentType("application/json",!1),Lt(t)):t}],transformResponse:[function(t){const e=this.transitional||zt.transitional,n=e&&e.forcedJSONParsing,r="json"===this.responseType;if(t&&ot.isString(t)&&(n&&!this.responseType||r)){const n=e&&e.silentJSONParsing,o=!n&&r;try{return JSON.parse(t)}catch(i){if(o){if("SyntaxError"===i.name)throw ut.from(i,ut.ERR_BAD_RESPONSE,this,null,this.response);throw i}}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:$t.classes.FormData,Blob:$t.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ot.forEach(["delete","get","head","post","put","patch"],(t=>{zt.headers[t]={}}));var Bt=zt;const Wt=ot.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]);var Ut=t=>{const e={};let n,r,i;return t&&t.split("\n").forEach((function(t){i=t.indexOf(":"),n=t.substring(0,i).trim().toLowerCase(),r=t.substring(i+1).trim(),!n||e[n]&&Wt[n]||("set-cookie"===n?e[n]?e[n].push(r):e[n]=[r]:e[n]=e[n]?e[n]+", "+r:r)})),e};const Vt=Symbol("internals");function jt(t){return t&&String(t).trim().toLowerCase()}function Ht(t){return!1===t||null==t?t:ot.isArray(t)?t.map(Ht):String(t)}function Gt(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;while(r=n.exec(t))e[r[1]]=r[2];return e}const qt=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function Kt(t,e,n,r,i){return ot.isFunction(r)?r.call(this,e,n):(i&&(e=n),ot.isString(e)?ot.isString(r)?-1!==e.indexOf(r):ot.isRegExp(r)?r.test(e):void 0:void 0)}function Xt(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((t,e,n)=>e.toUpperCase()+n))}function Yt(t,e){const n=ot.toCamelCase(" "+e);["get","set","has"].forEach((r=>{Object.defineProperty(t,r+n,{value:function(t,n,i){return this[r].call(this,e,t,n,i)},configurable:!0})}))}class Jt{constructor(t){t&&this.set(t)}set(t,e,n){const r=this;function i(t,e,n){const i=jt(e);if(!i)throw new Error("header name must be a non-empty string");const o=ot.findKey(r,i);(!o||void 0===r[o]||!0===n||void 0===n&&!1!==r[o])&&(r[o||e]=Ht(t))}const o=(t,e)=>ot.forEach(t,((t,n)=>i(t,n,e)));return ot.isPlainObject(t)||t instanceof this.constructor?o(t,e):ot.isString(t)&&(t=t.trim())&&!qt(t)?o(Ut(t),e):null!=t&&i(e,t,n),this}get(t,e){if(t=jt(t),t){const n=ot.findKey(this,t);if(n){const t=this[n];if(!e)return t;if(!0===e)return Gt(t);if(ot.isFunction(e))return e.call(this,t,n);if(ot.isRegExp(e))return e.exec(t);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,e){if(t=jt(t),t){const n=ot.findKey(this,t);return!(!n||void 0===this[n]||e&&!Kt(this,this[n],n,e))}return!1}delete(t,e){const n=this;let r=!1;function i(t){if(t=jt(t),t){const i=ot.findKey(n,t);!i||e&&!Kt(n,n[i],i,e)||(delete n[i],r=!0)}}return ot.isArray(t)?t.forEach(i):i(t),r}clear(t){const e=Object.keys(this);let n=e.length,r=!1;while(n--){const i=e[n];t&&!Kt(this,this[i],i,t,!0)||(delete this[i],r=!0)}return r}normalize(t){const e=this,n={};return ot.forEach(this,((r,i)=>{const o=ot.findKey(n,i);if(o)return e[o]=Ht(r),void delete e[i];const s=t?Xt(i):String(i).trim();s!==i&&delete e[i],e[s]=Ht(r),n[s]=!0})),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const e=Object.create(null);return ot.forEach(this,((n,r)=>{null!=n&&!1!==n&&(e[r]=t&&ot.isArray(n)?n.join(", "):n)})),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((([t,e])=>t+": "+e)).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...e){const n=new this(t);return e.forEach((t=>n.set(t))),n}static accessor(t){const e=this[Vt]=this[Vt]={accessors:{}},n=e.accessors,r=this.prototype;function i(t){const e=jt(t);n[e]||(Yt(r,t),n[e]=!0)}return ot.isArray(t)?t.forEach(i):i(t),this}}Jt.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),ot.reduceDescriptors(Jt.prototype,(({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(t){this[n]=t}}})),ot.freezeMethods(Jt);var Zt=Jt;function Qt(t,e){const n=this||Bt,r=e||n,i=Zt.from(r.headers);let o=r.data;return ot.forEach(t,(function(t){o=t.call(n,o,i.normalize(),e?e.status:void 0)})),i.normalize(),o}function te(t){return!(!t||!t.__CANCEL__)}function ee(t,e,n){ut.call(this,null==t?"canceled":t,ut.ERR_CANCELED,e,n),this.name="CanceledError"}ot.inherits(ee,ut,{__CANCEL__:!0});var ne=ee;n(3429);function re(t,e,n){const r=n.config.validateStatus;n.status&&r&&!r(n.status)?e(new ut("Request failed with status code "+n.status,[ut.ERR_BAD_REQUEST,ut.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):t(n)}var ie=$t.isStandardBrowserEnv?function(){return{write:function(t,e,n,r,i,o){const s=[];s.push(t+"="+encodeURIComponent(e)),ot.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),ot.isString(r)&&s.push("path="+r),ot.isString(i)&&s.push("domain="+i),!0===o&&s.push("secure"),document.cookie=s.join("; ")},read:function(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}();function oe(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function se(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}function ae(t,e){return t&&!oe(e)?se(t,e):e}var le=$t.isStandardBrowserEnv?function(){const t=/(msie|trident)/i.test(navigator.userAgent),e=document.createElement("a");let n;function r(n){let r=n;return t&&(e.setAttribute("href",r),r=e.href),e.setAttribute("href",r),{href:e.href,protocol:e.protocol?e.protocol.replace(/:$/,""):"",host:e.host,search:e.search?e.search.replace(/^\?/,""):"",hash:e.hash?e.hash.replace(/^#/,""):"",hostname:e.hostname,port:e.port,pathname:"/"===e.pathname.charAt(0)?e.pathname:"/"+e.pathname}}return n=r(window.location.href),function(t){const e=ot.isString(t)?r(t):t;return e.protocol===n.protocol&&e.host===n.host}}():function(){return function(){return!0}}();function ue(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function ce(t,e){t=t||10;const n=new Array(t),r=new Array(t);let i,o=0,s=0;return e=void 0!==e?e:1e3,function(a){const l=Date.now(),u=r[s];i||(i=l),n[o]=a,r[o]=l;let c=s,h=0;while(c!==o)h+=n[c++],c%=t;if(o=(o+1)%t,o===s&&(s=(s+1)%t),l-i<e)return;const d=u&&l-u;return d?Math.round(1e3*h/d):void 0}}var he=ce;function de(t,e){let n=0;const r=he(50,250);return i=>{const o=i.loaded,s=i.lengthComputable?i.total:void 0,a=o-n,l=r(a),u=o<=s;n=o;const c={loaded:o,total:s,progress:s?o/s:void 0,bytes:a,rate:l||void 0,estimated:l&&s&&u?(s-o)/l:void 0,event:i};c[e?"download":"upload"]=!0,t(c)}}const pe="undefined"!==typeof XMLHttpRequest;var fe=pe&&function(t){return new Promise((function(e,n){let r=t.data;const i=Zt.from(t.headers).normalize(),o=t.responseType;let s,a;function l(){t.cancelToken&&t.cancelToken.unsubscribe(s),t.signal&&t.signal.removeEventListener("abort",s)}ot.isFormData(r)&&($t.isStandardBrowserEnv||$t.isStandardBrowserWebWorkerEnv?i.setContentType(!1):i.getContentType(/^\s*multipart\/form-data/)?ot.isString(a=i.getContentType())&&i.setContentType(a.replace(/^\s*(multipart\/form-data);+/,"$1")):i.setContentType("multipart/form-data"));let u=new XMLHttpRequest;if(t.auth){const e=t.auth.username||"",n=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";i.set("Authorization","Basic "+btoa(e+":"+n))}const c=ae(t.baseURL,t.url);function h(){if(!u)return;const r=Zt.from("getAllResponseHeaders"in u&&u.getAllResponseHeaders()),i=o&&"text"!==o&&"json"!==o?u.response:u.responseText,s={data:i,status:u.status,statusText:u.statusText,headers:r,config:t,request:u};re((function(t){e(t),l()}),(function(t){n(t),l()}),s),u=null}if(u.open(t.method.toUpperCase(),_t(c,t.params,t.paramsSerializer),!0),u.timeout=t.timeout,"onloadend"in u?u.onloadend=h:u.onreadystatechange=function(){u&&4===u.readyState&&(0!==u.status||u.responseURL&&0===u.responseURL.indexOf("file:"))&&setTimeout(h)},u.onabort=function(){u&&(n(new ut("Request aborted",ut.ECONNABORTED,t,u)),u=null)},u.onerror=function(){n(new ut("Network Error",ut.ERR_NETWORK,t,u)),u=null},u.ontimeout=function(){let e=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded";const r=t.transitional||St;t.timeoutErrorMessage&&(e=t.timeoutErrorMessage),n(new ut(e,r.clarifyTimeoutError?ut.ETIMEDOUT:ut.ECONNABORTED,t,u)),u=null},$t.isStandardBrowserEnv){const e=(t.withCredentials||le(c))&&t.xsrfCookieName&&ie.read(t.xsrfCookieName);e&&i.set(t.xsrfHeaderName,e)}void 0===r&&i.setContentType(null),"setRequestHeader"in u&&ot.forEach(i.toJSON(),(function(t,e){u.setRequestHeader(e,t)})),ot.isUndefined(t.withCredentials)||(u.withCredentials=!!t.withCredentials),o&&"json"!==o&&(u.responseType=t.responseType),"function"===typeof t.onDownloadProgress&&u.addEventListener("progress",de(t.onDownloadProgress,!0)),"function"===typeof t.onUploadProgress&&u.upload&&u.upload.addEventListener("progress",de(t.onUploadProgress)),(t.cancelToken||t.signal)&&(s=e=>{u&&(n(!e||e.type?new ne(null,t,u):e),u.abort(),u=null)},t.cancelToken&&t.cancelToken.subscribe(s),t.signal&&(t.signal.aborted?s():t.signal.addEventListener("abort",s)));const d=ue(c);d&&-1===$t.protocols.indexOf(d)?n(new ut("Unsupported protocol "+d+":",ut.ERR_BAD_REQUEST,t)):u.send(r||null)}))};const ge={http:ct,xhr:fe};ot.forEach(ge,((t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch(n){}Object.defineProperty(t,"adapterName",{value:e})}}));const me=t=>`- ${t}`,ye=t=>ot.isFunction(t)||null===t||!1===t;var be={getAdapter:t=>{t=ot.isArray(t)?t:[t];const{length:e}=t;let n,r;const i={};for(let o=0;o<e;o++){let e;if(n=t[o],r=n,!ye(n)&&(r=ge[(e=String(n)).toLowerCase()],void 0===r))throw new ut(`Unknown adapter '${e}'`);if(r)break;i[e||"#"+o]=r}if(!r){const t=Object.entries(i).map((([t,e])=>`adapter ${t} `+(!1===e?"is not supported by the environment":"is not available in the build")));let n=e?t.length>1?"since :\n"+t.map(me).join("\n"):" "+me(t[0]):"as no adapter specified";throw new ut("There is no suitable adapter to dispatch the request "+n,"ERR_NOT_SUPPORT")}return r},adapters:ge};function ve(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new ne(null,t)}function we(t){ve(t),t.headers=Zt.from(t.headers),t.data=Qt.call(t,t.transformRequest),-1!==["post","put","patch"].indexOf(t.method)&&t.headers.setContentType("application/x-www-form-urlencoded",!1);const e=be.getAdapter(t.adapter||Bt.adapter);return e(t).then((function(e){return ve(t),e.data=Qt.call(t,t.transformResponse,e),e.headers=Zt.from(e.headers),e}),(function(e){return te(e)||(ve(t),e&&e.response&&(e.response.data=Qt.call(t,t.transformResponse,e.response),e.response.headers=Zt.from(e.response.headers))),Promise.reject(e)}))}const xe=t=>t instanceof Zt?t.toJSON():t;function ke(t,e){e=e||{};const n={};function r(t,e,n){return ot.isPlainObject(t)&&ot.isPlainObject(e)?ot.merge.call({caseless:n},t,e):ot.isPlainObject(e)?ot.merge({},e):ot.isArray(e)?e.slice():e}function i(t,e,n){return ot.isUndefined(e)?ot.isUndefined(t)?void 0:r(void 0,t,n):r(t,e,n)}function o(t,e){if(!ot.isUndefined(e))return r(void 0,e)}function s(t,e){return ot.isUndefined(e)?ot.isUndefined(t)?void 0:r(void 0,t):r(void 0,e)}function a(n,i,o){return o in e?r(n,i):o in t?r(void 0,n):void 0}const l={url:o,method:o,data:o,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,beforeRedirect:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:a,headers:(t,e)=>i(xe(t),xe(e),!0)};return ot.forEach(Object.keys(Object.assign({},t,e)),(function(r){const o=l[r]||i,s=o(t[r],e[r],r);ot.isUndefined(s)&&o!==a||(n[r]=s)})),n}const _e="1.5.1",Ie={};["object","boolean","number","function","string","symbol"].forEach(((t,e)=>{Ie[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}}));const Ce={};function Se(t,e,n){if("object"!==typeof t)throw new ut("options must be an object",ut.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let i=r.length;while(i-- >0){const o=r[i],s=e[o];if(s){const e=t[o],n=void 0===e||s(e,o,t);if(!0!==n)throw new ut("option "+o+" must be "+n,ut.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new ut("Unknown option "+o,ut.ERR_BAD_OPTION)}}Ie.transitional=function(t,e,n){function r(t,e){return"[Axios v"+_e+"] Transitional option '"+t+"'"+e+(n?". "+n:"")}return(n,i,o)=>{if(!1===t)throw new ut(r(i," has been removed"+(e?" in "+e:"")),ut.ERR_DEPRECATED);return e&&!Ce[i]&&(Ce[i]=!0,console.warn(r(i," has been deprecated since v"+e+" and will be removed in the near future"))),!t||t(n,i,o)}};var Te={assertOptions:Se,validators:Ie};const Ee=Te.validators;class Ne{constructor(t){this.defaults=t,this.interceptors={request:new Ct,response:new Ct}}request(t,e){"string"===typeof t?(e=e||{},e.url=t):e=t||{},e=ke(this.defaults,e);const{transitional:n,paramsSerializer:r,headers:i}=e;void 0!==n&&Te.assertOptions(n,{silentJSONParsing:Ee.transitional(Ee.boolean),forcedJSONParsing:Ee.transitional(Ee.boolean),clarifyTimeoutError:Ee.transitional(Ee.boolean)},!1),null!=r&&(ot.isFunction(r)?e.paramsSerializer={serialize:r}:Te.assertOptions(r,{encode:Ee.function,serialize:Ee.function},!0)),e.method=(e.method||this.defaults.method||"get").toLowerCase();let o=i&&ot.merge(i.common,i[e.method]);i&&ot.forEach(["delete","get","head","post","put","patch","common"],(t=>{delete i[t]})),e.headers=Zt.concat(o,i);const s=[];let a=!0;this.interceptors.request.forEach((function(t){"function"===typeof t.runWhen&&!1===t.runWhen(e)||(a=a&&t.synchronous,s.unshift(t.fulfilled,t.rejected))}));const l=[];let u;this.interceptors.response.forEach((function(t){l.push(t.fulfilled,t.rejected)}));let c,h=0;if(!a){const t=[we.bind(this),void 0];t.unshift.apply(t,s),t.push.apply(t,l),c=t.length,u=Promise.resolve(e);while(h<c)u=u.then(t[h++],t[h++]);return u}c=s.length;let d=e;h=0;while(h<c){const t=s[h++],e=s[h++];try{d=t(d)}catch(p){e.call(this,p);break}}try{u=we.call(this,d)}catch(p){return Promise.reject(p)}h=0,c=l.length;while(h<c)u=u.then(l[h++],l[h++]);return u}getUri(t){t=ke(this.defaults,t);const e=ae(t.baseURL,t.url);return _t(e,t.params,t.paramsSerializer)}}ot.forEach(["delete","get","head","options"],(function(t){Ne.prototype[t]=function(e,n){return this.request(ke(n||{},{method:t,url:e,data:(n||{}).data}))}})),ot.forEach(["post","put","patch"],(function(t){function e(e){return function(n,r,i){return this.request(ke(i||{},{method:t,headers:e?{"Content-Type":"multipart/form-data"}:{},url:n,data:r}))}}Ne.prototype[t]=e(),Ne.prototype[t+"Form"]=e(!0)}));var Ae=Ne;class Re{constructor(t){if("function"!==typeof t)throw new TypeError("executor must be a function.");let e;this.promise=new Promise((function(t){e=t}));const n=this;this.promise.then((t=>{if(!n._listeners)return;let e=n._listeners.length;while(e-- >0)n._listeners[e](t);n._listeners=null})),this.promise.then=t=>{let e;const r=new Promise((t=>{n.subscribe(t),e=t})).then(t);return r.cancel=function(){n.unsubscribe(e)},r},t((function(t,r,i){n.reason||(n.reason=new ne(t,r,i),e(n.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){this.reason?t(this.reason):this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const e=this._listeners.indexOf(t);-1!==e&&this._listeners.splice(e,1)}static source(){let t;const e=new Re((function(e){t=e}));return{token:e,cancel:t}}}var $e=Re;function De(t){return function(e){return t.apply(null,e)}}function Oe(t){return ot.isObject(t)&&!0===t.isAxiosError}const Fe={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Fe).forEach((([t,e])=>{Fe[e]=t}));var Me=Fe;function Pe(t){const e=new Ae(t),n=r(Ae.prototype.request,e);return ot.extend(n,Ae.prototype,e,{allOwnKeys:!0}),ot.extend(n,e,null,{allOwnKeys:!0}),n.create=function(e){return Pe(ke(t,e))},n}const Le=Pe(Bt);Le.Axios=Ae,Le.CanceledError=ne,Le.CancelToken=$e,Le.isCancel=te,Le.VERSION=_e,Le.toFormData=yt,Le.AxiosError=ut,Le.Cancel=Le.CanceledError,Le.all=function(t){return Promise.all(t)},Le.spread=De,Le.isAxiosError=Oe,Le.mergeConfig=ke,Le.AxiosHeaders=Zt,Le.formToJSON=t=>Pt(ot.isHTMLForm(t)?new FormData(t):t),Le.getAdapter=be.getAdapter,Le.HttpStatusCode=Me,Le.default=Le;var ze=Le},1632:function(t,e,n){"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function i(t,e){if("object"!=r(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function o(t){var e=i(t,"string");return"symbol"==r(e)?e:String(e)}function s(t,e,n){return e=o(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.d(e,{ZP:function(){return Bu}});n(560);
/*!
 * @kurkle/color v0.3.2
 * https://github.com/kurkle/color#readme
 * (c) 2023 Jukka Kurkela
 * Released under the MIT License
 */
function a(t){return t+.5|0}const l=(t,e,n)=>Math.max(Math.min(t,n),e);function u(t){return l(a(2.55*t),0,255)}function c(t){return l(a(255*t),0,255)}function h(t){return l(a(t/2.55)/100,0,1)}function d(t){return l(a(100*t),0,100)}const p={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},f=[..."0123456789ABCDEF"],g=t=>f[15&t],m=t=>f[(240&t)>>4]+f[15&t],y=t=>(240&t)>>4===(15&t),b=t=>y(t.r)&&y(t.g)&&y(t.b)&&y(t.a);function v(t){var e,n=t.length;return"#"===t[0]&&(4===n||5===n?e={r:255&17*p[t[1]],g:255&17*p[t[2]],b:255&17*p[t[3]],a:5===n?17*p[t[4]]:255}:7!==n&&9!==n||(e={r:p[t[1]]<<4|p[t[2]],g:p[t[3]]<<4|p[t[4]],b:p[t[5]]<<4|p[t[6]],a:9===n?p[t[7]]<<4|p[t[8]]:255})),e}const w=(t,e)=>t<255?e(t):"";function x(t){var e=b(t)?g:m;return t?"#"+e(t.r)+e(t.g)+e(t.b)+w(t.a,e):void 0}const k=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function _(t,e,n){const r=e*Math.min(n,1-n),i=(e,i=(e+t/30)%12)=>n-r*Math.max(Math.min(i-3,9-i,1),-1);return[i(0),i(8),i(4)]}function I(t,e,n){const r=(r,i=(r+t/60)%6)=>n-n*e*Math.max(Math.min(i,4-i,1),0);return[r(5),r(3),r(1)]}function C(t,e,n){const r=_(t,1,.5);let i;for(e+n>1&&(i=1/(e+n),e*=i,n*=i),i=0;i<3;i++)r[i]*=1-e-n,r[i]+=e;return r}function S(t,e,n,r,i){return t===i?(e-n)/r+(e<n?6:0):e===i?(n-t)/r+2:(t-e)/r+4}function T(t){const e=255,n=t.r/e,r=t.g/e,i=t.b/e,o=Math.max(n,r,i),s=Math.min(n,r,i),a=(o+s)/2;let l,u,c;return o!==s&&(c=o-s,u=a>.5?c/(2-o-s):c/(o+s),l=S(n,r,i,c,o),l=60*l+.5),[0|l,u||0,a]}function E(t,e,n,r){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,n,r)).map(c)}function N(t,e,n){return E(_,t,e,n)}function A(t,e,n){return E(C,t,e,n)}function R(t,e,n){return E(I,t,e,n)}function $(t){return(t%360+360)%360}function D(t){const e=k.exec(t);let n,r=255;if(!e)return;e[5]!==n&&(r=e[6]?u(+e[5]):c(+e[5]));const i=$(+e[2]),o=+e[3]/100,s=+e[4]/100;return n="hwb"===e[1]?A(i,o,s):"hsv"===e[1]?R(i,o,s):N(i,o,s),{r:n[0],g:n[1],b:n[2],a:r}}function O(t,e){var n=T(t);n[0]=$(n[0]+e),n=N(n),t.r=n[0],t.g=n[1],t.b=n[2]}function F(t){if(!t)return;const e=T(t),n=e[0],r=d(e[1]),i=d(e[2]);return t.a<255?`hsla(${n}, ${r}%, ${i}%, ${h(t.a)})`:`hsl(${n}, ${r}%, ${i}%)`}const M={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},P={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function L(){const t={},e=Object.keys(P),n=Object.keys(M);let r,i,o,s,a;for(r=0;r<e.length;r++){for(s=a=e[r],i=0;i<n.length;i++)o=n[i],a=a.replace(o,M[o]);o=parseInt(P[s],16),t[a]=[o>>16&255,o>>8&255,255&o]}return t}let z;function B(t){z||(z=L(),z.transparent=[0,0,0,0]);const e=z[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:4===e.length?e[3]:255}}const W=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function U(t){const e=W.exec(t);let n,r,i,o=255;if(e){if(e[7]!==n){const t=+e[7];o=e[8]?u(t):l(255*t,0,255)}return n=+e[1],r=+e[3],i=+e[5],n=255&(e[2]?u(n):l(n,0,255)),r=255&(e[4]?u(r):l(r,0,255)),i=255&(e[6]?u(i):l(i,0,255)),{r:n,g:r,b:i,a:o}}}function V(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${h(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const j=t=>t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055,H=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function G(t,e,n){const r=H(h(t.r)),i=H(h(t.g)),o=H(h(t.b));return{r:c(j(r+n*(H(h(e.r))-r))),g:c(j(i+n*(H(h(e.g))-i))),b:c(j(o+n*(H(h(e.b))-o))),a:t.a+n*(e.a-t.a)}}function q(t,e,n){if(t){let r=T(t);r[e]=Math.max(0,Math.min(r[e]+r[e]*n,0===e?360:1)),r=N(r),t.r=r[0],t.g=r[1],t.b=r[2]}}function K(t,e){return t?Object.assign(e||{},t):t}function X(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=c(t[3]))):(e=K(t,{r:0,g:0,b:0,a:1}),e.a=c(e.a)),e}function Y(t){return"r"===t.charAt(0)?U(t):D(t)}class J{constructor(t){if(t instanceof J)return t;const e=typeof t;let n;"object"===e?n=X(t):"string"===e&&(n=v(t)||B(t)||Y(t)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var t=K(this._rgb);return t&&(t.a=h(t.a)),t}set rgb(t){this._rgb=X(t)}rgbString(){return this._valid?V(this._rgb):void 0}hexString(){return this._valid?x(this._rgb):void 0}hslString(){return this._valid?F(this._rgb):void 0}mix(t,e){if(t){const n=this.rgb,r=t.rgb;let i;const o=e===i?.5:e,s=2*o-1,a=n.a-r.a,l=((s*a===-1?s:(s+a)/(1+s*a))+1)/2;i=1-l,n.r=255&l*n.r+i*r.r+.5,n.g=255&l*n.g+i*r.g+.5,n.b=255&l*n.b+i*r.b+.5,n.a=o*n.a+(1-o)*r.a,this.rgb=n}return this}interpolate(t,e){return t&&(this._rgb=G(this._rgb,t._rgb,e)),this}clone(){return new J(this.rgb)}alpha(t){return this._rgb.a=c(t),this}clearer(t){const e=this._rgb;return e.a*=1-t,this}greyscale(){const t=this._rgb,e=a(.3*t.r+.59*t.g+.11*t.b);return t.r=t.g=t.b=e,this}opaquer(t){const e=this._rgb;return e.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return q(this._rgb,2,t),this}darken(t){return q(this._rgb,2,-t),this}saturate(t){return q(this._rgb,1,t),this}desaturate(t){return q(this._rgb,1,-t),this}rotate(t){return O(this._rgb,t),this}}
/*!
 * Chart.js v4.4.1
 * https://www.chartjs.org
 * (c) 2023 Chart.js Contributors
 * Released under the MIT License
 */
function Z(){}const Q=(()=>{let t=0;return()=>t++})();function tt(t){return null===t||"undefined"===typeof t}function et(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return"[object"===e.slice(0,7)&&"Array]"===e.slice(-6)}function nt(t){return null!==t&&"[object Object]"===Object.prototype.toString.call(t)}function rt(t){return("number"===typeof t||t instanceof Number)&&isFinite(+t)}function it(t,e){return rt(t)?t:e}function ot(t,e){return"undefined"===typeof t?e:t}const st=(t,e)=>"string"===typeof t&&t.endsWith("%")?parseFloat(t)/100:+t/e,at=(t,e)=>"string"===typeof t&&t.endsWith("%")?parseFloat(t)/100*e:+t;function lt(t,e,n){if(t&&"function"===typeof t.call)return t.apply(n,e)}function ut(t,e,n,r){let i,o,s;if(et(t))if(o=t.length,r)for(i=o-1;i>=0;i--)e.call(n,t[i],i);else for(i=0;i<o;i++)e.call(n,t[i],i);else if(nt(t))for(s=Object.keys(t),o=s.length,i=0;i<o;i++)e.call(n,t[s[i]],s[i])}function ct(t,e){let n,r,i,o;if(!t||!e||t.length!==e.length)return!1;for(n=0,r=t.length;n<r;++n)if(i=t[n],o=e[n],i.datasetIndex!==o.datasetIndex||i.index!==o.index)return!1;return!0}function ht(t){if(et(t))return t.map(ht);if(nt(t)){const e=Object.create(null),n=Object.keys(t),r=n.length;let i=0;for(;i<r;++i)e[n[i]]=ht(t[n[i]]);return e}return t}function dt(t){return-1===["__proto__","prototype","constructor"].indexOf(t)}function pt(t,e,n,r){if(!dt(t))return;const i=e[t],o=n[t];nt(i)&&nt(o)?ft(i,o,r):e[t]=ht(o)}function ft(t,e,n){const r=et(e)?e:[e],i=r.length;if(!nt(t))return t;n=n||{};const o=n.merger||pt;let s;for(let a=0;a<i;++a){if(s=r[a],!nt(s))continue;const e=Object.keys(s);for(let r=0,i=e.length;r<i;++r)o(e[r],t,s,n)}return t}function gt(t,e){return ft(t,e,{merger:mt})}function mt(t,e,n){if(!dt(t))return;const r=e[t],i=n[t];nt(r)&&nt(i)?gt(r,i):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=ht(i))}const yt={"":t=>t,x:t=>t.x,y:t=>t.y};function bt(t){const e=t.split("."),n=[];let r="";for(const i of e)r+=i,r.endsWith("\\")?r=r.slice(0,-1)+".":(n.push(r),r="");return n}function vt(t){const e=bt(t);return t=>{for(const n of e){if(""===n)break;t=t&&t[n]}return t}}function wt(t,e){const n=yt[e]||(yt[e]=vt(e));return n(t)}function xt(t){return t.charAt(0).toUpperCase()+t.slice(1)}const kt=t=>"undefined"!==typeof t,_t=t=>"function"===typeof t,It=(t,e)=>{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0};function Ct(t){return"mouseup"===t.type||"click"===t.type||"contextmenu"===t.type}const St=Math.PI,Tt=2*St,Et=Tt+St,Nt=Number.POSITIVE_INFINITY,At=St/180,Rt=St/2,$t=St/4,Dt=2*St/3,Ot=Math.log10,Ft=Math.sign;function Mt(t,e,n){return Math.abs(t-e)<n}function Pt(t){const e=Math.round(t);t=Mt(t,e,t/1e3)?e:t;const n=Math.pow(10,Math.floor(Ot(t))),r=t/n,i=r<=1?1:r<=2?2:r<=5?5:10;return i*n}function Lt(t){const e=[],n=Math.sqrt(t);let r;for(r=1;r<n;r++)t%r===0&&(e.push(r),e.push(t/r));return n===(0|n)&&e.push(n),e.sort(((t,e)=>t-e)).pop(),e}function zt(t){return!isNaN(parseFloat(t))&&isFinite(t)}function Bt(t,e){const n=Math.round(t);return n-e<=t&&n+e>=t}function Wt(t,e,n){let r,i,o;for(r=0,i=t.length;r<i;r++)o=t[r][n],isNaN(o)||(e.min=Math.min(e.min,o),e.max=Math.max(e.max,o))}function Ut(t){return t*(St/180)}function Vt(t){return t*(180/St)}function jt(t){if(!rt(t))return;let e=1,n=0;while(Math.round(t*e)/e!==t)e*=10,n++;return n}function Ht(t,e){const n=e.x-t.x,r=e.y-t.y,i=Math.sqrt(n*n+r*r);let o=Math.atan2(r,n);return o<-.5*St&&(o+=Tt),{angle:o,distance:i}}function Gt(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function qt(t,e){return(t-e+Et)%Tt-St}function Kt(t){return(t%Tt+Tt)%Tt}function Xt(t,e,n,r){const i=Kt(t),o=Kt(e),s=Kt(n),a=Kt(o-i),l=Kt(s-i),u=Kt(i-o),c=Kt(i-s);return i===o||i===s||r&&o===s||a>l&&u<c}function Yt(t,e,n){return Math.max(e,Math.min(n,t))}function Jt(t){return Yt(t,-32768,32767)}function Zt(t,e,n,r=1e-6){return t>=Math.min(e,n)-r&&t<=Math.max(e,n)+r}function Qt(t,e,n){n=n||(n=>t[n]<e);let r,i=t.length-1,o=0;while(i-o>1)r=o+i>>1,n(r)?o=r:i=r;return{lo:o,hi:i}}const te=(t,e,n,r)=>Qt(t,n,r?r=>{const i=t[r][e];return i<n||i===n&&t[r+1][e]===n}:r=>t[r][e]<n),ee=(t,e,n)=>Qt(t,n,(r=>t[r][e]>=n));function ne(t,e,n){let r=0,i=t.length;while(r<i&&t[r]<e)r++;while(i>r&&t[i-1]>n)i--;return r>0||i<t.length?t.slice(r,i):t}const re=["push","pop","shift","splice","unshift"];function ie(t,e){t._chartjs?t._chartjs.listeners.push(e):(Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),re.forEach((e=>{const n="_onData"+xt(e),r=t[e];Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value(...e){const i=r.apply(this,e);return t._chartjs.listeners.forEach((t=>{"function"===typeof t[n]&&t[n](...e)})),i}})})))}function oe(t,e){const n=t._chartjs;if(!n)return;const r=n.listeners,i=r.indexOf(e);-1!==i&&r.splice(i,1),r.length>0||(re.forEach((e=>{delete t[e]})),delete t._chartjs)}function se(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const ae=function(){return"undefined"===typeof window?function(t){return t()}:window.requestAnimationFrame}();function le(t,e){let n=[],r=!1;return function(...i){n=i,r||(r=!0,ae.call(window,(()=>{r=!1,t.apply(e,n)})))}}function ue(t,e){let n;return function(...r){return e?(clearTimeout(n),n=setTimeout(t,e,r)):t.apply(this,r),e}}const ce=t=>"start"===t?"left":"end"===t?"right":"center",he=(t,e,n)=>"start"===t?e:"end"===t?n:(e+n)/2,de=(t,e,n,r)=>{const i=r?"left":"right";return t===i?n:"center"===t?(e+n)/2:e};function pe(t,e,n){const r=e.length;let i=0,o=r;if(t._sorted){const{iScale:s,_parsed:a}=t,l=s.axis,{min:u,max:c,minDefined:h,maxDefined:d}=s.getUserBounds();h&&(i=Yt(Math.min(te(a,l,u).lo,n?r:te(e,l,s.getPixelForValue(u)).lo),0,r-1)),o=d?Yt(Math.max(te(a,s.axis,c,!0).hi+1,n?0:te(e,l,s.getPixelForValue(c),!0).hi+1),i,r)-i:r-i}return{start:i,count:o}}function fe(t){const{xScale:e,yScale:n,_scaleRanges:r}=t,i={xmin:e.min,xmax:e.max,ymin:n.min,ymax:n.max};if(!r)return t._scaleRanges=i,!0;const o=r.xmin!==e.min||r.xmax!==e.max||r.ymin!==n.min||r.ymax!==n.max;return Object.assign(r,i),o}const ge=t=>0===t||1===t,me=(t,e,n)=>-Math.pow(2,10*(t-=1))*Math.sin((t-e)*Tt/n),ye=(t,e,n)=>Math.pow(2,-10*t)*Math.sin((t-e)*Tt/n)+1,be={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>1-Math.cos(t*Rt),easeOutSine:t=>Math.sin(t*Rt),easeInOutSine:t=>-.5*(Math.cos(St*t)-1),easeInExpo:t=>0===t?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>1===t?1:1-Math.pow(2,-10*t),easeInOutExpo:t=>ge(t)?t:t<.5?.5*Math.pow(2,10*(2*t-1)):.5*(2-Math.pow(2,-10*(2*t-1))),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>ge(t)?t:me(t,.075,.3),easeOutElastic:t=>ge(t)?t:ye(t,.075,.3),easeInOutElastic(t){const e=.1125,n=.45;return ge(t)?t:t<.5?.5*me(2*t,e,n):.5+.5*ye(2*t-1,e,n)},easeInBack(t){const e=1.70158;return t*t*((e+1)*t-e)},easeOutBack(t){const e=1.70158;return(t-=1)*t*((e+1)*t+e)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?t*t*((1+(e*=1.525))*t-e)*.5:.5*((t-=2)*t*((1+(e*=1.525))*t+e)+2)},easeInBounce:t=>1-be.easeOutBounce(1-t),easeOutBounce(t){const e=7.5625,n=2.75;return t<1/n?e*t*t:t<2/n?e*(t-=1.5/n)*t+.75:t<2.5/n?e*(t-=2.25/n)*t+.9375:e*(t-=2.625/n)*t+.984375},easeInOutBounce:t=>t<.5?.5*be.easeInBounce(2*t):.5*be.easeOutBounce(2*t-1)+.5};function ve(t){if(t&&"object"===typeof t){const e=t.toString();return"[object CanvasPattern]"===e||"[object CanvasGradient]"===e}return!1}function we(t){return ve(t)?t:new J(t)}function xe(t){return ve(t)?t:new J(t).saturate(.5).darken(.1).hexString()}const ke=["x","y","borderWidth","radius","tension"],_e=["color","borderColor","backgroundColor"];function Ie(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>"onProgress"!==t&&"onComplete"!==t&&"fn"!==t}),t.set("animations",{colors:{type:"color",properties:_e},numbers:{type:"number",properties:ke}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>0|t}}}})}function Ce(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const Se=new Map;function Te(t,e){e=e||{};const n=t+JSON.stringify(e);let r=Se.get(n);return r||(r=new Intl.NumberFormat(t,e),Se.set(n,r)),r}function Ee(t,e,n){return Te(e,n).format(t)}const Ne={values(t){return et(t)?t:""+t},numeric(t,e,n){if(0===t)return"0";const r=this.chart.options.locale;let i,o=t;if(n.length>1){const e=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(e<1e-4||e>1e15)&&(i="scientific"),o=Ae(t,n)}const s=Ot(Math.abs(o)),a=isNaN(s)?1:Math.max(Math.min(-1*Math.floor(s),20),0),l={notation:i,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),Ee(t,r,l)},logarithmic(t,e,n){if(0===t)return"0";const r=n[e].significand||t/Math.pow(10,Math.floor(Ot(t)));return[1,2,3,5,10,15].includes(r)||e>.8*n.length?Ne.numeric.call(this,t,e,n):""}};function Ae(t,e){let n=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(n)>=1&&t!==Math.floor(t)&&(n=t-Math.floor(t)),n}var Re={formatters:Ne};function $e(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,e)=>e.lineWidth,tickColor:(t,e)=>e.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Re.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&"callback"!==t&&"parser"!==t,_indexable:t=>"borderDash"!==t&&"tickBorderDash"!==t&&"dash"!==t}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:t=>"backdropPadding"!==t&&"callback"!==t,_indexable:t=>"backdropPadding"!==t})}const De=Object.create(null),Oe=Object.create(null);function Fe(t,e){if(!e)return t;const n=e.split(".");for(let r=0,i=n.length;r<i;++r){const e=n[r];t=t[e]||(t[e]=Object.create(null))}return t}function Me(t,e,n){return"string"===typeof e?ft(Fe(t,e),n):ft(Fe(t,""),e)}class Pe{constructor(t,e){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=t=>t.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(t,e)=>xe(e.backgroundColor),this.hoverBorderColor=(t,e)=>xe(e.borderColor),this.hoverColor=(t,e)=>xe(e.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(e)}set(t,e){return Me(this,t,e)}get(t){return Fe(this,t)}describe(t,e){return Me(Oe,t,e)}override(t,e){return Me(De,t,e)}route(t,e,n,r){const i=Fe(this,t),o=Fe(this,n),s="_"+e;Object.defineProperties(i,{[s]:{value:i[e],writable:!0},[e]:{enumerable:!0,get(){const t=this[s],e=o[r];return nt(t)?Object.assign({},e,t):ot(t,e)},set(t){this[s]=t}}})}apply(t){t.forEach((t=>t(this)))}}var Le=new Pe({_scriptable:t=>!t.startsWith("on"),_indexable:t=>"events"!==t,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[Ie,Ce,$e]);function ze(t){return!t||tt(t.size)||tt(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function Be(t,e,n,r,i){let o=e[i];return o||(o=e[i]=t.measureText(i).width,n.push(i)),o>r&&(r=o),r}function We(t,e,n,r){r=r||{};let i=r.data=r.data||{},o=r.garbageCollect=r.garbageCollect||[];r.font!==e&&(i=r.data={},o=r.garbageCollect=[],r.font=e),t.save(),t.font=e;let s=0;const a=n.length;let l,u,c,h,d;for(l=0;l<a;l++)if(h=n[l],void 0===h||null===h||et(h)){if(et(h))for(u=0,c=h.length;u<c;u++)d=h[u],void 0===d||null===d||et(d)||(s=Be(t,i,o,s,d))}else s=Be(t,i,o,s,h);t.restore();const p=o.length/2;if(p>n.length){for(l=0;l<p;l++)delete i[o[l]];o.splice(0,p)}return s}function Ue(t,e,n){const r=t.currentDevicePixelRatio,i=0!==n?Math.max(n/2,.5):0;return Math.round((e-i)*r)/r+i}function Ve(t,e){e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore()}function je(t,e,n,r){He(t,e,n,r,null)}function He(t,e,n,r,i){let o,s,a,l,u,c,h,d;const p=e.pointStyle,f=e.rotation,g=e.radius;let m=(f||0)*At;if(p&&"object"===typeof p&&(o=p.toString(),"[object HTMLImageElement]"===o||"[object HTMLCanvasElement]"===o))return t.save(),t.translate(n,r),t.rotate(m),t.drawImage(p,-p.width/2,-p.height/2,p.width,p.height),void t.restore();if(!(isNaN(g)||g<=0)){switch(t.beginPath(),p){default:i?t.ellipse(n,r,i/2,g,0,0,Tt):t.arc(n,r,g,0,Tt),t.closePath();break;case"triangle":c=i?i/2:g,t.moveTo(n+Math.sin(m)*c,r-Math.cos(m)*g),m+=Dt,t.lineTo(n+Math.sin(m)*c,r-Math.cos(m)*g),m+=Dt,t.lineTo(n+Math.sin(m)*c,r-Math.cos(m)*g),t.closePath();break;case"rectRounded":u=.516*g,l=g-u,s=Math.cos(m+$t)*l,h=Math.cos(m+$t)*(i?i/2-u:l),a=Math.sin(m+$t)*l,d=Math.sin(m+$t)*(i?i/2-u:l),t.arc(n-h,r-a,u,m-St,m-Rt),t.arc(n+d,r-s,u,m-Rt,m),t.arc(n+h,r+a,u,m,m+Rt),t.arc(n-d,r+s,u,m+Rt,m+St),t.closePath();break;case"rect":if(!f){l=Math.SQRT1_2*g,c=i?i/2:l,t.rect(n-c,r-l,2*c,2*l);break}m+=$t;case"rectRot":h=Math.cos(m)*(i?i/2:g),s=Math.cos(m)*g,a=Math.sin(m)*g,d=Math.sin(m)*(i?i/2:g),t.moveTo(n-h,r-a),t.lineTo(n+d,r-s),t.lineTo(n+h,r+a),t.lineTo(n-d,r+s),t.closePath();break;case"crossRot":m+=$t;case"cross":h=Math.cos(m)*(i?i/2:g),s=Math.cos(m)*g,a=Math.sin(m)*g,d=Math.sin(m)*(i?i/2:g),t.moveTo(n-h,r-a),t.lineTo(n+h,r+a),t.moveTo(n+d,r-s),t.lineTo(n-d,r+s);break;case"star":h=Math.cos(m)*(i?i/2:g),s=Math.cos(m)*g,a=Math.sin(m)*g,d=Math.sin(m)*(i?i/2:g),t.moveTo(n-h,r-a),t.lineTo(n+h,r+a),t.moveTo(n+d,r-s),t.lineTo(n-d,r+s),m+=$t,h=Math.cos(m)*(i?i/2:g),s=Math.cos(m)*g,a=Math.sin(m)*g,d=Math.sin(m)*(i?i/2:g),t.moveTo(n-h,r-a),t.lineTo(n+h,r+a),t.moveTo(n+d,r-s),t.lineTo(n-d,r+s);break;case"line":s=i?i/2:Math.cos(m)*g,a=Math.sin(m)*g,t.moveTo(n-s,r-a),t.lineTo(n+s,r+a);break;case"dash":t.moveTo(n,r),t.lineTo(n+Math.cos(m)*(i?i/2:g),r+Math.sin(m)*g);break;case!1:t.closePath();break}t.fill(),e.borderWidth>0&&t.stroke()}}function Ge(t,e,n){return n=n||.5,!e||t&&t.x>e.left-n&&t.x<e.right+n&&t.y>e.top-n&&t.y<e.bottom+n}function qe(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function Ke(t){t.restore()}function Xe(t,e,n,r,i){if(!e)return t.lineTo(n.x,n.y);if("middle"===i){const r=(e.x+n.x)/2;t.lineTo(r,e.y),t.lineTo(r,n.y)}else"after"===i!==!!r?t.lineTo(e.x,n.y):t.lineTo(n.x,e.y);t.lineTo(n.x,n.y)}function Ye(t,e,n,r){if(!e)return t.lineTo(n.x,n.y);t.bezierCurveTo(r?e.cp1x:e.cp2x,r?e.cp1y:e.cp2y,r?n.cp2x:n.cp1x,r?n.cp2y:n.cp1y,n.x,n.y)}function Je(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),tt(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function Ze(t,e,n,r,i){if(i.strikethrough||i.underline){const o=t.measureText(r),s=e-o.actualBoundingBoxLeft,a=e+o.actualBoundingBoxRight,l=n-o.actualBoundingBoxAscent,u=n+o.actualBoundingBoxDescent,c=i.strikethrough?(l+u)/2:u;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=i.decorationWidth||2,t.moveTo(s,c),t.lineTo(a,c),t.stroke()}}function Qe(t,e){const n=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=n}function tn(t,e,n,r,i,o={}){const s=et(e)?e:[e],a=o.strokeWidth>0&&""!==o.strokeColor;let l,u;for(t.save(),t.font=i.string,Je(t,o),l=0;l<s.length;++l)u=s[l],o.backdrop&&Qe(t,o.backdrop),a&&(o.strokeColor&&(t.strokeStyle=o.strokeColor),tt(o.strokeWidth)||(t.lineWidth=o.strokeWidth),t.strokeText(u,n,r,o.maxWidth)),t.fillText(u,n,r,o.maxWidth),Ze(t,n,r,u,o),r+=Number(i.lineHeight);t.restore()}function en(t,e){const{x:n,y:r,w:i,h:o,radius:s}=e;t.arc(n+s.topLeft,r+s.topLeft,s.topLeft,1.5*St,St,!0),t.lineTo(n,r+o-s.bottomLeft),t.arc(n+s.bottomLeft,r+o-s.bottomLeft,s.bottomLeft,St,Rt,!0),t.lineTo(n+i-s.bottomRight,r+o),t.arc(n+i-s.bottomRight,r+o-s.bottomRight,s.bottomRight,Rt,0,!0),t.lineTo(n+i,r+s.topRight),t.arc(n+i-s.topRight,r+s.topRight,s.topRight,0,-Rt,!0),t.lineTo(n+s.topLeft,r)}const nn=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,rn=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function on(t,e){const n=(""+t).match(nn);if(!n||"normal"===n[1])return 1.2*e;switch(t=+n[2],n[3]){case"px":return t;case"%":t/=100;break}return e*t}const sn=t=>+t||0;function an(t,e){const n={},r=nt(e),i=r?Object.keys(e):e,o=nt(t)?r?n=>ot(t[n],t[e[n]]):e=>t[e]:()=>t;for(const s of i)n[s]=sn(o(s));return n}function ln(t){return an(t,{top:"y",right:"x",bottom:"y",left:"x"})}function un(t){return an(t,["topLeft","topRight","bottomLeft","bottomRight"])}function cn(t){const e=ln(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function hn(t,e){t=t||{},e=e||Le.font;let n=ot(t.size,e.size);"string"===typeof n&&(n=parseInt(n,10));let r=ot(t.style,e.style);r&&!(""+r).match(rn)&&(console.warn('Invalid font style specified: "'+r+'"'),r=void 0);const i={family:ot(t.family,e.family),lineHeight:on(ot(t.lineHeight,e.lineHeight),n),size:n,style:r,weight:ot(t.weight,e.weight),string:""};return i.string=ze(i),i}function dn(t,e,n,r){let i,o,s,a=!0;for(i=0,o=t.length;i<o;++i)if(s=t[i],void 0!==s&&(void 0!==e&&"function"===typeof s&&(s=s(e),a=!1),void 0!==n&&et(s)&&(s=s[n%s.length],a=!1),void 0!==s))return r&&!a&&(r.cacheable=!1),s}function pn(t,e,n){const{min:r,max:i}=t,o=at(e,(i-r)/2),s=(t,e)=>n&&0===t?0:t+e;return{min:s(r,-Math.abs(o)),max:s(i,o)}}function fn(t,e){return Object.assign(Object.create(t),e)}function gn(t,e=[""],n,r,i=(()=>t[0])){const o=n||t;"undefined"===typeof r&&(r=Rn("_fallback",t));const s={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:o,_fallback:r,_getTarget:i,override:n=>gn([n,...t],e,o,r)};return new Proxy(s,{deleteProperty(e,n){return delete e[n],delete e._keys,delete t[0][n],!0},get(n,r){return wn(n,r,(()=>An(r,e,t,n)))},getOwnPropertyDescriptor(t,e){return Reflect.getOwnPropertyDescriptor(t._scopes[0],e)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(t,e){return $n(t).includes(e)},ownKeys(t){return $n(t)},set(t,e,n){const r=t._storage||(t._storage=i());return t[e]=r[e]=n,delete t._keys,!0}})}function mn(t,e,n,r){const i={_cacheable:!1,_proxy:t,_context:e,_subProxy:n,_stack:new Set,_descriptors:yn(t,r),setContext:e=>mn(t,e,n,r),override:i=>mn(t.override(i),e,n,r)};return new Proxy(i,{deleteProperty(e,n){return delete e[n],delete t[n],!0},get(t,e,n){return wn(t,e,(()=>xn(t,e,n)))},getOwnPropertyDescriptor(e,n){return e._descriptors.allKeys?Reflect.has(t,n)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,n)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(e,n){return Reflect.has(t,n)},ownKeys(){return Reflect.ownKeys(t)},set(e,n,r){return t[n]=r,delete e[n],!0}})}function yn(t,e={scriptable:!0,indexable:!0}){const{_scriptable:n=e.scriptable,_indexable:r=e.indexable,_allKeys:i=e.allKeys}=t;return{allKeys:i,scriptable:n,indexable:r,isScriptable:_t(n)?n:()=>n,isIndexable:_t(r)?r:()=>r}}const bn=(t,e)=>t?t+xt(e):e,vn=(t,e)=>nt(e)&&"adapters"!==t&&(null===Object.getPrototypeOf(e)||e.constructor===Object);function wn(t,e,n){if(Object.prototype.hasOwnProperty.call(t,e))return t[e];const r=n();return t[e]=r,r}function xn(t,e,n){const{_proxy:r,_context:i,_subProxy:o,_descriptors:s}=t;let a=r[e];return _t(a)&&s.isScriptable(e)&&(a=kn(e,a,t,n)),et(a)&&a.length&&(a=_n(e,a,t,s.isIndexable)),vn(e,a)&&(a=mn(a,i,o&&o[e],s)),a}function kn(t,e,n,r){const{_proxy:i,_context:o,_subProxy:s,_stack:a}=n;if(a.has(t))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+t);a.add(t);let l=e(o,s||r);return a.delete(t),vn(t,l)&&(l=Tn(i._scopes,i,t,l)),l}function _n(t,e,n,r){const{_proxy:i,_context:o,_subProxy:s,_descriptors:a}=n;if("undefined"!==typeof o.index&&r(t))return e[o.index%e.length];if(nt(e[0])){const n=e,r=i._scopes.filter((t=>t!==n));e=[];for(const l of n){const n=Tn(r,i,t,l);e.push(mn(n,o,s&&s[t],a))}}return e}function In(t,e,n){return _t(t)?t(e,n):t}const Cn=(t,e)=>!0===t?e:"string"===typeof t?wt(e,t):void 0;function Sn(t,e,n,r,i){for(const o of e){const e=Cn(n,o);if(e){t.add(e);const o=In(e._fallback,n,i);if("undefined"!==typeof o&&o!==n&&o!==r)return o}else if(!1===e&&"undefined"!==typeof r&&n!==r)return null}return!1}function Tn(t,e,n,r){const i=e._rootScopes,o=In(e._fallback,n,r),s=[...t,...i],a=new Set;a.add(r);let l=En(a,s,n,o||n,r);return null!==l&&(("undefined"===typeof o||o===n||(l=En(a,s,o,l,r),null!==l))&&gn(Array.from(a),[""],i,o,(()=>Nn(e,n,r))))}function En(t,e,n,r,i){while(n)n=Sn(t,e,n,r,i);return n}function Nn(t,e,n){const r=t._getTarget();e in r||(r[e]={});const i=r[e];return et(i)&&nt(n)?n:i||{}}function An(t,e,n,r){let i;for(const o of e)if(i=Rn(bn(o,t),n),"undefined"!==typeof i)return vn(t,i)?Tn(n,r,t,i):i}function Rn(t,e){for(const n of e){if(!n)continue;const e=n[t];if("undefined"!==typeof e)return e}}function $n(t){let e=t._keys;return e||(e=t._keys=Dn(t._scopes)),e}function Dn(t){const e=new Set;for(const n of t)for(const t of Object.keys(n).filter((t=>!t.startsWith("_"))))e.add(t);return Array.from(e)}function On(t,e,n,r){const{iScale:i}=t,{key:o="r"}=this._parsing,s=new Array(r);let a,l,u,c;for(a=0,l=r;a<l;++a)u=a+n,c=e[u],s[a]={r:i.parse(wt(c,o),u)};return s}const Fn=Number.EPSILON||1e-14,Mn=(t,e)=>e<t.length&&!t[e].skip&&t[e],Pn=t=>"x"===t?"y":"x";function Ln(t,e,n,r){const i=t.skip?e:t,o=e,s=n.skip?e:n,a=Gt(o,i),l=Gt(s,o);let u=a/(a+l),c=l/(a+l);u=isNaN(u)?0:u,c=isNaN(c)?0:c;const h=r*u,d=r*c;return{previous:{x:o.x-h*(s.x-i.x),y:o.y-h*(s.y-i.y)},next:{x:o.x+d*(s.x-i.x),y:o.y+d*(s.y-i.y)}}}function zn(t,e,n){const r=t.length;let i,o,s,a,l,u=Mn(t,0);for(let c=0;c<r-1;++c)l=u,u=Mn(t,c+1),l&&u&&(Mt(e[c],0,Fn)?n[c]=n[c+1]=0:(i=n[c]/e[c],o=n[c+1]/e[c],a=Math.pow(i,2)+Math.pow(o,2),a<=9||(s=3/Math.sqrt(a),n[c]=i*s*e[c],n[c+1]=o*s*e[c])))}function Bn(t,e,n="x"){const r=Pn(n),i=t.length;let o,s,a,l=Mn(t,0);for(let u=0;u<i;++u){if(s=a,a=l,l=Mn(t,u+1),!a)continue;const i=a[n],c=a[r];s&&(o=(i-s[n])/3,a[`cp1${n}`]=i-o,a[`cp1${r}`]=c-o*e[u]),l&&(o=(l[n]-i)/3,a[`cp2${n}`]=i+o,a[`cp2${r}`]=c+o*e[u])}}function Wn(t,e="x"){const n=Pn(e),r=t.length,i=Array(r).fill(0),o=Array(r);let s,a,l,u=Mn(t,0);for(s=0;s<r;++s)if(a=l,l=u,u=Mn(t,s+1),l){if(u){const t=u[e]-l[e];i[s]=0!==t?(u[n]-l[n])/t:0}o[s]=a?u?Ft(i[s-1])!==Ft(i[s])?0:(i[s-1]+i[s])/2:i[s-1]:i[s]}zn(t,i,o),Bn(t,o,e)}function Un(t,e,n){return Math.max(Math.min(t,n),e)}function Vn(t,e){let n,r,i,o,s,a=Ge(t[0],e);for(n=0,r=t.length;n<r;++n)s=o,o=a,a=n<r-1&&Ge(t[n+1],e),o&&(i=t[n],s&&(i.cp1x=Un(i.cp1x,e.left,e.right),i.cp1y=Un(i.cp1y,e.top,e.bottom)),a&&(i.cp2x=Un(i.cp2x,e.left,e.right),i.cp2y=Un(i.cp2y,e.top,e.bottom)))}function jn(t,e,n,r,i){let o,s,a,l;if(e.spanGaps&&(t=t.filter((t=>!t.skip))),"monotone"===e.cubicInterpolationMode)Wn(t,i);else{let n=r?t[t.length-1]:t[0];for(o=0,s=t.length;o<s;++o)a=t[o],l=Ln(n,a,t[Math.min(o+1,s-(r?0:1))%s],e.tension),a.cp1x=l.previous.x,a.cp1y=l.previous.y,a.cp2x=l.next.x,a.cp2y=l.next.y,n=a}e.capBezierPoints&&Vn(t,n)}function Hn(){return"undefined"!==typeof window&&"undefined"!==typeof document}function Gn(t){let e=t.parentNode;return e&&"[object ShadowRoot]"===e.toString()&&(e=e.host),e}function qn(t,e,n){let r;return"string"===typeof t?(r=parseInt(t,10),-1!==t.indexOf("%")&&(r=r/100*e.parentNode[n])):r=t,r}const Kn=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function Xn(t,e){return Kn(t).getPropertyValue(e)}const Yn=["top","right","bottom","left"];function Jn(t,e,n){const r={};n=n?"-"+n:"";for(let i=0;i<4;i++){const o=Yn[i];r[o]=parseFloat(t[e+"-"+o+n])||0}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}const Zn=(t,e,n)=>(t>0||e>0)&&(!n||!n.shadowRoot);function Qn(t,e){const n=t.touches,r=n&&n.length?n[0]:t,{offsetX:i,offsetY:o}=r;let s,a,l=!1;if(Zn(i,o,t.target))s=i,a=o;else{const t=e.getBoundingClientRect();s=r.clientX-t.left,a=r.clientY-t.top,l=!0}return{x:s,y:a,box:l}}function tr(t,e){if("native"in t)return t;const{canvas:n,currentDevicePixelRatio:r}=e,i=Kn(n),o="border-box"===i.boxSizing,s=Jn(i,"padding"),a=Jn(i,"border","width"),{x:l,y:u,box:c}=Qn(t,n),h=s.left+(c&&a.left),d=s.top+(c&&a.top);let{width:p,height:f}=e;return o&&(p-=s.width+a.width,f-=s.height+a.height),{x:Math.round((l-h)/p*n.width/r),y:Math.round((u-d)/f*n.height/r)}}function er(t,e,n){let r,i;if(void 0===e||void 0===n){const o=Gn(t);if(o){const t=o.getBoundingClientRect(),s=Kn(o),a=Jn(s,"border","width"),l=Jn(s,"padding");e=t.width-l.width-a.width,n=t.height-l.height-a.height,r=qn(s.maxWidth,o,"clientWidth"),i=qn(s.maxHeight,o,"clientHeight")}else e=t.clientWidth,n=t.clientHeight}return{width:e,height:n,maxWidth:r||Nt,maxHeight:i||Nt}}const nr=t=>Math.round(10*t)/10;function rr(t,e,n,r){const i=Kn(t),o=Jn(i,"margin"),s=qn(i.maxWidth,t,"clientWidth")||Nt,a=qn(i.maxHeight,t,"clientHeight")||Nt,l=er(t,e,n);let{width:u,height:c}=l;if("content-box"===i.boxSizing){const t=Jn(i,"border","width"),e=Jn(i,"padding");u-=e.width+t.width,c-=e.height+t.height}u=Math.max(0,u-o.width),c=Math.max(0,r?u/r:c-o.height),u=nr(Math.min(u,s,l.maxWidth)),c=nr(Math.min(c,a,l.maxHeight)),u&&!c&&(c=nr(u/2));const h=void 0!==e||void 0!==n;return h&&r&&l.height&&c>l.height&&(c=l.height,u=nr(Math.floor(c*r))),{width:u,height:c}}function ir(t,e,n){const r=e||1,i=Math.floor(t.height*r),o=Math.floor(t.width*r);t.height=Math.floor(t.height),t.width=Math.floor(t.width);const s=t.canvas;return s.style&&(n||!s.style.height&&!s.style.width)&&(s.style.height=`${t.height}px`,s.style.width=`${t.width}px`),(t.currentDevicePixelRatio!==r||s.height!==i||s.width!==o)&&(t.currentDevicePixelRatio=r,s.height=i,s.width=o,t.ctx.setTransform(r,0,0,r,0,0),!0)}const or=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};Hn()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch(e){}return t}();function sr(t,e){const n=Xn(t,e),r=n&&n.match(/^(\d+)(\.\d+)?px$/);return r?+r[1]:void 0}function ar(t,e,n,r){return{x:t.x+n*(e.x-t.x),y:t.y+n*(e.y-t.y)}}function lr(t,e,n,r){return{x:t.x+n*(e.x-t.x),y:"middle"===r?n<.5?t.y:e.y:"after"===r?n<1?t.y:e.y:n>0?e.y:t.y}}function ur(t,e,n,r){const i={x:t.cp2x,y:t.cp2y},o={x:e.cp1x,y:e.cp1y},s=ar(t,i,n),a=ar(i,o,n),l=ar(o,e,n),u=ar(s,a,n),c=ar(a,l,n);return ar(u,c,n)}const cr=function(t,e){return{x(n){return t+t+e-n},setWidth(t){e=t},textAlign(t){return"center"===t?t:"right"===t?"left":"right"},xPlus(t,e){return t-e},leftForLtr(t,e){return t-e}}},hr=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function dr(t,e,n){return t?cr(e,n):hr()}function pr(t,e){let n,r;"ltr"!==e&&"rtl"!==e||(n=t.canvas.style,r=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",e,"important"),t.prevTextDirection=r)}function fr(t,e){void 0!==e&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function gr(t){return"angle"===t?{between:Xt,compare:qt,normalize:Kt}:{between:Zt,compare:(t,e)=>t-e,normalize:t=>t}}function mr({start:t,end:e,count:n,loop:r,style:i}){return{start:t%n,end:e%n,loop:r&&(e-t+1)%n===0,style:i}}function yr(t,e,n){const{property:r,start:i,end:o}=n,{between:s,normalize:a}=gr(r),l=e.length;let u,c,{start:h,end:d,loop:p}=t;if(p){for(h+=l,d+=l,u=0,c=l;u<c;++u){if(!s(a(e[h%l][r]),i,o))break;h--,d--}h%=l,d%=l}return d<h&&(d+=l),{start:h,end:d,loop:p,style:t.style}}function br(t,e,n){if(!n)return[t];const{property:r,start:i,end:o}=n,s=e.length,{compare:a,between:l,normalize:u}=gr(r),{start:c,end:h,loop:d,style:p}=yr(t,e,n),f=[];let g,m,y,b=!1,v=null;const w=()=>l(i,y,g)&&0!==a(i,y),x=()=>0===a(o,g)||l(o,y,g),k=()=>b||w(),_=()=>!b||x();for(let I=c,C=c;I<=h;++I)m=e[I%s],m.skip||(g=u(m[r]),g!==y&&(b=l(g,i,o),null===v&&k()&&(v=0===a(g,i)?I:C),null!==v&&_()&&(f.push(mr({start:v,end:I,loop:d,count:s,style:p})),v=null),C=I,y=g));return null!==v&&f.push(mr({start:v,end:h,loop:d,count:s,style:p})),f}function vr(t,e){const n=[],r=t.segments;for(let i=0;i<r.length;i++){const o=br(r[i],t.points,e);o.length&&n.push(...o)}return n}function wr(t,e,n,r){let i=0,o=e-1;if(n&&!r)while(i<e&&!t[i].skip)i++;while(i<e&&t[i].skip)i++;i%=e,n&&(o+=i);while(o>i&&t[o%e].skip)o--;return o%=e,{start:i,end:o}}function xr(t,e,n,r){const i=t.length,o=[];let s,a=e,l=t[e];for(s=e+1;s<=n;++s){const n=t[s%i];n.skip||n.stop?l.skip||(r=!1,o.push({start:e%i,end:(s-1)%i,loop:r}),e=a=n.stop?s:null):(a=s,l.skip&&(e=s)),l=n}return null!==a&&o.push({start:e%i,end:a%i,loop:r}),o}function kr(t,e){const n=t.points,r=t.options.spanGaps,i=n.length;if(!i)return[];const o=!!t._loop,{start:s,end:a}=wr(n,i,o,r);if(!0===r)return _r(t,[{start:s,end:a,loop:o}],n,e);const l=a<s?a+i:a,u=!!t._fullLoop&&0===s&&a===i-1;return _r(t,xr(n,s,l,u),n,e)}function _r(t,e,n,r){return r&&r.setContext&&n?Ir(t,e,n,r):e}function Ir(t,e,n,r){const i=t._chart.getContext(),o=Cr(t.options),{_datasetIndex:s,options:{spanGaps:a}}=t,l=n.length,u=[];let c=o,h=e[0].start,d=h;function p(t,e,r,i){const o=a?-1:1;if(t!==e){t+=l;while(n[t%l].skip)t-=o;while(n[e%l].skip)e+=o;t%l!==e%l&&(u.push({start:t%l,end:e%l,loop:r,style:i}),c=i,h=e%l)}}for(const f of e){h=a?h:f.start;let t,e=n[h%l];for(d=h+1;d<=f.end;d++){const o=n[d%l];t=Cr(r.setContext(fn(i,{type:"segment",p0:e,p1:o,p0DataIndex:(d-1)%l,p1DataIndex:d%l,datasetIndex:s}))),Sr(t,c)&&p(h,d-1,f.loop,c),e=o,c=t}h<d-1&&p(h,d-1,f.loop,c)}return u}function Cr(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function Sr(t,e){if(!e)return!1;const n=[],r=function(t,e){return ve(e)?(n.includes(e)||n.push(e),n.indexOf(e)):e};return JSON.stringify(t,r)!==JSON.stringify(e,r)}
/*!
 * Chart.js v4.4.1
 * https://www.chartjs.org
 * (c) 2023 Chart.js Contributors
 * Released under the MIT License
 */
class Tr{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,e,n,r){const i=e.listeners[r],o=e.duration;i.forEach((r=>r({chart:t,initial:e.initial,numSteps:o,currentStep:Math.min(n-e.start,o)})))}_refresh(){this._request||(this._running=!0,this._request=ae.call(window,(()=>{this._update(),this._request=null,this._running&&this._refresh()})))}_update(t=Date.now()){let e=0;this._charts.forEach(((n,r)=>{if(!n.running||!n.items.length)return;const i=n.items;let o,s=i.length-1,a=!1;for(;s>=0;--s)o=i[s],o._active?(o._total>n.duration&&(n.duration=o._total),o.tick(t),a=!0):(i[s]=i[i.length-1],i.pop());a&&(r.draw(),this._notify(r,n,t,"progress")),i.length||(n.running=!1,this._notify(r,n,t,"complete"),n.initial=!1),e+=i.length})),this._lastDate=t,0===e&&(this._running=!1)}_getAnims(t){const e=this._charts;let n=e.get(t);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},e.set(t,n)),n}listen(t,e,n){this._getAnims(t).listeners[e].push(n)}add(t,e){e&&e.length&&this._getAnims(t).items.push(...e)}has(t){return this._getAnims(t).items.length>0}start(t){const e=this._charts.get(t);e&&(e.running=!0,e.start=Date.now(),e.duration=e.items.reduce(((t,e)=>Math.max(t,e._duration)),0),this._refresh())}running(t){if(!this._running)return!1;const e=this._charts.get(t);return!!(e&&e.running&&e.items.length)}stop(t){const e=this._charts.get(t);if(!e||!e.items.length)return;const n=e.items;let r=n.length-1;for(;r>=0;--r)n[r].cancel();e.items=[],this._notify(t,e,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var Er=new Tr;const Nr="transparent",Ar={boolean(t,e,n){return n>.5?e:t},color(t,e,n){const r=we(t||Nr),i=r.valid&&we(e||Nr);return i&&i.valid?i.mix(r,n).hexString():e},number(t,e,n){return t+(e-t)*n}};class Rr{constructor(t,e,n,r){const i=e[n];r=dn([t.to,r,i,t.from]);const o=dn([t.from,i,r]);this._active=!0,this._fn=t.fn||Ar[t.type||typeof o],this._easing=be[t.easing]||be.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=e,this._prop=n,this._from=o,this._to=r,this._promises=void 0}active(){return this._active}update(t,e,n){if(this._active){this._notify(!1);const r=this._target[this._prop],i=n-this._start,o=this._duration-i;this._start=n,this._duration=Math.floor(Math.max(o,t.duration)),this._total+=i,this._loop=!!t.loop,this._to=dn([t.to,e,r,t.from]),this._from=dn([t.from,r,e])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const e=t-this._start,n=this._duration,r=this._prop,i=this._from,o=this._loop,s=this._to;let a;if(this._active=i!==s&&(o||e<n),!this._active)return this._target[r]=s,void this._notify(!0);e<0?this._target[r]=i:(a=e/n%2,a=o&&a>1?2-a:a,a=this._easing(Math.min(1,Math.max(0,a))),this._target[r]=this._fn(i,s,a))}wait(){const t=this._promises||(this._promises=[]);return new Promise(((e,n)=>{t.push({res:e,rej:n})}))}_notify(t){const e=t?"res":"rej",n=this._promises||[];for(let r=0;r<n.length;r++)n[r][e]()}}class $r{constructor(t,e){this._chart=t,this._properties=new Map,this.configure(e)}configure(t){if(!nt(t))return;const e=Object.keys(Le.animation),n=this._properties;Object.getOwnPropertyNames(t).forEach((r=>{const i=t[r];if(!nt(i))return;const o={};for(const t of e)o[t]=i[t];(et(i.properties)&&i.properties||[r]).forEach((t=>{t!==r&&n.has(t)||n.set(t,o)}))}))}_animateOptions(t,e){const n=e.options,r=Or(t,n);if(!r)return[];const i=this._createAnimations(r,n);return n.$shared&&Dr(t.options.$animations,n).then((()=>{t.options=n}),(()=>{})),i}_createAnimations(t,e){const n=this._properties,r=[],i=t.$animations||(t.$animations={}),o=Object.keys(e),s=Date.now();let a;for(a=o.length-1;a>=0;--a){const l=o[a];if("$"===l.charAt(0))continue;if("options"===l){r.push(...this._animateOptions(t,e));continue}const u=e[l];let c=i[l];const h=n.get(l);if(c){if(h&&c.active()){c.update(h,u,s);continue}c.cancel()}h&&h.duration?(i[l]=c=new Rr(h,t,l,u),r.push(c)):t[l]=u}return r}update(t,e){if(0===this._properties.size)return void Object.assign(t,e);const n=this._createAnimations(t,e);return n.length?(Er.add(this._chart,n),!0):void 0}}function Dr(t,e){const n=[],r=Object.keys(e);for(let i=0;i<r.length;i++){const e=t[r[i]];e&&e.active()&&n.push(e.wait())}return Promise.all(n)}function Or(t,e){if(!e)return;let n=t.options;if(n)return n.$shared&&(t.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n;t.options=e}function Fr(t,e){const n=t&&t.options||{},r=n.reverse,i=void 0===n.min?e:0,o=void 0===n.max?e:0;return{start:r?o:i,end:r?i:o}}function Mr(t,e,n){if(!1===n)return!1;const r=Fr(t,n),i=Fr(e,n);return{top:i.end,right:r.end,bottom:i.start,left:r.start}}function Pr(t){let e,n,r,i;return nt(t)?(e=t.top,n=t.right,r=t.bottom,i=t.left):e=n=r=i=t,{top:e,right:n,bottom:r,left:i,disabled:!1===t}}function Lr(t,e){const n=[],r=t._getSortedDatasetMetas(e);let i,o;for(i=0,o=r.length;i<o;++i)n.push(r[i].index);return n}function zr(t,e,n,r={}){const i=t.keys,o="single"===r.mode;let s,a,l,u;if(null!==e){for(s=0,a=i.length;s<a;++s){if(l=+i[s],l===n){if(r.all)continue;break}u=t.values[l],rt(u)&&(o||0===e||Ft(e)===Ft(u))&&(e+=u)}return e}}function Br(t){const e=Object.keys(t),n=new Array(e.length);let r,i,o;for(r=0,i=e.length;r<i;++r)o=e[r],n[r]={x:o,y:t[o]};return n}function Wr(t,e){const n=t&&t.options.stacked;return n||void 0===n&&void 0!==e.stack}function Ur(t,e,n){return`${t.id}.${e.id}.${n.stack||n.type}`}function Vr(t){const{min:e,max:n,minDefined:r,maxDefined:i}=t.getUserBounds();return{min:r?e:Number.NEGATIVE_INFINITY,max:i?n:Number.POSITIVE_INFINITY}}function jr(t,e,n){const r=t[e]||(t[e]={});return r[n]||(r[n]={})}function Hr(t,e,n,r){for(const i of e.getMatchingVisibleMetas(r).reverse()){const e=t[i.index];if(n&&e>0||!n&&e<0)return i.index}return null}function Gr(t,e){const{chart:n,_cachedMeta:r}=t,i=n._stacks||(n._stacks={}),{iScale:o,vScale:s,index:a}=r,l=o.axis,u=s.axis,c=Ur(o,s,r),h=e.length;let d;for(let p=0;p<h;++p){const t=e[p],{[l]:n,[u]:o}=t,h=t._stacks||(t._stacks={});d=h[u]=jr(i,c,n),d[a]=o,d._top=Hr(d,s,!0,r.type),d._bottom=Hr(d,s,!1,r.type);const f=d._visualValues||(d._visualValues={});f[a]=o}}function qr(t,e){const n=t.scales;return Object.keys(n).filter((t=>n[t].axis===e)).shift()}function Kr(t,e){return fn(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function Xr(t,e,n){return fn(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:n,index:e,mode:"default",type:"data"})}function Yr(t,e){const n=t.controller.index,r=t.vScale&&t.vScale.axis;if(r){e=e||t._parsed;for(const t of e){const e=t._stacks;if(!e||void 0===e[r]||void 0===e[r][n])return;delete e[r][n],void 0!==e[r]._visualValues&&void 0!==e[r]._visualValues[n]&&delete e[r]._visualValues[n]}}}const Jr=t=>"reset"===t||"none"===t,Zr=(t,e)=>e?t:Object.assign({},t),Qr=(t,e,n)=>t&&!e.hidden&&e._stacked&&{keys:Lr(n,!0),values:null};class ti{constructor(t,e){this.chart=t,this._ctx=t.ctx,this.index=e,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=Wr(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&Yr(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,e=this._cachedMeta,n=this.getDataset(),r=(t,e,n,r)=>"x"===t?e:"r"===t?r:n,i=e.xAxisID=ot(n.xAxisID,qr(t,"x")),o=e.yAxisID=ot(n.yAxisID,qr(t,"y")),s=e.rAxisID=ot(n.rAxisID,qr(t,"r")),a=e.indexAxis,l=e.iAxisID=r(a,i,o,s),u=e.vAxisID=r(a,o,i,s);e.xScale=this.getScaleForId(i),e.yScale=this.getScaleForId(o),e.rScale=this.getScaleForId(s),e.iScale=this.getScaleForId(l),e.vScale=this.getScaleForId(u)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const e=this._cachedMeta;return t===e.iScale?e.vScale:e.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&oe(this._data,this),t._stacked&&Yr(t)}_dataCheck(){const t=this.getDataset(),e=t.data||(t.data=[]),n=this._data;if(nt(e))this._data=Br(e);else if(n!==e){if(n){oe(n,this);const t=this._cachedMeta;Yr(t),t._parsed=[]}e&&Object.isExtensible(e)&&ie(e,this),this._syncList=[],this._data=e}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const e=this._cachedMeta,n=this.getDataset();let r=!1;this._dataCheck();const i=e._stacked;e._stacked=Wr(e.vScale,e),e.stack!==n.stack&&(r=!0,Yr(e),e.stack=n.stack),this._resyncElements(t),(r||i!==e._stacked)&&Gr(this,e._parsed)}configure(){const t=this.chart.config,e=t.datasetScopeKeys(this._type),n=t.getOptionScopes(this.getDataset(),e,!0);this.options=t.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,e){const{_cachedMeta:n,_data:r}=this,{iScale:i,_stacked:o}=n,s=i.axis;let a,l,u,c=0===t&&e===r.length||n._sorted,h=t>0&&n._parsed[t-1];if(!1===this._parsing)n._parsed=r,n._sorted=!0,u=r;else{u=et(r[t])?this.parseArrayData(n,r,t,e):nt(r[t])?this.parseObjectData(n,r,t,e):this.parsePrimitiveData(n,r,t,e);const i=()=>null===l[s]||h&&l[s]<h[s];for(a=0;a<e;++a)n._parsed[a+t]=l=u[a],c&&(i()&&(c=!1),h=l);n._sorted=c}o&&Gr(this,u)}parsePrimitiveData(t,e,n,r){const{iScale:i,vScale:o}=t,s=i.axis,a=o.axis,l=i.getLabels(),u=i===o,c=new Array(r);let h,d,p;for(h=0,d=r;h<d;++h)p=h+n,c[h]={[s]:u||i.parse(l[p],p),[a]:o.parse(e[p],p)};return c}parseArrayData(t,e,n,r){const{xScale:i,yScale:o}=t,s=new Array(r);let a,l,u,c;for(a=0,l=r;a<l;++a)u=a+n,c=e[u],s[a]={x:i.parse(c[0],u),y:o.parse(c[1],u)};return s}parseObjectData(t,e,n,r){const{xScale:i,yScale:o}=t,{xAxisKey:s="x",yAxisKey:a="y"}=this._parsing,l=new Array(r);let u,c,h,d;for(u=0,c=r;u<c;++u)h=u+n,d=e[h],l[u]={x:i.parse(wt(d,s),h),y:o.parse(wt(d,a),h)};return l}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,e,n){const r=this.chart,i=this._cachedMeta,o=e[t.axis],s={keys:Lr(r,!0),values:e._stacks[t.axis]._visualValues};return zr(s,o,i.index,{mode:n})}updateRangeFromParsed(t,e,n,r){const i=n[e.axis];let o=null===i?NaN:i;const s=r&&n._stacks[e.axis];r&&s&&(r.values=s,o=zr(r,i,this._cachedMeta.index)),t.min=Math.min(t.min,o),t.max=Math.max(t.max,o)}getMinMax(t,e){const n=this._cachedMeta,r=n._parsed,i=n._sorted&&t===n.iScale,o=r.length,s=this._getOtherScale(t),a=Qr(e,n,this.chart),l={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:u,max:c}=Vr(s);let h,d;function p(){d=r[h];const e=d[s.axis];return!rt(d[t.axis])||u>e||c<e}for(h=0;h<o;++h)if(!p()&&(this.updateRangeFromParsed(l,t,d,a),i))break;if(i)for(h=o-1;h>=0;--h)if(!p()){this.updateRangeFromParsed(l,t,d,a);break}return l}getAllParsedValues(t){const e=this._cachedMeta._parsed,n=[];let r,i,o;for(r=0,i=e.length;r<i;++r)o=e[r][t.axis],rt(o)&&n.push(o);return n}getMaxOverflow(){return!1}getLabelAndValue(t){const e=this._cachedMeta,n=e.iScale,r=e.vScale,i=this.getParsed(t);return{label:n?""+n.getLabelForValue(i[n.axis]):"",value:r?""+r.getLabelForValue(i[r.axis]):""}}_update(t){const e=this._cachedMeta;this.update(t||"default"),e._clip=Pr(ot(this.options.clip,Mr(e.xScale,e.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,e=this.chart,n=this._cachedMeta,r=n.data||[],i=e.chartArea,o=[],s=this._drawStart||0,a=this._drawCount||r.length-s,l=this.options.drawActiveElementsOnTop;let u;for(n.dataset&&n.dataset.draw(t,i,s,a),u=s;u<s+a;++u){const e=r[u];e.hidden||(e.active&&l?o.push(e):e.draw(t,i))}for(u=0;u<o.length;++u)o[u].draw(t,i)}getStyle(t,e){const n=e?"active":"default";return void 0===t&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(t||0,n)}getContext(t,e,n){const r=this.getDataset();let i;if(t>=0&&t<this._cachedMeta.data.length){const e=this._cachedMeta.data[t];i=e.$context||(e.$context=Xr(this.getContext(),t,e)),i.parsed=this.getParsed(t),i.raw=r.data[t],i.index=i.dataIndex=t}else i=this.$context||(this.$context=Kr(this.chart.getContext(),this.index)),i.dataset=r,i.index=i.datasetIndex=this.index;return i.active=!!e,i.mode=n,i}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,e){return this._resolveElementOptions(this.dataElementType.id,e,t)}_resolveElementOptions(t,e="default",n){const r="active"===e,i=this._cachedDataOpts,o=t+"-"+e,s=i[o],a=this.enableOptionSharing&&kt(n);if(s)return Zr(s,a);const l=this.chart.config,u=l.datasetElementScopeKeys(this._type,t),c=r?[`${t}Hover`,"hover",t,""]:[t,""],h=l.getOptionScopes(this.getDataset(),u),d=Object.keys(Le.elements[t]),p=()=>this.getContext(n,r,e),f=l.resolveNamedOptions(h,d,p,c);return f.$shared&&(f.$shared=a,i[o]=Object.freeze(Zr(f,a))),f}_resolveAnimations(t,e,n){const r=this.chart,i=this._cachedDataOpts,o=`animation-${e}`,s=i[o];if(s)return s;let a;if(!1!==r.options.animation){const r=this.chart.config,i=r.datasetAnimationScopeKeys(this._type,e),o=r.getOptionScopes(this.getDataset(),i);a=r.createResolver(o,this.getContext(t,n,e))}const l=new $r(r,a&&a.animations);return a&&a._cacheable&&(i[o]=Object.freeze(l)),l}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,e){return!e||Jr(t)||this.chart._animationsDisabled}_getSharedOptions(t,e){const n=this.resolveDataElementOptions(t,e),r=this._sharedOptions,i=this.getSharedOptions(n),o=this.includeOptions(e,i)||i!==r;return this.updateSharedOptions(i,e,n),{sharedOptions:i,includeOptions:o}}updateElement(t,e,n,r){Jr(r)?Object.assign(t,n):this._resolveAnimations(e,r).update(t,n)}updateSharedOptions(t,e,n){t&&!Jr(e)&&this._resolveAnimations(void 0,e).update(t,n)}_setStyle(t,e,n,r){t.active=r;const i=this.getStyle(e,r);this._resolveAnimations(e,n,r).update(t,{options:!r&&this.getSharedOptions(i)||i})}removeHoverStyle(t,e,n){this._setStyle(t,n,"active",!1)}setHoverStyle(t,e,n){this._setStyle(t,n,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const e=this._data,n=this._cachedMeta.data;for(const[s,a,l]of this._syncList)this[s](a,l);this._syncList=[];const r=n.length,i=e.length,o=Math.min(i,r);o&&this.parse(0,o),i>r?this._insertElements(r,i-r,t):i<r&&this._removeElements(i,r-i)}_insertElements(t,e,n=!0){const r=this._cachedMeta,i=r.data,o=t+e;let s;const a=t=>{for(t.length+=e,s=t.length-1;s>=o;s--)t[s]=t[s-e]};for(a(i),s=t;s<o;++s)i[s]=new this.dataElementType;this._parsing&&a(r._parsed),this.parse(t,e),n&&this.updateElements(i,t,e,"reset")}updateElements(t,e,n,r){}_removeElements(t,e){const n=this._cachedMeta;if(this._parsing){const r=n._parsed.splice(t,e);n._stacked&&Yr(n,r)}n.data.splice(t,e)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[e,n,r]=t;this[e](n,r)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,e){e&&this._sync(["_removeElements",t,e]);const n=arguments.length-2;n&&this._sync(["_insertElements",t,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function ei(t,e){if(!t._cache.$bar){const n=t.getMatchingVisibleMetas(e);let r=[];for(let e=0,i=n.length;e<i;e++)r=r.concat(n[e].controller.getAllParsedValues(t));t._cache.$bar=se(r.sort(((t,e)=>t-e)))}return t._cache.$bar}function ni(t){const e=t.iScale,n=ei(e,t.type);let r,i,o,s,a=e._length;const l=()=>{32767!==o&&-32768!==o&&(kt(s)&&(a=Math.min(a,Math.abs(o-s)||a)),s=o)};for(r=0,i=n.length;r<i;++r)o=e.getPixelForValue(n[r]),l();for(s=void 0,r=0,i=e.ticks.length;r<i;++r)o=e.getPixelForTick(r),l();return a}function ri(t,e,n,r){const i=n.barThickness;let o,s;return tt(i)?(o=e.min*n.categoryPercentage,s=n.barPercentage):(o=i*r,s=1),{chunk:o/r,ratio:s,start:e.pixels[t]-o/2}}function ii(t,e,n,r){const i=e.pixels,o=i[t];let s=t>0?i[t-1]:null,a=t<i.length-1?i[t+1]:null;const l=n.categoryPercentage;null===s&&(s=o-(null===a?e.end-e.start:a-o)),null===a&&(a=o+o-s);const u=o-(o-Math.min(s,a))/2*l,c=Math.abs(a-s)/2*l;return{chunk:c/r,ratio:n.barPercentage,start:u}}function oi(t,e,n,r){const i=n.parse(t[0],r),o=n.parse(t[1],r),s=Math.min(i,o),a=Math.max(i,o);let l=s,u=a;Math.abs(s)>Math.abs(a)&&(l=a,u=s),e[n.axis]=u,e._custom={barStart:l,barEnd:u,start:i,end:o,min:s,max:a}}function si(t,e,n,r){return et(t)?oi(t,e,n,r):e[n.axis]=n.parse(t,r),e}function ai(t,e,n,r){const i=t.iScale,o=t.vScale,s=i.getLabels(),a=i===o,l=[];let u,c,h,d;for(u=n,c=n+r;u<c;++u)d=e[u],h={},h[i.axis]=a||i.parse(s[u],u),l.push(si(d,h,o,u));return l}function li(t){return t&&void 0!==t.barStart&&void 0!==t.barEnd}function ui(t,e,n){return 0!==t?Ft(t):(e.isHorizontal()?1:-1)*(e.min>=n?1:-1)}function ci(t){let e,n,r,i,o;return t.horizontal?(e=t.base>t.x,n="left",r="right"):(e=t.base<t.y,n="bottom",r="top"),e?(i="end",o="start"):(i="start",o="end"),{start:n,end:r,reverse:e,top:i,bottom:o}}function hi(t,e,n,r){let i=e.borderSkipped;const o={};if(!i)return void(t.borderSkipped=o);if(!0===i)return void(t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0});const{start:s,end:a,reverse:l,top:u,bottom:c}=ci(t);"middle"===i&&n&&(t.enableBorderRadius=!0,(n._top||0)===r?i=u:(n._bottom||0)===r?i=c:(o[di(c,s,a,l)]=!0,i=u)),o[di(i,s,a,l)]=!0,t.borderSkipped=o}function di(t,e,n,r){return r?(t=pi(t,e,n),t=fi(t,n,e)):t=fi(t,e,n),t}function pi(t,e,n){return t===e?n:t===n?e:t}function fi(t,e,n){return"start"===t?e:"end"===t?n:t}function gi(t,{inflateAmount:e},n){t.inflateAmount="auto"===e?1===n?.33:0:e}s(ti,"defaults",{}),s(ti,"datasetElementType",null),s(ti,"dataElementType",null);class mi extends ti{parsePrimitiveData(t,e,n,r){return ai(t,e,n,r)}parseArrayData(t,e,n,r){return ai(t,e,n,r)}parseObjectData(t,e,n,r){const{iScale:i,vScale:o}=t,{xAxisKey:s="x",yAxisKey:a="y"}=this._parsing,l="x"===i.axis?s:a,u="x"===o.axis?s:a,c=[];let h,d,p,f;for(h=n,d=n+r;h<d;++h)f=e[h],p={},p[i.axis]=i.parse(wt(f,l),h),c.push(si(wt(f,u),p,o,h));return c}updateRangeFromParsed(t,e,n,r){super.updateRangeFromParsed(t,e,n,r);const i=n._custom;i&&e===this._cachedMeta.vScale&&(t.min=Math.min(t.min,i.min),t.max=Math.max(t.max,i.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const e=this._cachedMeta,{iScale:n,vScale:r}=e,i=this.getParsed(t),o=i._custom,s=li(o)?"["+o.start+", "+o.end+"]":""+r.getLabelForValue(i[r.axis]);return{label:""+n.getLabelForValue(i[n.axis]),value:s}}initialize(){this.enableOptionSharing=!0,super.initialize();const t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){const e=this._cachedMeta;this.updateElements(e.data,0,e.data.length,t)}updateElements(t,e,n,r){const i="reset"===r,{index:o,_cachedMeta:{vScale:s}}=this,a=s.getBasePixel(),l=s.isHorizontal(),u=this._getRuler(),{sharedOptions:c,includeOptions:h}=this._getSharedOptions(e,r);for(let d=e;d<e+n;d++){const e=this.getParsed(d),n=i||tt(e[s.axis])?{base:a,head:a}:this._calculateBarValuePixels(d),p=this._calculateBarIndexPixels(d,u),f=(e._stacks||{})[s.axis],g={horizontal:l,base:n.base,enableBorderRadius:!f||li(e._custom)||o===f._top||o===f._bottom,x:l?n.head:p.center,y:l?p.center:n.head,height:l?p.size:Math.abs(n.size),width:l?Math.abs(n.size):p.size};h&&(g.options=c||this.resolveDataElementOptions(d,t[d].active?"active":r));const m=g.options||t[d].options;hi(g,m,f,o),gi(g,m,u.ratio),this.updateElement(t[d],d,g,r)}}_getStacks(t,e){const{iScale:n}=this._cachedMeta,r=n.getMatchingVisibleMetas(this._type).filter((t=>t.controller.options.grouped)),i=n.options.stacked,o=[],s=t=>{const n=t.controller.getParsed(e),r=n&&n[t.vScale.axis];if(tt(r)||isNaN(r))return!0};for(const a of r)if((void 0===e||!s(a))&&((!1===i||-1===o.indexOf(a.stack)||void 0===i&&void 0===a.stack)&&o.push(a.stack),a.index===t))break;return o.length||o.push(void 0),o}_getStackCount(t){return this._getStacks(void 0,t).length}_getStackIndex(t,e,n){const r=this._getStacks(t,n),i=void 0!==e?r.indexOf(e):-1;return-1===i?r.length-1:i}_getRuler(){const t=this.options,e=this._cachedMeta,n=e.iScale,r=[];let i,o;for(i=0,o=e.data.length;i<o;++i)r.push(n.getPixelForValue(this.getParsed(i)[n.axis],i));const s=t.barThickness,a=s||ni(e);return{min:a,pixels:r,start:n._startPixel,end:n._endPixel,stackCount:this._getStackCount(),scale:n,grouped:t.grouped,ratio:s?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:e,_stacked:n,index:r},options:{base:i,minBarLength:o}}=this,s=i||0,a=this.getParsed(t),l=a._custom,u=li(l);let c,h,d=a[e.axis],p=0,f=n?this.applyStack(e,a,n):d;f!==d&&(p=f-d,f=d),u&&(d=l.barStart,f=l.barEnd-l.barStart,0!==d&&Ft(d)!==Ft(l.barEnd)&&(p=0),p+=d);const g=tt(i)||u?p:i;let m=e.getPixelForValue(g);if(c=this.chart.getDataVisibility(t)?e.getPixelForValue(p+f):m,h=c-m,Math.abs(h)<o){h=ui(h,e,s)*o,d===s&&(m-=h/2);const t=e.getPixelForDecimal(0),i=e.getPixelForDecimal(1),l=Math.min(t,i),p=Math.max(t,i);m=Math.max(Math.min(m,p),l),c=m+h,n&&!u&&(a._stacks[e.axis]._visualValues[r]=e.getValueForPixel(c)-e.getValueForPixel(m))}if(m===e.getPixelForValue(s)){const t=Ft(h)*e.getLineWidthForValue(s)/2;m+=t,h-=t}return{size:h,base:m,head:c,center:c+h/2}}_calculateBarIndexPixels(t,e){const n=e.scale,r=this.options,i=r.skipNull,o=ot(r.maxBarThickness,1/0);let s,a;if(e.grouped){const n=i?this._getStackCount(t):e.stackCount,l="flex"===r.barThickness?ii(t,e,r,n):ri(t,e,r,n),u=this._getStackIndex(this.index,this._cachedMeta.stack,i?t:void 0);s=l.start+l.chunk*u+l.chunk/2,a=Math.min(o,l.chunk*l.ratio)}else s=n.getPixelForValue(this.getParsed(t)[n.axis],t),a=Math.min(o,e.min*e.ratio);return{base:s-a/2,head:s+a/2,center:s,size:a}}draw(){const t=this._cachedMeta,e=t.vScale,n=t.data,r=n.length;let i=0;for(;i<r;++i)null!==this.getParsed(i)[e.axis]&&n[i].draw(this._ctx)}}s(mi,"id","bar"),s(mi,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),s(mi,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class yi extends ti{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(t,e,n,r){const i=super.parsePrimitiveData(t,e,n,r);for(let o=0;o<i.length;o++)i[o]._custom=this.resolveDataElementOptions(o+n).radius;return i}parseArrayData(t,e,n,r){const i=super.parseArrayData(t,e,n,r);for(let o=0;o<i.length;o++){const t=e[n+o];i[o]._custom=ot(t[2],this.resolveDataElementOptions(o+n).radius)}return i}parseObjectData(t,e,n,r){const i=super.parseObjectData(t,e,n,r);for(let o=0;o<i.length;o++){const t=e[n+o];i[o]._custom=ot(t&&t.r&&+t.r,this.resolveDataElementOptions(o+n).radius)}return i}getMaxOverflow(){const t=this._cachedMeta.data;let e=0;for(let n=t.length-1;n>=0;--n)e=Math.max(e,t[n].size(this.resolveDataElementOptions(n))/2);return e>0&&e}getLabelAndValue(t){const e=this._cachedMeta,n=this.chart.data.labels||[],{xScale:r,yScale:i}=e,o=this.getParsed(t),s=r.getLabelForValue(o.x),a=i.getLabelForValue(o.y),l=o._custom;return{label:n[t]||"",value:"("+s+", "+a+(l?", "+l:"")+")"}}update(t){const e=this._cachedMeta.data;this.updateElements(e,0,e.length,t)}updateElements(t,e,n,r){const i="reset"===r,{iScale:o,vScale:s}=this._cachedMeta,{sharedOptions:a,includeOptions:l}=this._getSharedOptions(e,r),u=o.axis,c=s.axis;for(let h=e;h<e+n;h++){const e=t[h],n=!i&&this.getParsed(h),d={},p=d[u]=i?o.getPixelForDecimal(.5):o.getPixelForValue(n[u]),f=d[c]=i?s.getBasePixel():s.getPixelForValue(n[c]);d.skip=isNaN(p)||isNaN(f),l&&(d.options=a||this.resolveDataElementOptions(h,e.active?"active":r),i&&(d.options.radius=0)),this.updateElement(e,h,d,r)}}resolveDataElementOptions(t,e){const n=this.getParsed(t);let r=super.resolveDataElementOptions(t,e);r.$shared&&(r=Object.assign({},r,{$shared:!1}));const i=r.radius;return"active"!==e&&(r.radius=0),r.radius+=ot(n&&n._custom,i),r}}function bi(t,e,n){let r=1,i=1,o=0,s=0;if(e<Tt){const a=t,l=a+e,u=Math.cos(a),c=Math.sin(a),h=Math.cos(l),d=Math.sin(l),p=(t,e,r)=>Xt(t,a,l,!0)?1:Math.max(e,e*n,r,r*n),f=(t,e,r)=>Xt(t,a,l,!0)?-1:Math.min(e,e*n,r,r*n),g=p(0,u,h),m=p(Rt,c,d),y=f(St,u,h),b=f(St+Rt,c,d);r=(g-y)/2,i=(m-b)/2,o=-(g+y)/2,s=-(m+b)/2}return{ratioX:r,ratioY:i,offsetX:o,offsetY:s}}s(yi,"id","bubble"),s(yi,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),s(yi,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});class vi extends ti{constructor(t,e){super(t,e),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,e){const n=this.getDataset().data,r=this._cachedMeta;if(!1===this._parsing)r._parsed=n;else{let i,o,s=t=>+n[t];if(nt(n[t])){const{key:t="value"}=this._parsing;s=e=>+wt(n[e],t)}for(i=t,o=t+e;i<o;++i)r._parsed[i]=s(i)}}_getRotation(){return Ut(this.options.rotation-90)}_getCircumference(){return Ut(this.options.circumference)}_getRotationExtents(){let t=Tt,e=-Tt;for(let n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)&&this.chart.getDatasetMeta(n).type===this._type){const r=this.chart.getDatasetMeta(n).controller,i=r._getRotation(),o=r._getCircumference();t=Math.min(t,i),e=Math.max(e,i+o)}return{rotation:t,circumference:e-t}}update(t){const e=this.chart,{chartArea:n}=e,r=this._cachedMeta,i=r.data,o=this.getMaxBorderWidth()+this.getMaxOffset(i)+this.options.spacing,s=Math.max((Math.min(n.width,n.height)-o)/2,0),a=Math.min(st(this.options.cutout,s),1),l=this._getRingWeight(this.index),{circumference:u,rotation:c}=this._getRotationExtents(),{ratioX:h,ratioY:d,offsetX:p,offsetY:f}=bi(c,u,a),g=(n.width-o)/h,m=(n.height-o)/d,y=Math.max(Math.min(g,m)/2,0),b=at(this.options.radius,y),v=Math.max(b*a,0),w=(b-v)/this._getVisibleDatasetWeightTotal();this.offsetX=p*b,this.offsetY=f*b,r.total=this.calculateTotal(),this.outerRadius=b-w*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-w*l,0),this.updateElements(i,0,i.length,t)}_circumference(t,e){const n=this.options,r=this._cachedMeta,i=this._getCircumference();return e&&n.animation.animateRotate||!this.chart.getDataVisibility(t)||null===r._parsed[t]||r.data[t].hidden?0:this.calculateCircumference(r._parsed[t]*i/Tt)}updateElements(t,e,n,r){const i="reset"===r,o=this.chart,s=o.chartArea,a=o.options,l=a.animation,u=(s.left+s.right)/2,c=(s.top+s.bottom)/2,h=i&&l.animateScale,d=h?0:this.innerRadius,p=h?0:this.outerRadius,{sharedOptions:f,includeOptions:g}=this._getSharedOptions(e,r);let m,y=this._getRotation();for(m=0;m<e;++m)y+=this._circumference(m,i);for(m=e;m<e+n;++m){const e=this._circumference(m,i),n=t[m],o={x:u+this.offsetX,y:c+this.offsetY,startAngle:y,endAngle:y+e,circumference:e,outerRadius:p,innerRadius:d};g&&(o.options=f||this.resolveDataElementOptions(m,n.active?"active":r)),y+=e,this.updateElement(n,m,o,r)}}calculateTotal(){const t=this._cachedMeta,e=t.data;let n,r=0;for(n=0;n<e.length;n++){const i=t._parsed[n];null===i||isNaN(i)||!this.chart.getDataVisibility(n)||e[n].hidden||(r+=Math.abs(i))}return r}calculateCircumference(t){const e=this._cachedMeta.total;return e>0&&!isNaN(t)?Tt*(Math.abs(t)/e):0}getLabelAndValue(t){const e=this._cachedMeta,n=this.chart,r=n.data.labels||[],i=Ee(e._parsed[t],n.options.locale);return{label:r[t]||"",value:i}}getMaxBorderWidth(t){let e=0;const n=this.chart;let r,i,o,s,a;if(!t)for(r=0,i=n.data.datasets.length;r<i;++r)if(n.isDatasetVisible(r)){o=n.getDatasetMeta(r),t=o.data,s=o.controller;break}if(!t)return 0;for(r=0,i=t.length;r<i;++r)a=s.resolveDataElementOptions(r),"inner"!==a.borderAlign&&(e=Math.max(e,a.borderWidth||0,a.hoverBorderWidth||0));return e}getMaxOffset(t){let e=0;for(let n=0,r=t.length;n<r;++n){const t=this.resolveDataElementOptions(n);e=Math.max(e,t.offset||0,t.hoverOffset||0)}return e}_getRingWeightOffset(t){let e=0;for(let n=0;n<t;++n)this.chart.isDatasetVisible(n)&&(e+=this._getRingWeight(n));return e}_getRingWeight(t){return Math.max(ot(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}s(vi,"id","doughnut"),s(vi,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),s(vi,"descriptors",{_scriptable:t=>"spacing"!==t,_indexable:t=>"spacing"!==t&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")}),s(vi,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:n,color:r}}=t.legend.options;return e.labels.map(((e,i)=>{const o=t.getDatasetMeta(0),s=o.controller.getStyle(i);return{text:e,fillStyle:s.backgroundColor,strokeStyle:s.borderColor,fontColor:r,lineWidth:s.borderWidth,pointStyle:n,hidden:!t.getDataVisibility(i),index:i}}))}return[]}},onClick(t,e,n){n.chart.toggleDataVisibility(e.index),n.chart.update()}}}});class wi extends ti{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const e=this._cachedMeta,{dataset:n,data:r=[],_dataset:i}=e,o=this.chart._animationsDisabled;let{start:s,count:a}=pe(e,r,o);this._drawStart=s,this._drawCount=a,fe(e)&&(s=0,a=r.length),n._chart=this.chart,n._datasetIndex=this.index,n._decimated=!!i._decimated,n.points=r;const l=this.resolveDatasetElementOptions(t);this.options.showLine||(l.borderWidth=0),l.segment=this.options.segment,this.updateElement(n,void 0,{animated:!o,options:l},t),this.updateElements(r,s,a,t)}updateElements(t,e,n,r){const i="reset"===r,{iScale:o,vScale:s,_stacked:a,_dataset:l}=this._cachedMeta,{sharedOptions:u,includeOptions:c}=this._getSharedOptions(e,r),h=o.axis,d=s.axis,{spanGaps:p,segment:f}=this.options,g=zt(p)?p:Number.POSITIVE_INFINITY,m=this.chart._animationsDisabled||i||"none"===r,y=e+n,b=t.length;let v=e>0&&this.getParsed(e-1);for(let w=0;w<b;++w){const n=t[w],p=m?n:{};if(w<e||w>=y){p.skip=!0;continue}const b=this.getParsed(w),x=tt(b[d]),k=p[h]=o.getPixelForValue(b[h],w),_=p[d]=i||x?s.getBasePixel():s.getPixelForValue(a?this.applyStack(s,b,a):b[d],w);p.skip=isNaN(k)||isNaN(_)||x,p.stop=w>0&&Math.abs(b[h]-v[h])>g,f&&(p.parsed=b,p.raw=l.data[w]),c&&(p.options=u||this.resolveDataElementOptions(w,n.active?"active":r)),m||this.updateElement(n,w,p,r),v=b}}getMaxOverflow(){const t=this._cachedMeta,e=t.dataset,n=e.options&&e.options.borderWidth||0,r=t.data||[];if(!r.length)return n;const i=r[0].size(this.resolveDataElementOptions(0)),o=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(n,i,o)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}s(wi,"id","line"),s(wi,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),s(wi,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class xi extends ti{constructor(t,e){super(t,e),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(t){const e=this._cachedMeta,n=this.chart,r=n.data.labels||[],i=Ee(e._parsed[t].r,n.options.locale);return{label:r[t]||"",value:i}}parseObjectData(t,e,n,r){return On.bind(this)(t,e,n,r)}update(t){const e=this._cachedMeta.data;this._updateRadius(),this.updateElements(e,0,e.length,t)}getMinMax(){const t=this._cachedMeta,e={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return t.data.forEach(((t,n)=>{const r=this.getParsed(n).r;!isNaN(r)&&this.chart.getDataVisibility(n)&&(r<e.min&&(e.min=r),r>e.max&&(e.max=r))})),e}_updateRadius(){const t=this.chart,e=t.chartArea,n=t.options,r=Math.min(e.right-e.left,e.bottom-e.top),i=Math.max(r/2,0),o=Math.max(n.cutoutPercentage?i/100*n.cutoutPercentage:1,0),s=(i-o)/t.getVisibleDatasetCount();this.outerRadius=i-s*this.index,this.innerRadius=this.outerRadius-s}updateElements(t,e,n,r){const i="reset"===r,o=this.chart,s=o.options,a=s.animation,l=this._cachedMeta.rScale,u=l.xCenter,c=l.yCenter,h=l.getIndexAngle(0)-.5*St;let d,p=h;const f=360/this.countVisibleElements();for(d=0;d<e;++d)p+=this._computeAngle(d,r,f);for(d=e;d<e+n;d++){const e=t[d];let n=p,s=p+this._computeAngle(d,r,f),g=o.getDataVisibility(d)?l.getDistanceFromCenterForValue(this.getParsed(d).r):0;p=s,i&&(a.animateScale&&(g=0),a.animateRotate&&(n=s=h));const m={x:u,y:c,innerRadius:0,outerRadius:g,startAngle:n,endAngle:s,options:this.resolveDataElementOptions(d,e.active?"active":r)};this.updateElement(e,d,m,r)}}countVisibleElements(){const t=this._cachedMeta;let e=0;return t.data.forEach(((t,n)=>{!isNaN(this.getParsed(n).r)&&this.chart.getDataVisibility(n)&&e++})),e}_computeAngle(t,e,n){return this.chart.getDataVisibility(t)?Ut(this.resolveDataElementOptions(t,e).angle||n):0}}s(xi,"id","polarArea"),s(xi,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),s(xi,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:n,color:r}}=t.legend.options;return e.labels.map(((e,i)=>{const o=t.getDatasetMeta(0),s=o.controller.getStyle(i);return{text:e,fillStyle:s.backgroundColor,strokeStyle:s.borderColor,fontColor:r,lineWidth:s.borderWidth,pointStyle:n,hidden:!t.getDataVisibility(i),index:i}}))}return[]}},onClick(t,e,n){n.chart.toggleDataVisibility(e.index),n.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});class ki extends vi{}s(ki,"id","pie"),s(ki,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});class _i extends ti{getLabelAndValue(t){const e=this._cachedMeta.vScale,n=this.getParsed(t);return{label:e.getLabels()[t],value:""+e.getLabelForValue(n[e.axis])}}parseObjectData(t,e,n,r){return On.bind(this)(t,e,n,r)}update(t){const e=this._cachedMeta,n=e.dataset,r=e.data||[],i=e.iScale.getLabels();if(n.points=r,"resize"!==t){const e=this.resolveDatasetElementOptions(t);this.options.showLine||(e.borderWidth=0);const o={_loop:!0,_fullLoop:i.length===r.length,options:e};this.updateElement(n,void 0,o,t)}this.updateElements(r,0,r.length,t)}updateElements(t,e,n,r){const i=this._cachedMeta.rScale,o="reset"===r;for(let s=e;s<e+n;s++){const e=t[s],n=this.resolveDataElementOptions(s,e.active?"active":r),a=i.getPointPositionForValue(s,this.getParsed(s).r),l=o?i.xCenter:a.x,u=o?i.yCenter:a.y,c={x:l,y:u,angle:a.angle,skip:isNaN(l)||isNaN(u),options:n};this.updateElement(e,s,c,r)}}}s(_i,"id","radar"),s(_i,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),s(_i,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});class Ii extends ti{getLabelAndValue(t){const e=this._cachedMeta,n=this.chart.data.labels||[],{xScale:r,yScale:i}=e,o=this.getParsed(t),s=r.getLabelForValue(o.x),a=i.getLabelForValue(o.y);return{label:n[t]||"",value:"("+s+", "+a+")"}}update(t){const e=this._cachedMeta,{data:n=[]}=e,r=this.chart._animationsDisabled;let{start:i,count:o}=pe(e,n,r);if(this._drawStart=i,this._drawCount=o,fe(e)&&(i=0,o=n.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:i,_dataset:o}=e;i._chart=this.chart,i._datasetIndex=this.index,i._decimated=!!o._decimated,i.points=n;const s=this.resolveDatasetElementOptions(t);s.segment=this.options.segment,this.updateElement(i,void 0,{animated:!r,options:s},t)}else this.datasetElementType&&(delete e.dataset,this.datasetElementType=!1);this.updateElements(n,i,o,t)}addElements(){const{showLine:t}=this.options;!this.datasetElementType&&t&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(t,e,n,r){const i="reset"===r,{iScale:o,vScale:s,_stacked:a,_dataset:l}=this._cachedMeta,u=this.resolveDataElementOptions(e,r),c=this.getSharedOptions(u),h=this.includeOptions(r,c),d=o.axis,p=s.axis,{spanGaps:f,segment:g}=this.options,m=zt(f)?f:Number.POSITIVE_INFINITY,y=this.chart._animationsDisabled||i||"none"===r;let b=e>0&&this.getParsed(e-1);for(let v=e;v<e+n;++v){const e=t[v],n=this.getParsed(v),u=y?e:{},f=tt(n[p]),w=u[d]=o.getPixelForValue(n[d],v),x=u[p]=i||f?s.getBasePixel():s.getPixelForValue(a?this.applyStack(s,n,a):n[p],v);u.skip=isNaN(w)||isNaN(x)||f,u.stop=v>0&&Math.abs(n[d]-b[d])>m,g&&(u.parsed=n,u.raw=l.data[v]),h&&(u.options=c||this.resolveDataElementOptions(v,e.active?"active":r)),y||this.updateElement(e,v,u,r),b=n}this.updateSharedOptions(c,r,u)}getMaxOverflow(){const t=this._cachedMeta,e=t.data||[];if(!this.options.showLine){let t=0;for(let n=e.length-1;n>=0;--n)t=Math.max(t,e[n].size(this.resolveDataElementOptions(n))/2);return t>0&&t}const n=t.dataset,r=n.options&&n.options.borderWidth||0;if(!e.length)return r;const i=e[0].size(this.resolveDataElementOptions(0)),o=e[e.length-1].size(this.resolveDataElementOptions(e.length-1));return Math.max(r,i,o)/2}}s(Ii,"id","scatter"),s(Ii,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),s(Ii,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});var Ci=Object.freeze({__proto__:null,BarController:mi,BubbleController:yi,DoughnutController:vi,LineController:wi,PieController:ki,PolarAreaController:xi,RadarController:_i,ScatterController:Ii});function Si(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Ti{static override(t){Object.assign(Ti.prototype,t)}constructor(t){s(this,"options",void 0),this.options=t||{}}init(){}formats(){return Si()}parse(){return Si()}format(){return Si()}add(){return Si()}diff(){return Si()}startOf(){return Si()}endOf(){return Si()}}var Ei={_date:Ti};function Ni(t,e,n,r){const{controller:i,data:o,_sorted:s}=t,a=i._cachedMeta.iScale;if(a&&e===a.axis&&"r"!==e&&s&&o.length){const t=a._reversePixels?ee:te;if(!r)return t(o,e,n);if(i._sharedOptions){const r=o[0],i="function"===typeof r.getRange&&r.getRange(e);if(i){const r=t(o,e,n-i),s=t(o,e,n+i);return{lo:r.lo,hi:s.hi}}}}return{lo:0,hi:o.length-1}}function Ai(t,e,n,r,i){const o=t.getSortedVisibleDatasetMetas(),s=n[e];for(let a=0,l=o.length;a<l;++a){const{index:t,data:n}=o[a],{lo:l,hi:u}=Ni(o[a],e,s,i);for(let e=l;e<=u;++e){const i=n[e];i.skip||r(i,t,e)}}}function Ri(t){const e=-1!==t.indexOf("x"),n=-1!==t.indexOf("y");return function(t,r){const i=e?Math.abs(t.x-r.x):0,o=n?Math.abs(t.y-r.y):0;return Math.sqrt(Math.pow(i,2)+Math.pow(o,2))}}function $i(t,e,n,r,i){const o=[];if(!i&&!t.isPointInArea(e))return o;const s=function(n,s,a){(i||Ge(n,t.chartArea,0))&&n.inRange(e.x,e.y,r)&&o.push({element:n,datasetIndex:s,index:a})};return Ai(t,n,e,s,!0),o}function Di(t,e,n,r){let i=[];function o(t,n,o){const{startAngle:s,endAngle:a}=t.getProps(["startAngle","endAngle"],r),{angle:l}=Ht(t,{x:e.x,y:e.y});Xt(l,s,a)&&i.push({element:t,datasetIndex:n,index:o})}return Ai(t,n,e,o),i}function Oi(t,e,n,r,i,o){let s=[];const a=Ri(n);let l=Number.POSITIVE_INFINITY;function u(n,u,c){const h=n.inRange(e.x,e.y,i);if(r&&!h)return;const d=n.getCenterPoint(i),p=!!o||t.isPointInArea(d);if(!p&&!h)return;const f=a(e,d);f<l?(s=[{element:n,datasetIndex:u,index:c}],l=f):f===l&&s.push({element:n,datasetIndex:u,index:c})}return Ai(t,n,e,u),s}function Fi(t,e,n,r,i,o){return o||t.isPointInArea(e)?"r"!==n||r?Oi(t,e,n,r,i,o):Di(t,e,n,i):[]}function Mi(t,e,n,r,i){const o=[],s="x"===n?"inXRange":"inYRange";let a=!1;return Ai(t,n,e,((t,r,l)=>{t[s](e[n],i)&&(o.push({element:t,datasetIndex:r,index:l}),a=a||t.inRange(e.x,e.y,i))})),r&&!a?[]:o}var Pi={evaluateInteractionItems:Ai,modes:{index(t,e,n,r){const i=tr(e,t),o=n.axis||"x",s=n.includeInvisible||!1,a=n.intersect?$i(t,i,o,r,s):Fi(t,i,o,!1,r,s),l=[];return a.length?(t.getSortedVisibleDatasetMetas().forEach((t=>{const e=a[0].index,n=t.data[e];n&&!n.skip&&l.push({element:n,datasetIndex:t.index,index:e})})),l):[]},dataset(t,e,n,r){const i=tr(e,t),o=n.axis||"xy",s=n.includeInvisible||!1;let a=n.intersect?$i(t,i,o,r,s):Fi(t,i,o,!1,r,s);if(a.length>0){const e=a[0].datasetIndex,n=t.getDatasetMeta(e).data;a=[];for(let t=0;t<n.length;++t)a.push({element:n[t],datasetIndex:e,index:t})}return a},point(t,e,n,r){const i=tr(e,t),o=n.axis||"xy",s=n.includeInvisible||!1;return $i(t,i,o,r,s)},nearest(t,e,n,r){const i=tr(e,t),o=n.axis||"xy",s=n.includeInvisible||!1;return Fi(t,i,o,n.intersect,r,s)},x(t,e,n,r){const i=tr(e,t);return Mi(t,i,"x",n.intersect,r)},y(t,e,n,r){const i=tr(e,t);return Mi(t,i,"y",n.intersect,r)}}};const Li=["left","top","right","bottom"];function zi(t,e){return t.filter((t=>t.pos===e))}function Bi(t,e){return t.filter((t=>-1===Li.indexOf(t.pos)&&t.box.axis===e))}function Wi(t,e){return t.sort(((t,n)=>{const r=e?n:t,i=e?t:n;return r.weight===i.weight?r.index-i.index:r.weight-i.weight}))}function Ui(t){const e=[];let n,r,i,o,s,a;for(n=0,r=(t||[]).length;n<r;++n)i=t[n],({position:o,options:{stack:s,stackWeight:a=1}}=i),e.push({index:n,box:i,pos:o,horizontal:i.isHorizontal(),weight:i.weight,stack:s&&o+s,stackWeight:a});return e}function Vi(t){const e={};for(const n of t){const{stack:t,pos:r,stackWeight:i}=n;if(!t||!Li.includes(r))continue;const o=e[t]||(e[t]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=i}return e}function ji(t,e){const n=Vi(t),{vBoxMaxWidth:r,hBoxMaxHeight:i}=e;let o,s,a;for(o=0,s=t.length;o<s;++o){a=t[o];const{fullSize:s}=a.box,l=n[a.stack],u=l&&a.stackWeight/l.weight;a.horizontal?(a.width=u?u*r:s&&e.availableWidth,a.height=i):(a.width=r,a.height=u?u*i:s&&e.availableHeight)}return n}function Hi(t){const e=Ui(t),n=Wi(e.filter((t=>t.box.fullSize)),!0),r=Wi(zi(e,"left"),!0),i=Wi(zi(e,"right")),o=Wi(zi(e,"top"),!0),s=Wi(zi(e,"bottom")),a=Bi(e,"x"),l=Bi(e,"y");return{fullSize:n,leftAndTop:r.concat(o),rightAndBottom:i.concat(l).concat(s).concat(a),chartArea:zi(e,"chartArea"),vertical:r.concat(i).concat(l),horizontal:o.concat(s).concat(a)}}function Gi(t,e,n,r){return Math.max(t[n],e[n])+Math.max(t[r],e[r])}function qi(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function Ki(t,e,n,r){const{pos:i,box:o}=n,s=t.maxPadding;if(!nt(i)){n.size&&(t[i]-=n.size);const e=r[n.stack]||{size:0,count:1};e.size=Math.max(e.size,n.horizontal?o.height:o.width),n.size=e.size/e.count,t[i]+=n.size}o.getPadding&&qi(s,o.getPadding());const a=Math.max(0,e.outerWidth-Gi(s,t,"left","right")),l=Math.max(0,e.outerHeight-Gi(s,t,"top","bottom")),u=a!==t.w,c=l!==t.h;return t.w=a,t.h=l,n.horizontal?{same:u,other:c}:{same:c,other:u}}function Xi(t){const e=t.maxPadding;function n(n){const r=Math.max(e[n]-t[n],0);return t[n]+=r,r}t.y+=n("top"),t.x+=n("left"),n("right"),n("bottom")}function Yi(t,e){const n=e.maxPadding;function r(t){const r={left:0,top:0,right:0,bottom:0};return t.forEach((t=>{r[t]=Math.max(e[t],n[t])})),r}return r(t?["left","right"]:["top","bottom"])}function Ji(t,e,n,r){const i=[];let o,s,a,l,u,c;for(o=0,s=t.length,u=0;o<s;++o){a=t[o],l=a.box,l.update(a.width||e.w,a.height||e.h,Yi(a.horizontal,e));const{same:s,other:h}=Ki(e,n,a,r);u|=s&&i.length,c=c||h,l.fullSize||i.push(a)}return u&&Ji(i,e,n,r)||c}function Zi(t,e,n,r,i){t.top=n,t.left=e,t.right=e+r,t.bottom=n+i,t.width=r,t.height=i}function Qi(t,e,n,r){const i=n.padding;let{x:o,y:s}=e;for(const a of t){const t=a.box,l=r[a.stack]||{count:1,placed:0,weight:1},u=a.stackWeight/l.weight||1;if(a.horizontal){const r=e.w*u,o=l.size||t.height;kt(l.start)&&(s=l.start),t.fullSize?Zi(t,i.left,s,n.outerWidth-i.right-i.left,o):Zi(t,e.left+l.placed,s,r,o),l.start=s,l.placed+=r,s=t.bottom}else{const r=e.h*u,s=l.size||t.width;kt(l.start)&&(o=l.start),t.fullSize?Zi(t,o,i.top,s,n.outerHeight-i.bottom-i.top):Zi(t,o,e.top+l.placed,s,r),l.start=o,l.placed+=r,o=t.right}}e.x=o,e.y=s}var to={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},t.boxes.push(e)},removeBox(t,e){const n=t.boxes?t.boxes.indexOf(e):-1;-1!==n&&t.boxes.splice(n,1)},configure(t,e,n){e.fullSize=n.fullSize,e.position=n.position,e.weight=n.weight},update(t,e,n,r){if(!t)return;const i=cn(t.options.layout.padding),o=Math.max(e-i.width,0),s=Math.max(n-i.height,0),a=Hi(t.boxes),l=a.vertical,u=a.horizontal;ut(t.boxes,(t=>{"function"===typeof t.beforeLayout&&t.beforeLayout()}));const c=l.reduce(((t,e)=>e.box.options&&!1===e.box.options.display?t:t+1),0)||1,h=Object.freeze({outerWidth:e,outerHeight:n,padding:i,availableWidth:o,availableHeight:s,vBoxMaxWidth:o/2/c,hBoxMaxHeight:s/2}),d=Object.assign({},i);qi(d,cn(r));const p=Object.assign({maxPadding:d,w:o,h:s,x:i.left,y:i.top},i),f=ji(l.concat(u),h);Ji(a.fullSize,p,h,f),Ji(l,p,h,f),Ji(u,p,h,f)&&Ji(l,p,h,f),Xi(p),Qi(a.leftAndTop,p,h,f),p.x+=p.w,p.y+=p.h,Qi(a.rightAndBottom,p,h,f),t.chartArea={left:p.left,top:p.top,right:p.left+p.w,bottom:p.top+p.h,height:p.h,width:p.w},ut(a.chartArea,(e=>{const n=e.box;Object.assign(n,t.chartArea),n.update(p.w,p.h,{left:0,top:0,right:0,bottom:0})}))}};class eo{acquireContext(t,e){}releaseContext(t){return!1}addEventListener(t,e,n){}removeEventListener(t,e,n){}getDevicePixelRatio(){return 1}getMaximumSize(t,e,n,r){return e=Math.max(0,e||t.width),n=n||t.height,{width:e,height:Math.max(0,r?Math.floor(e/r):n)}}isAttached(t){return!0}updateConfig(t){}}class no extends eo{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const ro="$chartjs",io={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},oo=t=>null===t||""===t;function so(t,e){const n=t.style,r=t.getAttribute("height"),i=t.getAttribute("width");if(t[ro]={initial:{height:r,width:i,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",oo(i)){const e=sr(t,"width");void 0!==e&&(t.width=e)}if(oo(r))if(""===t.style.height)t.height=t.width/(e||2);else{const e=sr(t,"height");void 0!==e&&(t.height=e)}return t}const ao=!!or&&{passive:!0};function lo(t,e,n){t.addEventListener(e,n,ao)}function uo(t,e,n){t.canvas.removeEventListener(e,n,ao)}function co(t,e){const n=io[t.type]||t.type,{x:r,y:i}=tr(t,e);return{type:n,chart:e,native:t,x:void 0!==r?r:null,y:void 0!==i?i:null}}function ho(t,e){for(const n of t)if(n===e||n.contains(e))return!0}function po(t,e,n){const r=t.canvas,i=new MutationObserver((t=>{let e=!1;for(const n of t)e=e||ho(n.addedNodes,r),e=e&&!ho(n.removedNodes,r);e&&n()}));return i.observe(document,{childList:!0,subtree:!0}),i}function fo(t,e,n){const r=t.canvas,i=new MutationObserver((t=>{let e=!1;for(const n of t)e=e||ho(n.removedNodes,r),e=e&&!ho(n.addedNodes,r);e&&n()}));return i.observe(document,{childList:!0,subtree:!0}),i}const go=new Map;let mo=0;function yo(){const t=window.devicePixelRatio;t!==mo&&(mo=t,go.forEach(((e,n)=>{n.currentDevicePixelRatio!==t&&e()})))}function bo(t,e){go.size||window.addEventListener("resize",yo),go.set(t,e)}function vo(t){go.delete(t),go.size||window.removeEventListener("resize",yo)}function wo(t,e,n){const r=t.canvas,i=r&&Gn(r);if(!i)return;const o=le(((t,e)=>{const r=i.clientWidth;n(t,e),r<i.clientWidth&&n()}),window),s=new ResizeObserver((t=>{const e=t[0],n=e.contentRect.width,r=e.contentRect.height;0===n&&0===r||o(n,r)}));return s.observe(i),bo(t,o),s}function xo(t,e,n){n&&n.disconnect(),"resize"===e&&vo(t)}function ko(t,e,n){const r=t.canvas,i=le((e=>{null!==t.ctx&&n(co(e,t))}),t);return lo(r,e,i),i}class _o extends eo{acquireContext(t,e){const n=t&&t.getContext&&t.getContext("2d");return n&&n.canvas===t?(so(t,e),n):null}releaseContext(t){const e=t.canvas;if(!e[ro])return!1;const n=e[ro].initial;["height","width"].forEach((t=>{const r=n[t];tt(r)?e.removeAttribute(t):e.setAttribute(t,r)}));const r=n.style||{};return Object.keys(r).forEach((t=>{e.style[t]=r[t]})),e.width=e.width,delete e[ro],!0}addEventListener(t,e,n){this.removeEventListener(t,e);const r=t.$proxies||(t.$proxies={}),i={attach:po,detach:fo,resize:wo},o=i[e]||ko;r[e]=o(t,e,n)}removeEventListener(t,e){const n=t.$proxies||(t.$proxies={}),r=n[e];if(!r)return;const i={attach:xo,detach:xo,resize:xo},o=i[e]||uo;o(t,e,r),n[e]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,e,n,r){return rr(t,e,n,r)}isAttached(t){const e=Gn(t);return!(!e||!e.isConnected)}}function Io(t){return!Hn()||"undefined"!==typeof OffscreenCanvas&&t instanceof OffscreenCanvas?no:_o}class Co{constructor(){s(this,"x",void 0),s(this,"y",void 0),s(this,"active",!1),s(this,"options",void 0),s(this,"$animations",void 0)}tooltipPosition(t){const{x:e,y:n}=this.getProps(["x","y"],t);return{x:e,y:n}}hasValue(){return zt(this.x)&&zt(this.y)}getProps(t,e){const n=this.$animations;if(!e||!n)return this;const r={};return t.forEach((t=>{r[t]=n[t]&&n[t].active()?n[t]._to:this[t]})),r}}function So(t,e){const n=t.options.ticks,r=To(t),i=Math.min(n.maxTicksLimit||r,r),o=n.major.enabled?No(e):[],s=o.length,a=o[0],l=o[s-1],u=[];if(s>i)return Ao(e,u,o,s/i),u;const c=Eo(o,e,i);if(s>0){let t,n;const r=s>1?Math.round((l-a)/(s-1)):null;for(Ro(e,u,c,tt(r)?0:a-r,a),t=0,n=s-1;t<n;t++)Ro(e,u,c,o[t],o[t+1]);return Ro(e,u,c,l,tt(r)?e.length:l+r),u}return Ro(e,u,c),u}function To(t){const e=t.options.offset,n=t._tickSize(),r=t._length/n+(e?0:1),i=t._maxLength/n;return Math.floor(Math.min(r,i))}function Eo(t,e,n){const r=$o(t),i=e.length/n;if(!r)return Math.max(i,1);const o=Lt(r);for(let s=0,a=o.length-1;s<a;s++){const t=o[s];if(t>i)return t}return Math.max(i,1)}function No(t){const e=[];let n,r;for(n=0,r=t.length;n<r;n++)t[n].major&&e.push(n);return e}function Ao(t,e,n,r){let i,o=0,s=n[0];for(r=Math.ceil(r),i=0;i<t.length;i++)i===s&&(e.push(t[i]),o++,s=n[o*r])}function Ro(t,e,n,r,i){const o=ot(r,0),s=Math.min(ot(i,t.length),t.length);let a,l,u,c=0;n=Math.ceil(n),i&&(a=i-r,n=a/Math.floor(a/n)),u=o;while(u<0)c++,u=Math.round(o+c*n);for(l=Math.max(o,0);l<s;l++)l===u&&(e.push(t[l]),c++,u=Math.round(o+c*n))}function $o(t){const e=t.length;let n,r;if(e<2)return!1;for(r=t[0],n=1;n<e;++n)if(t[n]-t[n-1]!==r)return!1;return r}s(Co,"defaults",{}),s(Co,"defaultRoutes",void 0);const Do=t=>"left"===t?"right":"right"===t?"left":t,Oo=(t,e,n)=>"top"===e||"left"===e?t[e]+n:t[e]-n,Fo=(t,e)=>Math.min(e||t,t);function Mo(t,e){const n=[],r=t.length/e,i=t.length;let o=0;for(;o<i;o+=r)n.push(t[Math.floor(o)]);return n}function Po(t,e,n){const r=t.ticks.length,i=Math.min(e,r-1),o=t._startPixel,s=t._endPixel,a=1e-6;let l,u=t.getPixelForTick(i);if(!(n&&(l=1===r?Math.max(u-o,s-u):0===e?(t.getPixelForTick(1)-u)/2:(u-t.getPixelForTick(i-1))/2,u+=i<e?l:-l,u<o-a||u>s+a)))return u}function Lo(t,e){ut(t,(t=>{const n=t.gc,r=n.length/2;let i;if(r>e){for(i=0;i<r;++i)delete t.data[n[i]];n.splice(0,r)}}))}function zo(t){return t.drawTicks?t.tickLength:0}function Bo(t,e){if(!t.display)return 0;const n=hn(t.font,e),r=cn(t.padding),i=et(t.text)?t.text.length:1;return i*n.lineHeight+r.height}function Wo(t,e){return fn(t,{scale:e,type:"scale"})}function Uo(t,e,n){return fn(t,{tick:n,index:e,type:"tick"})}function Vo(t,e,n){let r=ce(t);return(n&&"right"!==e||!n&&"right"===e)&&(r=Do(r)),r}function jo(t,e,n,r){const{top:i,left:o,bottom:s,right:a,chart:l}=t,{chartArea:u,scales:c}=l;let h,d,p,f=0;const g=s-i,m=a-o;if(t.isHorizontal()){if(d=he(r,o,a),nt(n)){const t=Object.keys(n)[0],r=n[t];p=c[t].getPixelForValue(r)+g-e}else p="center"===n?(u.bottom+u.top)/2+g-e:Oo(t,n,e);h=a-o}else{if(nt(n)){const t=Object.keys(n)[0],r=n[t];d=c[t].getPixelForValue(r)-m+e}else d="center"===n?(u.left+u.right)/2-m+e:Oo(t,n,e);p=he(r,s,i),f="left"===n?-Rt:Rt}return{titleX:d,titleY:p,maxWidth:h,rotation:f}}class Ho extends Co{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,e){return t}getUserBounds(){let{_userMin:t,_userMax:e,_suggestedMin:n,_suggestedMax:r}=this;return t=it(t,Number.POSITIVE_INFINITY),e=it(e,Number.NEGATIVE_INFINITY),n=it(n,Number.POSITIVE_INFINITY),r=it(r,Number.NEGATIVE_INFINITY),{min:it(t,n),max:it(e,r),minDefined:rt(t),maxDefined:rt(e)}}getMinMax(t){let e,{min:n,max:r,minDefined:i,maxDefined:o}=this.getUserBounds();if(i&&o)return{min:n,max:r};const s=this.getMatchingVisibleMetas();for(let a=0,l=s.length;a<l;++a)e=s[a].controller.getMinMax(this,t),i||(n=Math.min(n,e.min)),o||(r=Math.max(r,e.max));return n=o&&n>r?r:n,r=i&&n>r?n:r,{min:it(n,it(r,n)),max:it(r,it(n,r))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){const e=this._labelItems||(this._labelItems=this._computeLabelItems(t));return e}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){lt(this.options.beforeUpdate,[this])}update(t,e,n){const{beginAtZero:r,grace:i,ticks:o}=this.options,s=o.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=e,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=pn(this,i,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const a=s<this.ticks.length;this._convertTicksToLabels(a?Mo(this.ticks,s):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||"auto"===o.source)&&(this.ticks=So(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),a&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t,e,n=this.options.reverse;this.isHorizontal()?(t=this.left,e=this.right):(t=this.top,e=this.bottom,n=!n),this._startPixel=t,this._endPixel=e,this._reversePixels=n,this._length=e-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){lt(this.options.afterUpdate,[this])}beforeSetDimensions(){lt(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){lt(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),lt(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){lt(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const e=this.options.ticks;let n,r,i;for(n=0,r=t.length;n<r;n++)i=t[n],i.label=lt(e.callback,[i.value,n,t],this)}afterTickToLabelConversion(){lt(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){lt(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,e=t.ticks,n=Fo(this.ticks.length,t.ticks.maxTicksLimit),r=e.minRotation||0,i=e.maxRotation;let o,s,a,l=r;if(!this._isVisible()||!e.display||r>=i||n<=1||!this.isHorizontal())return void(this.labelRotation=r);const u=this._getLabelSizes(),c=u.widest.width,h=u.highest.height,d=Yt(this.chart.width-c,0,this.maxWidth);o=t.offset?this.maxWidth/n:d/(n-1),c+6>o&&(o=d/(n-(t.offset?.5:1)),s=this.maxHeight-zo(t.grid)-e.padding-Bo(t.title,this.chart.options.font),a=Math.sqrt(c*c+h*h),l=Vt(Math.min(Math.asin(Yt((u.highest.height+6)/o,-1,1)),Math.asin(Yt(s/a,-1,1))-Math.asin(Yt(h/a,-1,1)))),l=Math.max(r,Math.min(i,l))),this.labelRotation=l}afterCalculateLabelRotation(){lt(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){lt(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:e,options:{ticks:n,title:r,grid:i}}=this,o=this._isVisible(),s=this.isHorizontal();if(o){const o=Bo(r,e.options.font);if(s?(t.width=this.maxWidth,t.height=zo(i)+o):(t.height=this.maxHeight,t.width=zo(i)+o),n.display&&this.ticks.length){const{first:e,last:r,widest:i,highest:o}=this._getLabelSizes(),a=2*n.padding,l=Ut(this.labelRotation),u=Math.cos(l),c=Math.sin(l);if(s){const e=n.mirror?0:c*i.width+u*o.height;t.height=Math.min(this.maxHeight,t.height+e+a)}else{const e=n.mirror?0:u*i.width+c*o.height;t.width=Math.min(this.maxWidth,t.width+e+a)}this._calculatePadding(e,r,c,u)}}this._handleMargins(),s?(this.width=this._length=e.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=e.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,e,n,r){const{ticks:{align:i,padding:o},position:s}=this.options,a=0!==this.labelRotation,l="top"!==s&&"x"===this.axis;if(this.isHorizontal()){const s=this.getPixelForTick(0)-this.left,u=this.right-this.getPixelForTick(this.ticks.length-1);let c=0,h=0;a?l?(c=r*t.width,h=n*e.height):(c=n*t.height,h=r*e.width):"start"===i?h=e.width:"end"===i?c=t.width:"inner"!==i&&(c=t.width/2,h=e.width/2),this.paddingLeft=Math.max((c-s+o)*this.width/(this.width-s),0),this.paddingRight=Math.max((h-u+o)*this.width/(this.width-u),0)}else{let n=e.height/2,r=t.height/2;"start"===i?(n=0,r=t.height):"end"===i&&(n=e.height,r=0),this.paddingTop=n+o,this.paddingBottom=r+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){lt(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:e}=this.options;return"top"===e||"bottom"===e||"x"===t}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){let e,n;for(this.beforeTickToLabelConversion(),this.generateTickLabels(t),e=0,n=t.length;e<n;e++)tt(t[e].label)&&(t.splice(e,1),n--,e--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const e=this.options.ticks.sampleSize;let n=this.ticks;e<n.length&&(n=Mo(n,e)),this._labelSizes=t=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,e,n){const{ctx:r,_longestTextCache:i}=this,o=[],s=[],a=Math.floor(e/Fo(e,n));let l,u,c,h,d,p,f,g,m,y,b,v=0,w=0;for(l=0;l<e;l+=a){if(h=t[l].label,d=this._resolveTickFontOptions(l),r.font=p=d.string,f=i[p]=i[p]||{data:{},gc:[]},g=d.lineHeight,m=y=0,tt(h)||et(h)){if(et(h))for(u=0,c=h.length;u<c;++u)b=h[u],tt(b)||et(b)||(m=Be(r,f.data,f.gc,m,b),y+=g)}else m=Be(r,f.data,f.gc,m,h),y=g;o.push(m),s.push(y),v=Math.max(m,v),w=Math.max(y,w)}Lo(i,e);const x=o.indexOf(v),k=s.indexOf(w),_=t=>({width:o[t]||0,height:s[t]||0});return{first:_(0),last:_(e-1),widest:_(x),highest:_(k),widths:o,heights:s}}getLabelForValue(t){return t}getPixelForValue(t,e){return NaN}getValueForPixel(t){}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const e=this._startPixel+t*this._length;return Jt(this._alignToPixels?Ue(this.chart,e,0):e)}getDecimalForPixel(t){const e=(t-this._startPixel)/this._length;return this._reversePixels?1-e:e}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:e}=this;return t<0&&e<0?e:t>0&&e>0?t:0}getContext(t){const e=this.ticks||[];if(t>=0&&t<e.length){const n=e[t];return n.$context||(n.$context=Uo(this.getContext(),t,n))}return this.$context||(this.$context=Wo(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,e=Ut(this.labelRotation),n=Math.abs(Math.cos(e)),r=Math.abs(Math.sin(e)),i=this._getLabelSizes(),o=t.autoSkipPadding||0,s=i?i.widest.width+o:0,a=i?i.highest.height+o:0;return this.isHorizontal()?a*n>s*r?s/n:a/r:a*r<s*n?a/n:s/r}_isVisible(){const t=this.options.display;return"auto"!==t?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const e=this.axis,n=this.chart,r=this.options,{grid:i,position:o,border:s}=r,a=i.offset,l=this.isHorizontal(),u=this.ticks,c=u.length+(a?1:0),h=zo(i),d=[],p=s.setContext(this.getContext()),f=p.display?p.width:0,g=f/2,m=function(t){return Ue(n,t,f)};let y,b,v,w,x,k,_,I,C,S,T,E;if("top"===o)y=m(this.bottom),k=this.bottom-h,I=y-g,S=m(t.top)+g,E=t.bottom;else if("bottom"===o)y=m(this.top),S=t.top,E=m(t.bottom)-g,k=y+g,I=this.top+h;else if("left"===o)y=m(this.right),x=this.right-h,_=y-g,C=m(t.left)+g,T=t.right;else if("right"===o)y=m(this.left),C=t.left,T=m(t.right)-g,x=y+g,_=this.left+h;else if("x"===e){if("center"===o)y=m((t.top+t.bottom)/2+.5);else if(nt(o)){const t=Object.keys(o)[0],e=o[t];y=m(this.chart.scales[t].getPixelForValue(e))}S=t.top,E=t.bottom,k=y+g,I=k+h}else if("y"===e){if("center"===o)y=m((t.left+t.right)/2);else if(nt(o)){const t=Object.keys(o)[0],e=o[t];y=m(this.chart.scales[t].getPixelForValue(e))}x=y-g,_=x-h,C=t.left,T=t.right}const N=ot(r.ticks.maxTicksLimit,c),A=Math.max(1,Math.ceil(c/N));for(b=0;b<c;b+=A){const t=this.getContext(b),e=i.setContext(t),r=s.setContext(t),o=e.lineWidth,u=e.color,c=r.dash||[],h=r.dashOffset,p=e.tickWidth,f=e.tickColor,g=e.tickBorderDash||[],m=e.tickBorderDashOffset;v=Po(this,b,a),void 0!==v&&(w=Ue(n,v,o),l?x=_=C=T=w:k=I=S=E=w,d.push({tx1:x,ty1:k,tx2:_,ty2:I,x1:C,y1:S,x2:T,y2:E,width:o,color:u,borderDash:c,borderDashOffset:h,tickWidth:p,tickColor:f,tickBorderDash:g,tickBorderDashOffset:m}))}return this._ticksLength=c,this._borderValue=y,d}_computeLabelItems(t){const e=this.axis,n=this.options,{position:r,ticks:i}=n,o=this.isHorizontal(),s=this.ticks,{align:a,crossAlign:l,padding:u,mirror:c}=i,h=zo(n.grid),d=h+u,p=c?-u:d,f=-Ut(this.labelRotation),g=[];let m,y,b,v,w,x,k,_,I,C,S,T,E="middle";if("top"===r)x=this.bottom-p,k=this._getXAxisLabelAlignment();else if("bottom"===r)x=this.top+p,k=this._getXAxisLabelAlignment();else if("left"===r){const t=this._getYAxisLabelAlignment(h);k=t.textAlign,w=t.x}else if("right"===r){const t=this._getYAxisLabelAlignment(h);k=t.textAlign,w=t.x}else if("x"===e){if("center"===r)x=(t.top+t.bottom)/2+d;else if(nt(r)){const t=Object.keys(r)[0],e=r[t];x=this.chart.scales[t].getPixelForValue(e)+d}k=this._getXAxisLabelAlignment()}else if("y"===e){if("center"===r)w=(t.left+t.right)/2-d;else if(nt(r)){const t=Object.keys(r)[0],e=r[t];w=this.chart.scales[t].getPixelForValue(e)}k=this._getYAxisLabelAlignment(h).textAlign}"y"===e&&("start"===a?E="top":"end"===a&&(E="bottom"));const N=this._getLabelSizes();for(m=0,y=s.length;m<y;++m){b=s[m],v=b.label;const t=i.setContext(this.getContext(m));_=this.getPixelForTick(m)+i.labelOffset,I=this._resolveTickFontOptions(m),C=I.lineHeight,S=et(v)?v.length:1;const e=S/2,n=t.color,a=t.textStrokeColor,u=t.textStrokeWidth;let h,d=k;if(o?(w=_,"inner"===k&&(d=m===y-1?this.options.reverse?"left":"right":0===m?this.options.reverse?"right":"left":"center"),T="top"===r?"near"===l||0!==f?-S*C+C/2:"center"===l?-N.highest.height/2-e*C+C:-N.highest.height+C/2:"near"===l||0!==f?C/2:"center"===l?N.highest.height/2-e*C:N.highest.height-S*C,c&&(T*=-1),0===f||t.showLabelBackdrop||(w+=C/2*Math.sin(f))):(x=_,T=(1-S)*C/2),t.showLabelBackdrop){const e=cn(t.backdropPadding),n=N.heights[m],r=N.widths[m];let i=T-e.top,o=0-e.left;switch(E){case"middle":i-=n/2;break;case"bottom":i-=n;break}switch(k){case"center":o-=r/2;break;case"right":o-=r;break;case"inner":m===y-1?o-=r:m>0&&(o-=r/2);break}h={left:o,top:i,width:r+e.width,height:n+e.height,color:t.backdropColor}}g.push({label:v,font:I,textOffset:T,options:{rotation:f,color:n,strokeColor:a,strokeWidth:u,textAlign:d,textBaseline:E,translation:[w,x],backdrop:h}})}return g}_getXAxisLabelAlignment(){const{position:t,ticks:e}=this.options,n=-Ut(this.labelRotation);if(n)return"top"===t?"left":"right";let r="center";return"start"===e.align?r="left":"end"===e.align?r="right":"inner"===e.align&&(r="inner"),r}_getYAxisLabelAlignment(t){const{position:e,ticks:{crossAlign:n,mirror:r,padding:i}}=this.options,o=this._getLabelSizes(),s=t+i,a=o.widest.width;let l,u;return"left"===e?r?(u=this.right+i,"near"===n?l="left":"center"===n?(l="center",u+=a/2):(l="right",u+=a)):(u=this.right-s,"near"===n?l="right":"center"===n?(l="center",u-=a/2):(l="left",u=this.left)):"right"===e?r?(u=this.left+i,"near"===n?l="right":"center"===n?(l="center",u-=a/2):(l="left",u-=a)):(u=this.left+s,"near"===n?l="left":"center"===n?(l="center",u+=a/2):(l="right",u=this.right)):l="right",{textAlign:l,x:u}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,e=this.options.position;return"left"===e||"right"===e?{top:0,left:this.left,bottom:t.height,right:this.right}:"top"===e||"bottom"===e?{top:this.top,left:0,bottom:this.bottom,right:t.width}:void 0}drawBackground(){const{ctx:t,options:{backgroundColor:e},left:n,top:r,width:i,height:o}=this;e&&(t.save(),t.fillStyle=e,t.fillRect(n,r,i,o),t.restore())}getLineWidthForValue(t){const e=this.options.grid;if(!this._isVisible()||!e.display)return 0;const n=this.ticks,r=n.findIndex((e=>e.value===t));if(r>=0){const t=e.setContext(this.getContext(r));return t.lineWidth}return 0}drawGrid(t){const e=this.options.grid,n=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let i,o;const s=(t,e,r)=>{r.width&&r.color&&(n.save(),n.lineWidth=r.width,n.strokeStyle=r.color,n.setLineDash(r.borderDash||[]),n.lineDashOffset=r.borderDashOffset,n.beginPath(),n.moveTo(t.x,t.y),n.lineTo(e.x,e.y),n.stroke(),n.restore())};if(e.display)for(i=0,o=r.length;i<o;++i){const t=r[i];e.drawOnChartArea&&s({x:t.x1,y:t.y1},{x:t.x2,y:t.y2},t),e.drawTicks&&s({x:t.tx1,y:t.ty1},{x:t.tx2,y:t.ty2},{color:t.tickColor,width:t.tickWidth,borderDash:t.tickBorderDash,borderDashOffset:t.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:e,options:{border:n,grid:r}}=this,i=n.setContext(this.getContext()),o=n.display?i.width:0;if(!o)return;const s=r.setContext(this.getContext(0)).lineWidth,a=this._borderValue;let l,u,c,h;this.isHorizontal()?(l=Ue(t,this.left,o)-o/2,u=Ue(t,this.right,s)+s/2,c=h=a):(c=Ue(t,this.top,o)-o/2,h=Ue(t,this.bottom,s)+s/2,l=u=a),e.save(),e.lineWidth=i.width,e.strokeStyle=i.color,e.beginPath(),e.moveTo(l,c),e.lineTo(u,h),e.stroke(),e.restore()}drawLabels(t){const e=this.options.ticks;if(!e.display)return;const n=this.ctx,r=this._computeLabelArea();r&&qe(n,r);const i=this.getLabelItems(t);for(const o of i){const t=o.options,e=o.font,r=o.label,i=o.textOffset;tn(n,r,0,i,e,t)}r&&Ke(n)}drawTitle(){const{ctx:t,options:{position:e,title:n,reverse:r}}=this;if(!n.display)return;const i=hn(n.font),o=cn(n.padding),s=n.align;let a=i.lineHeight/2;"bottom"===e||"center"===e||nt(e)?(a+=o.bottom,et(n.text)&&(a+=i.lineHeight*(n.text.length-1))):a+=o.top;const{titleX:l,titleY:u,maxWidth:c,rotation:h}=jo(this,a,e,s);tn(t,n.text,0,0,i,{color:n.color,maxWidth:c,rotation:h,textAlign:Vo(s,e,r),textBaseline:"middle",translation:[l,u]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,e=t.ticks&&t.ticks.z||0,n=ot(t.grid&&t.grid.z,-1),r=ot(t.border&&t.border.z,0);return this._isVisible()&&this.draw===Ho.prototype.draw?[{z:n,draw:t=>{this.drawBackground(),this.drawGrid(t),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:e,draw:t=>{this.drawLabels(t)}}]:[{z:e,draw:t=>{this.draw(t)}}]}getMatchingVisibleMetas(t){const e=this.chart.getSortedVisibleDatasetMetas(),n=this.axis+"AxisID",r=[];let i,o;for(i=0,o=e.length;i<o;++i){const o=e[i];o[n]!==this.id||t&&o.type!==t||r.push(o)}return r}_resolveTickFontOptions(t){const e=this.options.ticks.setContext(this.getContext(t));return hn(e.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class Go{constructor(t,e,n){this.type=t,this.scope=e,this.override=n,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const e=Object.getPrototypeOf(t);let n;Xo(e)&&(n=this.register(e));const r=this.items,i=t.id,o=this.scope+"."+i;if(!i)throw new Error("class does not have id: "+t);return i in r||(r[i]=t,qo(t,o,n),this.override&&Le.override(t.id,t.overrides)),o}get(t){return this.items[t]}unregister(t){const e=this.items,n=t.id,r=this.scope;n in e&&delete e[n],r&&n in Le[r]&&(delete Le[r][n],this.override&&delete De[n])}}function qo(t,e,n){const r=ft(Object.create(null),[n?Le.get(n):{},Le.get(e),t.defaults]);Le.set(e,r),t.defaultRoutes&&Ko(e,t.defaultRoutes),t.descriptors&&Le.describe(e,t.descriptors)}function Ko(t,e){Object.keys(e).forEach((n=>{const r=n.split("."),i=r.pop(),o=[t].concat(r).join("."),s=e[n].split("."),a=s.pop(),l=s.join(".");Le.route(o,i,l,a)}))}function Xo(t){return"id"in t&&"defaults"in t}class Yo{constructor(){this.controllers=new Go(ti,"datasets",!0),this.elements=new Go(Co,"elements"),this.plugins=new Go(Object,"plugins"),this.scales=new Go(Ho,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,e,n){[...e].forEach((e=>{const r=n||this._getRegistryForType(e);n||r.isForType(e)||r===this.plugins&&e.id?this._exec(t,r,e):ut(e,(e=>{const r=n||this._getRegistryForType(e);this._exec(t,r,e)}))}))}_exec(t,e,n){const r=xt(t);lt(n["before"+r],[],n),e[t](n),lt(n["after"+r],[],n)}_getRegistryForType(t){for(let e=0;e<this._typedRegistries.length;e++){const n=this._typedRegistries[e];if(n.isForType(t))return n}return this.plugins}_get(t,e,n){const r=e.get(t);if(void 0===r)throw new Error('"'+t+'" is not a registered '+n+".");return r}}var Jo=new Yo;class Zo{constructor(){this._init=[]}notify(t,e,n,r){"beforeInit"===e&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install"));const i=r?this._descriptors(t).filter(r):this._descriptors(t),o=this._notify(i,t,e,n);return"afterDestroy"===e&&(this._notify(i,t,"stop"),this._notify(this._init,t,"uninstall")),o}_notify(t,e,n,r){r=r||{};for(const i of t){const t=i.plugin,o=t[n],s=[e,r,i.options];if(!1===lt(o,s,t)&&r.cancelable)return!1}return!0}invalidate(){tt(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const e=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),e}_createDescriptors(t,e){const n=t&&t.config,r=ot(n.options&&n.options.plugins,{}),i=Qo(n);return!1!==r||e?es(t,i,r,e):[]}_notifyStateChanges(t){const e=this._oldCache||[],n=this._cache,r=(t,e)=>t.filter((t=>!e.some((e=>t.plugin.id===e.plugin.id))));this._notify(r(e,n),t,"stop"),this._notify(r(n,e),t,"start")}}function Qo(t){const e={},n=[],r=Object.keys(Jo.plugins.items);for(let o=0;o<r.length;o++)n.push(Jo.getPlugin(r[o]));const i=t.plugins||[];for(let o=0;o<i.length;o++){const t=i[o];-1===n.indexOf(t)&&(n.push(t),e[t.id]=!0)}return{plugins:n,localIds:e}}function ts(t,e){return e||!1!==t?!0===t?{}:t:null}function es(t,{plugins:e,localIds:n},r,i){const o=[],s=t.getContext();for(const a of e){const e=a.id,l=ts(r[e],i);null!==l&&o.push({plugin:a,options:ns(t.config,{plugin:a,local:n[e]},l,s)})}return o}function ns(t,{plugin:e,local:n},r,i){const o=t.pluginScopeKeys(e),s=t.getOptionScopes(r,o);return n&&e.defaults&&s.push(e.defaults),t.createResolver(s,i,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function rs(t,e){const n=Le.datasets[t]||{},r=(e.datasets||{})[t]||{};return r.indexAxis||e.indexAxis||n.indexAxis||"x"}function is(t,e){let n=t;return"_index_"===t?n=e:"_value_"===t&&(n="x"===e?"y":"x"),n}function os(t,e){return t===e?"_index_":"_value_"}function ss(t){if("x"===t||"y"===t||"r"===t)return t}function as(t){return"top"===t||"bottom"===t?"x":"left"===t||"right"===t?"y":void 0}function ls(t,...e){if(ss(t))return t;for(const n of e){const e=n.axis||as(n.position)||t.length>1&&ss(t[0].toLowerCase());if(e)return e}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function us(t,e,n){if(n[e+"AxisID"]===t)return{axis:e}}function cs(t,e){if(e.data&&e.data.datasets){const n=e.data.datasets.filter((e=>e.xAxisID===t||e.yAxisID===t));if(n.length)return us(t,"x",n[0])||us(t,"y",n[0])}return{}}function hs(t,e){const n=De[t.type]||{scales:{}},r=e.scales||{},i=rs(t.type,e),o=Object.create(null);return Object.keys(r).forEach((e=>{const s=r[e];if(!nt(s))return console.error(`Invalid scale configuration for scale: ${e}`);if(s._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${e}`);const a=ls(e,s,cs(e,t),Le.scales[s.type]),l=os(a,i),u=n.scales||{};o[e]=gt(Object.create(null),[{axis:a},s,u[a],u[l]])})),t.data.datasets.forEach((n=>{const i=n.type||t.type,s=n.indexAxis||rs(i,e),a=De[i]||{},l=a.scales||{};Object.keys(l).forEach((t=>{const e=is(t,s),i=n[e+"AxisID"]||e;o[i]=o[i]||Object.create(null),gt(o[i],[{axis:e},r[i],l[t]])}))})),Object.keys(o).forEach((t=>{const e=o[t];gt(e,[Le.scales[e.type],Le.scale])})),o}function ds(t){const e=t.options||(t.options={});e.plugins=ot(e.plugins,{}),e.scales=hs(t,e)}function ps(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function fs(t){return t=t||{},t.data=ps(t.data),ds(t),t}const gs=new Map,ms=new Set;function ys(t,e){let n=gs.get(t);return n||(n=e(),gs.set(t,n),ms.add(n)),n}const bs=(t,e,n)=>{const r=wt(e,n);void 0!==r&&t.add(r)};class vs{constructor(t){this._config=fs(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=ps(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),ds(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return ys(t,(()=>[[`datasets.${t}`,""]]))}datasetAnimationScopeKeys(t,e){return ys(`${t}.transition.${e}`,(()=>[[`datasets.${t}.transitions.${e}`,`transitions.${e}`],[`datasets.${t}`,""]]))}datasetElementScopeKeys(t,e){return ys(`${t}-${e}`,(()=>[[`datasets.${t}.elements.${e}`,`datasets.${t}`,`elements.${e}`,""]]))}pluginScopeKeys(t){const e=t.id,n=this.type;return ys(`${n}-plugin-${e}`,(()=>[[`plugins.${e}`,...t.additionalOptionScopes||[]]]))}_cachedScopes(t,e){const n=this._scopeCache;let r=n.get(t);return r&&!e||(r=new Map,n.set(t,r)),r}getOptionScopes(t,e,n){const{options:r,type:i}=this,o=this._cachedScopes(t,n),s=o.get(e);if(s)return s;const a=new Set;e.forEach((e=>{t&&(a.add(t),e.forEach((e=>bs(a,t,e)))),e.forEach((t=>bs(a,r,t))),e.forEach((t=>bs(a,De[i]||{},t))),e.forEach((t=>bs(a,Le,t))),e.forEach((t=>bs(a,Oe,t)))}));const l=Array.from(a);return 0===l.length&&l.push(Object.create(null)),ms.has(e)&&o.set(e,l),l}chartOptionScopes(){const{options:t,type:e}=this;return[t,De[e]||{},Le.datasets[e]||{},{type:e},Le,Oe]}resolveNamedOptions(t,e,n,r=[""]){const i={$shared:!0},{resolver:o,subPrefixes:s}=ws(this._resolverCache,t,r);let a=o;if(ks(o,e)){i.$shared=!1,n=_t(n)?n():n;const e=this.createResolver(t,n,s);a=mn(o,n,e)}for(const l of e)i[l]=a[l];return i}createResolver(t,e,n=[""],r){const{resolver:i}=ws(this._resolverCache,t,n);return nt(e)?mn(i,e,void 0,r):i}}function ws(t,e,n){let r=t.get(e);r||(r=new Map,t.set(e,r));const i=n.join();let o=r.get(i);if(!o){const t=gn(e,n);o={resolver:t,subPrefixes:n.filter((t=>!t.toLowerCase().includes("hover")))},r.set(i,o)}return o}const xs=t=>nt(t)&&Object.getOwnPropertyNames(t).some((e=>_t(t[e])));function ks(t,e){const{isScriptable:n,isIndexable:r}=yn(t);for(const i of e){const e=n(i),o=r(i),s=(o||e)&&t[i];if(e&&(_t(s)||xs(s))||o&&et(s))return!0}return!1}var _s="4.4.1";const Is=["top","bottom","left","right","chartArea"];function Cs(t,e){return"top"===t||"bottom"===t||-1===Is.indexOf(t)&&"x"===e}function Ss(t,e){return function(n,r){return n[t]===r[t]?n[e]-r[e]:n[t]-r[t]}}function Ts(t){const e=t.chart,n=e.options.animation;e.notifyPlugins("afterRender"),lt(n&&n.onComplete,[t],e)}function Es(t){const e=t.chart,n=e.options.animation;lt(n&&n.onProgress,[t],e)}function Ns(t){return Hn()&&"string"===typeof t?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const As={},Rs=t=>{const e=Ns(t);return Object.values(As).filter((t=>t.canvas===e)).pop()};function $s(t,e,n){const r=Object.keys(t);for(const i of r){const r=+i;if(r>=e){const o=t[i];delete t[i],(n>0||r>e)&&(t[r+n]=o)}}}function Ds(t,e,n,r){return n&&"mouseout"!==t.type?r?e:t:null}function Os(t,e,n){return t.options.clip?t[n]:e[n]}function Fs(t,e){const{xScale:n,yScale:r}=t;return n&&r?{left:Os(n,e,"left"),right:Os(n,e,"right"),top:Os(r,e,"top"),bottom:Os(r,e,"bottom")}:e}class Ms{static register(...t){Jo.add(...t),Ps()}static unregister(...t){Jo.remove(...t),Ps()}constructor(t,e){const n=this.config=new vs(e),r=Ns(t),i=Rs(r);if(i)throw new Error("Canvas is already in use. Chart with ID '"+i.id+"' must be destroyed before the canvas with ID '"+i.canvas.id+"' can be reused.");const o=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||Io(r)),this.platform.updateConfig(n);const s=this.platform.acquireContext(r,o.aspectRatio),a=s&&s.canvas,l=a&&a.height,u=a&&a.width;this.id=Q(),this.ctx=s,this.canvas=a,this.width=u,this.height=l,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new Zo,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=ue((t=>this.update(t)),o.resizeDelay||0),this._dataChanges=[],As[this.id]=this,s&&a?(Er.listen(this,"complete",Ts),Er.listen(this,"progress",Es),this._initialize(),this.attached&&this.update()):console.error("Failed to create chart: can't acquire context from the given item")}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:e},width:n,height:r,_aspectRatio:i}=this;return tt(t)?e&&i?i:r?n/r:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return Jo}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():ir(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Ve(this.canvas,this.ctx),this}stop(){return Er.stop(this),this}resize(t,e){Er.running(this)?this._resizeBeforeDraw={width:t,height:e}:this._resize(t,e)}_resize(t,e){const n=this.options,r=this.canvas,i=n.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(r,t,e,i),s=n.devicePixelRatio||this.platform.getDevicePixelRatio(),a=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,ir(this,s,!0)&&(this.notifyPlugins("resize",{size:o}),lt(n.onResize,[this,o],this),this.attached&&this._doResize(a)&&this.render())}ensureScalesHaveIDs(){const t=this.options,e=t.scales||{};ut(e,((t,e)=>{t.id=e}))}buildOrUpdateScales(){const t=this.options,e=t.scales,n=this.scales,r=Object.keys(n).reduce(((t,e)=>(t[e]=!1,t)),{});let i=[];e&&(i=i.concat(Object.keys(e).map((t=>{const n=e[t],r=ls(t,n),i="r"===r,o="x"===r;return{options:n,dposition:i?"chartArea":o?"bottom":"left",dtype:i?"radialLinear":o?"category":"linear"}})))),ut(i,(e=>{const i=e.options,o=i.id,s=ls(o,i),a=ot(i.type,e.dtype);void 0!==i.position&&Cs(i.position,s)===Cs(e.dposition)||(i.position=e.dposition),r[o]=!0;let l=null;if(o in n&&n[o].type===a)l=n[o];else{const t=Jo.getScale(a);l=new t({id:o,type:a,ctx:this.ctx,chart:this}),n[l.id]=l}l.init(i,t)})),ut(r,((t,e)=>{t||delete n[e]})),ut(n,(t=>{to.configure(this,t,t.options),to.addBox(this,t)}))}_updateMetasets(){const t=this._metasets,e=this.data.datasets.length,n=t.length;if(t.sort(((t,e)=>t.index-e.index)),n>e){for(let t=e;t<n;++t)this._destroyDatasetMeta(t);t.splice(e,n-e)}this._sortedMetasets=t.slice(0).sort(Ss("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:e}}=this;t.length>e.length&&delete this._stacks,t.forEach(((t,n)=>{0===e.filter((e=>e===t._dataset)).length&&this._destroyDatasetMeta(n)}))}buildOrUpdateControllers(){const t=[],e=this.data.datasets;let n,r;for(this._removeUnreferencedMetasets(),n=0,r=e.length;n<r;n++){const r=e[n];let i=this.getDatasetMeta(n);const o=r.type||this.config.type;if(i.type&&i.type!==o&&(this._destroyDatasetMeta(n),i=this.getDatasetMeta(n)),i.type=o,i.indexAxis=r.indexAxis||rs(o,this.options),i.order=r.order||0,i.index=n,i.label=""+r.label,i.visible=this.isDatasetVisible(n),i.controller)i.controller.updateIndex(n),i.controller.linkScales();else{const e=Jo.getController(o),{datasetElementType:r,dataElementType:s}=Le.datasets[o];Object.assign(e,{dataElementType:Jo.getElement(s),datasetElementType:r&&Jo.getElement(r)}),i.controller=new e(this,n),t.push(i.controller)}}return this._updateMetasets(),t}_resetElements(){ut(this.data.datasets,((t,e)=>{this.getDatasetMeta(e).controller.reset()}),this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const e=this.config;e.update();const n=this._options=e.createResolver(e.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1===this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0}))return;const i=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let l=0,u=this.data.datasets.length;l<u;l++){const{controller:t}=this.getDatasetMeta(l),e=!r&&-1===i.indexOf(t);t.buildOrUpdateElements(e),o=Math.max(+t.getMaxOverflow(),o)}o=this._minPadding=n.layout.autoPadding?o:0,this._updateLayout(o),r||ut(i,(t=>{t.reset()})),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(Ss("z","_idx"));const{_active:s,_lastEvent:a}=this;a?this._eventHandler(a,!0):s.length&&this._updateHoverStyles(s,s,!0),this.render()}_updateScales(){ut(this.scales,(t=>{to.removeBox(this,t)})),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,e=new Set(Object.keys(this._listeners)),n=new Set(t.events);It(e,n)&&!!this._responsiveListeners===t.responsive||(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,e=this._getUniformDataChanges()||[];for(const{method:n,start:r,count:i}of e){const e="_removeElements"===n?-i:i;$s(t,r,e)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const e=this.data.datasets.length,n=e=>new Set(t.filter((t=>t[0]===e)).map(((t,e)=>e+","+t.splice(1).join(",")))),r=n(0);for(let i=1;i<e;i++)if(!It(r,n(i)))return;return Array.from(r).map((t=>t.split(","))).map((t=>({method:t[1],start:+t[2],count:+t[3]})))}_updateLayout(t){if(!1===this.notifyPlugins("beforeLayout",{cancelable:!0}))return;to.update(this,this.width,this.height,t);const e=this.chartArea,n=e.width<=0||e.height<=0;this._layers=[],ut(this.boxes,(t=>{n&&"chartArea"===t.position||(t.configure&&t.configure(),this._layers.push(...t._layers()))}),this),this._layers.forEach(((t,e)=>{t._idx=e})),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})){for(let t=0,e=this.data.datasets.length;t<e;++t)this.getDatasetMeta(t).controller.configure();for(let e=0,n=this.data.datasets.length;e<n;++e)this._updateDataset(e,_t(t)?t({datasetIndex:e}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,e){const n=this.getDatasetMeta(t),r={meta:n,index:t,mode:e,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",r)&&(n.controller._update(e),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(Er.has(this)?this.attached&&!Er.running(this)&&Er.start(this):(this.draw(),Ts({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:t,height:e}=this._resizeBeforeDraw;this._resize(t,e),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0)return;if(!1===this.notifyPlugins("beforeDraw",{cancelable:!0}))return;const e=this._layers;for(t=0;t<e.length&&e[t].z<=0;++t)e[t].draw(this.chartArea);for(this._drawDatasets();t<e.length;++t)e[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const e=this._sortedMetasets,n=[];let r,i;for(r=0,i=e.length;r<i;++r){const i=e[r];t&&!i.visible||n.push(i)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(!1===this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;const t=this.getSortedVisibleDatasetMetas();for(let e=t.length-1;e>=0;--e)this._drawDataset(t[e]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const e=this.ctx,n=t._clip,r=!n.disabled,i=Fs(t,this.chartArea),o={meta:t,index:t.index,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetDraw",o)&&(r&&qe(e,{left:!1===n.left?0:i.left-n.left,right:!1===n.right?this.width:i.right+n.right,top:!1===n.top?0:i.top-n.top,bottom:!1===n.bottom?this.height:i.bottom+n.bottom}),t.controller.draw(),r&&Ke(e),o.cancelable=!1,this.notifyPlugins("afterDatasetDraw",o))}isPointInArea(t){return Ge(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,e,n,r){const i=Pi.modes[e];return"function"===typeof i?i(this,t,n,r):[]}getDatasetMeta(t){const e=this.data.datasets[t],n=this._metasets;let r=n.filter((t=>t&&t._dataset===e)).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:e&&e.order||0,index:t,_dataset:e,_parsed:[],_sorted:!1},n.push(r)),r}getContext(){return this.$context||(this.$context=fn(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const e=this.data.datasets[t];if(!e)return!1;const n=this.getDatasetMeta(t);return"boolean"===typeof n.hidden?!n.hidden:!e.hidden}setDatasetVisibility(t,e){const n=this.getDatasetMeta(t);n.hidden=!e}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,e,n){const r=n?"show":"hide",i=this.getDatasetMeta(t),o=i.controller._resolveAnimations(void 0,r);kt(e)?(i.data[e].hidden=!n,this.update()):(this.setDatasetVisibility(t,n),o.update(i,{visible:n}),this.update((e=>e.datasetIndex===t?r:void 0)))}hide(t,e){this._updateVisibility(t,e,!1)}show(t,e){this._updateVisibility(t,e,!0)}_destroyDatasetMeta(t){const e=this._metasets[t];e&&e.controller&&e.controller._destroy(),delete this._metasets[t]}_stop(){let t,e;for(this.stop(),Er.remove(this),t=0,e=this.data.datasets.length;t<e;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:e}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),Ve(t,e),this.platform.releaseContext(e),this.canvas=null,this.ctx=null),delete As[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,e=this.platform,n=(n,r)=>{e.addEventListener(this,n,r),t[n]=r},r=(t,e,n)=>{t.offsetX=e,t.offsetY=n,this._eventHandler(t)};ut(this.options.events,(t=>n(t,r)))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,e=this.platform,n=(n,r)=>{e.addEventListener(this,n,r),t[n]=r},r=(n,r)=>{t[n]&&(e.removeEventListener(this,n,r),delete t[n])},i=(t,e)=>{this.canvas&&this.resize(t,e)};let o;const s=()=>{r("attach",s),this.attached=!0,this.resize(),n("resize",i),n("detach",o)};o=()=>{this.attached=!1,r("resize",i),this._stop(),this._resize(0,0),n("attach",s)},e.isAttached(this.canvas)?s():o()}unbindEvents(){ut(this._listeners,((t,e)=>{this.platform.removeEventListener(this,e,t)})),this._listeners={},ut(this._responsiveListeners,((t,e)=>{this.platform.removeEventListener(this,e,t)})),this._responsiveListeners=void 0}updateHoverStyle(t,e,n){const r=n?"set":"remove";let i,o,s,a;for("dataset"===e&&(i=this.getDatasetMeta(t[0].datasetIndex),i.controller["_"+r+"DatasetHoverStyle"]()),s=0,a=t.length;s<a;++s){o=t[s];const e=o&&this.getDatasetMeta(o.datasetIndex).controller;e&&e[r+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const e=this._active||[],n=t.map((({datasetIndex:t,index:e})=>{const n=this.getDatasetMeta(t);if(!n)throw new Error("No dataset found at index "+t);return{datasetIndex:t,element:n.data[e],index:e}})),r=!ct(n,e);r&&(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,e))}notifyPlugins(t,e,n){return this._plugins.notify(this,t,e,n)}isPluginEnabled(t){return 1===this._plugins._cache.filter((e=>e.plugin.id===t)).length}_updateHoverStyles(t,e,n){const r=this.options.hover,i=(t,e)=>t.filter((t=>!e.some((e=>t.datasetIndex===e.datasetIndex&&t.index===e.index)))),o=i(e,t),s=n?t:i(t,e);o.length&&this.updateHoverStyle(o,r.mode,!1),s.length&&r.mode&&this.updateHoverStyle(s,r.mode,!0)}_eventHandler(t,e){const n={event:t,replay:e,cancelable:!0,inChartArea:this.isPointInArea(t)},r=e=>(e.options.events||this.options.events).includes(t.native.type);if(!1===this.notifyPlugins("beforeEvent",n,r))return;const i=this._handleEvent(t,e,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,r),(i||n.changed)&&this.render(),this}_handleEvent(t,e,n){const{_active:r=[],options:i}=this,o=e,s=this._getActiveElements(t,r,n,o),a=Ct(t),l=Ds(t,this._lastEvent,n,a);n&&(this._lastEvent=null,lt(i.onHover,[t,s,this],this),a&&lt(i.onClick,[t,s,this],this));const u=!ct(s,r);return(u||e)&&(this._active=s,this._updateHoverStyles(s,r,e)),this._lastEvent=l,u}_getActiveElements(t,e,n,r){if("mouseout"===t.type)return[];if(!n)return e;const i=this.options.hover;return this.getElementsAtEventForMode(t,i.mode,i,r)}}function Ps(){return ut(Ms.instances,(t=>t._plugins.invalidate()))}function Ls(t,e,n){const{startAngle:r,pixelMargin:i,x:o,y:s,outerRadius:a,innerRadius:l}=e;let u=i/a;t.beginPath(),t.arc(o,s,a,r-u,n+u),l>i?(u=i/l,t.arc(o,s,l,n+u,r-u,!0)):t.arc(o,s,i,n+Rt,r-Rt),t.closePath(),t.clip()}function zs(t){return an(t,["outerStart","outerEnd","innerStart","innerEnd"])}function Bs(t,e,n,r){const i=zs(t.options.borderRadius),o=(n-e)/2,s=Math.min(o,r*e/2),a=t=>{const e=(n-Math.min(o,t))*r/2;return Yt(t,0,Math.min(o,e))};return{outerStart:a(i.outerStart),outerEnd:a(i.outerEnd),innerStart:Yt(i.innerStart,0,s),innerEnd:Yt(i.innerEnd,0,s)}}function Ws(t,e,n,r){return{x:n+t*Math.cos(e),y:r+t*Math.sin(e)}}function Us(t,e,n,r,i,o){const{x:s,y:a,startAngle:l,pixelMargin:u,innerRadius:c}=e,h=Math.max(e.outerRadius+r+n-u,0),d=c>0?c+r+n+u:0;let p=0;const f=i-l;if(r){const t=c>0?c-r:0,e=h>0?h-r:0,n=(t+e)/2,i=0!==n?f*n/(n+r):f;p=(f-i)/2}const g=Math.max(.001,f*h-n/St)/h,m=(f-g)/2,y=l+m+p,b=i-m-p,{outerStart:v,outerEnd:w,innerStart:x,innerEnd:k}=Bs(e,d,h,b-y),_=h-v,I=h-w,C=y+v/_,S=b-w/I,T=d+x,E=d+k,N=y+x/T,A=b-k/E;if(t.beginPath(),o){const e=(C+S)/2;if(t.arc(s,a,h,C,e),t.arc(s,a,h,e,S),w>0){const e=Ws(I,S,s,a);t.arc(e.x,e.y,w,S,b+Rt)}const n=Ws(E,b,s,a);if(t.lineTo(n.x,n.y),k>0){const e=Ws(E,A,s,a);t.arc(e.x,e.y,k,b+Rt,A+Math.PI)}const r=(b-k/d+(y+x/d))/2;if(t.arc(s,a,d,b-k/d,r,!0),t.arc(s,a,d,r,y+x/d,!0),x>0){const e=Ws(T,N,s,a);t.arc(e.x,e.y,x,N+Math.PI,y-Rt)}const i=Ws(_,y,s,a);if(t.lineTo(i.x,i.y),v>0){const e=Ws(_,C,s,a);t.arc(e.x,e.y,v,y-Rt,C)}}else{t.moveTo(s,a);const e=Math.cos(C)*h+s,n=Math.sin(C)*h+a;t.lineTo(e,n);const r=Math.cos(S)*h+s,i=Math.sin(S)*h+a;t.lineTo(r,i)}t.closePath()}function Vs(t,e,n,r,i){const{fullCircles:o,startAngle:s,circumference:a}=e;let l=e.endAngle;if(o){Us(t,e,n,r,l,i);for(let e=0;e<o;++e)t.fill();isNaN(a)||(l=s+(a%Tt||Tt))}return Us(t,e,n,r,l,i),t.fill(),l}function js(t,e,n,r,i){const{fullCircles:o,startAngle:s,circumference:a,options:l}=e,{borderWidth:u,borderJoinStyle:c,borderDash:h,borderDashOffset:d}=l,p="inner"===l.borderAlign;if(!u)return;t.setLineDash(h||[]),t.lineDashOffset=d,p?(t.lineWidth=2*u,t.lineJoin=c||"round"):(t.lineWidth=u,t.lineJoin=c||"bevel");let f=e.endAngle;if(o){Us(t,e,n,r,f,i);for(let e=0;e<o;++e)t.stroke();isNaN(a)||(f=s+(a%Tt||Tt))}p&&Ls(t,e,f),o||(Us(t,e,n,r,f,i),t.stroke())}s(Ms,"defaults",Le),s(Ms,"instances",As),s(Ms,"overrides",De),s(Ms,"registry",Jo),s(Ms,"version",_s),s(Ms,"getChart",Rs);class Hs extends Co{constructor(t){super(),s(this,"circumference",void 0),s(this,"endAngle",void 0),s(this,"fullCircles",void 0),s(this,"innerRadius",void 0),s(this,"outerRadius",void 0),s(this,"pixelMargin",void 0),s(this,"startAngle",void 0),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,e,n){const r=this.getProps(["x","y"],n),{angle:i,distance:o}=Ht(r,{x:t,y:e}),{startAngle:s,endAngle:a,innerRadius:l,outerRadius:u,circumference:c}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],n),h=(this.options.spacing+this.options.borderWidth)/2,d=ot(c,a-s),p=d>=Tt||Xt(i,s,a),f=Zt(o,l+h,u+h);return p&&f}getCenterPoint(t){const{x:e,y:n,startAngle:r,endAngle:i,innerRadius:o,outerRadius:s}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],t),{offset:a,spacing:l}=this.options,u=(r+i)/2,c=(o+s+l+a)/2;return{x:e+Math.cos(u)*c,y:n+Math.sin(u)*c}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:e,circumference:n}=this,r=(e.offset||0)/4,i=(e.spacing||0)/2,o=e.circular;if(this.pixelMargin="inner"===e.borderAlign?.33:0,this.fullCircles=n>Tt?Math.floor(n/Tt):0,0===n||this.innerRadius<0||this.outerRadius<0)return;t.save();const s=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(s)*r,Math.sin(s)*r);const a=1-Math.sin(Math.min(St,n||0)),l=r*a;t.fillStyle=e.backgroundColor,t.strokeStyle=e.borderColor,Vs(t,this,l,i,o),js(t,this,l,i,o),t.restore()}}function Gs(t,e,n=e){t.lineCap=ot(n.borderCapStyle,e.borderCapStyle),t.setLineDash(ot(n.borderDash,e.borderDash)),t.lineDashOffset=ot(n.borderDashOffset,e.borderDashOffset),t.lineJoin=ot(n.borderJoinStyle,e.borderJoinStyle),t.lineWidth=ot(n.borderWidth,e.borderWidth),t.strokeStyle=ot(n.borderColor,e.borderColor)}function qs(t,e,n){t.lineTo(n.x,n.y)}function Ks(t){return t.stepped?Xe:t.tension||"monotone"===t.cubicInterpolationMode?Ye:qs}function Xs(t,e,n={}){const r=t.length,{start:i=0,end:o=r-1}=n,{start:s,end:a}=e,l=Math.max(i,s),u=Math.min(o,a),c=i<s&&o<s||i>a&&o>a;return{count:r,start:l,loop:e.loop,ilen:u<l&&!c?r+u-l:u-l}}function Ys(t,e,n,r){const{points:i,options:o}=e,{count:s,start:a,loop:l,ilen:u}=Xs(i,n,r),c=Ks(o);let h,d,p,{move:f=!0,reverse:g}=r||{};for(h=0;h<=u;++h)d=i[(a+(g?u-h:h))%s],d.skip||(f?(t.moveTo(d.x,d.y),f=!1):c(t,p,d,g,o.stepped),p=d);return l&&(d=i[(a+(g?u:0))%s],c(t,p,d,g,o.stepped)),!!l}function Js(t,e,n,r){const i=e.points,{count:o,start:s,ilen:a}=Xs(i,n,r),{move:l=!0,reverse:u}=r||{};let c,h,d,p,f,g,m=0,y=0;const b=t=>(s+(u?a-t:t))%o,v=()=>{p!==f&&(t.lineTo(m,f),t.lineTo(m,p),t.lineTo(m,g))};for(l&&(h=i[b(0)],t.moveTo(h.x,h.y)),c=0;c<=a;++c){if(h=i[b(c)],h.skip)continue;const e=h.x,n=h.y,r=0|e;r===d?(n<p?p=n:n>f&&(f=n),m=(y*m+e)/++y):(v(),t.lineTo(e,n),d=r,y=0,p=f=n),g=n}v()}function Zs(t){const e=t.options,n=e.borderDash&&e.borderDash.length,r=!t._decimated&&!t._loop&&!e.tension&&"monotone"!==e.cubicInterpolationMode&&!e.stepped&&!n;return r?Js:Ys}function Qs(t){return t.stepped?lr:t.tension||"monotone"===t.cubicInterpolationMode?ur:ar}function ta(t,e,n,r){let i=e._path;i||(i=e._path=new Path2D,e.path(i,n,r)&&i.closePath()),Gs(t,e.options),t.stroke(i)}function ea(t,e,n,r){const{segments:i,options:o}=e,s=Zs(e);for(const a of i)Gs(t,o,a.style),t.beginPath(),s(t,e,a,{start:n,end:n+r-1})&&t.closePath(),t.stroke()}s(Hs,"id","arc"),s(Hs,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),s(Hs,"defaultRoutes",{backgroundColor:"backgroundColor"}),s(Hs,"descriptors",{_scriptable:!0,_indexable:t=>"borderDash"!==t});const na="function"===typeof Path2D;function ra(t,e,n,r){na&&!e.options.segment?ta(t,e,n,r):ea(t,e,n,r)}class ia extends Co{constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,e){const n=this.options;if((n.tension||"monotone"===n.cubicInterpolationMode)&&!n.stepped&&!this._pointsUpdated){const r=n.spanGaps?this._loop:this._fullLoop;jn(this._points,n,t,r,e),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=kr(this,this.options.segment))}first(){const t=this.segments,e=this.points;return t.length&&e[t[0].start]}last(){const t=this.segments,e=this.points,n=t.length;return n&&e[t[n-1].end]}interpolate(t,e){const n=this.options,r=t[e],i=this.points,o=vr(this,{property:e,start:r,end:r});if(!o.length)return;const s=[],a=Qs(n);let l,u;for(l=0,u=o.length;l<u;++l){const{start:u,end:c}=o[l],h=i[u],d=i[c];if(h===d){s.push(h);continue}const p=Math.abs((r-h[e])/(d[e]-h[e])),f=a(h,d,p,n.stepped);f[e]=t[e],s.push(f)}return 1===s.length?s[0]:s}pathSegment(t,e,n){const r=Zs(this);return r(t,this,e,n)}path(t,e,n){const r=this.segments,i=Zs(this);let o=this._loop;e=e||0,n=n||this.points.length-e;for(const s of r)o&=i(t,this,s,{start:e,end:e+n-1});return!!o}draw(t,e,n,r){const i=this.options||{},o=this.points||[];o.length&&i.borderWidth&&(t.save(),ra(t,this,n,r),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function oa(t,e,n,r){const i=t.options,{[n]:o}=t.getProps([n],r);return Math.abs(e-o)<i.radius+i.hitRadius}s(ia,"id","line"),s(ia,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),s(ia,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),s(ia,"descriptors",{_scriptable:!0,_indexable:t=>"borderDash"!==t&&"fill"!==t});class sa extends Co{constructor(t){super(),s(this,"parsed",void 0),s(this,"skip",void 0),s(this,"stop",void 0),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,e,n){const r=this.options,{x:i,y:o}=this.getProps(["x","y"],n);return Math.pow(t-i,2)+Math.pow(e-o,2)<Math.pow(r.hitRadius+r.radius,2)}inXRange(t,e){return oa(this,t,"x",e)}inYRange(t,e){return oa(this,t,"y",e)}getCenterPoint(t){const{x:e,y:n}=this.getProps(["x","y"],t);return{x:e,y:n}}size(t){t=t||this.options||{};let e=t.radius||0;e=Math.max(e,e&&t.hoverRadius||0);const n=e&&t.borderWidth||0;return 2*(e+n)}draw(t,e){const n=this.options;this.skip||n.radius<.1||!Ge(this,e,this.size(n)/2)||(t.strokeStyle=n.borderColor,t.lineWidth=n.borderWidth,t.fillStyle=n.backgroundColor,je(t,n,this.x,this.y))}getRange(){const t=this.options||{};return t.radius+t.hitRadius}}function aa(t,e){const{x:n,y:r,base:i,width:o,height:s}=t.getProps(["x","y","base","width","height"],e);let a,l,u,c,h;return t.horizontal?(h=s/2,a=Math.min(n,i),l=Math.max(n,i),u=r-h,c=r+h):(h=o/2,a=n-h,l=n+h,u=Math.min(r,i),c=Math.max(r,i)),{left:a,top:u,right:l,bottom:c}}function la(t,e,n,r){return t?0:Yt(e,n,r)}function ua(t,e,n){const r=t.options.borderWidth,i=t.borderSkipped,o=ln(r);return{t:la(i.top,o.top,0,n),r:la(i.right,o.right,0,e),b:la(i.bottom,o.bottom,0,n),l:la(i.left,o.left,0,e)}}function ca(t,e,n){const{enableBorderRadius:r}=t.getProps(["enableBorderRadius"]),i=t.options.borderRadius,o=un(i),s=Math.min(e,n),a=t.borderSkipped,l=r||nt(i);return{topLeft:la(!l||a.top||a.left,o.topLeft,0,s),topRight:la(!l||a.top||a.right,o.topRight,0,s),bottomLeft:la(!l||a.bottom||a.left,o.bottomLeft,0,s),bottomRight:la(!l||a.bottom||a.right,o.bottomRight,0,s)}}function ha(t){const e=aa(t),n=e.right-e.left,r=e.bottom-e.top,i=ua(t,n/2,r/2),o=ca(t,n/2,r/2);return{outer:{x:e.left,y:e.top,w:n,h:r,radius:o},inner:{x:e.left+i.l,y:e.top+i.t,w:n-i.l-i.r,h:r-i.t-i.b,radius:{topLeft:Math.max(0,o.topLeft-Math.max(i.t,i.l)),topRight:Math.max(0,o.topRight-Math.max(i.t,i.r)),bottomLeft:Math.max(0,o.bottomLeft-Math.max(i.b,i.l)),bottomRight:Math.max(0,o.bottomRight-Math.max(i.b,i.r))}}}}function da(t,e,n,r){const i=null===e,o=null===n,s=i&&o,a=t&&!s&&aa(t,r);return a&&(i||Zt(e,a.left,a.right))&&(o||Zt(n,a.top,a.bottom))}function pa(t){return t.topLeft||t.topRight||t.bottomLeft||t.bottomRight}function fa(t,e){t.rect(e.x,e.y,e.w,e.h)}function ga(t,e,n={}){const r=t.x!==n.x?-e:0,i=t.y!==n.y?-e:0,o=(t.x+t.w!==n.x+n.w?e:0)-r,s=(t.y+t.h!==n.y+n.h?e:0)-i;return{x:t.x+r,y:t.y+i,w:t.w+o,h:t.h+s,radius:t.radius}}s(sa,"id","point"),s(sa,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),s(sa,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});class ma extends Co{constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:e,options:{borderColor:n,backgroundColor:r}}=this,{inner:i,outer:o}=ha(this),s=pa(o.radius)?en:fa;t.save(),o.w===i.w&&o.h===i.h||(t.beginPath(),s(t,ga(o,e,i)),t.clip(),s(t,ga(i,-e,o)),t.fillStyle=n,t.fill("evenodd")),t.beginPath(),s(t,ga(i,e)),t.fillStyle=r,t.fill(),t.restore()}inRange(t,e,n){return da(this,t,e,n)}inXRange(t,e){return da(this,t,null,e)}inYRange(t,e){return da(this,null,t,e)}getCenterPoint(t){const{x:e,y:n,base:r,horizontal:i}=this.getProps(["x","y","base","horizontal"],t);return{x:i?(e+r)/2:e,y:i?n:(n+r)/2}}getRange(t){return"x"===t?this.width/2:this.height/2}}s(ma,"id","bar"),s(ma,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),s(ma,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var ya=Object.freeze({__proto__:null,ArcElement:Hs,BarElement:ma,LineElement:ia,PointElement:sa});const ba=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],va=ba.map((t=>t.replace("rgb(","rgba(").replace(")",", 0.5)")));function wa(t){return ba[t%ba.length]}function xa(t){return va[t%va.length]}function ka(t,e){return t.borderColor=wa(e),t.backgroundColor=xa(e),++e}function _a(t,e){return t.backgroundColor=t.data.map((()=>wa(e++))),e}function Ia(t,e){return t.backgroundColor=t.data.map((()=>xa(e++))),e}function Ca(t){let e=0;return(n,r)=>{const i=t.getDatasetMeta(r).controller;i instanceof vi?e=_a(n,e):i instanceof xi?e=Ia(n,e):i&&(e=ka(n,e))}}function Sa(t){let e;for(e in t)if(t[e].borderColor||t[e].backgroundColor)return!0;return!1}function Ta(t){return t&&(t.borderColor||t.backgroundColor)}var Ea={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(t,e,n){if(!n.enabled)return;const{data:{datasets:r},options:i}=t.config,{elements:o}=i;if(!n.forceOverride&&(Sa(r)||Ta(i)||o&&Sa(o)))return;const s=Ca(t);r.forEach(s)}};function Na(t,e,n,r,i){const o=i.samples||r;if(o>=n)return t.slice(e,e+n);const s=[],a=(n-2)/(o-2);let l=0;const u=e+n-1;let c,h,d,p,f,g=e;for(s[l++]=t[g],c=0;c<o-2;c++){let r,i=0,o=0;const u=Math.floor((c+1)*a)+1+e,m=Math.min(Math.floor((c+2)*a)+1,n)+e,y=m-u;for(r=u;r<m;r++)i+=t[r].x,o+=t[r].y;i/=y,o/=y;const b=Math.floor(c*a)+1+e,v=Math.min(Math.floor((c+1)*a)+1,n)+e,{x:w,y:x}=t[g];for(d=p=-1,r=b;r<v;r++)p=.5*Math.abs((w-i)*(t[r].y-x)-(w-t[r].x)*(o-x)),p>d&&(d=p,h=t[r],f=r);s[l++]=h,g=f}return s[l++]=t[u],s}function Aa(t,e,n,r){let i,o,s,a,l,u,c,h,d,p,f=0,g=0;const m=[],y=e+n-1,b=t[e].x,v=t[y].x,w=v-b;for(i=e;i<e+n;++i){o=t[i],s=(o.x-b)/w*r,a=o.y;const e=0|s;if(e===l)a<d?(d=a,u=i):a>p&&(p=a,c=i),f=(g*f+o.x)/++g;else{const n=i-1;if(!tt(u)&&!tt(c)){const e=Math.min(u,c),r=Math.max(u,c);e!==h&&e!==n&&m.push({...t[e],x:f}),r!==h&&r!==n&&m.push({...t[r],x:f})}i>0&&n!==h&&m.push(t[n]),m.push(o),l=e,g=0,d=p=a,u=c=h=i}}return m}function Ra(t){if(t._decimated){const e=t._data;delete t._decimated,delete t._data,Object.defineProperty(t,"data",{configurable:!0,enumerable:!0,writable:!0,value:e})}}function $a(t){t.data.datasets.forEach((t=>{Ra(t)}))}function Da(t,e){const n=e.length;let r,i=0;const{iScale:o}=t,{min:s,max:a,minDefined:l,maxDefined:u}=o.getUserBounds();return l&&(i=Yt(te(e,o.axis,s).lo,0,n-1)),r=u?Yt(te(e,o.axis,a).hi+1,i,n)-i:n-i,{start:i,count:r}}var Oa={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(t,e,n)=>{if(!n.enabled)return void $a(t);const r=t.width;t.data.datasets.forEach(((e,i)=>{const{_data:o,indexAxis:s}=e,a=t.getDatasetMeta(i),l=o||e.data;if("y"===dn([s,t.options.indexAxis]))return;if(!a.controller.supportsDecimation)return;const u=t.scales[a.xAxisID];if("linear"!==u.type&&"time"!==u.type)return;if(t.options.parsing)return;let{start:c,count:h}=Da(a,l);const d=n.threshold||4*r;if(h<=d)return void Ra(e);let p;switch(tt(o)&&(e._data=l,delete e.data,Object.defineProperty(e,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(t){this._data=t}})),n.algorithm){case"lttb":p=Na(l,c,h,r,n);break;case"min-max":p=Aa(l,c,h,r);break;default:throw new Error(`Unsupported decimation algorithm '${n.algorithm}'`)}e._decimated=p}))},destroy(t){$a(t)}};function Fa(t,e,n){const r=t.segments,i=t.points,o=e.points,s=[];for(const a of r){let{start:t,end:r}=a;r=La(t,r,i);const l=Ma(n,i[t],i[r],a.loop);if(!e.segments){s.push({source:a,target:l,start:i[t],end:i[r]});continue}const u=vr(e,l);for(const e of u){const t=Ma(n,o[e.start],o[e.end],e.loop),r=br(a,i,t);for(const i of r)s.push({source:i,target:e,start:{[n]:za(l,t,"start",Math.max)},end:{[n]:za(l,t,"end",Math.min)}})}}return s}function Ma(t,e,n,r){if(r)return;let i=e[t],o=n[t];return"angle"===t&&(i=Kt(i),o=Kt(o)),{property:t,start:i,end:o}}function Pa(t,e){const{x:n=null,y:r=null}=t||{},i=e.points,o=[];return e.segments.forEach((({start:t,end:e})=>{e=La(t,e,i);const s=i[t],a=i[e];null!==r?(o.push({x:s.x,y:r}),o.push({x:a.x,y:r})):null!==n&&(o.push({x:n,y:s.y}),o.push({x:n,y:a.y}))})),o}function La(t,e,n){for(;e>t;e--){const t=n[e];if(!isNaN(t.x)&&!isNaN(t.y))break}return e}function za(t,e,n,r){return t&&e?r(t[n],e[n]):t?t[n]:e?e[n]:0}function Ba(t,e){let n=[],r=!1;return et(t)?(r=!0,n=t):n=Pa(t,e),n.length?new ia({points:n,options:{tension:0},_loop:r,_fullLoop:r}):null}function Wa(t){return t&&!1!==t.fill}function Ua(t,e,n){const r=t[e];let i=r.fill;const o=[e];let s;if(!n)return i;while(!1!==i&&-1===o.indexOf(i)){if(!rt(i))return i;if(s=t[i],!s)return!1;if(s.visible)return i;o.push(i),i=s.fill}return!1}function Va(t,e,n){const r=qa(t);if(nt(r))return!isNaN(r.value)&&r;let i=parseFloat(r);return rt(i)&&Math.floor(i)===i?ja(r[0],e,i,n):["origin","start","end","stack","shape"].indexOf(r)>=0&&r}function ja(t,e,n,r){return"-"!==t&&"+"!==t||(n=e+n),!(n===e||n<0||n>=r)&&n}function Ha(t,e){let n=null;return"start"===t?n=e.bottom:"end"===t?n=e.top:nt(t)?n=e.getPixelForValue(t.value):e.getBasePixel&&(n=e.getBasePixel()),n}function Ga(t,e,n){let r;return r="start"===t?n:"end"===t?e.options.reverse?e.min:e.max:nt(t)?t.value:e.getBaseValue(),r}function qa(t){const e=t.options,n=e.fill;let r=ot(n&&n.target,n);return void 0===r&&(r=!!e.backgroundColor),!1!==r&&null!==r&&(!0===r?"origin":r)}function Ka(t){const{scale:e,index:n,line:r}=t,i=[],o=r.segments,s=r.points,a=Xa(e,n);a.push(Ba({x:null,y:e.bottom},r));for(let l=0;l<o.length;l++){const t=o[l];for(let e=t.start;e<=t.end;e++)Ya(i,s[e],a)}return new ia({points:i,options:{}})}function Xa(t,e){const n=[],r=t.getMatchingVisibleMetas("line");for(let i=0;i<r.length;i++){const t=r[i];if(t.index===e)break;t.hidden||n.unshift(t.dataset)}return n}function Ya(t,e,n){const r=[];for(let i=0;i<n.length;i++){const o=n[i],{first:s,last:a,point:l}=Ja(o,e,"x");if(!(!l||s&&a))if(s)r.unshift(l);else if(t.push(l),!a)break}t.push(...r)}function Ja(t,e,n){const r=t.interpolate(e,n);if(!r)return{};const i=r[n],o=t.segments,s=t.points;let a=!1,l=!1;for(let u=0;u<o.length;u++){const t=o[u],e=s[t.start][n],r=s[t.end][n];if(Zt(i,e,r)){a=i===e,l=i===r;break}}return{first:a,last:l,point:r}}class Za{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,e,n){const{x:r,y:i,radius:o}=this;return e=e||{start:0,end:Tt},t.arc(r,i,o,e.end,e.start,!0),!n.bounds}interpolate(t){const{x:e,y:n,radius:r}=this,i=t.angle;return{x:e+Math.cos(i)*r,y:n+Math.sin(i)*r,angle:i}}}function Qa(t){const{chart:e,fill:n,line:r}=t;if(rt(n))return tl(e,n);if("stack"===n)return Ka(t);if("shape"===n)return!0;const i=el(t);return i instanceof Za?i:Ba(i,r)}function tl(t,e){const n=t.getDatasetMeta(e),r=n&&t.isDatasetVisible(e);return r?n.dataset:null}function el(t){const e=t.scale||{};return e.getPointPositionForValue?rl(t):nl(t)}function nl(t){const{scale:e={},fill:n}=t,r=Ha(n,e);if(rt(r)){const t=e.isHorizontal();return{x:t?r:null,y:t?null:r}}return null}function rl(t){const{scale:e,fill:n}=t,r=e.options,i=e.getLabels().length,o=r.reverse?e.max:e.min,s=Ga(n,e,o),a=[];if(r.grid.circular){const t=e.getPointPositionForValue(0,o);return new Za({x:t.x,y:t.y,radius:e.getDistanceFromCenterForValue(s)})}for(let l=0;l<i;++l)a.push(e.getPointPositionForValue(l,s));return a}function il(t,e,n){const r=Qa(e),{line:i,scale:o,axis:s}=e,a=i.options,l=a.fill,u=a.backgroundColor,{above:c=u,below:h=u}=l||{};r&&i.points.length&&(qe(t,n),ol(t,{line:i,target:r,above:c,below:h,area:n,scale:o,axis:s}),Ke(t))}function ol(t,e){const{line:n,target:r,above:i,below:o,area:s,scale:a}=e,l=n._loop?"angle":e.axis;t.save(),"x"===l&&o!==i&&(sl(t,r,s.top),al(t,{line:n,target:r,color:i,scale:a,property:l}),t.restore(),t.save(),sl(t,r,s.bottom)),al(t,{line:n,target:r,color:o,scale:a,property:l}),t.restore()}function sl(t,e,n){const{segments:r,points:i}=e;let o=!0,s=!1;t.beginPath();for(const a of r){const{start:r,end:l}=a,u=i[r],c=i[La(r,l,i)];o?(t.moveTo(u.x,u.y),o=!1):(t.lineTo(u.x,n),t.lineTo(u.x,u.y)),s=!!e.pathSegment(t,a,{move:s}),s?t.closePath():t.lineTo(c.x,n)}t.lineTo(e.first().x,n),t.closePath(),t.clip()}function al(t,e){const{line:n,target:r,property:i,color:o,scale:s}=e,a=Fa(n,r,i);for(const{source:l,target:u,start:c,end:h}of a){const{style:{backgroundColor:e=o}={}}=l,a=!0!==r;t.save(),t.fillStyle=e,ll(t,s,a&&Ma(i,c,h)),t.beginPath();const d=!!n.pathSegment(t,l);let p;if(a){d?t.closePath():ul(t,r,h,i);const e=!!r.pathSegment(t,u,{move:d,reverse:!0});p=d&&e,p||ul(t,r,c,i)}t.closePath(),t.fill(p?"evenodd":"nonzero"),t.restore()}}function ll(t,e,n){const{top:r,bottom:i}=e.chart.chartArea,{property:o,start:s,end:a}=n||{};"x"===o&&(t.beginPath(),t.rect(s,r,a-s,i-r),t.clip())}function ul(t,e,n,r){const i=e.interpolate(n,r);i&&t.lineTo(i.x,i.y)}var cl={id:"filler",afterDatasetsUpdate(t,e,n){const r=(t.data.datasets||[]).length,i=[];let o,s,a,l;for(s=0;s<r;++s)o=t.getDatasetMeta(s),a=o.dataset,l=null,a&&a.options&&a instanceof ia&&(l={visible:t.isDatasetVisible(s),index:s,fill:Va(a,s,r),chart:t,axis:o.controller.options.indexAxis,scale:o.vScale,line:a}),o.$filler=l,i.push(l);for(s=0;s<r;++s)l=i[s],l&&!1!==l.fill&&(l.fill=Ua(i,s,n.propagate))},beforeDraw(t,e,n){const r="beforeDraw"===n.drawTime,i=t.getSortedVisibleDatasetMetas(),o=t.chartArea;for(let s=i.length-1;s>=0;--s){const e=i[s].$filler;e&&(e.line.updateControlPoints(o,e.axis),r&&e.fill&&il(t.ctx,e,o))}},beforeDatasetsDraw(t,e,n){if("beforeDatasetsDraw"!==n.drawTime)return;const r=t.getSortedVisibleDatasetMetas();for(let i=r.length-1;i>=0;--i){const e=r[i].$filler;Wa(e)&&il(t.ctx,e,t.chartArea)}},beforeDatasetDraw(t,e,n){const r=e.meta.$filler;Wa(r)&&"beforeDatasetDraw"===n.drawTime&&il(t.ctx,r,t.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const hl=(t,e)=>{let{boxHeight:n=e,boxWidth:r=e}=t;return t.usePointStyle&&(n=Math.min(n,e),r=t.pointStyleWidth||Math.min(r,e)),{boxWidth:r,boxHeight:n,itemHeight:Math.max(e,n)}},dl=(t,e)=>null!==t&&null!==e&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class pl extends Co{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e,n){this.maxWidth=t,this.maxHeight=e,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let e=lt(t.generateLabels,[this.chart],this)||[];t.filter&&(e=e.filter((e=>t.filter(e,this.chart.data)))),t.sort&&(e=e.sort(((e,n)=>t.sort(e,n,this.chart.data)))),this.options.reverse&&e.reverse(),this.legendItems=e}fit(){const{options:t,ctx:e}=this;if(!t.display)return void(this.width=this.height=0);const n=t.labels,r=hn(n.font),i=r.size,o=this._computeTitleHeight(),{boxWidth:s,itemHeight:a}=hl(n,i);let l,u;e.font=r.string,this.isHorizontal()?(l=this.maxWidth,u=this._fitRows(o,i,s,a)+10):(u=this.maxHeight,l=this._fitCols(o,r,s,a)+10),this.width=Math.min(l,t.maxWidth||this.maxWidth),this.height=Math.min(u,t.maxHeight||this.maxHeight)}_fitRows(t,e,n,r){const{ctx:i,maxWidth:o,options:{labels:{padding:s}}}=this,a=this.legendHitBoxes=[],l=this.lineWidths=[0],u=r+s;let c=t;i.textAlign="left",i.textBaseline="middle";let h=-1,d=-u;return this.legendItems.forEach(((t,p)=>{const f=n+e/2+i.measureText(t.text).width;(0===p||l[l.length-1]+f+2*s>o)&&(c+=u,l[l.length-(p>0?0:1)]=0,d+=u,h++),a[p]={left:0,top:d,row:h,width:f,height:r},l[l.length-1]+=f+s})),c}_fitCols(t,e,n,r){const{ctx:i,maxHeight:o,options:{labels:{padding:s}}}=this,a=this.legendHitBoxes=[],l=this.columnSizes=[],u=o-t;let c=s,h=0,d=0,p=0,f=0;return this.legendItems.forEach(((t,o)=>{const{itemWidth:g,itemHeight:m}=fl(n,e,i,t,r);o>0&&d+m+2*s>u&&(c+=h+s,l.push({width:h,height:d}),p+=h+s,f++,h=d=0),a[o]={left:p,top:d,col:f,width:g,height:m},h=Math.max(h,g),d+=m+s})),c+=h,l.push({width:h,height:d}),c}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:e,options:{align:n,labels:{padding:r},rtl:i}}=this,o=dr(i,this.left,this.width);if(this.isHorizontal()){let i=0,s=he(n,this.left+r,this.right-this.lineWidths[i]);for(const a of e)i!==a.row&&(i=a.row,s=he(n,this.left+r,this.right-this.lineWidths[i])),a.top+=this.top+t+r,a.left=o.leftForLtr(o.x(s),a.width),s+=a.width+r}else{let i=0,s=he(n,this.top+t+r,this.bottom-this.columnSizes[i].height);for(const a of e)a.col!==i&&(i=a.col,s=he(n,this.top+t+r,this.bottom-this.columnSizes[i].height)),a.top=s,a.left+=this.left+r,a.left=o.leftForLtr(o.x(a.left),a.width),s+=a.height+r}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){if(this.options.display){const t=this.ctx;qe(t,this),this._draw(),Ke(t)}}_draw(){const{options:t,columnSizes:e,lineWidths:n,ctx:r}=this,{align:i,labels:o}=t,s=Le.color,a=dr(t.rtl,this.left,this.width),l=hn(o.font),{padding:u}=o,c=l.size,h=c/2;let d;this.drawTitle(),r.textAlign=a.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=l.string;const{boxWidth:p,boxHeight:f,itemHeight:g}=hl(o,c),m=function(t,e,n){if(isNaN(p)||p<=0||isNaN(f)||f<0)return;r.save();const i=ot(n.lineWidth,1);if(r.fillStyle=ot(n.fillStyle,s),r.lineCap=ot(n.lineCap,"butt"),r.lineDashOffset=ot(n.lineDashOffset,0),r.lineJoin=ot(n.lineJoin,"miter"),r.lineWidth=i,r.strokeStyle=ot(n.strokeStyle,s),r.setLineDash(ot(n.lineDash,[])),o.usePointStyle){const s={radius:f*Math.SQRT2/2,pointStyle:n.pointStyle,rotation:n.rotation,borderWidth:i},l=a.xPlus(t,p/2),u=e+h;He(r,s,l,u,o.pointStyleWidth&&p)}else{const o=e+Math.max((c-f)/2,0),s=a.leftForLtr(t,p),l=un(n.borderRadius);r.beginPath(),Object.values(l).some((t=>0!==t))?en(r,{x:s,y:o,w:p,h:f,radius:l}):r.rect(s,o,p,f),r.fill(),0!==i&&r.stroke()}r.restore()},y=function(t,e,n){tn(r,n.text,t,e+g/2,l,{strikethrough:n.hidden,textAlign:a.textAlign(n.textAlign)})},b=this.isHorizontal(),v=this._computeTitleHeight();d=b?{x:he(i,this.left+u,this.right-n[0]),y:this.top+u+v,line:0}:{x:this.left+u,y:he(i,this.top+v+u,this.bottom-e[0].height),line:0},pr(this.ctx,t.textDirection);const w=g+u;this.legendItems.forEach(((s,c)=>{r.strokeStyle=s.fontColor,r.fillStyle=s.fontColor;const f=r.measureText(s.text).width,g=a.textAlign(s.textAlign||(s.textAlign=o.textAlign)),x=p+h+f;let k=d.x,_=d.y;a.setWidth(this.width),b?c>0&&k+x+u>this.right&&(_=d.y+=w,d.line++,k=d.x=he(i,this.left+u,this.right-n[d.line])):c>0&&_+w>this.bottom&&(k=d.x=k+e[d.line].width+u,d.line++,_=d.y=he(i,this.top+v+u,this.bottom-e[d.line].height));const I=a.x(k);if(m(I,_,s),k=de(g,k+p+h,b?k+x:this.right,t.rtl),y(a.x(k),_,s),b)d.x+=x+u;else if("string"!==typeof s.text){const t=l.lineHeight;d.y+=yl(s,t)+u}else d.y+=w})),fr(this.ctx,t.textDirection)}drawTitle(){const t=this.options,e=t.title,n=hn(e.font),r=cn(e.padding);if(!e.display)return;const i=dr(t.rtl,this.left,this.width),o=this.ctx,s=e.position,a=n.size/2,l=r.top+a;let u,c=this.left,h=this.width;if(this.isHorizontal())h=Math.max(...this.lineWidths),u=this.top+l,c=he(t.align,c,this.right-h);else{const e=this.columnSizes.reduce(((t,e)=>Math.max(t,e.height)),0);u=l+he(t.align,this.top,this.bottom-e-t.labels.padding-this._computeTitleHeight())}const d=he(s,c,c+h);o.textAlign=i.textAlign(ce(s)),o.textBaseline="middle",o.strokeStyle=e.color,o.fillStyle=e.color,o.font=n.string,tn(o,e.text,d,u,n)}_computeTitleHeight(){const t=this.options.title,e=hn(t.font),n=cn(t.padding);return t.display?e.lineHeight+n.height:0}_getLegendItemAt(t,e){let n,r,i;if(Zt(t,this.left,this.right)&&Zt(e,this.top,this.bottom))for(i=this.legendHitBoxes,n=0;n<i.length;++n)if(r=i[n],Zt(t,r.left,r.left+r.width)&&Zt(e,r.top,r.top+r.height))return this.legendItems[n];return null}handleEvent(t){const e=this.options;if(!bl(t.type,e))return;const n=this._getLegendItemAt(t.x,t.y);if("mousemove"===t.type||"mouseout"===t.type){const r=this._hoveredItem,i=dl(r,n);r&&!i&&lt(e.onLeave,[t,r,this],this),this._hoveredItem=n,n&&!i&&lt(e.onHover,[t,n,this],this)}else n&&lt(e.onClick,[t,n,this],this)}}function fl(t,e,n,r,i){const o=gl(r,t,e,n),s=ml(i,r,e.lineHeight);return{itemWidth:o,itemHeight:s}}function gl(t,e,n,r){let i=t.text;return i&&"string"!==typeof i&&(i=i.reduce(((t,e)=>t.length>e.length?t:e))),e+n.size/2+r.measureText(i).width}function ml(t,e,n){let r=t;return"string"!==typeof e.text&&(r=yl(e,n)),r}function yl(t,e){const n=t.text?t.text.length:0;return e*n}function bl(t,e){return!("mousemove"!==t&&"mouseout"!==t||!e.onHover&&!e.onLeave)||!(!e.onClick||"click"!==t&&"mouseup"!==t)}var vl={id:"legend",_element:pl,start(t,e,n){const r=t.legend=new pl({ctx:t.ctx,options:n,chart:t});to.configure(t,r,n),to.addBox(t,r)},stop(t){to.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,n){const r=t.legend;to.configure(t,r,n),r.options=n},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,n){const r=e.datasetIndex,i=n.chart;i.isDatasetVisible(r)?(i.hide(r),e.hidden=!0):(i.show(r),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:n,pointStyle:r,textAlign:i,color:o,useBorderRadius:s,borderRadius:a}}=t.legend.options;return t._getSortedDatasetMetas().map((t=>{const l=t.controller.getStyle(n?0:void 0),u=cn(l.borderWidth);return{text:e[t.index].label,fillStyle:l.backgroundColor,fontColor:o,hidden:!t.visible,lineCap:l.borderCapStyle,lineDash:l.borderDash,lineDashOffset:l.borderDashOffset,lineJoin:l.borderJoinStyle,lineWidth:(u.width+u.height)/4,strokeStyle:l.borderColor,pointStyle:r||l.pointStyle,rotation:l.rotation,textAlign:i||l.textAlign,borderRadius:s&&(a||l.borderRadius),datasetIndex:t.index}}),this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class wl extends Co{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e){const n=this.options;if(this.left=0,this.top=0,!n.display)return void(this.width=this.height=this.right=this.bottom=0);this.width=this.right=t,this.height=this.bottom=e;const r=et(n.text)?n.text.length:1;this._padding=cn(n.padding);const i=r*hn(n.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=i:this.width=i}isHorizontal(){const t=this.options.position;return"top"===t||"bottom"===t}_drawArgs(t){const{top:e,left:n,bottom:r,right:i,options:o}=this,s=o.align;let a,l,u,c=0;return this.isHorizontal()?(l=he(s,n,i),u=e+t,a=i-n):("left"===o.position?(l=n+t,u=he(s,r,e),c=-.5*St):(l=i-t,u=he(s,e,r),c=.5*St),a=r-e),{titleX:l,titleY:u,maxWidth:a,rotation:c}}draw(){const t=this.ctx,e=this.options;if(!e.display)return;const n=hn(e.font),r=n.lineHeight,i=r/2+this._padding.top,{titleX:o,titleY:s,maxWidth:a,rotation:l}=this._drawArgs(i);tn(t,e.text,0,0,n,{color:e.color,maxWidth:a,rotation:l,textAlign:ce(e.align),textBaseline:"middle",translation:[o,s]})}}function xl(t,e){const n=new wl({ctx:t.ctx,options:e,chart:t});to.configure(t,n,e),to.addBox(t,n),t.titleBlock=n}var kl={id:"title",_element:wl,start(t,e,n){xl(t,n)},stop(t){const e=t.titleBlock;to.removeBox(t,e),delete t.titleBlock},beforeUpdate(t,e,n){const r=t.titleBlock;to.configure(t,r,n),r.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const _l=new WeakMap;var Il={id:"subtitle",start(t,e,n){const r=new wl({ctx:t.ctx,options:n,chart:t});to.configure(t,r,n),to.addBox(t,r),_l.set(t,r)},stop(t){to.removeBox(t,_l.get(t)),_l.delete(t)},beforeUpdate(t,e,n){const r=_l.get(t);to.configure(t,r,n),r.options=n},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Cl={average(t){if(!t.length)return!1;let e,n,r=0,i=0,o=0;for(e=0,n=t.length;e<n;++e){const n=t[e].element;if(n&&n.hasValue()){const t=n.tooltipPosition();r+=t.x,i+=t.y,++o}}return{x:r/o,y:i/o}},nearest(t,e){if(!t.length)return!1;let n,r,i,o=e.x,s=e.y,a=Number.POSITIVE_INFINITY;for(n=0,r=t.length;n<r;++n){const r=t[n].element;if(r&&r.hasValue()){const t=r.getCenterPoint(),n=Gt(e,t);n<a&&(a=n,i=r)}}if(i){const t=i.tooltipPosition();o=t.x,s=t.y}return{x:o,y:s}}};function Sl(t,e){return e&&(et(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function Tl(t){return("string"===typeof t||t instanceof String)&&t.indexOf("\n")>-1?t.split("\n"):t}function El(t,e){const{element:n,datasetIndex:r,index:i}=e,o=t.getDatasetMeta(r).controller,{label:s,value:a}=o.getLabelAndValue(i);return{chart:t,label:s,parsed:o.getParsed(i),raw:t.data.datasets[r].data[i],formattedValue:a,dataset:o.getDataset(),dataIndex:i,datasetIndex:r,element:n}}function Nl(t,e){const n=t.chart.ctx,{body:r,footer:i,title:o}=t,{boxWidth:s,boxHeight:a}=e,l=hn(e.bodyFont),u=hn(e.titleFont),c=hn(e.footerFont),h=o.length,d=i.length,p=r.length,f=cn(e.padding);let g=f.height,m=0,y=r.reduce(((t,e)=>t+e.before.length+e.lines.length+e.after.length),0);if(y+=t.beforeBody.length+t.afterBody.length,h&&(g+=h*u.lineHeight+(h-1)*e.titleSpacing+e.titleMarginBottom),y){const t=e.displayColors?Math.max(a,l.lineHeight):l.lineHeight;g+=p*t+(y-p)*l.lineHeight+(y-1)*e.bodySpacing}d&&(g+=e.footerMarginTop+d*c.lineHeight+(d-1)*e.footerSpacing);let b=0;const v=function(t){m=Math.max(m,n.measureText(t).width+b)};return n.save(),n.font=u.string,ut(t.title,v),n.font=l.string,ut(t.beforeBody.concat(t.afterBody),v),b=e.displayColors?s+2+e.boxPadding:0,ut(r,(t=>{ut(t.before,v),ut(t.lines,v),ut(t.after,v)})),b=0,n.font=c.string,ut(t.footer,v),n.restore(),m+=f.width,{width:m,height:g}}function Al(t,e){const{y:n,height:r}=e;return n<r/2?"top":n>t.height-r/2?"bottom":"center"}function Rl(t,e,n,r){const{x:i,width:o}=r,s=n.caretSize+n.caretPadding;return"left"===t&&i+o+s>e.width||("right"===t&&i-o-s<0||void 0)}function $l(t,e,n,r){const{x:i,width:o}=n,{width:s,chartArea:{left:a,right:l}}=t;let u="center";return"center"===r?u=i<=(a+l)/2?"left":"right":i<=o/2?u="left":i>=s-o/2&&(u="right"),Rl(u,t,e,n)&&(u="center"),u}function Dl(t,e,n){const r=n.yAlign||e.yAlign||Al(t,n);return{xAlign:n.xAlign||e.xAlign||$l(t,e,n,r),yAlign:r}}function Ol(t,e){let{x:n,width:r}=t;return"right"===e?n-=r:"center"===e&&(n-=r/2),n}function Fl(t,e,n){let{y:r,height:i}=t;return"top"===e?r+=n:r-="bottom"===e?i+n:i/2,r}function Ml(t,e,n,r){const{caretSize:i,caretPadding:o,cornerRadius:s}=t,{xAlign:a,yAlign:l}=n,u=i+o,{topLeft:c,topRight:h,bottomLeft:d,bottomRight:p}=un(s);let f=Ol(e,a);const g=Fl(e,l,u);return"center"===l?"left"===a?f+=u:"right"===a&&(f-=u):"left"===a?f-=Math.max(c,d)+i:"right"===a&&(f+=Math.max(h,p)+i),{x:Yt(f,0,r.width-e.width),y:Yt(g,0,r.height-e.height)}}function Pl(t,e,n){const r=cn(n.padding);return"center"===e?t.x+t.width/2:"right"===e?t.x+t.width-r.right:t.x+r.left}function Ll(t){return Sl([],Tl(t))}function zl(t,e,n){return fn(t,{tooltip:e,tooltipItems:n,type:"tooltip"})}function Bl(t,e){const n=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return n?t.override(n):t}const Wl={beforeTitle:Z,title(t){if(t.length>0){const e=t[0],n=e.chart.data.labels,r=n?n.length:0;if(this&&this.options&&"dataset"===this.options.mode)return e.dataset.label||"";if(e.label)return e.label;if(r>0&&e.dataIndex<r)return n[e.dataIndex]}return""},afterTitle:Z,beforeBody:Z,beforeLabel:Z,label(t){if(this&&this.options&&"dataset"===this.options.mode)return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const n=t.formattedValue;return tt(n)||(e+=n),e},labelColor(t){const e=t.chart.getDatasetMeta(t.datasetIndex),n=e.controller.getStyle(t.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const e=t.chart.getDatasetMeta(t.datasetIndex),n=e.controller.getStyle(t.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:Z,afterBody:Z,beforeFooter:Z,footer:Z,afterFooter:Z};function Ul(t,e,n,r){const i=t[e].call(n,r);return"undefined"===typeof i?Wl[e].call(n,r):i}class Vl extends Co{constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const e=this.chart,n=this.options.setContext(this.getContext()),r=n.enabled&&e.options.animation&&n.animations,i=new $r(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(i)),i}getContext(){return this.$context||(this.$context=zl(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,e){const{callbacks:n}=e,r=Ul(n,"beforeTitle",this,t),i=Ul(n,"title",this,t),o=Ul(n,"afterTitle",this,t);let s=[];return s=Sl(s,Tl(r)),s=Sl(s,Tl(i)),s=Sl(s,Tl(o)),s}getBeforeBody(t,e){return Ll(Ul(e.callbacks,"beforeBody",this,t))}getBody(t,e){const{callbacks:n}=e,r=[];return ut(t,(t=>{const e={before:[],lines:[],after:[]},i=Bl(n,t);Sl(e.before,Tl(Ul(i,"beforeLabel",this,t))),Sl(e.lines,Ul(i,"label",this,t)),Sl(e.after,Tl(Ul(i,"afterLabel",this,t))),r.push(e)})),r}getAfterBody(t,e){return Ll(Ul(e.callbacks,"afterBody",this,t))}getFooter(t,e){const{callbacks:n}=e,r=Ul(n,"beforeFooter",this,t),i=Ul(n,"footer",this,t),o=Ul(n,"afterFooter",this,t);let s=[];return s=Sl(s,Tl(r)),s=Sl(s,Tl(i)),s=Sl(s,Tl(o)),s}_createItems(t){const e=this._active,n=this.chart.data,r=[],i=[],o=[];let s,a,l=[];for(s=0,a=e.length;s<a;++s)l.push(El(this.chart,e[s]));return t.filter&&(l=l.filter(((e,r,i)=>t.filter(e,r,i,n)))),t.itemSort&&(l=l.sort(((e,r)=>t.itemSort(e,r,n)))),ut(l,(e=>{const n=Bl(t.callbacks,e);r.push(Ul(n,"labelColor",this,e)),i.push(Ul(n,"labelPointStyle",this,e)),o.push(Ul(n,"labelTextColor",this,e))})),this.labelColors=r,this.labelPointStyles=i,this.labelTextColors=o,this.dataPoints=l,l}update(t,e){const n=this.options.setContext(this.getContext()),r=this._active;let i,o=[];if(r.length){const t=Cl[n.position].call(this,r,this._eventPosition);o=this._createItems(n),this.title=this.getTitle(o,n),this.beforeBody=this.getBeforeBody(o,n),this.body=this.getBody(o,n),this.afterBody=this.getAfterBody(o,n),this.footer=this.getFooter(o,n);const e=this._size=Nl(this,n),s=Object.assign({},t,e),a=Dl(this.chart,n,s),l=Ml(n,s,a,this.chart);this.xAlign=a.xAlign,this.yAlign=a.yAlign,i={opacity:1,x:l.x,y:l.y,width:e.width,height:e.height,caretX:t.x,caretY:t.y}}else 0!==this.opacity&&(i={opacity:0});this._tooltipItems=o,this.$context=void 0,i&&this._resolveAnimations().update(this,i),t&&n.external&&n.external.call(this,{chart:this.chart,tooltip:this,replay:e})}drawCaret(t,e,n,r){const i=this.getCaretPosition(t,n,r);e.lineTo(i.x1,i.y1),e.lineTo(i.x2,i.y2),e.lineTo(i.x3,i.y3)}getCaretPosition(t,e,n){const{xAlign:r,yAlign:i}=this,{caretSize:o,cornerRadius:s}=n,{topLeft:a,topRight:l,bottomLeft:u,bottomRight:c}=un(s),{x:h,y:d}=t,{width:p,height:f}=e;let g,m,y,b,v,w;return"center"===i?(v=d+f/2,"left"===r?(g=h,m=g-o,b=v+o,w=v-o):(g=h+p,m=g+o,b=v-o,w=v+o),y=g):(m="left"===r?h+Math.max(a,u)+o:"right"===r?h+p-Math.max(l,c)-o:this.caretX,"top"===i?(b=d,v=b-o,g=m-o,y=m+o):(b=d+f,v=b+o,g=m+o,y=m-o),w=b),{x1:g,x2:m,x3:y,y1:b,y2:v,y3:w}}drawTitle(t,e,n){const r=this.title,i=r.length;let o,s,a;if(i){const l=dr(n.rtl,this.x,this.width);for(t.x=Pl(this,n.titleAlign,n),e.textAlign=l.textAlign(n.titleAlign),e.textBaseline="middle",o=hn(n.titleFont),s=n.titleSpacing,e.fillStyle=n.titleColor,e.font=o.string,a=0;a<i;++a)e.fillText(r[a],l.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+s,a+1===i&&(t.y+=n.titleMarginBottom-s)}}_drawColorBox(t,e,n,r,i){const o=this.labelColors[n],s=this.labelPointStyles[n],{boxHeight:a,boxWidth:l}=i,u=hn(i.bodyFont),c=Pl(this,"left",i),h=r.x(c),d=a<u.lineHeight?(u.lineHeight-a)/2:0,p=e.y+d;if(i.usePointStyle){const e={radius:Math.min(l,a)/2,pointStyle:s.pointStyle,rotation:s.rotation,borderWidth:1},n=r.leftForLtr(h,l)+l/2,u=p+a/2;t.strokeStyle=i.multiKeyBackground,t.fillStyle=i.multiKeyBackground,je(t,e,n,u),t.strokeStyle=o.borderColor,t.fillStyle=o.backgroundColor,je(t,e,n,u)}else{t.lineWidth=nt(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,t.strokeStyle=o.borderColor,t.setLineDash(o.borderDash||[]),t.lineDashOffset=o.borderDashOffset||0;const e=r.leftForLtr(h,l),n=r.leftForLtr(r.xPlus(h,1),l-2),s=un(o.borderRadius);Object.values(s).some((t=>0!==t))?(t.beginPath(),t.fillStyle=i.multiKeyBackground,en(t,{x:e,y:p,w:l,h:a,radius:s}),t.fill(),t.stroke(),t.fillStyle=o.backgroundColor,t.beginPath(),en(t,{x:n,y:p+1,w:l-2,h:a-2,radius:s}),t.fill()):(t.fillStyle=i.multiKeyBackground,t.fillRect(e,p,l,a),t.strokeRect(e,p,l,a),t.fillStyle=o.backgroundColor,t.fillRect(n,p+1,l-2,a-2))}t.fillStyle=this.labelTextColors[n]}drawBody(t,e,n){const{body:r}=this,{bodySpacing:i,bodyAlign:o,displayColors:s,boxHeight:a,boxWidth:l,boxPadding:u}=n,c=hn(n.bodyFont);let h=c.lineHeight,d=0;const p=dr(n.rtl,this.x,this.width),f=function(n){e.fillText(n,p.x(t.x+d),t.y+h/2),t.y+=h+i},g=p.textAlign(o);let m,y,b,v,w,x,k;for(e.textAlign=o,e.textBaseline="middle",e.font=c.string,t.x=Pl(this,g,n),e.fillStyle=n.bodyColor,ut(this.beforeBody,f),d=s&&"right"!==g?"center"===o?l/2+u:l+2+u:0,v=0,x=r.length;v<x;++v){for(m=r[v],y=this.labelTextColors[v],e.fillStyle=y,ut(m.before,f),b=m.lines,s&&b.length&&(this._drawColorBox(e,t,v,p,n),h=Math.max(c.lineHeight,a)),w=0,k=b.length;w<k;++w)f(b[w]),h=c.lineHeight;ut(m.after,f)}d=0,h=c.lineHeight,ut(this.afterBody,f),t.y-=i}drawFooter(t,e,n){const r=this.footer,i=r.length;let o,s;if(i){const a=dr(n.rtl,this.x,this.width);for(t.x=Pl(this,n.footerAlign,n),t.y+=n.footerMarginTop,e.textAlign=a.textAlign(n.footerAlign),e.textBaseline="middle",o=hn(n.footerFont),e.fillStyle=n.footerColor,e.font=o.string,s=0;s<i;++s)e.fillText(r[s],a.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+n.footerSpacing}}drawBackground(t,e,n,r){const{xAlign:i,yAlign:o}=this,{x:s,y:a}=t,{width:l,height:u}=n,{topLeft:c,topRight:h,bottomLeft:d,bottomRight:p}=un(r.cornerRadius);e.fillStyle=r.backgroundColor,e.strokeStyle=r.borderColor,e.lineWidth=r.borderWidth,e.beginPath(),e.moveTo(s+c,a),"top"===o&&this.drawCaret(t,e,n,r),e.lineTo(s+l-h,a),e.quadraticCurveTo(s+l,a,s+l,a+h),"center"===o&&"right"===i&&this.drawCaret(t,e,n,r),e.lineTo(s+l,a+u-p),e.quadraticCurveTo(s+l,a+u,s+l-p,a+u),"bottom"===o&&this.drawCaret(t,e,n,r),e.lineTo(s+d,a+u),e.quadraticCurveTo(s,a+u,s,a+u-d),"center"===o&&"left"===i&&this.drawCaret(t,e,n,r),e.lineTo(s,a+c),e.quadraticCurveTo(s,a,s+c,a),e.closePath(),e.fill(),r.borderWidth>0&&e.stroke()}_updateAnimationTarget(t){const e=this.chart,n=this.$animations,r=n&&n.x,i=n&&n.y;if(r||i){const n=Cl[t.position].call(this,this._active,this._eventPosition);if(!n)return;const o=this._size=Nl(this,t),s=Object.assign({},n,this._size),a=Dl(e,t,s),l=Ml(t,s,a,e);r._to===l.x&&i._to===l.y||(this.xAlign=a.xAlign,this.yAlign=a.yAlign,this.width=o.width,this.height=o.height,this.caretX=n.x,this.caretY=n.y,this._resolveAnimations().update(this,l))}}_willRender(){return!!this.opacity}draw(t){const e=this.options.setContext(this.getContext());let n=this.opacity;if(!n)return;this._updateAnimationTarget(e);const r={width:this.width,height:this.height},i={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;const o=cn(e.padding),s=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;e.enabled&&s&&(t.save(),t.globalAlpha=n,this.drawBackground(i,t,r,e),pr(t,e.textDirection),i.y+=o.top,this.drawTitle(i,t,e),this.drawBody(i,t,e),this.drawFooter(i,t,e),fr(t,e.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,e){const n=this._active,r=t.map((({datasetIndex:t,index:e})=>{const n=this.chart.getDatasetMeta(t);if(!n)throw new Error("Cannot find a dataset at index "+t);return{datasetIndex:t,element:n.data[e],index:e}})),i=!ct(n,r),o=this._positionChanged(r,e);(i||o)&&(this._active=r,this._eventPosition=e,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,e,n=!0){if(e&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,i=this._active||[],o=this._getActiveElements(t,i,e,n),s=this._positionChanged(o,t),a=e||!ct(o,i)||s;return a&&(this._active=o,(r.enabled||r.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,e))),a}_getActiveElements(t,e,n,r){const i=this.options;if("mouseout"===t.type)return[];if(!r)return e.filter((t=>this.chart.data.datasets[t.datasetIndex]&&void 0!==this.chart.getDatasetMeta(t.datasetIndex).controller.getParsed(t.index)));const o=this.chart.getElementsAtEventForMode(t,i.mode,i,n);return i.reverse&&o.reverse(),o}_positionChanged(t,e){const{caretX:n,caretY:r,options:i}=this,o=Cl[i.position].call(this,t,e);return!1!==o&&(n!==o.x||r!==o.y)}}s(Vl,"positioners",Cl);var jl={id:"tooltip",_element:Vl,positioners:Cl,afterInit(t,e,n){n&&(t.tooltip=new Vl({chart:t,options:n}))},beforeUpdate(t,e,n){t.tooltip&&t.tooltip.initialize(n)},reset(t,e,n){t.tooltip&&t.tooltip.initialize(n)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const n={tooltip:e};if(!1===t.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0}))return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",n)}},afterEvent(t,e){if(t.tooltip){const n=e.replay;t.tooltip.handleEvent(e.event,n,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:Wl},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>"filter"!==t&&"itemSort"!==t&&"external"!==t,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},Hl=Object.freeze({__proto__:null,Colors:Ea,Decimation:Oa,Filler:cl,Legend:vl,SubTitle:Il,Title:kl,Tooltip:jl});const Gl=(t,e,n,r)=>("string"===typeof e?(n=t.push(e)-1,r.unshift({index:n,label:e})):isNaN(e)&&(n=null),n);function ql(t,e,n,r){const i=t.indexOf(e);if(-1===i)return Gl(t,e,n,r);const o=t.lastIndexOf(e);return i!==o?n:i}const Kl=(t,e)=>null===t?null:Yt(Math.round(t),0,e);function Xl(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}class Yl extends Ho{constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const e=this._addedLabels;if(e.length){const t=this.getLabels();for(const{index:n,label:r}of e)t[n]===r&&t.splice(n,1);this._addedLabels=[]}super.init(t)}parse(t,e){if(tt(t))return null;const n=this.getLabels();return e=isFinite(e)&&n[e]===t?e:ql(n,t,ot(e,t),this._addedLabels),Kl(e,n.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let{min:n,max:r}=this.getMinMax(!0);"ticks"===this.options.bounds&&(t||(n=0),e||(r=this.getLabels().length-1)),this.min=n,this.max=r}buildTicks(){const t=this.min,e=this.max,n=this.options.offset,r=[];let i=this.getLabels();i=0===t&&e===i.length-1?i:i.slice(t,e+1),this._valueRange=Math.max(i.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(let o=t;o<=e;o++)r.push({value:o});return r}getLabelForValue(t){return Xl.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return"number"!==typeof t&&(t=this.parse(t)),null===t?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}function Jl(t,e){const n=[],r=1e-14,{bounds:i,step:o,min:s,max:a,precision:l,count:u,maxTicks:c,maxDigits:h,includeBounds:d}=t,p=o||1,f=c-1,{min:g,max:m}=e,y=!tt(s),b=!tt(a),v=!tt(u),w=(m-g)/(h+1);let x,k,_,I,C=Pt((m-g)/f/p)*p;if(C<r&&!y&&!b)return[{value:g},{value:m}];I=Math.ceil(m/C)-Math.floor(g/C),I>f&&(C=Pt(I*C/f/p)*p),tt(l)||(x=Math.pow(10,l),C=Math.ceil(C*x)/x),"ticks"===i?(k=Math.floor(g/C)*C,_=Math.ceil(m/C)*C):(k=g,_=m),y&&b&&o&&Bt((a-s)/o,C/1e3)?(I=Math.round(Math.min((a-s)/C,c)),C=(a-s)/I,k=s,_=a):v?(k=y?s:k,_=b?a:_,I=u-1,C=(_-k)/I):(I=(_-k)/C,I=Mt(I,Math.round(I),C/1e3)?Math.round(I):Math.ceil(I));const S=Math.max(jt(C),jt(k));x=Math.pow(10,tt(l)?S:l),k=Math.round(k*x)/x,_=Math.round(_*x)/x;let T=0;for(y&&(d&&k!==s?(n.push({value:s}),k<s&&T++,Mt(Math.round((k+T*C)*x)/x,s,Zl(s,w,t))&&T++):k<s&&T++);T<I;++T){const t=Math.round((k+T*C)*x)/x;if(b&&t>a)break;n.push({value:t})}return b&&d&&_!==a?n.length&&Mt(n[n.length-1].value,a,Zl(a,w,t))?n[n.length-1].value=a:n.push({value:a}):b&&_!==a||n.push({value:_}),n}function Zl(t,e,{horizontal:n,minRotation:r}){const i=Ut(r),o=(n?Math.sin(i):Math.cos(i))||.001,s=.75*e*(""+t).length;return Math.min(e/o,s)}s(Yl,"id","category"),s(Yl,"defaults",{ticks:{callback:Xl}});class Ql extends Ho{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,e){return tt(t)||("number"===typeof t||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:e,maxDefined:n}=this.getUserBounds();let{min:r,max:i}=this;const o=t=>r=e?r:t,s=t=>i=n?i:t;if(t){const t=Ft(r),e=Ft(i);t<0&&e<0?s(0):t>0&&e>0&&o(0)}if(r===i){let e=0===i?1:Math.abs(.05*i);s(i+e),t||o(r-e)}this.min=r,this.max=i}getTickLimit(){const t=this.options.ticks;let e,{maxTicksLimit:n,stepSize:r}=t;return r?(e=Math.ceil(this.max/r)-Math.floor(this.min/r)+1,e>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${r} would result generating up to ${e} ticks. Limiting to 1000.`),e=1e3)):(e=this.computeTickLimit(),n=n||11),n&&(e=Math.min(n,e)),e}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,e=t.ticks;let n=this.getTickLimit();n=Math.max(2,n);const r={maxTicks:n,bounds:t.bounds,min:t.min,max:t.max,precision:e.precision,step:e.stepSize,count:e.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:e.minRotation||0,includeBounds:!1!==e.includeBounds},i=this._range||this,o=Jl(r,i);return"ticks"===t.bounds&&Wt(o,this,"value"),t.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const t=this.ticks;let e=this.min,n=this.max;if(super.configure(),this.options.offset&&t.length){const r=(n-e)/Math.max(t.length-1,1)/2;e-=r,n+=r}this._startValue=e,this._endValue=n,this._valueRange=n-e}getLabelForValue(t){return Ee(t,this.chart.options.locale,this.options.ticks.format)}}class tu extends Ql{determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=rt(t)?t:0,this.max=rt(e)?e:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),e=t?this.width:this.height,n=Ut(this.options.ticks.minRotation),r=(t?Math.sin(n):Math.cos(n))||.001,i=this._resolveTickFontOptions(0);return Math.ceil(e/Math.min(40,i.lineHeight/r))}getPixelForValue(t){return null===t?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}s(tu,"id","linear"),s(tu,"defaults",{ticks:{callback:Re.formatters.numeric}});const eu=t=>Math.floor(Ot(t)),nu=(t,e)=>Math.pow(10,eu(t)+e);function ru(t){const e=t/Math.pow(10,eu(t));return 1===e}function iu(t,e,n){const r=Math.pow(10,n),i=Math.floor(t/r),o=Math.ceil(e/r);return o-i}function ou(t,e){const n=e-t;let r=eu(n);while(iu(t,e,r)>10)r++;while(iu(t,e,r)<10)r--;return Math.min(r,eu(t))}function su(t,{min:e,max:n}){e=it(t.min,e);const r=[],i=eu(e);let o=ou(e,n),s=o<0?Math.pow(10,Math.abs(o)):1;const a=Math.pow(10,o),l=i>o?Math.pow(10,i):0,u=Math.round((e-l)*s)/s,c=Math.floor((e-l)/a/10)*a*10;let h=Math.floor((u-c)/Math.pow(10,o)),d=it(t.min,Math.round((l+c+h*Math.pow(10,o))*s)/s);while(d<n)r.push({value:d,major:ru(d),significand:h}),h>=10?h=h<15?15:20:h++,h>=20&&(o++,h=2,s=o>=0?1:s),d=Math.round((l+c+h*Math.pow(10,o))*s)/s;const p=it(t.max,d);return r.push({value:p,major:ru(p),significand:h}),r}class au extends Ho{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,e){const n=Ql.prototype.parse.apply(this,[t,e]);if(0!==n)return rt(n)&&n>0?n:null;this._zero=!0}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=rt(t)?Math.max(0,t):null,this.max=rt(e)?Math.max(0,e):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!rt(this._userMin)&&(this.min=t===nu(this.min,0)?nu(this.min,-1):nu(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let n=this.min,r=this.max;const i=e=>n=t?n:e,o=t=>r=e?r:t;n===r&&(n<=0?(i(1),o(10)):(i(nu(n,-1)),o(nu(r,1)))),n<=0&&i(nu(r,-1)),r<=0&&o(nu(n,1)),this.min=n,this.max=r}buildTicks(){const t=this.options,e={min:this._userMin,max:this._userMax},n=su(e,this);return"ticks"===t.bounds&&Wt(n,this,"value"),t.reverse?(n.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),n}getLabelForValue(t){return void 0===t?"0":Ee(t,this.chart.options.locale,this.options.ticks.format)}configure(){const t=this.min;super.configure(),this._startValue=Ot(t),this._valueRange=Ot(this.max)-Ot(t)}getPixelForValue(t){return void 0!==t&&0!==t||(t=this.min),null===t||isNaN(t)?NaN:this.getPixelForDecimal(t===this.min?0:(Ot(t)-this._startValue)/this._valueRange)}getValueForPixel(t){const e=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+e*this._valueRange)}}function lu(t){const e=t.ticks;if(e.display&&t.display){const t=cn(e.backdropPadding);return ot(e.font&&e.font.size,Le.font.size)+t.height}return 0}function uu(t,e,n){return n=et(n)?n:[n],{w:We(t,e.string,n),h:n.length*e.lineHeight}}function cu(t,e,n,r,i){return t===r||t===i?{start:e-n/2,end:e+n/2}:t<r||t>i?{start:e-n,end:e}:{start:e,end:e+n}}function hu(t){const e={l:t.left+t._padding.left,r:t.right-t._padding.right,t:t.top+t._padding.top,b:t.bottom-t._padding.bottom},n=Object.assign({},e),r=[],i=[],o=t._pointLabels.length,s=t.options.pointLabels,a=s.centerPointLabels?St/o:0;for(let l=0;l<o;l++){const o=s.setContext(t.getPointLabelContext(l));i[l]=o.padding;const u=t.getPointPosition(l,t.drawingArea+i[l],a),c=hn(o.font),h=uu(t.ctx,c,t._pointLabels[l]);r[l]=h;const d=Kt(t.getIndexAngle(l)+a),p=Math.round(Vt(d)),f=cu(p,u.x,h.w,0,180),g=cu(p,u.y,h.h,90,270);du(n,e,d,f,g)}t.setCenterPoint(e.l-n.l,n.r-e.r,e.t-n.t,n.b-e.b),t._pointLabelItems=gu(t,r,i)}function du(t,e,n,r,i){const o=Math.abs(Math.sin(n)),s=Math.abs(Math.cos(n));let a=0,l=0;r.start<e.l?(a=(e.l-r.start)/o,t.l=Math.min(t.l,e.l-a)):r.end>e.r&&(a=(r.end-e.r)/o,t.r=Math.max(t.r,e.r+a)),i.start<e.t?(l=(e.t-i.start)/s,t.t=Math.min(t.t,e.t-l)):i.end>e.b&&(l=(i.end-e.b)/s,t.b=Math.max(t.b,e.b+l))}function pu(t,e,n){const r=t.drawingArea,{extra:i,additionalAngle:o,padding:s,size:a}=n,l=t.getPointPosition(e,r+i+s,o),u=Math.round(Vt(Kt(l.angle+Rt))),c=bu(l.y,a.h,u),h=mu(u),d=yu(l.x,a.w,h);return{visible:!0,x:l.x,y:c,textAlign:h,left:d,top:c,right:d+a.w,bottom:c+a.h}}function fu(t,e){if(!e)return!0;const{left:n,top:r,right:i,bottom:o}=t,s=Ge({x:n,y:r},e)||Ge({x:n,y:o},e)||Ge({x:i,y:r},e)||Ge({x:i,y:o},e);return!s}function gu(t,e,n){const r=[],i=t._pointLabels.length,o=t.options,{centerPointLabels:s,display:a}=o.pointLabels,l={extra:lu(o)/2,additionalAngle:s?St/i:0};let u;for(let c=0;c<i;c++){l.padding=n[c],l.size=e[c];const i=pu(t,c,l);r.push(i),"auto"===a&&(i.visible=fu(i,u),i.visible&&(u=i))}return r}function mu(t){return 0===t||180===t?"center":t<180?"left":"right"}function yu(t,e,n){return"right"===n?t-=e:"center"===n&&(t-=e/2),t}function bu(t,e,n){return 90===n||270===n?t-=e/2:(n>270||n<90)&&(t-=e),t}function vu(t,e,n){const{left:r,top:i,right:o,bottom:s}=n,{backdropColor:a}=e;if(!tt(a)){const n=un(e.borderRadius),l=cn(e.backdropPadding);t.fillStyle=a;const u=r-l.left,c=i-l.top,h=o-r+l.width,d=s-i+l.height;Object.values(n).some((t=>0!==t))?(t.beginPath(),en(t,{x:u,y:c,w:h,h:d,radius:n}),t.fill()):t.fillRect(u,c,h,d)}}function wu(t,e){const{ctx:n,options:{pointLabels:r}}=t;for(let i=e-1;i>=0;i--){const e=t._pointLabelItems[i];if(!e.visible)continue;const o=r.setContext(t.getPointLabelContext(i));vu(n,o,e);const s=hn(o.font),{x:a,y:l,textAlign:u}=e;tn(n,t._pointLabels[i],a,l+s.lineHeight/2,s,{color:o.color,textAlign:u,textBaseline:"middle"})}}function xu(t,e,n,r){const{ctx:i}=t;if(n)i.arc(t.xCenter,t.yCenter,e,0,Tt);else{let n=t.getPointPosition(0,e);i.moveTo(n.x,n.y);for(let o=1;o<r;o++)n=t.getPointPosition(o,e),i.lineTo(n.x,n.y)}}function ku(t,e,n,r,i){const o=t.ctx,s=e.circular,{color:a,lineWidth:l}=e;!s&&!r||!a||!l||n<0||(o.save(),o.strokeStyle=a,o.lineWidth=l,o.setLineDash(i.dash),o.lineDashOffset=i.dashOffset,o.beginPath(),xu(t,n,s,r),o.closePath(),o.stroke(),o.restore())}function _u(t,e,n){return fn(t,{label:n,index:e,type:"pointLabel"})}s(au,"id","logarithmic"),s(au,"defaults",{ticks:{callback:Re.formatters.logarithmic,major:{enabled:!0}}});class Iu extends Ql{constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const t=this._padding=cn(lu(this.options)/2),e=this.width=this.maxWidth-t.width,n=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+e/2+t.left),this.yCenter=Math.floor(this.top+n/2+t.top),this.drawingArea=Math.floor(Math.min(e,n)/2)}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!1);this.min=rt(t)&&!isNaN(t)?t:0,this.max=rt(e)&&!isNaN(e)?e:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/lu(this.options))}generateTickLabels(t){Ql.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map(((t,e)=>{const n=lt(this.options.pointLabels.callback,[t,e],this);return n||0===n?n:""})).filter(((t,e)=>this.chart.getDataVisibility(e)))}fit(){const t=this.options;t.display&&t.pointLabels.display?hu(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,e,n,r){this.xCenter+=Math.floor((t-e)/2),this.yCenter+=Math.floor((n-r)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,e,n,r))}getIndexAngle(t){const e=Tt/(this._pointLabels.length||1),n=this.options.startAngle||0;return Kt(t*e+Ut(n))}getDistanceFromCenterForValue(t){if(tt(t))return NaN;const e=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*e:(t-this.min)*e}getValueForDistanceFromCenter(t){if(tt(t))return NaN;const e=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-e:this.min+e}getPointLabelContext(t){const e=this._pointLabels||[];if(t>=0&&t<e.length){const n=e[t];return _u(this.getContext(),t,n)}}getPointPosition(t,e,n=0){const r=this.getIndexAngle(t)-Rt+n;return{x:Math.cos(r)*e+this.xCenter,y:Math.sin(r)*e+this.yCenter,angle:r}}getPointPositionForValue(t,e){return this.getPointPosition(t,this.getDistanceFromCenterForValue(e))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){const{left:e,top:n,right:r,bottom:i}=this._pointLabelItems[t];return{left:e,top:n,right:r,bottom:i}}drawBackground(){const{backgroundColor:t,grid:{circular:e}}=this.options;if(t){const n=this.ctx;n.save(),n.beginPath(),xu(this,this.getDistanceFromCenterForValue(this._endValue),e,this._pointLabels.length),n.closePath(),n.fillStyle=t,n.fill(),n.restore()}}drawGrid(){const t=this.ctx,e=this.options,{angleLines:n,grid:r,border:i}=e,o=this._pointLabels.length;let s,a,l;if(e.pointLabels.display&&wu(this,o),r.display&&this.ticks.forEach(((t,e)=>{if(0!==e){a=this.getDistanceFromCenterForValue(t.value);const n=this.getContext(e),s=r.setContext(n),l=i.setContext(n);ku(this,s,a,o,l)}})),n.display){for(t.save(),s=o-1;s>=0;s--){const r=n.setContext(this.getPointLabelContext(s)),{color:i,lineWidth:o}=r;o&&i&&(t.lineWidth=o,t.strokeStyle=i,t.setLineDash(r.borderDash),t.lineDashOffset=r.borderDashOffset,a=this.getDistanceFromCenterForValue(e.ticks.reverse?this.min:this.max),l=this.getPointPosition(s,a),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(l.x,l.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){const t=this.ctx,e=this.options,n=e.ticks;if(!n.display)return;const r=this.getIndexAngle(0);let i,o;t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(r),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach(((r,s)=>{if(0===s&&!e.reverse)return;const a=n.setContext(this.getContext(s)),l=hn(a.font);if(i=this.getDistanceFromCenterForValue(this.ticks[s].value),a.showLabelBackdrop){t.font=l.string,o=t.measureText(r.label).width,t.fillStyle=a.backdropColor;const e=cn(a.backdropPadding);t.fillRect(-o/2-e.left,-i-l.size/2-e.top,o+e.width,l.size+e.height)}tn(t,r.label,0,-i,l,{color:a.color,strokeColor:a.textStrokeColor,strokeWidth:a.textStrokeWidth})})),t.restore()}drawTitle(){}}s(Iu,"id","radialLinear"),s(Iu,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Re.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(t){return t},padding:5,centerPointLabels:!1}}),s(Iu,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),s(Iu,"descriptors",{angleLines:{_fallback:"grid"}});const Cu={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Su=Object.keys(Cu);function Tu(t,e){return t-e}function Eu(t,e){if(tt(e))return null;const n=t._adapter,{parser:r,round:i,isoWeekday:o}=t._parseOpts;let s=e;return"function"===typeof r&&(s=r(s)),rt(s)||(s="string"===typeof r?n.parse(s,r):n.parse(s)),null===s?null:(i&&(s="week"!==i||!zt(o)&&!0!==o?n.startOf(s,i):n.startOf(s,"isoWeek",o)),+s)}function Nu(t,e,n,r){const i=Su.length;for(let o=Su.indexOf(t);o<i-1;++o){const t=Cu[Su[o]],i=t.steps?t.steps:Number.MAX_SAFE_INTEGER;if(t.common&&Math.ceil((n-e)/(i*t.size))<=r)return Su[o]}return Su[i-1]}function Au(t,e,n,r,i){for(let o=Su.length-1;o>=Su.indexOf(n);o--){const n=Su[o];if(Cu[n].common&&t._adapter.diff(i,r,n)>=e-1)return n}return Su[n?Su.indexOf(n):0]}function Ru(t){for(let e=Su.indexOf(t)+1,n=Su.length;e<n;++e)if(Cu[Su[e]].common)return Su[e]}function $u(t,e,n){if(n){if(n.length){const{lo:r,hi:i}=Qt(n,e),o=n[r]>=e?n[r]:n[i];t[o]=!0}}else t[e]=!0}function Du(t,e,n,r){const i=t._adapter,o=+i.startOf(e[0].value,r),s=e[e.length-1].value;let a,l;for(a=o;a<=s;a=+i.add(a,1,r))l=n[a],l>=0&&(e[l].major=!0);return e}function Ou(t,e,n){const r=[],i={},o=e.length;let s,a;for(s=0;s<o;++s)a=e[s],i[a]=s,r.push({value:a,major:!1});return 0!==o&&n?Du(t,r,i,n):r}class Fu extends Ho{constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,e={}){const n=t.time||(t.time={}),r=this._adapter=new Ei._date(t.adapters.date);r.init(e),gt(n.displayFormats,r.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(t),this._normalized=e.normalized}parse(t,e){return void 0===t?null:Eu(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,e=this._adapter,n=t.time.unit||"day";let{min:r,max:i,minDefined:o,maxDefined:s}=this.getUserBounds();function a(t){o||isNaN(t.min)||(r=Math.min(r,t.min)),s||isNaN(t.max)||(i=Math.max(i,t.max))}o&&s||(a(this._getLabelBounds()),"ticks"===t.bounds&&"labels"===t.ticks.source||a(this.getMinMax(!1))),r=rt(r)&&!isNaN(r)?r:+e.startOf(Date.now(),n),i=rt(i)&&!isNaN(i)?i:+e.endOf(Date.now(),n)+1,this.min=Math.min(r,i-1),this.max=Math.max(r+1,i)}_getLabelBounds(){const t=this.getLabelTimestamps();let e=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return t.length&&(e=t[0],n=t[t.length-1]),{min:e,max:n}}buildTicks(){const t=this.options,e=t.time,n=t.ticks,r="labels"===n.source?this.getLabelTimestamps():this._generate();"ticks"===t.bounds&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const i=this.min,o=this.max,s=ne(r,i,o);return this._unit=e.unit||(n.autoSkip?Nu(e.minUnit,this.min,this.max,this._getLabelCapacity(i)):Au(this,s.length,e.minUnit,this.min,this.max)),this._majorUnit=n.major.enabled&&"year"!==this._unit?Ru(this._unit):void 0,this.initOffsets(r),t.reverse&&s.reverse(),Ou(this,s,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map((t=>+t.value)))}initOffsets(t=[]){let e,n,r=0,i=0;this.options.offset&&t.length&&(e=this.getDecimalForValue(t[0]),r=1===t.length?1-e:(this.getDecimalForValue(t[1])-e)/2,n=this.getDecimalForValue(t[t.length-1]),i=1===t.length?n:(n-this.getDecimalForValue(t[t.length-2]))/2);const o=t.length<3?.5:.25;r=Yt(r,0,o),i=Yt(i,0,o),this._offsets={start:r,end:i,factor:1/(r+1+i)}}_generate(){const t=this._adapter,e=this.min,n=this.max,r=this.options,i=r.time,o=i.unit||Nu(i.minUnit,e,n,this._getLabelCapacity(e)),s=ot(r.ticks.stepSize,1),a="week"===o&&i.isoWeekday,l=zt(a)||!0===a,u={};let c,h,d=e;if(l&&(d=+t.startOf(d,"isoWeek",a)),d=+t.startOf(d,l?"day":o),t.diff(n,e,o)>1e5*s)throw new Error(e+" and "+n+" are too far apart with stepSize of "+s+" "+o);const p="data"===r.ticks.source&&this.getDataTimestamps();for(c=d,h=0;c<n;c=+t.add(c,s,o),h++)$u(u,c,p);return c!==n&&"ticks"!==r.bounds&&1!==h||$u(u,c,p),Object.keys(u).sort(Tu).map((t=>+t))}getLabelForValue(t){const e=this._adapter,n=this.options.time;return n.tooltipFormat?e.format(t,n.tooltipFormat):e.format(t,n.displayFormats.datetime)}format(t,e){const n=this.options,r=n.time.displayFormats,i=this._unit,o=e||r[i];return this._adapter.format(t,o)}_tickFormatFunction(t,e,n,r){const i=this.options,o=i.ticks.callback;if(o)return lt(o,[t,e,n],this);const s=i.time.displayFormats,a=this._unit,l=this._majorUnit,u=a&&s[a],c=l&&s[l],h=n[e],d=l&&c&&h&&h.major;return this._adapter.format(t,r||(d?c:u))}generateTickLabels(t){let e,n,r;for(e=0,n=t.length;e<n;++e)r=t[e],r.label=this._tickFormatFunction(r.value,e,t)}getDecimalForValue(t){return null===t?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const e=this._offsets,n=this.getDecimalForValue(t);return this.getPixelForDecimal((e.start+n)*e.factor)}getValueForPixel(t){const e=this._offsets,n=this.getDecimalForPixel(t)/e.factor-e.end;return this.min+n*(this.max-this.min)}_getLabelSize(t){const e=this.options.ticks,n=this.ctx.measureText(t).width,r=Ut(this.isHorizontal()?e.maxRotation:e.minRotation),i=Math.cos(r),o=Math.sin(r),s=this._resolveTickFontOptions(0).size;return{w:n*i+s*o,h:n*o+s*i}}_getLabelCapacity(t){const e=this.options.time,n=e.displayFormats,r=n[e.unit]||n.millisecond,i=this._tickFormatFunction(t,0,Ou(this,[t],this._majorUnit),r),o=this._getLabelSize(i),s=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return s>0?s:1}getDataTimestamps(){let t,e,n=this._cache.data||[];if(n.length)return n;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(t=0,e=r.length;t<e;++t)n=n.concat(r[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(n)}getLabelTimestamps(){const t=this._cache.labels||[];let e,n;if(t.length)return t;const r=this.getLabels();for(e=0,n=r.length;e<n;++e)t.push(Eu(this,r[e]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return se(t.sort(Tu))}}function Mu(t,e,n){let r,i,o,s,a=0,l=t.length-1;n?(e>=t[a].pos&&e<=t[l].pos&&({lo:a,hi:l}=te(t,"pos",e)),({pos:r,time:o}=t[a]),({pos:i,time:s}=t[l])):(e>=t[a].time&&e<=t[l].time&&({lo:a,hi:l}=te(t,"time",e)),({time:r,pos:o}=t[a]),({time:i,pos:s}=t[l]));const u=i-r;return u?o+(s-o)*(e-r)/u:o}s(Fu,"id","time"),s(Fu,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});class Pu extends Fu{constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),e=this._table=this.buildLookupTable(t);this._minPos=Mu(e,this.min),this._tableRange=Mu(e,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:e,max:n}=this,r=[],i=[];let o,s,a,l,u;for(o=0,s=t.length;o<s;++o)l=t[o],l>=e&&l<=n&&r.push(l);if(r.length<2)return[{time:e,pos:0},{time:n,pos:1}];for(o=0,s=r.length;o<s;++o)u=r[o+1],a=r[o-1],l=r[o],Math.round((u+a)/2)!==l&&i.push({time:l,pos:o/(s-1)});return i}_generate(){const t=this.min,e=this.max;let n=super.getDataTimestamps();return n.includes(t)&&n.length||n.splice(0,0,t),n.includes(e)&&1!==n.length||n.push(e),n.sort(((t,e)=>t-e))}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const e=this.getDataTimestamps(),n=this.getLabelTimestamps();return t=e.length&&n.length?this.normalize(e.concat(n)):e.length?e:n,t=this._cache.all=t,t}getDecimalForValue(t){return(Mu(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const e=this._offsets,n=this.getDecimalForPixel(t)/e.factor-e.end;return Mu(this._table,n*this._tableRange+this._minPos,!0)}}s(Pu,"id","timeseries"),s(Pu,"defaults",Fu.defaults);var Lu=Object.freeze({__proto__:null,CategoryScale:Yl,LinearScale:tu,LogarithmicScale:au,RadialLinearScale:Iu,TimeScale:Fu,TimeSeriesScale:Pu});const zu=[Ci,ya,Hl,Lu];Ms.register(...zu);var Bu=Ms},199:function(t,e,n){"use strict";n.d(e,{CR:function(){return u},Jh:function(){return a},XA:function(){return l},ZT:function(){return i},ev:function(){return c},mG:function(){return s},pi:function(){return o}});n(560);var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},r(t,e)};function i(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var o=function(){return o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},o.apply(this,arguments)};function s(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,o){function s(t){try{l(r.next(t))}catch(e){o(e)}}function a(t){try{l(r["throw"](t))}catch(e){o(e)}}function l(t){t.done?n(t.value):i(t.value).then(s,a)}l((r=r.apply(t,e||[])).next())}))}function a(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(t){return function(e){return l([t,e])}}function l(a){if(n)throw new TypeError("Generator is already executing.");while(o&&(o=0,a[0]&&(s=0)),s)try{if(n=1,r&&(i=2&a[0]?r["return"]:a[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!(i=i.length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(t,s)}catch(l){a=[6,l],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}}Object.create;function l(t){var e="function"===typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"===typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function u(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{while((void 0===e||e-- >0)&&!(r=o.next()).done)s.push(r.value)}catch(a){i={error:a}}finally{try{r&&!r.done&&(n=o["return"])&&n.call(o)}finally{if(i)throw i.error}}return s}function c(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}Object.create;"function"===typeof SuppressedError&&SuppressedError},2483:function(t,e,n){"use strict";n.d(e,{PO:function(){return z},p7:function(){return ee},tv:function(){return re}});n(560);var r=n(3396),i=n(4870);
/*!
  * vue-router v4.2.5
  * (c) 2023 Eduardo San Martin Morote
  * @license MIT
  */
const o="undefined"!==typeof window;function s(t){return t.__esModule||"Module"===t[Symbol.toStringTag]}const a=Object.assign;function l(t,e){const n={};for(const r in e){const i=e[r];n[r]=c(i)?i.map(t):t(i)}return n}const u=()=>{},c=Array.isArray;const h=/\/$/,d=t=>t.replace(h,"");function p(t,e,n="/"){let r,i={},o="",s="";const a=e.indexOf("#");let l=e.indexOf("?");return a<l&&a>=0&&(l=-1),l>-1&&(r=e.slice(0,l),o=e.slice(l+1,a>-1?a:e.length),i=t(o)),a>-1&&(r=r||e.slice(0,a),s=e.slice(a,e.length)),r=x(null!=r?r:e,n),{fullPath:r+(o&&"?")+o+s,path:r,query:i,hash:s}}function f(t,e){const n=e.query?t(e.query):"";return e.path+(n&&"?")+n+(e.hash||"")}function g(t,e){return e&&t.toLowerCase().startsWith(e.toLowerCase())?t.slice(e.length)||"/":t}function m(t,e,n){const r=e.matched.length-1,i=n.matched.length-1;return r>-1&&r===i&&y(e.matched[r],n.matched[i])&&b(e.params,n.params)&&t(e.query)===t(n.query)&&e.hash===n.hash}function y(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function b(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!v(t[n],e[n]))return!1;return!0}function v(t,e){return c(t)?w(t,e):c(e)?w(e,t):t===e}function w(t,e){return c(e)?t.length===e.length&&t.every(((t,n)=>t===e[n])):1===t.length&&t[0]===e}function x(t,e){if(t.startsWith("/"))return t;if(!t)return e;const n=e.split("/"),r=t.split("/"),i=r[r.length-1];".."!==i&&"."!==i||r.push("");let o,s,a=n.length-1;for(o=0;o<r.length;o++)if(s=r[o],"."!==s){if(".."!==s)break;a>1&&a--}return n.slice(0,a).join("/")+"/"+r.slice(o-(o===r.length?1:0)).join("/")}var k,_;(function(t){t["pop"]="pop",t["push"]="push"})(k||(k={})),function(t){t["back"]="back",t["forward"]="forward",t["unknown"]=""}(_||(_={}));function I(t){if(!t)if(o){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return"/"!==t[0]&&"#"!==t[0]&&(t="/"+t),d(t)}const C=/^[^#]+#/;function S(t,e){return t.replace(C,"#")+e}function T(t,e){const n=document.documentElement.getBoundingClientRect(),r=t.getBoundingClientRect();return{behavior:e.behavior,left:r.left-n.left-(e.left||0),top:r.top-n.top-(e.top||0)}}const E=()=>({left:window.pageXOffset,top:window.pageYOffset});function N(t){let e;if("el"in t){const n=t.el,r="string"===typeof n&&n.startsWith("#");0;const i="string"===typeof n?r?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!i)return;e=T(i,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(null!=e.left?e.left:window.pageXOffset,null!=e.top?e.top:window.pageYOffset)}function A(t,e){const n=history.state?history.state.position-e:-1;return n+t}const R=new Map;function $(t,e){R.set(t,e)}function D(t){const e=R.get(t);return R.delete(t),e}let O=()=>location.protocol+"//"+location.host;function F(t,e){const{pathname:n,search:r,hash:i}=e,o=t.indexOf("#");if(o>-1){let e=i.includes(t.slice(o))?t.slice(o).length:1,n=i.slice(e);return"/"!==n[0]&&(n="/"+n),g(n,"")}const s=g(n,t);return s+r+i}function M(t,e,n,r){let i=[],o=[],s=null;const l=({state:o})=>{const a=F(t,location),l=n.value,u=e.value;let c=0;if(o){if(n.value=a,e.value=o,s&&s===l)return void(s=null);c=u?o.position-u.position:0}else r(a);i.forEach((t=>{t(n.value,l,{delta:c,type:k.pop,direction:c?c>0?_.forward:_.back:_.unknown})}))};function u(){s=n.value}function c(t){i.push(t);const e=()=>{const e=i.indexOf(t);e>-1&&i.splice(e,1)};return o.push(e),e}function h(){const{history:t}=window;t.state&&t.replaceState(a({},t.state,{scroll:E()}),"")}function d(){for(const t of o)t();o=[],window.removeEventListener("popstate",l),window.removeEventListener("beforeunload",h)}return window.addEventListener("popstate",l),window.addEventListener("beforeunload",h,{passive:!0}),{pauseListeners:u,listen:c,destroy:d}}function P(t,e,n,r=!1,i=!1){return{back:t,current:e,forward:n,replaced:r,position:window.history.length,scroll:i?E():null}}function L(t){const{history:e,location:n}=window,r={value:F(t,n)},i={value:e.state};function o(r,o,s){const a=t.indexOf("#"),l=a>-1?(n.host&&document.querySelector("base")?t:t.slice(a))+r:O()+t+r;try{e[s?"replaceState":"pushState"](o,"",l),i.value=o}catch(u){console.error(u),n[s?"replace":"assign"](l)}}function s(t,n){const s=a({},e.state,P(i.value.back,t,i.value.forward,!0),n,{position:i.value.position});o(t,s,!0),r.value=t}function l(t,n){const s=a({},i.value,e.state,{forward:t,scroll:E()});o(s.current,s,!0);const l=a({},P(r.value,t,null),{position:s.position+1},n);o(t,l,!1),r.value=t}return i.value||o(r.value,{back:null,current:r.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0),{location:r,state:i,push:l,replace:s}}function z(t){t=I(t);const e=L(t),n=M(t,e.state,e.location,e.replace);function r(t,e=!0){e||n.pauseListeners(),history.go(t)}const i=a({location:"",base:t,go:r,createHref:S.bind(null,t)},e,n);return Object.defineProperty(i,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(i,"state",{enumerable:!0,get:()=>e.state.value}),i}function B(t){return"string"===typeof t||t&&"object"===typeof t}function W(t){return"string"===typeof t||"symbol"===typeof t}const U={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},V=Symbol("");var j;(function(t){t[t["aborted"]=4]="aborted",t[t["cancelled"]=8]="cancelled",t[t["duplicated"]=16]="duplicated"})(j||(j={}));function H(t,e){return a(new Error,{type:t,[V]:!0},e)}function G(t,e){return t instanceof Error&&V in t&&(null==e||!!(t.type&e))}const q="[^/]+?",K={sensitive:!1,strict:!1,start:!0,end:!0},X=/[.+*?^${}()[\]/\\]/g;function Y(t,e){const n=a({},K,e),r=[];let i=n.start?"^":"";const o=[];for(const a of t){const t=a.length?[]:[90];n.strict&&!a.length&&(i+="/");for(let e=0;e<a.length;e++){const r=a[e];let s=40+(n.sensitive?.25:0);if(0===r.type)e||(i+="/"),i+=r.value.replace(X,"\\$&"),s+=40;else if(1===r.type){const{value:t,repeatable:n,optional:l,regexp:u}=r;o.push({name:t,repeatable:n,optional:l});const c=u||q;if(c!==q){s+=10;try{new RegExp(`(${c})`)}catch(h){throw new Error(`Invalid custom RegExp for param "${t}" (${c}): `+h.message)}}let d=n?`((?:${c})(?:/(?:${c}))*)`:`(${c})`;e||(d=l&&a.length<2?`(?:/${d})`:"/"+d),l&&(d+="?"),i+=d,s+=20,l&&(s+=-8),n&&(s+=-20),".*"===c&&(s+=-50)}t.push(s)}r.push(t)}if(n.strict&&n.end){const t=r.length-1;r[t][r[t].length-1]+=.7000000000000001}n.strict||(i+="/?"),n.end?i+="$":n.strict&&(i+="(?:/|$)");const s=new RegExp(i,n.sensitive?"":"i");function l(t){const e=t.match(s),n={};if(!e)return null;for(let r=1;r<e.length;r++){const t=e[r]||"",i=o[r-1];n[i.name]=t&&i.repeatable?t.split("/"):t}return n}function u(e){let n="",r=!1;for(const i of t){r&&n.endsWith("/")||(n+="/"),r=!1;for(const t of i)if(0===t.type)n+=t.value;else if(1===t.type){const{value:o,repeatable:s,optional:a}=t,l=o in e?e[o]:"";if(c(l)&&!s)throw new Error(`Provided param "${o}" is an array but it is not repeatable (* or + modifiers)`);const u=c(l)?l.join("/"):l;if(!u){if(!a)throw new Error(`Missing required param "${o}"`);i.length<2&&(n.endsWith("/")?n=n.slice(0,-1):r=!0)}n+=u}}return n||"/"}return{re:s,score:r,keys:o,parse:l,stringify:u}}function J(t,e){let n=0;while(n<t.length&&n<e.length){const r=e[n]-t[n];if(r)return r;n++}return t.length<e.length?1===t.length&&80===t[0]?-1:1:t.length>e.length?1===e.length&&80===e[0]?1:-1:0}function Z(t,e){let n=0;const r=t.score,i=e.score;while(n<r.length&&n<i.length){const t=J(r[n],i[n]);if(t)return t;n++}if(1===Math.abs(i.length-r.length)){if(Q(r))return 1;if(Q(i))return-1}return i.length-r.length}function Q(t){const e=t[t.length-1];return t.length>0&&e[e.length-1]<0}const tt={type:0,value:""},et=/[a-zA-Z0-9_]/;function nt(t){if(!t)return[[]];if("/"===t)return[[tt]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(t){throw new Error(`ERR (${n})/"${u}": ${t}`)}let n=0,r=n;const i=[];let o;function s(){o&&i.push(o),o=[]}let a,l=0,u="",c="";function h(){u&&(0===n?o.push({type:0,value:u}):1===n||2===n||3===n?(o.length>1&&("*"===a||"+"===a)&&e(`A repeatable param (${u}) must be alone in its segment. eg: '/:ids+.`),o.push({type:1,value:u,regexp:c,repeatable:"*"===a||"+"===a,optional:"*"===a||"?"===a})):e("Invalid state to consume buffer"),u="")}function d(){u+=a}while(l<t.length)if(a=t[l++],"\\"!==a||2===n)switch(n){case 0:"/"===a?(u&&h(),s()):":"===a?(h(),n=1):d();break;case 4:d(),n=r;break;case 1:"("===a?n=2:et.test(a)?d():(h(),n=0,"*"!==a&&"?"!==a&&"+"!==a&&l--);break;case 2:")"===a?"\\"==c[c.length-1]?c=c.slice(0,-1)+a:n=3:c+=a;break;case 3:h(),n=0,"*"!==a&&"?"!==a&&"+"!==a&&l--,c="";break;default:e("Unknown state");break}else r=n,n=4;return 2===n&&e(`Unfinished custom RegExp for param "${u}"`),h(),s(),i}function rt(t,e,n){const r=Y(nt(t.path),n);const i=a(r,{record:t,parent:e,children:[],alias:[]});return e&&!i.record.aliasOf===!e.record.aliasOf&&e.children.push(i),i}function it(t,e){const n=[],r=new Map;function i(t){return r.get(t)}function o(t,n,r){const i=!r,l=st(t);l.aliasOf=r&&r.record;const h=ct(e,t),d=[l];if("alias"in t){const e="string"===typeof t.alias?[t.alias]:t.alias;for(const t of e)d.push(a({},l,{components:r?r.record.components:l.components,path:t,aliasOf:r?r.record:l}))}let p,f;for(const e of d){const{path:a}=e;if(n&&"/"!==a[0]){const t=n.record.path,r="/"===t[t.length-1]?"":"/";e.path=n.record.path+(a&&r+a)}if(p=rt(e,n,h),r?r.alias.push(p):(f=f||p,f!==p&&f.alias.push(p),i&&t.name&&!lt(p)&&s(t.name)),l.children){const t=l.children;for(let e=0;e<t.length;e++)o(t[e],p,r&&r.children[e])}r=r||p,(p.record.components&&Object.keys(p.record.components).length||p.record.name||p.record.redirect)&&c(p)}return f?()=>{s(f)}:u}function s(t){if(W(t)){const e=r.get(t);e&&(r.delete(t),n.splice(n.indexOf(e),1),e.children.forEach(s),e.alias.forEach(s))}else{const e=n.indexOf(t);e>-1&&(n.splice(e,1),t.record.name&&r.delete(t.record.name),t.children.forEach(s),t.alias.forEach(s))}}function l(){return n}function c(t){let e=0;while(e<n.length&&Z(t,n[e])>=0&&(t.record.path!==n[e].record.path||!ht(t,n[e])))e++;n.splice(e,0,t),t.record.name&&!lt(t)&&r.set(t.record.name,t)}function h(t,e){let i,o,s,l={};if("name"in t&&t.name){if(i=r.get(t.name),!i)throw H(1,{location:t});0,s=i.record.name,l=a(ot(e.params,i.keys.filter((t=>!t.optional)).map((t=>t.name))),t.params&&ot(t.params,i.keys.map((t=>t.name)))),o=i.stringify(l)}else if("path"in t)o=t.path,i=n.find((t=>t.re.test(o))),i&&(l=i.parse(o),s=i.record.name);else{if(i=e.name?r.get(e.name):n.find((t=>t.re.test(e.path))),!i)throw H(1,{location:t,currentLocation:e});s=i.record.name,l=a({},e.params,t.params),o=i.stringify(l)}const u=[];let c=i;while(c)u.unshift(c.record),c=c.parent;return{name:s,path:o,params:l,matched:u,meta:ut(u)}}return e=ct({strict:!1,end:!0,sensitive:!1},e),t.forEach((t=>o(t))),{addRoute:o,resolve:h,removeRoute:s,getRoutes:l,getRecordMatcher:i}}function ot(t,e){const n={};for(const r of e)r in t&&(n[r]=t[r]);return n}function st(t){return{path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:void 0,beforeEnter:t.beforeEnter,props:at(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}}}function at(t){const e={},n=t.props||!1;if("component"in t)e.default=n;else for(const r in t.components)e[r]="object"===typeof n?n[r]:n;return e}function lt(t){while(t){if(t.record.aliasOf)return!0;t=t.parent}return!1}function ut(t){return t.reduce(((t,e)=>a(t,e.meta)),{})}function ct(t,e){const n={};for(const r in t)n[r]=r in e?e[r]:t[r];return n}function ht(t,e){return e.children.some((e=>e===t||ht(t,e)))}const dt=/#/g,pt=/&/g,ft=/\//g,gt=/=/g,mt=/\?/g,yt=/\+/g,bt=/%5B/g,vt=/%5D/g,wt=/%5E/g,xt=/%60/g,kt=/%7B/g,_t=/%7C/g,It=/%7D/g,Ct=/%20/g;function St(t){return encodeURI(""+t).replace(_t,"|").replace(bt,"[").replace(vt,"]")}function Tt(t){return St(t).replace(kt,"{").replace(It,"}").replace(wt,"^")}function Et(t){return St(t).replace(yt,"%2B").replace(Ct,"+").replace(dt,"%23").replace(pt,"%26").replace(xt,"`").replace(kt,"{").replace(It,"}").replace(wt,"^")}function Nt(t){return Et(t).replace(gt,"%3D")}function At(t){return St(t).replace(dt,"%23").replace(mt,"%3F")}function Rt(t){return null==t?"":At(t).replace(ft,"%2F")}function $t(t){try{return decodeURIComponent(""+t)}catch(e){}return""+t}function Dt(t){const e={};if(""===t||"?"===t)return e;const n="?"===t[0],r=(n?t.slice(1):t).split("&");for(let i=0;i<r.length;++i){const t=r[i].replace(yt," "),n=t.indexOf("="),o=$t(n<0?t:t.slice(0,n)),s=n<0?null:$t(t.slice(n+1));if(o in e){let t=e[o];c(t)||(t=e[o]=[t]),t.push(s)}else e[o]=s}return e}function Ot(t){let e="";for(let n in t){const r=t[n];if(n=Nt(n),null==r){void 0!==r&&(e+=(e.length?"&":"")+n);continue}const i=c(r)?r.map((t=>t&&Et(t))):[r&&Et(r)];i.forEach((t=>{void 0!==t&&(e+=(e.length?"&":"")+n,null!=t&&(e+="="+t))}))}return e}function Ft(t){const e={};for(const n in t){const r=t[n];void 0!==r&&(e[n]=c(r)?r.map((t=>null==t?null:""+t)):null==r?r:""+r)}return e}const Mt=Symbol(""),Pt=Symbol(""),Lt=Symbol(""),zt=Symbol(""),Bt=Symbol("");function Wt(){let t=[];function e(e){return t.push(e),()=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)}}function n(){t=[]}return{add:e,list:()=>t.slice(),reset:n}}function Ut(t,e,n,r,i){const o=r&&(r.enterCallbacks[i]=r.enterCallbacks[i]||[]);return()=>new Promise(((s,a)=>{const l=t=>{!1===t?a(H(4,{from:n,to:e})):t instanceof Error?a(t):B(t)?a(H(2,{from:e,to:t})):(o&&r.enterCallbacks[i]===o&&"function"===typeof t&&o.push(t),s())},u=t.call(r&&r.instances[i],e,n,l);let c=Promise.resolve(u);t.length<3&&(c=c.then(l)),c.catch((t=>a(t)))}))}function Vt(t,e,n,r){const i=[];for(const o of t){0;for(const t in o.components){let a=o.components[t];if("beforeRouteEnter"===e||o.instances[t])if(jt(a)){const s=a.__vccOpts||a,l=s[e];l&&i.push(Ut(l,n,r,o,t))}else{let l=a();0,i.push((()=>l.then((i=>{if(!i)return Promise.reject(new Error(`Couldn't resolve component "${t}" at "${o.path}"`));const a=s(i)?i.default:i;o.components[t]=a;const l=a.__vccOpts||a,u=l[e];return u&&Ut(u,n,r,o,t)()}))))}}}return i}function jt(t){return"object"===typeof t||"displayName"in t||"props"in t||"__vccOpts"in t}function Ht(t){const e=(0,r.f3)(Lt),n=(0,r.f3)(zt),o=(0,r.Fl)((()=>e.resolve((0,i.SU)(t.to)))),s=(0,r.Fl)((()=>{const{matched:t}=o.value,{length:e}=t,r=t[e-1],i=n.matched;if(!r||!i.length)return-1;const s=i.findIndex(y.bind(null,r));if(s>-1)return s;const a=Yt(t[e-2]);return e>1&&Yt(r)===a&&i[i.length-1].path!==a?i.findIndex(y.bind(null,t[e-2])):s})),a=(0,r.Fl)((()=>s.value>-1&&Xt(n.params,o.value.params))),l=(0,r.Fl)((()=>s.value>-1&&s.value===n.matched.length-1&&b(n.params,o.value.params)));function c(n={}){return Kt(n)?e[(0,i.SU)(t.replace)?"replace":"push"]((0,i.SU)(t.to)).catch(u):Promise.resolve()}return{route:o,href:(0,r.Fl)((()=>o.value.href)),isActive:a,isExactActive:l,navigate:c}}const Gt=(0,r.aZ)({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Ht,setup(t,{slots:e}){const n=(0,i.qj)(Ht(t)),{options:o}=(0,r.f3)(Lt),s=(0,r.Fl)((()=>({[Jt(t.activeClass,o.linkActiveClass,"router-link-active")]:n.isActive,[Jt(t.exactActiveClass,o.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive})));return()=>{const i=e.default&&e.default(n);return t.custom?i:(0,r.h)("a",{"aria-current":n.isExactActive?t.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:s.value},i)}}}),qt=Gt;function Kt(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&(void 0===t.button||0===t.button)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function Xt(t,e){for(const n in e){const r=e[n],i=t[n];if("string"===typeof r){if(r!==i)return!1}else if(!c(i)||i.length!==r.length||r.some(((t,e)=>t!==i[e])))return!1}return!0}function Yt(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const Jt=(t,e,n)=>null!=t?t:null!=e?e:n,Zt=(0,r.aZ)({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:e,slots:n}){const o=(0,r.f3)(Bt),s=(0,r.Fl)((()=>t.route||o.value)),l=(0,r.f3)(Pt,0),u=(0,r.Fl)((()=>{let t=(0,i.SU)(l);const{matched:e}=s.value;let n;while((n=e[t])&&!n.components)t++;return t})),c=(0,r.Fl)((()=>s.value.matched[u.value]));(0,r.JJ)(Pt,(0,r.Fl)((()=>u.value+1))),(0,r.JJ)(Mt,c),(0,r.JJ)(Bt,s);const h=(0,i.iH)();return(0,r.YP)((()=>[h.value,c.value,t.name]),(([t,e,n],[r,i,o])=>{e&&(e.instances[n]=t,i&&i!==e&&t&&t===r&&(e.leaveGuards.size||(e.leaveGuards=i.leaveGuards),e.updateGuards.size||(e.updateGuards=i.updateGuards))),!t||!e||i&&y(e,i)&&r||(e.enterCallbacks[n]||[]).forEach((e=>e(t)))}),{flush:"post"}),()=>{const i=s.value,o=t.name,l=c.value,u=l&&l.components[o];if(!u)return Qt(n.default,{Component:u,route:i});const d=l.props[o],p=d?!0===d?i.params:"function"===typeof d?d(i):d:null,f=t=>{t.component.isUnmounted&&(l.instances[o]=null)},g=(0,r.h)(u,a({},p,e,{onVnodeUnmounted:f,ref:h}));return Qt(n.default,{Component:g,route:i})||g}}});function Qt(t,e){if(!t)return null;const n=t(e);return 1===n.length?n[0]:n}const te=Zt;function ee(t){const e=it(t.routes,t),n=t.parseQuery||Dt,s=t.stringifyQuery||Ot,h=t.history;const d=Wt(),g=Wt(),y=Wt(),b=(0,i.XI)(U);let v=U;o&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const w=l.bind(null,(t=>""+t)),x=l.bind(null,Rt),_=l.bind(null,$t);function I(t,n){let r,i;return W(t)?(r=e.getRecordMatcher(t),i=n):i=t,e.addRoute(i,r)}function C(t){const n=e.getRecordMatcher(t);n&&e.removeRoute(n)}function S(){return e.getRoutes().map((t=>t.record))}function T(t){return!!e.getRecordMatcher(t)}function R(t,r){if(r=a({},r||b.value),"string"===typeof t){const i=p(n,t,r.path),o=e.resolve({path:i.path},r),s=h.createHref(i.fullPath);return a(i,o,{params:_(o.params),hash:$t(i.hash),redirectedFrom:void 0,href:s})}let i;if("path"in t)i=a({},t,{path:p(n,t.path,r.path).path});else{const e=a({},t.params);for(const t in e)null==e[t]&&delete e[t];i=a({},t,{params:x(e)}),r.params=x(r.params)}const o=e.resolve(i,r),l=t.hash||"";o.params=w(_(o.params));const u=f(s,a({},t,{hash:Tt(l),path:o.path})),c=h.createHref(u);return a({fullPath:u,hash:l,query:s===Ot?Ft(t.query):t.query||{}},o,{redirectedFrom:void 0,href:c})}function O(t){return"string"===typeof t?p(n,t,b.value.path):a({},t)}function F(t,e){if(v!==t)return H(8,{from:e,to:t})}function M(t){return z(t)}function P(t){return M(a(O(t),{replace:!0}))}function L(t){const e=t.matched[t.matched.length-1];if(e&&e.redirect){const{redirect:n}=e;let r="function"===typeof n?n(t):n;return"string"===typeof r&&(r=r.includes("?")||r.includes("#")?r=O(r):{path:r},r.params={}),a({query:t.query,hash:t.hash,params:"path"in r?{}:t.params},r)}}function z(t,e){const n=v=R(t),r=b.value,i=t.state,o=t.force,l=!0===t.replace,u=L(n);if(u)return z(a(O(u),{state:"object"===typeof u?a({},i,u.state):i,force:o,replace:l}),e||n);const c=n;let h;return c.redirectedFrom=e,!o&&m(s,r,n)&&(h=H(16,{to:c,from:r}),rt(r,r,!0,!1)),(h?Promise.resolve(h):j(c,r)).catch((t=>G(t)?G(t,2)?t:nt(t):tt(t,c,r))).then((t=>{if(t){if(G(t,2))return z(a({replace:l},O(t.to),{state:"object"===typeof t.to?a({},i,t.to.state):i,force:o}),e||c)}else t=K(c,r,!0,l,i);return q(c,r,t),t}))}function B(t,e){const n=F(t,e);return n?Promise.reject(n):Promise.resolve()}function V(t){const e=at.values().next().value;return e&&"function"===typeof e.runWithContext?e.runWithContext(t):t()}function j(t,e){let n;const[r,i,o]=ne(t,e);n=Vt(r.reverse(),"beforeRouteLeave",t,e);for(const a of r)a.leaveGuards.forEach((r=>{n.push(Ut(r,t,e))}));const s=B.bind(null,t,e);return n.push(s),ut(n).then((()=>{n=[];for(const r of d.list())n.push(Ut(r,t,e));return n.push(s),ut(n)})).then((()=>{n=Vt(i,"beforeRouteUpdate",t,e);for(const r of i)r.updateGuards.forEach((r=>{n.push(Ut(r,t,e))}));return n.push(s),ut(n)})).then((()=>{n=[];for(const r of o)if(r.beforeEnter)if(c(r.beforeEnter))for(const i of r.beforeEnter)n.push(Ut(i,t,e));else n.push(Ut(r.beforeEnter,t,e));return n.push(s),ut(n)})).then((()=>(t.matched.forEach((t=>t.enterCallbacks={})),n=Vt(o,"beforeRouteEnter",t,e),n.push(s),ut(n)))).then((()=>{n=[];for(const r of g.list())n.push(Ut(r,t,e));return n.push(s),ut(n)})).catch((t=>G(t,8)?t:Promise.reject(t)))}function q(t,e,n){y.list().forEach((r=>V((()=>r(t,e,n)))))}function K(t,e,n,r,i){const s=F(t,e);if(s)return s;const l=e===U,u=o?history.state:{};n&&(r||l?h.replace(t.fullPath,a({scroll:l&&u&&u.scroll},i)):h.push(t.fullPath,i)),b.value=t,rt(t,e,n,l),nt()}let X;function Y(){X||(X=h.listen(((t,e,n)=>{if(!lt.listening)return;const r=R(t),i=L(r);if(i)return void z(a(i,{replace:!0}),r).catch(u);v=r;const s=b.value;o&&$(A(s.fullPath,n.delta),E()),j(r,s).catch((t=>G(t,12)?t:G(t,2)?(z(t.to,r).then((t=>{G(t,20)&&!n.delta&&n.type===k.pop&&h.go(-1,!1)})).catch(u),Promise.reject()):(n.delta&&h.go(-n.delta,!1),tt(t,r,s)))).then((t=>{t=t||K(r,s,!1),t&&(n.delta&&!G(t,8)?h.go(-n.delta,!1):n.type===k.pop&&G(t,20)&&h.go(-1,!1)),q(r,s,t)})).catch(u)})))}let J,Z=Wt(),Q=Wt();function tt(t,e,n){nt(t);const r=Q.list();return r.length?r.forEach((r=>r(t,e,n))):console.error(t),Promise.reject(t)}function et(){return J&&b.value!==U?Promise.resolve():new Promise(((t,e)=>{Z.add([t,e])}))}function nt(t){return J||(J=!t,Y(),Z.list().forEach((([e,n])=>t?n(t):e())),Z.reset()),t}function rt(e,n,i,s){const{scrollBehavior:a}=t;if(!o||!a)return Promise.resolve();const l=!i&&D(A(e.fullPath,0))||(s||!i)&&history.state&&history.state.scroll||null;return(0,r.Y3)().then((()=>a(e,n,l))).then((t=>t&&N(t))).catch((t=>tt(t,e,n)))}const ot=t=>h.go(t);let st;const at=new Set,lt={currentRoute:b,listening:!0,addRoute:I,removeRoute:C,hasRoute:T,getRoutes:S,resolve:R,options:t,push:M,replace:P,go:ot,back:()=>ot(-1),forward:()=>ot(1),beforeEach:d.add,beforeResolve:g.add,afterEach:y.add,onError:Q.add,isReady:et,install(t){const e=this;t.component("RouterLink",qt),t.component("RouterView",te),t.config.globalProperties.$router=e,Object.defineProperty(t.config.globalProperties,"$route",{enumerable:!0,get:()=>(0,i.SU)(b)}),o&&!st&&b.value===U&&(st=!0,M(h.location).catch((t=>{0})));const n={};for(const i in U)Object.defineProperty(n,i,{get:()=>b.value[i],enumerable:!0});t.provide(Lt,e),t.provide(zt,(0,i.Um)(n)),t.provide(Bt,b);const r=t.unmount;at.add(t),t.unmount=function(){at.delete(t),at.size<1&&(v=U,X&&X(),X=null,b.value=U,st=!1,J=!1),r()}}};function ut(t){return t.reduce(((t,e)=>t.then((()=>V(e)))),Promise.resolve())}return lt}function ne(t,e){const n=[],r=[],i=[],o=Math.max(e.matched.length,t.matched.length);for(let s=0;s<o;s++){const o=e.matched[s];o&&(t.matched.find((t=>y(t,o)))?r.push(o):n.push(o));const a=t.matched[s];a&&(e.matched.find((t=>y(t,a)))||i.push(a))}return[n,r,i]}function re(){return(0,r.f3)(Lt)}}}]);
//# sourceMappingURL=chunk-vendors.b64ad73d.js.map